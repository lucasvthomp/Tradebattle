{"file_contents":{"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# Paper Trading Competition Platform\n\n## Overview\nA comprehensive paper trading competition platform enabling users to participate in global trading competitions. It offers virtual portfolio management, real-time market data, and competitive leaderboards, allowing aspiring traders to test skills in a risk-free environment with authentic market conditions. The platform fosters competition through features like tournament-specific trading, achievement systems, and real-time leaderboards, aiming to be a central hub for virtual trading challenges.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript\n- **Build Tool**: Vite\n- **Routing**: Wouter\n- **State Management**: TanStack Query (React Query)\n- **UI Framework**: Radix UI components with shadcn/ui styling\n- **Styling**: Tailwind CSS with CSS variables\n- **Animations**: Framer Motion\n- **Internationalization**: Comprehensive multi-language support (English, Portuguese, Spanish)\n- **Currency System**: Supports 10 currencies with proper formatting\n- **Signup Flow**: Multi-step signup experience with preferences selection\n- **Theming**: Dark mode implementation with consistent color schemes\n\n### Backend Architecture\n- **Runtime**: Node.js with Express.js\n- **Language**: TypeScript with ES modules\n- **Database**: PostgreSQL with Drizzle ORM (Neon Database provider)\n- **Authentication**: Replit Auth with OpenID Connect (username-based)\n- **Session Management**: PostgreSQL-backed sessions\n- **Monorepo Structure**: Client, server, and shared code separation\n- **API Design**: RESTful with middleware-based protection, centralized error handling, and request logging\n- **Financial Data Integration**: Real-time and historical stock data from Yahoo Finance API (previously Finnhub, Twelve Data, Polygon.io)\n- **Tournament Management**: Isolated tournament balances, unique codes, buy-ins, and customizable trading restrictions\n- **Achievement System**: Tiered badge system based on trading accomplishments and milestones\n- **Chat System**: Optimized real-time global and tournament-specific chat functionality (1.5s refresh rate, semi-transparent UI)\n- **Market Status**: Real-time market open/close detection with disclaimers and trade scheduling\n- **Buy-in System**: Complete tournament buy-in processing with creator and participant fee deduction, pot accumulation, and automatic prize distribution on tournament expiration\n\n### Key Design Decisions\n- **TypeScript-First**: End-to-end TypeScript implementation.\n- **Component-Driven UI**: Reusable components for consistent design.\n- **Data Flow**: User authentication, paper trading, competition participation, portfolio management, and real-time updates.\n- **Scalability**: Designed to handle real-time market data and a growing user base.\n- **User Experience**: Focus on intuitive interfaces, clear navigation, and engaging competitive features.\n- **Unified Dashboard**: Consolidation of personal portfolio and tournament trading into a single interface with proportional 2/3 + 1/3 layout.\n- **Dynamic Home Page**: Dual home page system for unauthenticated (marketing-focused) and authenticated (gaming-style hub) users.\n- **Optimized Chat System**: Fast 1.5s refresh intervals, semi-transparent UI design, compact chat selectors.\n- **Automated Tournament Management**: Scheduled tournaments automatically start when countdown reaches zero via background scheduler service.\n- **Complete Buy-in System**: Tournament creators and participants pay buy-ins from siteCash, with automatic pot accumulation and prize distribution (95% winner, 5% creator).\n- **Smart Trading Day Detection**: 1D timeframe intelligently excludes weekends and shows the most recent trading day data (e.g., Friday's data on weekends) with 5-minute intervals for authentic intraday movements.\n\n## External Dependencies\n- **Database**: Neon PostgreSQL\n- **Authentication**: Replit Auth\n- **Financial Data**: Yahoo Finance API (via `yahoo-finance2` NPM package)\n- **UI Components**: Radix UI, shadcn/ui\n- **Styling**: Tailwind CSS\n- **Forms**: React Hook Form, Zod\n- **Date Handling**: date-fns\n- **Charting**: Recharts (for portfolio graphs)","size_bytes":4248},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n        \"glow\": {\n          \"0%\": {\n            \"text-shadow\": \"0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green)\",\n          },\n          \"100%\": {\n            \"text-shadow\": \"0 0 20px var(--neon-green), 0 0 30px var(--neon-green), 0 0 40px var(--neon-green)\",\n          },\n        },\n        \"float\": {\n          \"0%, 100%\": {\n            transform: \"translateY(0px)\",\n          },\n          \"50%\": {\n            transform: \"translateY(-20px)\",\n          },\n        },\n        \"slide-up\": {\n          \"0%\": {\n            opacity: \"0\",\n            transform: \"translateY(20px)\",\n          },\n          \"100%\": {\n            opacity: \"1\",\n            transform: \"translateY(0)\",\n          },\n        },\n        \"fade-in\": {\n          \"0%\": {\n            opacity: \"0\",\n          },\n          \"100%\": {\n            opacity: \"1\",\n          },\n        },\n        \"pulse-glow\": {\n          \"0%\": {\n            \"box-shadow\": \"0 0 20px var(--neon-green)\",\n          },\n          \"100%\": {\n            \"box-shadow\": \"0 0 40px var(--neon-green)\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n        \"glow\": \"glow 2s ease-in-out infinite alternate\",\n        \"float\": \"float 6s ease-in-out infinite\",\n        \"slide-up\": \"slide-up 0.5s cubic-bezier(0.4, 0, 0.2, 1)\",\n        \"fade-in\": \"fade-in 0.5s cubic-bezier(0.4, 0, 0.2, 1)\",\n        \"pulse-glow\": \"pulse-glow 2s ease-in-out infinite alternate\",\n        \"pulse-slow\": \"pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4102},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/auth.ts":{"content":"import passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport { Express } from \"express\";\nimport session from \"express-session\";\nimport { scrypt, randomBytes, timingSafeEqual } from \"crypto\";\nimport { promisify } from \"util\";\nimport connectPg from \"connect-pg-simple\";\nimport MemoryStore from \"memorystore\";\nimport { storage } from \"./storage\";\nimport { User, LoginUser, RegisterUser } from \"@shared/schema\";\n\n// Global flag to disable authentication entirely\nconst AUTH_DISABLED = process.env.AUTH_DISABLED === 'true' || true; // Temporarily forcing true\nexport { AUTH_DISABLED };\n\n// Development user when auth is disabled\nconst DEV_USER: User = {\n  id: 1,\n  userId: null,\n  email: \"admin@dev.local\",\n  username: \"admin\",\n  profilePicture: null,\n  lastUsernameChange: null,\n  password: \"admin\",\n  country: \"US\",\n  language: \"en\",\n  currency: \"USD\",\n  balance: \"100000\",\n  siteCash: \"10000\",\n  subscriptionTier: \"premium\",\n  premiumUpgradeDate: new Date(),\n  personalBalance: \"50000\",\n  totalDeposited: \"0\",\n  tournamentWins: 0,\n  banned: false,\n  adminNote: null,\n  createdAt: new Date(),\n  updatedAt: new Date()\n};\n\ndeclare global {\n  namespace Express {\n    interface User extends User {}\n  }\n}\n\nconst scryptAsync = promisify(scrypt);\n\nasync function hashPassword(password: string): Promise<string> {\n  const salt = randomBytes(16).toString(\"hex\");\n  const buf = (await scryptAsync(password, salt, 64)) as Buffer;\n  return `${buf.toString(\"hex\")}.${salt}`;\n}\n\nasync function comparePasswords(supplied: string, stored: string): Promise<boolean> {\n  // Handle both hashed and plain text passwords during migration\n  if (!stored.includes(\".\")) {\n    // Plain text password - compare directly\n    return supplied === stored;\n  }\n  \n  const [hashed, salt] = stored.split(\".\");\n  if (!hashed || !salt) {\n    return false;\n  }\n  \n  const hashedBuf = Buffer.from(hashed, \"hex\");\n  const suppliedBuf = (await scryptAsync(supplied, salt, 64)) as Buffer;\n  return timingSafeEqual(hashedBuf, suppliedBuf);\n}\n\nexport function setupAuth(app: Express) {\n  if (AUTH_DISABLED) {\n    console.warn(\"⚠️  AUTHENTICATION DISABLED - All users will be logged in as admin\");\n    // Short-circuit authentication - all requests get admin user\n    app.use((req, res, next) => {\n      req.user = DEV_USER;\n      req.isAuthenticated = () => true;\n      next();\n    });\n    return;\n  }\n\n  // Session configuration with database fallback\n  let sessionStore: any;\n  let isDatabaseAvailable = true;\n  \n  try {\n    const PostgresSessionStore = connectPg(session);\n    sessionStore = new PostgresSessionStore({\n      conString: process.env.DATABASE_URL,\n      createTableIfMissing: false,\n      tableName: \"sessions\",\n    });\n  } catch (error) {\n    console.log(\"Database session store unavailable, using memory store\");\n    isDatabaseAvailable = false;\n    const MemoryStoreSession = MemoryStore(session);\n    sessionStore = new MemoryStoreSession({\n      checkPeriod: 86400000, // prune expired entries every 24h\n    });\n  }\n\n  const sessionSettings: session.SessionOptions = {\n    secret: process.env.SESSION_SECRET || \"your-secret-key\",\n    resave: false,\n    saveUninitialized: false,\n    store: sessionStore,\n    cookie: {\n      secure: false, // Set to true in production with HTTPS\n      httpOnly: true,\n      maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n    },\n  };\n\n  app.set(\"trust proxy\", 1);\n  app.use(session(sessionSettings));\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // Configure passport local strategy with database fallback\n  passport.use(\n    new LocalStrategy(\n      { usernameField: \"username\" },\n      async (username, password, done) => {\n        try {\n          const user = await storage.getUserByUsername(username);\n          if (!user || !(await comparePasswords(password, user.password))) {\n            return done(null, false, { message: \"Invalid email or password\" });\n          }\n          return done(null, user);\n        } catch (error) {\n          // Check if this is a Neon API disabled error\n          if (error instanceof Error && error.message.includes(\"The endpoint has been disabled\")) {\n            console.log(\"Database unavailable, using development bypass for any credentials\");\n            // Create a mock admin user for development access\n            const mockAdmin: User = {\n              id: 1,\n              userId: null,\n              email: \"admin@dev.local\",\n              username: \"admin\",\n              profilePicture: null,\n              lastUsernameChange: null,\n              password: \"admin\", // In real scenarios, this would be hashed\n              country: \"US\",\n              language: \"en\",\n              currency: \"USD\",\n              balance: \"100000\",\n              siteCash: \"10000\",\n              subscriptionTier: \"premium\",\n              premiumUpgradeDate: new Date(),\n              personalBalance: \"50000\",\n              totalDeposited: \"0\",\n              tournamentWins: 0,\n              banned: false,\n              adminNote: null,\n              createdAt: new Date(),\n              updatedAt: new Date()\n            };\n            return done(null, mockAdmin);\n          }\n          return done(error);\n        }\n      }\n    )\n  );\n\n  passport.serializeUser((user, done) => done(null, user.id));\n  passport.deserializeUser(async (id: number, done) => {\n    try {\n      const user = await storage.getUser(id);\n      done(null, user);\n    } catch (error) {\n      // If database is unavailable, return the mock admin user for id 1\n      if (error instanceof Error && error.message.includes(\"The endpoint has been disabled\") && id === 1) {\n        const mockAdmin: User = {\n          id: 1,\n          userId: null,\n          email: \"admin@dev.local\",\n          username: \"admin\",\n          profilePicture: null,\n          lastUsernameChange: null,\n          password: \"admin\",\n          country: \"US\",\n          language: \"en\",\n          currency: \"USD\",\n          balance: \"100000\",\n          siteCash: \"10000\",\n          subscriptionTier: \"premium\",\n          premiumUpgradeDate: new Date(),\n          personalBalance: \"50000\",\n          totalDeposited: \"0\",\n          tournamentWins: 0,\n          banned: false,\n          adminNote: null,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        };\n        return done(null, mockAdmin);\n      }\n      done(error);\n    }\n  });\n\n  // Registration endpoint\n  app.post(\"/api/register\", async (req, res, next) => {\n    try {\n      const { email, username, password, country, language, currency } = req.body;\n\n      // Check if user already exists\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"User already exists with this email\" });\n      }\n\n      // Validate username\n      if (!username || username.length < 3 || username.length > 15 || !/^[a-zA-Z0-9_]+$/.test(username)) {\n        return res.status(400).json({ message: \"Username must be 3-15 characters and contain only letters, numbers, and underscores\" });\n      }\n\n      // Check if username is already taken\n      const existingUsername = await storage.getUserByUsername(username);\n      if (existingUsername) {\n        return res.status(400).json({ message: \"Username is already taken\" });\n      }\n\n      // Create user (password will be hashed in storage)\n      const userData: any = {\n        email,\n        username,\n        password,\n        country: country || null,\n        language: language || \"English\",\n        currency: currency || \"USD\",\n        subscriptionTier: \"free\",\n        premiumUpgradeDate: null,\n      };\n\n      const user = await storage.createUser(userData);\n\n      // Award achievements for new user\n      try {\n        // Award Welcome achievement\n        await storage.awardAchievementByParams(user.id, \"Welcome\", \"Common\", \"Welcome to ORSATH\", \"Welcome to the platform!\");\n        \n\n      } catch (achievementError) {\n        console.error(\"Error awarding achievements:\", achievementError);\n        // Don't fail registration if achievements fail\n      }\n\n      // Log the user in automatically\n      req.login(user, (err) => {\n        if (err) return next(err);\n        res.status(201).json({\n          id: user.id,\n          userId: user.userId,\n          email: user.email,\n          username: user.username,\n          displayName: user.displayName,\n          country: user.country,\n          language: user.language,\n          currency: user.currency,\n          subscriptionTier: user.subscriptionTier,\n          createdAt: user.createdAt,\n          updatedAt: user.updatedAt,\n        });\n      });\n    } catch (error) {\n      console.error(\"Registration error:\", error);\n      res.status(500).json({ message: \"Registration failed\" });\n    }\n  });\n\n  // Login endpoint\n  app.post(\"/api/login\", (req, res, next) => {\n    passport.authenticate(\"local\", (err: any, user: User | false, info: any) => {\n      if (err) return next(err);\n      if (!user) {\n        return res.status(401).json({ message: info?.message || \"Login failed\" });\n      }\n\n      req.login(user, (err) => {\n        if (err) return next(err);\n        res.json({\n          id: user.id,\n          userId: user.userId,\n          email: user.email,\n          username: user.username,\n          displayName: user.displayName,\n          firstName: user.firstName,\n          lastName: user.lastName,\n          subscriptionTier: user.subscriptionTier,\n          createdAt: user.createdAt,\n          updatedAt: user.updatedAt,\n        });\n      });\n    })(req, res, next);\n  });\n\n  // Logout endpoint\n  app.post(\"/api/logout\", (req, res, next) => {\n    req.logout((err) => {\n      if (err) return next(err);\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  // Get current user endpoint\n  app.get(\"/api/user\", async (req, res) => {\n    if (AUTH_DISABLED) {\n      // Return dev user without hitting database\n      return res.json({\n        id: DEV_USER.id,\n        userId: DEV_USER.userId,\n        email: DEV_USER.email,\n        username: DEV_USER.username,\n        subscriptionTier: DEV_USER.subscriptionTier,\n        siteCash: DEV_USER.siteCash,\n        balance: DEV_USER.balance,\n        createdAt: DEV_USER.createdAt,\n        updatedAt: DEV_USER.updatedAt,\n      });\n    }\n    \n    if (!req.isAuthenticated() || !req.user) {\n      return res.status(401).json({ message: \"Not authenticated\" });\n    }\n    \n    try {\n      // Always fetch fresh user data from database to ensure latest subscription tier\n      const freshUser = await storage.getUser(req.user.id);\n      if (!freshUser) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      res.json({\n        id: freshUser.id,\n        userId: freshUser.userId,\n        email: freshUser.email,\n        username: freshUser.username,\n        displayName: freshUser.displayName,\n        firstName: freshUser.firstName,\n        lastName: freshUser.lastName,\n        subscriptionTier: freshUser.subscriptionTier,\n        siteCash: freshUser.siteCash,\n        balance: freshUser.balance,\n        createdAt: freshUser.createdAt,\n        updatedAt: freshUser.updatedAt,\n      });\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n}\n\n// Authentication middleware\nexport function requireAuth(req: any, res: any, next: any) {\n  if (AUTH_DISABLED) {\n    return next(); // Skip authentication check\n  }\n  if (!req.isAuthenticated()) {\n    return res.status(401).json({ message: \"Authentication required\" });\n  }\n  next();\n}\n\n// Export hashPassword for use in storage\nexport { hashPassword };","size_bytes":11707},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { tournamentScheduler } from \"./services/tournamentScheduler\";\nimport { AUTH_DISABLED } from \"./auth\";\n\nconst app = express();\napp.use(express.json({ limit: '50mb' })); // Increase limit for profile pictures\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on port 5000\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = 5000;\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    // Start tournament expiration scheduler (disabled when auth is disabled)\n    if (AUTH_DISABLED) {\n      log('Tournament scheduler disabled (authentication disabled)');\n    } else {\n      try {\n        tournamentScheduler.start();\n      } catch (error) {\n        log('Tournament scheduler disabled due to database connectivity issues');\n      }\n    }\n  });\n})();\n","size_bytes":2447},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nif (!process.env.REPLIT_DOMAINS) {\n  throw new Error(\"Environment variable REPLIT_DOMAINS not provided\");\n}\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  for (const domain of process.env\n    .REPLIT_DOMAINS!.split(\",\")) {\n    const strategy = new Strategy(\n      {\n        name: `replitauth:${domain}`,\n        config,\n        scope: \"openid email profile offline_access\",\n        callbackURL: `https://${domain}/api/callback`,\n      },\n      verify,\n    );\n    passport.use(strategy);\n  }\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":4221},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\n\nimport { storage } from \"./storage\";\nimport { setupAuth, requireAuth } from \"./auth\";\nimport { insertContactSchema, insertWatchlistSchema, insertStockPurchaseSchema, registerSchema, loginSchema } from \"@shared/schema\";\nimport apiRoutes from \"./routes/api.js\";\nimport { errorHandler } from \"./utils/errorHandler.js\";\nimport { trackRequest, getSystemStatus } from \"./services/systemMonitor.js\";\nimport { z } from \"zod\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Add request tracking middleware\n  app.use(trackRequest);\n  \n  // Auth setup\n  setupAuth(app);\n\n  // Mount Yahoo Finance API routes\n  app.use('/api', apiRoutes);\n\n  // Authentication routes are handled in setupAuth()\n\n  // User profile routes (protected)\n  app.put('/api/user/profile', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      console.log(\"Profile update request for user:\", userId);\n      console.log(\"Request body:\", req.body);\n      \n      const validatedData = z.object({\n        email: z.string().email(),\n        displayName: z.string().optional().nullable(),\n        username: z.string().min(3, \"Username must be at least 3 characters\").max(15, \"Username must be at most 15 characters\").regex(/^[a-zA-Z0-9_]+$/, \"Username can only contain letters, numbers, and underscores\").optional()\n      }).parse(req.body);\n      \n      console.log(\"Validated data:\", validatedData);\n      \n      const updatedUser = await storage.updateUser(userId, validatedData);\n      console.log(\"Updated user:\", updatedUser);\n      \n      res.json(updatedUser);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        console.error(\"Validation error:\", error.errors);\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Error updating user profile:\", error);\n      res.status(500).json({ message: \"Failed to update profile\" });\n    }\n  });\n\n  // User preferences route (protected)\n  app.put('/api/user/preferences', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const validatedData = z.object({\n        language: z.string().optional(),\n        currency: z.string().optional()\n      }).parse(req.body);\n      \n      const updatedUser = await storage.updateUser(userId, validatedData);\n      res.json(updatedUser);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Error updating user preferences:\", error);\n      res.status(500).json({ message: \"Failed to update preferences\" });\n    }\n  });\n\n  // Balance management routes (protected)\n  app.post('/api/user/balance/add', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const validatedData = z.object({\n        amount: z.number().positive(\"Amount must be positive\")\n      }).parse(req.body);\n      \n      const updatedUser = await storage.addUserBalance(userId, validatedData.amount);\n      res.json({ \n        success: true, \n        message: `Added $${validatedData.amount} to your balance`,\n        newBalance: Number(updatedUser.balance)\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid amount\", errors: error.errors });\n      }\n      console.error(\"Error adding balance:\", error);\n      res.status(500).json({ message: \"Failed to add balance\" });\n    }\n  });\n\n  app.post('/api/user/balance/withdraw', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const validatedData = z.object({\n        amount: z.number().positive(\"Amount must be positive\")\n      }).parse(req.body);\n      \n      // Check if user has sufficient balance\n      const user = await storage.getUserById(userId);\n      const currentBalance = Number(user?.balance || 0);\n      \n      if (currentBalance < validatedData.amount) {\n        return res.status(400).json({ \n          message: \"Insufficient balance\",\n          currentBalance: currentBalance,\n          requestedAmount: validatedData.amount\n        });\n      }\n      \n      const updatedUser = await storage.subtractUserBalance(userId, validatedData.amount);\n      res.json({ \n        success: true, \n        message: `Withdrew $${validatedData.amount} from your balance`,\n        newBalance: Number(updatedUser.balance)\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid amount\", errors: error.errors });\n      }\n      console.error(\"Error withdrawing balance:\", error);\n      res.status(500).json({ message: \"Failed to withdraw balance\" });\n    }\n  });\n\n\n\n  // Watchlist routes (protected)\n  app.get('/api/watchlist', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const watchlist = await storage.getUserWatchlist(userId);\n      res.json(watchlist);\n    } catch (error) {\n      console.error(\"Error fetching watchlist:\", error);\n      res.status(500).json({ message: \"Failed to fetch watchlist\" });\n    }\n  });\n\n  app.post('/api/watchlist', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const validatedData = insertWatchlistSchema.parse(req.body);\n      \n      // If companyName is same as symbol, fetch the real company name from Yahoo Finance API\n      let companyName = validatedData.companyName;\n      if (companyName === validatedData.symbol || !companyName) {\n        try {\n          // Import the Yahoo Finance service to get company profile\n          const { getCompanyProfile } = await import('./services/yahooFinance.js');\n          const profile = await getCompanyProfile(validatedData.symbol);\n          companyName = (profile as any).longName || (profile as any).shortName || validatedData.symbol;\n          console.log(`Fetched company name for ${validatedData.symbol}: ${companyName}`);\n        } catch (error) {\n          console.log(`Could not fetch company name for ${validatedData.symbol}, using symbol`);\n          companyName = validatedData.symbol;\n        }\n      }\n      \n      // Create watchlist item with proper company name\n      const watchlistData = {\n        ...validatedData,\n        companyName\n      };\n      \n      const watchlistItem = await storage.addToWatchlist(userId, watchlistData);\n      res.status(201).json(watchlistItem);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Error adding to watchlist:\", error);\n      res.status(500).json({ message: \"Failed to add to watchlist\" });\n    }\n  });\n\n  app.delete('/api/watchlist/:id', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const id = parseInt(req.params.id);\n      await storage.removeFromWatchlist(userId, id);\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error removing from watchlist:\", error);\n      res.status(500).json({ message: \"Failed to remove from watchlist\" });\n    }\n  });\n\n  // Trading routes (protected)\n  app.get('/api/trading/balance', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const balance = await storage.getUserBalance(userId);\n      res.json({ balance });\n    } catch (error) {\n      console.error(\"Error fetching balance:\", error);\n      res.status(500).json({ message: \"Failed to fetch balance\" });\n    }\n  });\n\n  app.post('/api/trading/purchase', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const validatedData = insertStockPurchaseSchema.parse(req.body);\n      \n      // Check user's balance\n      const currentBalance = await storage.getUserBalance(userId);\n      const totalCost = parseFloat(validatedData.totalCost);\n      \n      if (currentBalance < totalCost) {\n        return res.status(400).json({ \n          message: \"Insufficient balance. Purchase cancelled.\",\n          balance: currentBalance,\n          required: totalCost\n        });\n      }\n      \n      // Create the purchase\n      const purchase = await storage.purchaseStock(userId, validatedData);\n      \n      // Update user balance\n      const newBalance = currentBalance - totalCost;\n      await storage.updateUserBalance(userId, newBalance);\n\n      // Award First Trade achievement if not already earned\n      const hasFirstTrade = await storage.hasAchievement(userId, 'First Trade');\n      if (!hasFirstTrade) {\n        await storage.awardAchievement({\n          userId: userId,\n          achievementType: 'first_trade',\n          achievementTier: 'common',\n          achievementName: 'First Trade',\n          achievementDescription: 'Made your first trade'\n        });\n      }\n      \n      res.status(201).json({ \n        purchase,\n        newBalance \n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Error processing stock purchase:\", error);\n      res.status(500).json({ message: \"Failed to process stock purchase\" });\n    }\n  });\n\n  app.get('/api/trading/purchases', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const purchases = await storage.getUserStockPurchases(userId);\n      res.json(purchases);\n    } catch (error) {\n      console.error(\"Error fetching purchases:\", error);\n      res.status(500).json({ message: \"Failed to fetch purchases\" });\n    }\n  });\n\n  app.post('/api/trading/sell', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { purchaseId, shares, salePrice, totalValue } = req.body;\n      \n      // Validate input\n      if (!purchaseId || !shares || !salePrice || !totalValue) {\n        return res.status(400).json({ message: \"Missing required fields\" });\n      }\n      \n      // Delete the purchase record\n      await storage.deletePurchase(userId, purchaseId);\n      \n      // Update user balance\n      const currentBalance = await storage.getUserBalance(userId);\n      const newBalance = currentBalance + totalValue;\n      await storage.updateUserBalance(userId, newBalance);\n      \n      res.status(200).json({ \n        message: \"Stock sold successfully\",\n        newBalance,\n        saleValue: totalValue\n      });\n    } catch (error) {\n      console.error(\"Error selling stock:\", error);\n      res.status(500).json({ message: \"Failed to sell stock\" });\n    }\n  });\n\n  // Contact form route\n  app.post('/api/contact', async (req, res) => {\n    try {\n      const validatedData = insertContactSchema.parse(req.body);\n      const submission = await storage.createContactSubmission(validatedData);\n      res.status(201).json(submission);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"Error creating contact submission:\", error);\n      res.status(500).json({ message: \"Failed to create contact submission\" });\n    }\n  });\n\n  // Admin endpoint to get all users (only for userId 0 or 1)\n  app.get(\"/api/admin/users\", requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.userId;\n      \n      // Check if user is admin (userId 0, 1, or 2)\n      if (userId !== 0 && userId !== 1 && userId !== 2) {\n        return res.status(403).json({ message: \"Access denied. Admin privileges required.\" });\n      }\n      \n      const allUsers = await storage.getAllUsers();\n      res.json(allUsers);\n    } catch (error) {\n      console.error(\"Error fetching all users:\", error);\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n\n  // Balance management endpoints\n  app.post(\"/api/balance/deposit\", requireAuth, async (req: any, res) => {\n    try {\n      const { amount } = req.body;\n      const userId = req.user.id;\n\n      // Validate amount\n      if (!amount || isNaN(amount) || amount <= 0) {\n        return res.status(400).json({ message: \"Invalid deposit amount\" });\n      }\n\n      if (amount < 1) {\n        return res.status(400).json({ message: \"Minimum deposit amount is $1.00\" });\n      }\n\n      if (amount > 10000) {\n        return res.status(400).json({ message: \"Maximum deposit amount is $10,000.00 per transaction\" });\n      }\n\n      // Get current user\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Calculate new balance\n      const currentBalance = parseFloat(user.balance.toString());\n      const newBalance = currentBalance + amount;\n\n      // Update user balance\n      await storage.updateUser(userId, { \n        balance: newBalance.toString() \n      });\n\n      // Log the transaction\n      await storage.createAdminLog({\n        adminUserId: userId,\n        targetUserId: userId,\n        action: 'balance_deposit',\n        oldValue: currentBalance.toString(),\n        newValue: newBalance.toString(),\n        notes: `User deposited $${amount.toFixed(2)}`\n      });\n\n      res.json({ \n        success: true, \n        message: \"Deposit successful\",\n        newBalance: newBalance\n      });\n    } catch (error) {\n      console.error(\"Error processing deposit:\", error);\n      res.status(500).json({ message: \"Failed to process deposit\" });\n    }\n  });\n\n  app.post(\"/api/balance/withdraw\", requireAuth, async (req: any, res) => {\n    try {\n      const { amount } = req.body;\n      const userId = req.user.id;\n\n      // Validate amount\n      if (!amount || isNaN(amount) || amount <= 0) {\n        return res.status(400).json({ message: \"Invalid withdrawal amount\" });\n      }\n\n      if (amount < 1) {\n        return res.status(400).json({ message: \"Minimum withdrawal amount is $1.00\" });\n      }\n\n      // Get current user\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      const currentBalance = parseFloat(user.siteCash?.toString() || '0');\n\n      // Check if user has sufficient funds\n      if (amount > currentBalance) {\n        return res.status(400).json({ message: \"Insufficient funds\" });\n      }\n\n      // Calculate new balance\n      const newBalance = currentBalance - amount;\n\n      // Update user balance\n      await storage.updateUser(userId, { \n        siteCash: newBalance.toString() \n      });\n\n      // Log the transaction\n      await storage.createAdminLog({\n        adminUserId: userId,\n        targetUserId: userId,\n        action: 'balance_withdrawal',\n        oldValue: currentBalance.toString(),\n        newValue: newBalance.toString(),\n        notes: `User withdrew $${amount.toFixed(2)}`\n      });\n\n      res.json({ \n        success: true, \n        message: \"Withdrawal successful\",\n        newBalance: newBalance\n      });\n    } catch (error) {\n      console.error(\"Error processing withdrawal:\", error);\n      res.status(500).json({ message: \"Failed to process withdrawal\" });\n    }\n  });\n\n  // Code redemption endpoint\n  app.post(\"/api/codes/redeem\", requireAuth, async (req: any, res) => {\n    try {\n      const { code } = req.body;\n      const userId = req.user.id;\n\n      // Validate code input\n      if (!code || typeof code !== 'string') {\n        return res.status(400).json({ message: \"Invalid code format\" });\n      }\n\n      const trimmedCode = code.trim().toUpperCase();\n      if (trimmedCode.length < 4) {\n        return res.status(400).json({ message: \"Code must be at least 4 characters long\" });\n      }\n\n      // Get current user\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n\n      // Predefined redemption codes with rewards\n      const validCodes: Record<string, { type: string; amount?: number; message: string; reward: string }> = {\n        'WELCOME500': {\n          type: 'balance',\n          amount: 500,\n          message: 'Welcome bonus redeemed! $500 added to your balance.',\n          reward: '$500 Balance Boost'\n        },\n        'STARTER1000': {\n          type: 'balance',\n          amount: 1000,\n          message: 'Starter pack redeemed! $1,000 added to your balance.',\n          reward: '$1,000 Balance Boost'\n        },\n        'BIGBOOST2500': {\n          type: 'balance',\n          amount: 2500,\n          message: 'Big boost redeemed! $2,500 added to your balance.',\n          reward: '$2,500 Balance Boost'\n        },\n        'MEGABOOST5000': {\n          type: 'balance',\n          amount: 5000,\n          message: 'Mega boost redeemed! $5,000 added to your balance.',\n          reward: '$5,000 Balance Boost'\n        },\n        'FREEMONEY': {\n          type: 'balance',\n          amount: 100,\n          message: 'Free money code redeemed! $100 added to your balance.',\n          reward: '$100 Balance Boost'\n        }\n      };\n\n      // Check if code exists\n      const codeData = validCodes[trimmedCode];\n      if (!codeData) {\n        return res.status(400).json({ message: \"Invalid or expired code\" });\n      }\n\n      // Apply the reward based on type\n      if (codeData.type === 'balance' && codeData.amount) {\n        const currentBalance = parseFloat(user.balance.toString());\n        const newBalance = currentBalance + codeData.amount;\n\n        // Update user balance\n        await storage.updateUser(userId, { \n          balance: newBalance.toString() \n        });\n\n        // Log the code redemption\n        await storage.createAdminLog({\n          adminUserId: userId,\n          targetUserId: userId,\n          action: 'code_redemption',\n          oldValue: currentBalance.toString(),\n          newValue: newBalance.toString(),\n          notes: `User redeemed code \"${trimmedCode}\" for $${codeData.amount}`\n        });\n\n        res.json({ \n          success: true, \n          message: codeData.message,\n          reward: codeData.reward,\n          newBalance: newBalance\n        });\n      } else {\n        // Handle other reward types in the future (premium features, items, etc.)\n        res.json({ \n          success: true, \n          message: codeData.message,\n          reward: codeData.reward\n        });\n      }\n    } catch (error) {\n      console.error(\"Error redeeming code:\", error);\n      res.status(500).json({ message: \"Failed to redeem code\" });\n    }\n  });\n\n  // Admin endpoint to get user logs\n  app.get(\"/api/admin/logs/:userId\", requireAuth, async (req: any, res) => {\n    try {\n      const adminUserId = req.user.userId;\n      const targetUserId = parseInt(req.params.userId);\n      \n      // Check if user is admin (userId 0, 1, or 2)\n      if (adminUserId !== 0 && adminUserId !== 1 && adminUserId !== 2) {\n        return res.status(403).json({ message: \"Access denied. Admin privileges required.\" });\n      }\n      \n      const logs = await storage.getAdminLogs(targetUserId);\n      res.json(logs);\n    } catch (error) {\n      console.error(\"Error fetching admin logs:\", error);\n      res.status(500).json({ message: \"Failed to fetch admin logs\" });\n    }\n  });\n\n  // Admin endpoint to delete a user (only for userId 0 or 1)\n  app.delete(\"/api/admin/users/:userEmail\", requireAuth, async (req: any, res) => {\n    try {\n      const adminUserId = req.user.userId;\n      const targetUserEmail = req.params.userEmail;\n      \n      console.log(`Admin userId ${adminUserId} attempting to delete user ${targetUserEmail}`);\n      \n      // Check if user is admin (userId 0, 1, or 2)\n      if (adminUserId !== 0 && adminUserId !== 1 && adminUserId !== 2) {\n        console.log(`Access denied: User ${adminUserId} is not an admin`);\n        return res.status(403).json({ message: \"Access denied. Admin privileges required.\" });\n      }\n\n      // Check if target user exists\n      const targetUser = await storage.getUserByEmail(targetUserEmail);\n      if (!targetUser) {\n        console.log(`User ${targetUserEmail} not found`);\n        return res.status(404).json({ message: \"User not found.\" });\n      }\n\n      // Prevent deletion of admin accounts\n      if (targetUser.userId === 0 || targetUser.userId === 1) {\n        console.log(`Cannot delete admin account: User ${targetUserEmail} (userId: ${targetUser.userId})`);\n        return res.status(403).json({ message: \"Cannot delete admin accounts.\" });\n      }\n\n      console.log(`Deleting user ${targetUserEmail}...`);\n      \n      // Delete the user\n      await storage.deleteUser(targetUser.id);\n      \n      console.log(`User ${targetUserEmail} deleted successfully`);\n      res.json({ message: \"User deleted successfully.\" });\n    } catch (error) {\n      console.error(\"Error deleting user:\", error);\n      res.status(500).json({ message: \"Failed to delete user\", error: error instanceof Error ? error.message : \"Unknown error\" });\n    }\n  });\n\n  // Add site cash to current user (for refill balance functionality)\n  app.post(\"/api/admin/add-site-cash\", requireAuth, async (req: any, res) => {\n    try {\n      const { amount } = req.body;\n      \n      if (!amount || amount <= 0) {\n        return res.status(400).json({ error: \"Invalid amount\" });\n      }\n\n      const currentUser = await storage.getUser(req.user.id);\n      if (!currentUser) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n\n      const currentSiteCash = Number(currentUser.siteCash) || 0;\n      const newBalance = currentSiteCash + Number(amount);\n      \n      const updatedUser = await storage.updateUser(req.user.id, { siteCash: newBalance.toString() });\n      \n      res.json({ \n        success: true, \n        amount: Number(amount),\n        newBalance: newBalance,\n        user: updatedUser \n      });\n    } catch (error) {\n      console.error(\"Error adding site cash:\", error);\n      res.status(500).json({ error: \"Failed to add site cash\" });\n    }\n  });\n\n  // System monitoring endpoint\n  app.get(\"/api/system/status\", requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      \n      // Check if user is admin (using subscription tier)\n      const user = await storage.getUser(userId);\n      if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n        return res.status(403).json({ message: \"Access denied. Admin privileges required.\" });\n      }\n      \n      const systemStatus = await getSystemStatus();\n      res.json(systemStatus);\n    } catch (error) {\n      console.error(\"Error fetching system status:\", error);\n      res.status(500).json({ message: \"Failed to fetch system status\" });\n    }\n  });\n\n  // Error handling middleware\n  app.use(errorHandler);\n\n  const httpServer = createServer(app);\n  \n  return httpServer;\n}","size_bytes":22880},"server/storage.ts":{"content":"import {\n  users,\n  watchlist,\n  stockPurchases,\n  personalStockPurchases,\n  contactSubmissions,\n  adminLogs,\n  tournaments,\n  tournamentParticipants,\n  tournamentStockPurchases,\n  tradeHistory,\n  userAchievements,\n  portfolioHistory,\n  chatMessages,\n  type User,\n  type InsertUser,\n  type WatchlistItem,\n  type InsertWatchlistItem,\n  type StockPurchase,\n  type InsertStockPurchase,\n  type ContactSubmission,\n  type InsertContactSubmission,\n  type AdminLog,\n  type InsertAdminLog,\n  type Tournament,\n  type InsertTournament,\n  type TournamentParticipant,\n  type InsertTournamentParticipant,\n  type TournamentStockPurchase,\n  type InsertTournamentStockPurchase,\n  type PersonalStockPurchase,\n  type InsertPersonalStockPurchase,\n  type TradeHistory,\n  type InsertTradeHistory,\n  type UserAchievement,\n  type InsertUserAchievement,\n  type PortfolioHistory,\n  type InsertPortfolioHistory,\n  type ChatMessage,\n  type InsertChatMessage,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, asc, and, or, sql, ne, isNull } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations for email/password auth\n  getUser(id: number): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: number, updates: Partial<Pick<User, 'username' | 'email' | 'balance' | 'siteCash' | 'subscriptionTier' | 'premiumUpgradeDate' | 'personalBalance' | 'totalDeposited' | 'tournamentWins' | 'language' | 'currency' | 'lastUsernameChange' | 'profilePicture'>>): Promise<User>;\n  getUserById(id: number): Promise<User | undefined>;\n  addUserBalance(userId: number, amount: number): Promise<User>;\n  subtractUserBalance(userId: number, amount: number): Promise<User>;\n  updateProfilePicture(userId: number, profilePicture: string): Promise<void>;\n  getAllUsers(): Promise<User[]>;\n  deleteUser(id: number): Promise<void>;\n  \n  // Watchlist operations\n  getUserWatchlist(userId: number): Promise<WatchlistItem[]>;\n  addToWatchlist(userId: number, item: InsertWatchlistItem): Promise<WatchlistItem>;\n  removeFromWatchlist(userId: number, id: number): Promise<void>;\n  \n  // Trading operations\n  getUserBalance(userId: number): Promise<number>;\n  updateUserBalance(userId: number, newBalance: number): Promise<User>;\n  purchaseStock(userId: number, purchase: InsertStockPurchase): Promise<StockPurchase>;\n  getUserStockPurchases(userId: number): Promise<StockPurchase[]>;\n  deletePurchase(userId: number, purchaseId: number): Promise<void>;\n  \n  // Contact operations\n  createContactSubmission(submission: InsertContactSubmission): Promise<ContactSubmission>;\n  \n  // Admin logs operations\n  getAdminLogs(targetUserId: number): Promise<AdminLog[]>;\n  createAdminLog(log: InsertAdminLog): Promise<AdminLog>;\n  \n  // Tournament operations\n  createTournament(tournament: InsertTournament, creatorId: number): Promise<Tournament>;\n  joinTournament(tournamentId: number, userId: number): Promise<TournamentParticipant>;\n  getTournamentByCode(code: string): Promise<Tournament | undefined>;\n  getTournamentById(id: number): Promise<Tournament | null>;\n  getUserTournaments(userId: number): Promise<any[]>;\n  getTournamentParticipants(tournamentId: number): Promise<TournamentParticipant[]>;\n  \n  // Tournament trading operations\n  getTournamentBalance(tournamentId: number, userId: number): Promise<number>;\n  updateTournamentBalance(tournamentId: number, userId: number, newBalance: number): Promise<TournamentParticipant>;\n  purchaseTournamentStock(tournamentId: number, userId: number, purchase: InsertTournamentStockPurchase): Promise<TournamentStockPurchase>;\n  getTournamentStockPurchases(tournamentId: number, userId: number): Promise<TournamentStockPurchase[]>;\n  deleteTournamentPurchase(tournamentId: number, userId: number, purchaseId: number): Promise<void>;\n  \n  // Personal portfolio operations\n  purchasePersonalStock(userId: number, purchase: InsertPersonalStockPurchase): Promise<PersonalStockPurchase>;\n  getPersonalStockPurchases(userId: number): Promise<PersonalStockPurchase[]>;\n  deletePersonalPurchase(userId: number, purchaseId: number): Promise<void>;\n  \n  // Tournament operations\n  getAllTournaments(): Promise<Tournament[]>;\n  getPublicTournaments(): Promise<Tournament[]>;\n  \n  // Trade tracking operations\n  recordTrade(trade: InsertTradeHistory): Promise<TradeHistory>;\n  getUserTradeCount(userId: number): Promise<number>;\n  \n  // Achievement operations\n  getUserAchievements(userId: number): Promise<UserAchievement[]>;\n  awardAchievement(achievement: InsertUserAchievement): Promise<UserAchievement>;\n  awardAchievementByParams(userId: number, achievementType: string, tier: string, name: string, description: string): Promise<UserAchievement>;\n  hasAchievement(userId: number, achievementType: string): Promise<boolean>;\n  ensureWelcomeAchievement(userId: number): Promise<void>;\n  \n  // Tournament status operations\n  updateTournamentStatus(tournamentId: number, status: string, endedAt?: Date): Promise<Tournament>;\n  getExpiredTournaments(): Promise<Tournament[]>;\n  getWaitingTournaments(): Promise<Tournament[]>;\n  getArchivedTournaments(userId: number): Promise<Tournament[]>;\n  \n  // Tournament win tracking\n  incrementTournamentWins(userId: number): Promise<void>;\n  getTournamentWins(userId: number): Promise<number>;\n\n  // Portfolio history operations\n  recordPortfolioValue(record: InsertPortfolioHistory): Promise<PortfolioHistory>;\n  getUserPortfolioHistory(userId: number, portfolioType: 'personal' | 'tournament', tournamentId?: number): Promise<PortfolioHistory[]>;\n  \n  // Chat operations\n  getChatMessages(tournamentId?: number): Promise<ChatMessage[]>;\n  createChatMessage(message: InsertChatMessage): Promise<ChatMessage>;\n\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: number): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.id, id));\n    return result[0];\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.email, email));\n    return result[0];\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.username, username));\n    return result[0];\n  }\n\n  async createUser(userData: InsertUser): Promise<User> {\n    try {\n      // Get the next available userId by finding the highest existing userId and adding 1\n      const maxUserIdResult = await db.select({ maxUserId: sql`COALESCE(MAX(user_id), -1)` }).from(users);\n      const maxUserId = (maxUserIdResult[0]?.maxUserId as number) || -1;\n      const nextUserId = (maxUserId >= 0) ? maxUserId + 1 : 0;\n      \n\n    \n    // Insert user with automatically assigned userId\n    const result = await db.insert(users).values({\n      ...userData,\n      userId: nextUserId\n    }).returning();\n    \n    const newUser = result[0];\n    \n    // Automatically award the \"Welcome\" achievement to all new users\n    try {\n      await this.awardAchievement({\n        userId: newUser.id,\n        achievementType: 'welcome',\n        achievementTier: 'common',\n        achievementName: 'Welcome',\n        achievementDescription: 'Joined the platform'\n      });\n    } catch (achievementError) {\n      console.error('Error awarding welcome achievement:', achievementError);\n      // Don't fail user creation if achievement fails\n    }\n    \n    return newUser;\n    } catch (error) {\n      console.error('Error in createUser:', error);\n      throw error;\n    }\n  }\n\n  async updateUser(id: number, updates: Partial<Pick<User, 'username' | 'email' | 'balance' | 'subscriptionTier' | 'premiumUpgradeDate' | 'personalBalance' | 'totalDeposited' | 'tournamentWins' | 'language' | 'currency' | 'lastUsernameChange' | 'profilePicture'>>): Promise<User> {\n    // If username is being updated, check the two-week restriction\n    if (updates.username) {\n      const currentUser = await this.getUser(id);\n      if (currentUser?.lastUsernameChange) {\n        const twoWeeksAgo = new Date();\n        twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);\n        \n        if (new Date(currentUser.lastUsernameChange) > twoWeeksAgo) {\n          throw new Error('Username can only be changed once every two weeks');\n        }\n      }\n      \n      // Set the lastUsernameChange timestamp when username is updated\n      updates.lastUsernameChange = new Date();\n    }\n    \n    const result = await db\n      .update(users)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return result[0];\n  }\n\n  async getUserById(id: number): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.id, id));\n    return result[0];\n  }\n\n  async addUserBalance(userId: number, amount: number): Promise<User> {\n    const result = await db\n      .update(users)\n      .set({ \n        siteCash: sql`${users.siteCash} + ${amount.toString()}`,\n        updatedAt: new Date()\n      })\n      .where(eq(users.id, userId))\n      .returning();\n    return result[0];\n  }\n\n  async subtractUserBalance(userId: number, amount: number): Promise<User> {\n    const result = await db\n      .update(users)\n      .set({ \n        siteCash: sql`${users.siteCash} - ${amount.toString()}`,\n        updatedAt: new Date()\n      })\n      .where(eq(users.id, userId))\n      .returning();\n    return result[0];\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users).orderBy(asc(users.userId));\n  }\n\n  async deleteUser(id: number): Promise<void> {\n    await db.delete(users).where(eq(users.id, id));\n  }\n\n  async updateProfilePicture(userId: number, profilePicture: string): Promise<void> {\n    await db\n      .update(users)\n      .set({ profilePicture, updatedAt: new Date() })\n      .where(eq(users.id, userId));\n  }\n\n  // Watchlist operations\n  async getUserWatchlist(userId: number): Promise<WatchlistItem[]> {\n    return await db\n      .select()\n      .from(watchlist)\n      .where(eq(watchlist.userId, userId))\n      .orderBy(desc(watchlist.createdAt));\n  }\n\n  async addToWatchlist(userId: number, item: InsertWatchlistItem): Promise<WatchlistItem> {\n    const result = await db\n      .insert(watchlist)\n      .values({ ...item, userId })\n      .returning();\n    return result[0];\n  }\n\n  async removeFromWatchlist(userId: number, id: number): Promise<void> {\n    await db.delete(watchlist).where(and(eq(watchlist.id, id), eq(watchlist.userId, userId)));\n  }\n\n  // Trading operations\n  async getUserBalance(userId: number): Promise<number> {\n    const result = await db.select({ siteCash: users.siteCash }).from(users).where(eq(users.id, userId));\n    return result[0] ? parseFloat(result[0].siteCash) : 0;\n  }\n\n  async updateUserBalance(userId: number, newBalance: number): Promise<User> {\n    const result = await db\n      .update(users)\n      .set({ siteCash: newBalance.toString() })\n      .where(eq(users.id, userId))\n      .returning();\n    return result[0];\n  }\n\n  async incrementTradeCount(userId: number): Promise<void> {\n    await db\n      .update(users)\n      .set({ totalTrades: sql`${users.totalTrades} + 1` })\n      .where(eq(users.id, userId));\n  }\n\n  async purchaseStock(userId: number, purchase: InsertStockPurchase): Promise<StockPurchase> {\n    const result = await db\n      .insert(stockPurchases)\n      .values({ ...purchase, userId })\n      .returning();\n    return result[0];\n  }\n\n  async getUserStockPurchases(userId: number): Promise<StockPurchase[]> {\n    return await db\n      .select()\n      .from(stockPurchases)\n      .where(eq(stockPurchases.userId, userId))\n      .orderBy(desc(stockPurchases.createdAt));\n  }\n\n  async deletePurchase(userId: number, purchaseId: number): Promise<void> {\n    await db\n      .delete(stockPurchases)\n      .where(and(eq(stockPurchases.id, purchaseId), eq(stockPurchases.userId, userId)));\n  }\n\n  // Contact operations\n  async createContactSubmission(submission: InsertContactSubmission): Promise<ContactSubmission> {\n    const result = await db.insert(contactSubmissions).values(submission).returning();\n    return result[0];\n  }\n\n  // Admin logs operations\n  async getAdminLogs(targetUserId: number): Promise<AdminLog[]> {\n    return await db\n      .select()\n      .from(adminLogs)\n      .where(eq(adminLogs.targetUserId, targetUserId))\n      .orderBy(desc(adminLogs.createdAt));\n  }\n\n  async createAdminLog(log: InsertAdminLog): Promise<AdminLog> {\n    const result = await db.insert(adminLogs).values(log).returning();\n    return result[0];\n  }\n\n  // Tournament operations\n  async createTournament(tournament: InsertTournament, creatorId: number): Promise<Tournament> {\n    // Generate unique 8-character code\n    const code = Math.random().toString(36).substring(2, 10).toUpperCase();\n    \n    const buyInAmount = Number(tournament.buyInAmount || 0);\n    \n    // If tournament has buy-in, check creator balance and deduct\n    if (buyInAmount > 0) {\n      // Get creator's current site cash\n      const user = await db.select().from(users).where(eq(users.id, creatorId)).limit(1);\n      if (!user[0]) {\n        throw new Error('Creator not found');\n      }\n      \n      const currentSiteCash = Number(user[0].siteCash || 0);\n      \n      // Check if creator has sufficient site cash\n      if (currentSiteCash < buyInAmount) {\n        throw new Error(`Insufficient site cash to create tournament. You need ${buyInAmount.toFixed(2)} but only have ${currentSiteCash.toFixed(2)}`);\n      }\n      \n      // Deduct buy-in amount from creator's site cash\n      await db.update(users)\n        .set({ siteCash: (currentSiteCash - buyInAmount).toString() })\n        .where(eq(users.id, creatorId));\n        \n      // Log the transaction\n      await db.insert(adminLogs).values({\n        adminUserId: creatorId,\n        targetUserId: creatorId,\n        action: 'tournament_creator_buyin',\n        oldValue: currentSiteCash.toString(),\n        newValue: (currentSiteCash - buyInAmount).toString(),\n        notes: `Buy-in deducted for creating tournament: ${tournament.name} ($${buyInAmount.toFixed(2)})`\n      });\n    }\n    \n    const result = await db.insert(tournaments).values({\n      ...tournament,\n      code,\n      creatorId,\n      currentPot: buyInAmount.toString() // Set initial pot to creator's buy-in\n    }).returning();\n    \n    // Add creator as first participant with specified starting balance\n    await db.insert(tournamentParticipants).values({\n      tournamentId: result[0].id,\n      userId: creatorId,\n      balance: (tournament.startingBalance || \"10000.00\").toString()\n    });\n    \n    return result[0];\n  }\n\n  async joinTournament(tournamentId: number, userId: number): Promise<TournamentParticipant> {\n    // Check if user is already in this tournament\n    const existingParticipant = await db\n      .select()\n      .from(tournamentParticipants)\n      .where(and(eq(tournamentParticipants.tournamentId, tournamentId), eq(tournamentParticipants.userId, userId)))\n      .limit(1);\n    \n    if (existingParticipant.length > 0) {\n      throw new Error('User is already participating in this tournament');\n    }\n    \n    // Get tournament data to check buy-in amount and set starting balance\n    const tournament = await db.select().from(tournaments).where(eq(tournaments.id, tournamentId));\n    if (!tournament[0]) {\n      throw new Error('Tournament not found');\n    }\n    \n    const buyInAmount = Number(tournament[0].buyInAmount || 0);\n    \n    // If tournament has buy-in, check user balance and deduct\n    if (buyInAmount > 0) {\n      // Get user's current site cash\n      const user = await db.select().from(users).where(eq(users.id, userId)).limit(1);\n      if (!user[0]) {\n        throw new Error('User not found');\n      }\n      \n      const currentSiteCash = Number(user[0].siteCash || 0);\n      \n      // Check if user has sufficient site cash\n      if (currentSiteCash < buyInAmount) {\n        throw new Error(`Insufficient site cash. You need ${buyInAmount.toFixed(2)} but only have ${currentSiteCash.toFixed(2)}`);\n      }\n      \n      // Deduct buy-in amount from user site cash\n      await db.update(users)\n        .set({ siteCash: (currentSiteCash - buyInAmount).toString() })\n        .where(eq(users.id, userId));\n        \n      // Add buy-in to tournament pot\n      await db.update(tournaments)\n        .set({ currentPot: sql`${tournaments.currentPot} + ${buyInAmount.toString()}` })\n        .where(eq(tournaments.id, tournamentId));\n    }\n    \n    const result = await db.insert(tournamentParticipants).values({\n      tournamentId,\n      userId,\n      balance: (tournament[0]?.startingBalance || \"10000.00\").toString()\n    }).returning();\n    \n    // Update tournament current players count\n    await db.update(tournaments)\n      .set({ currentPlayers: sql`${tournaments.currentPlayers} + 1` })\n      .where(eq(tournaments.id, tournamentId));\n    \n    return result[0];\n  }\n\n  async getTournamentByCode(code: string): Promise<Tournament | undefined> {\n    const result = await db.select().from(tournaments).where(eq(tournaments.code, code));\n    return result[0];\n  }\n\n  async getUserTournaments(userId: number): Promise<Tournament[]> {\n    const results = await db\n      .select({\n        tournament: tournaments,\n        balance: tournamentParticipants.balance\n      })\n      .from(tournaments)\n      .innerJoin(tournamentParticipants, eq(tournaments.id, tournamentParticipants.tournamentId))\n      .where(\n        and(\n          eq(tournamentParticipants.userId, userId),\n          ne(tournaments.status, 'completed')\n        )\n      )\n      .orderBy(desc(tournaments.createdAt));\n\n    return results.map(result => ({\n      ...result.tournament,\n      userBalance: result.balance\n    }));\n  }\n\n  async getTournamentParticipants(tournamentId: number): Promise<any[]> {\n    try {\n      // First, get all participants\n      const participants = await db\n        .select()\n        .from(tournamentParticipants)\n        .where(eq(tournamentParticipants.tournamentId, tournamentId))\n        .orderBy(asc(tournamentParticipants.joinedAt));\n\n      // Then, get user info and stock purchases for each participant\n      const participantsWithDetails = await Promise.all(\n        participants.map(async (participant) => {\n          // Get user info\n          const user = await db\n            .select()\n            .from(users)\n            .where(eq(users.id, participant.userId))\n            .limit(1);\n\n          // Get stock purchases\n          const stockPurchases = await db\n            .select()\n            .from(tournamentStockPurchases)\n            .where(\n              and(\n                eq(tournamentStockPurchases.userId, participant.userId),\n                eq(tournamentStockPurchases.tournamentId, tournamentId)\n              )\n            );\n\n          return {\n            ...participant,\n            username: user[0]?.username || '',\n            displayName: user[0]?.username || `User ${participant.userId}`,\n            email: user[0]?.email || '',\n            stockPurchases: stockPurchases || []\n          };\n        })\n      );\n\n      return participantsWithDetails;\n    } catch (error) {\n      console.error('Error in getTournamentParticipants:', error);\n      // Return empty array if there's an error\n      return [];\n    }\n  }\n\n  // Tournament trading operations\n  async getTournamentBalance(tournamentId: number, userId: number): Promise<number> {\n    const result = await db\n      .select({ balance: tournamentParticipants.balance })\n      .from(tournamentParticipants)\n      .where(and(eq(tournamentParticipants.tournamentId, tournamentId), eq(tournamentParticipants.userId, userId)));\n    return result[0] ? parseFloat(result[0].balance) : 0;\n  }\n\n  async updateTournamentBalance(tournamentId: number, userId: number, newBalance: number): Promise<TournamentParticipant> {\n    const result = await db\n      .update(tournamentParticipants)\n      .set({ balance: newBalance.toString() })\n      .where(and(eq(tournamentParticipants.tournamentId, tournamentId), eq(tournamentParticipants.userId, userId)))\n      .returning();\n    return result[0];\n  }\n\n  async purchaseTournamentStock(tournamentId: number, userId: number, purchase: InsertTournamentStockPurchase): Promise<TournamentStockPurchase> {\n    const result = await db\n      .insert(tournamentStockPurchases)\n      .values({ ...purchase, tournamentId, userId })\n      .returning();\n    return result[0];\n  }\n\n  async getTournamentStockPurchases(tournamentId: number, userId: number): Promise<TournamentStockPurchase[]> {\n    return await db\n      .select()\n      .from(tournamentStockPurchases)\n      .where(and(eq(tournamentStockPurchases.tournamentId, tournamentId), eq(tournamentStockPurchases.userId, userId)))\n      .orderBy(desc(tournamentStockPurchases.createdAt));\n  }\n\n  async deleteTournamentPurchase(tournamentId: number, userId: number, purchaseId: number): Promise<void> {\n    await db\n      .delete(tournamentStockPurchases)\n      .where(and(\n        eq(tournamentStockPurchases.id, purchaseId),\n        eq(tournamentStockPurchases.tournamentId, tournamentId),\n        eq(tournamentStockPurchases.userId, userId)\n      ));\n  }\n\n  // Personal portfolio operations\n  async purchasePersonalStock(userId: number, purchase: InsertPersonalStockPurchase): Promise<PersonalStockPurchase> {\n    const result = await db\n      .insert(personalStockPurchases)\n      .values({ ...purchase, userId })\n      .returning();\n    return result[0];\n  }\n\n  async getPersonalStockPurchases(userId: number): Promise<PersonalStockPurchase[]> {\n    return await db\n      .select()\n      .from(personalStockPurchases)\n      .where(eq(personalStockPurchases.userId, userId))\n      .orderBy(desc(personalStockPurchases.createdAt));\n  }\n\n  async deletePersonalPurchase(userId: number, purchaseId: number): Promise<void> {\n    await db\n      .delete(personalStockPurchases)\n      .where(and(\n        eq(personalStockPurchases.id, purchaseId),\n        eq(personalStockPurchases.userId, userId)\n      ));\n  }\n\n  async getAllTournaments(): Promise<Tournament[]> {\n    return await db.select().from(tournaments);\n  }\n\n  async getPublicTournaments(): Promise<Tournament[]> {\n    return await db.select().from(tournaments)\n      .where(and(\n        eq(tournaments.isPublic, true),\n        ne(tournaments.status, 'completed')\n      ));\n  }\n\n  // Trade tracking operations\n  async recordTrade(trade: InsertTradeHistory): Promise<TradeHistory> {\n    const result = await db\n      .insert(tradeHistory)\n      .values(trade)\n      .returning();\n    \n    // Increment the user's total trade count\n    await this.incrementTradeCount(trade.userId);\n    \n    return result[0];\n  }\n\n  async getUserTradeCount(userId: number): Promise<number> {\n    const result = await db\n      .select({ count: sql<number>`count(*)` })\n      .from(tradeHistory)\n      .where(eq(tradeHistory.userId, userId));\n    return result[0].count;\n  }\n\n  async getUserAchievements(userId: number): Promise<UserAchievement[]> {\n    // Ensure user has Welcome achievement before returning achievements\n    await this.ensureWelcomeAchievement(userId);\n    \n    return await db\n      .select()\n      .from(userAchievements)\n      .where(eq(userAchievements.userId, userId))\n      .orderBy(desc(userAchievements.earnedAt));\n  }\n\n  async awardAchievement(achievement: InsertUserAchievement): Promise<UserAchievement> {\n    const result = await db\n      .insert(userAchievements)\n      .values(achievement)\n      .onConflictDoNothing()\n      .returning();\n    \n    if (result.length === 0) {\n      // Achievement already exists, return existing one\n      const existing = await db\n        .select()\n        .from(userAchievements)\n        .where(\n          and(\n            eq(userAchievements.userId, achievement.userId),\n            eq(userAchievements.achievementType, achievement.achievementType)\n          )\n        )\n        .limit(1);\n      return existing[0];\n    }\n    \n    return result[0];\n  }\n\n  async awardAchievementByParams(userId: number, achievementType: string, tier: string, name: string, description: string): Promise<UserAchievement> {\n    return await this.awardAchievement({\n      userId,\n      achievementType,\n      achievementTier: tier,\n      achievementName: name,\n      achievementDescription: description\n    });\n  }\n\n  async hasAchievement(userId: number, achievementType: string): Promise<boolean> {\n    const result = await db\n      .select({ count: sql<number>`count(*)` })\n      .from(userAchievements)\n      .where(\n        and(\n          eq(userAchievements.userId, userId),\n          eq(userAchievements.achievementType, achievementType)\n        )\n      );\n    \n    return result[0].count > 0;\n  }\n\n  async updateTournamentStatus(tournamentId: number, status: string, endedAt?: Date): Promise<Tournament> {\n    const updateData: any = { status };\n    if (endedAt) {\n      updateData.endedAt = endedAt;\n    }\n\n    const result = await db\n      .update(tournaments)\n      .set(updateData)\n      .where(eq(tournaments.id, tournamentId))\n      .returning();\n    return result[0];\n  }\n\n  async getExpiredTournaments(): Promise<Tournament[]> {\n    const now = new Date();\n    // For now, we'll use a simple approach - tournaments that have been active for more than their timeframe\n    const results = await db\n      .select()\n      .from(tournaments)\n      .where(eq(tournaments.status, 'active'));\n    \n    // Filter expired tournaments in JavaScript since SQL interval parsing can be complex\n    return results.filter(tournament => {\n      const createdAt = tournament.createdAt ? new Date(tournament.createdAt) : new Date();\n      const timeframeMs = this.parseTimeframe(tournament.timeframe);\n      const expirationDate = new Date(createdAt.getTime() + timeframeMs);\n      return now > expirationDate;\n    });\n  }\n\n  // Tournament management methods\n  async getTournamentById(id: number): Promise<Tournament | null> {\n    const result = await db.select().from(tournaments).where(eq(tournaments.id, id)).limit(1);\n    return result[0] || null;\n  }\n\n  async updateTournament(id: number, updates: Partial<Tournament>): Promise<Tournament> {\n    const result = await db\n      .update(tournaments)\n      .set(updates)\n      .where(eq(tournaments.id, id))\n      .returning();\n    return result[0];\n  }\n\n  async deleteTournament(id: number): Promise<void> {\n    // Delete in order to respect foreign key constraints\n    await db.delete(tournamentStockPurchases).where(eq(tournamentStockPurchases.tournamentId, id));\n    await db.delete(tournamentParticipants).where(eq(tournamentParticipants.tournamentId, id));\n    await db.delete(tournaments).where(eq(tournaments.id, id));\n  }\n\n  async removeTournamentParticipant(tournamentId: number, participantId: number): Promise<void> {\n    await db\n      .delete(tournamentParticipants)\n      .where(\n        and(\n          eq(tournamentParticipants.tournamentId, tournamentId),\n          eq(tournamentParticipants.userId, participantId)\n        )\n      );\n  }\n\n  async getWaitingTournaments(): Promise<Tournament[]> {\n    return await db\n      .select()\n      .from(tournaments)\n      .where(eq(tournaments.status, 'waiting'));\n  }\n\n  private parseTimeframe(timeframe: string): number {\n    const match = timeframe.match(/(\\d+)\\s*(minute|minutes|day|days|week|weeks|month|months)/i);\n    if (!match) return 28 * 24 * 60 * 60 * 1000; // Default to 4 weeks in milliseconds\n    \n    const value = parseInt(match[1]);\n    const unit = match[2].toLowerCase();\n    \n    switch (unit) {\n      case 'minute':\n      case 'minutes':\n        return value * 60 * 1000; // Convert minutes to milliseconds\n      case 'day':\n      case 'days':\n        return value * 24 * 60 * 60 * 1000; // Convert days to milliseconds\n      case 'week':\n      case 'weeks':\n        return value * 7 * 24 * 60 * 60 * 1000; // Convert weeks to milliseconds\n      case 'month':\n      case 'months':\n        return value * 30 * 24 * 60 * 60 * 1000; // Convert months to milliseconds\n      default:\n        return 28 * 24 * 60 * 60 * 1000; // Default to 4 weeks in milliseconds\n    }\n  }\n\n  async getArchivedTournaments(userId: number): Promise<any[]> {\n    const userTournaments = await db\n      .select()\n      .from(tournaments)\n      .innerJoin(tournamentParticipants, eq(tournaments.id, tournamentParticipants.tournamentId))\n      .where(\n        and(\n          eq(tournamentParticipants.userId, userId),\n          eq(tournaments.status, 'completed')\n        )\n      )\n      .orderBy(desc(tournaments.endedAt));\n\n    // Get participants with final portfolio values for each tournament\n    const tournamentsWithParticipants = await Promise.all(\n      userTournaments.map(async (tournamentData) => {\n        const tournament = tournamentData.tournaments;\n        \n        // Get all participants for this tournament\n        const participantData = await db\n          .select()\n          .from(tournamentParticipants)\n          .innerJoin(users, eq(tournamentParticipants.userId, users.id))\n          .where(eq(tournamentParticipants.tournamentId, tournament.id));\n\n        // Get stock purchases for all participants to calculate portfolio values\n        const stockPurchases = await db\n          .select()\n          .from(tournamentStockPurchases)\n          .where(eq(tournamentStockPurchases.tournamentId, tournament.id));\n\n        // Calculate final portfolio values and rank participants\n        const participants = await Promise.all(\n          participantData.map(async (p) => {\n            const userPurchases = stockPurchases.filter(sp => sp.userId === p.users.id);\n            let portfolioValue = Number(p.tournament_participants.balance);\n            \n            // Calculate stock value for each purchase using purchase price (since tournament is completed)\n            for (const purchase of userPurchases) {\n              const stockValue = Number(purchase.shares) * Number(purchase.purchasePrice);\n              portfolioValue = Number(portfolioValue) + Number(stockValue);\n            }\n\n            return {\n              userId: p.users.id,\n              name: p.users.username,\n              finalBalance: p.tournament_participants.balance,\n              portfolioValue: portfolioValue,\n              position: 0 // Will be set after sorting\n            };\n          })\n        );\n\n        // Sort by portfolio value and assign positions\n        participants.sort((a, b) => Number(b.portfolioValue) - Number(a.portfolioValue));\n        participants.forEach((p, index) => {\n          p.position = index + 1;\n        });\n\n        return {\n          ...tournament,\n          participants\n        };\n      })\n    );\n\n    return tournamentsWithParticipants;\n  }\n\n  // Ensure user has Welcome achievement\n  async ensureWelcomeAchievement(userId: number): Promise<void> {\n    const hasWelcome = await this.hasAchievement(userId, 'welcome');\n    if (!hasWelcome) {\n      await this.awardAchievement({\n        userId: userId,\n        achievementType: 'welcome',\n        achievementTier: 'common',\n        achievementName: 'Welcome',\n        achievementDescription: 'Joined the platform'\n      });\n    }\n  }\n\n  async incrementTournamentWins(userId: number): Promise<void> {\n    await db\n      .update(users)\n      .set({\n        tournamentWins: sql`${users.tournamentWins} + 1`\n      })\n      .where(eq(users.id, userId));\n  }\n\n  async getTournamentWins(userId: number): Promise<number> {\n    const result = await db\n      .select({ tournamentWins: users.tournamentWins })\n      .from(users)\n      .where(eq(users.id, userId))\n      .limit(1);\n    \n    return result[0]?.tournamentWins || 0;\n  }\n\n  // Portfolio history operations\n  async recordPortfolioValue(record: InsertPortfolioHistory): Promise<PortfolioHistory> {\n    const result = await db.insert(portfolioHistory).values(record).returning();\n    return result[0];\n  }\n\n  async getUserPortfolioHistory(userId: number, portfolioType: 'personal' | 'tournament', tournamentId?: number): Promise<PortfolioHistory[]> {\n    let query = db\n      .select()\n      .from(portfolioHistory)\n      .where(and(\n        eq(portfolioHistory.userId, userId),\n        eq(portfolioHistory.portfolioType, portfolioType)\n      ));\n\n    if (portfolioType === 'tournament' && tournamentId) {\n      query = db\n        .select()\n        .from(portfolioHistory)\n        .where(and(\n          eq(portfolioHistory.userId, userId),\n          eq(portfolioHistory.portfolioType, portfolioType),\n          eq(portfolioHistory.tournamentId, tournamentId)\n        ));\n    }\n\n    return await query.orderBy(asc(portfolioHistory.recordedAt));\n  }\n\n  // Admin user management operations\n  async updateUserUsername(userId: number, username: string): Promise<void> {\n    await db\n      .update(users)\n      .set({ username })\n      .where(eq(users.id, userId));\n  }\n\n  async adminUpdateUserBalance(userId: number, amount: number, operation: 'add' | 'remove'): Promise<void> {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n    \n    const currentBalance = parseFloat(user.personalBalance) || 0;\n    const newBalance = operation === 'add' \n      ? currentBalance + amount \n      : Math.max(0, currentBalance - amount);\n    \n    await db\n      .update(users)\n      .set({ personalBalance: newBalance.toString() })\n      .where(eq(users.id, userId));\n  }\n\n  async updateUserAdminNote(userId: number, note: string): Promise<void> {\n    await db\n      .update(users)\n      .set({ adminNote: note })\n      .where(eq(users.id, userId));\n  }\n\n  async banUser(userId: number): Promise<void> {\n    await db\n      .update(users)\n      .set({ banned: true })\n      .where(eq(users.id, userId));\n  }\n\n  // Chat operations\n  async getChatMessages(tournamentId?: number): Promise<ChatMessage[]> {\n    return await db\n      .select()\n      .from(chatMessages)\n      .where(tournamentId ? eq(chatMessages.tournamentId, tournamentId) : isNull(chatMessages.tournamentId))\n      .orderBy(asc(chatMessages.createdAt))\n      .limit(100); // Limit to last 100 messages\n  }\n\n  async createChatMessage(message: InsertChatMessage): Promise<ChatMessage> {\n    const result = await db.insert(chatMessages).values(message).returning();\n    return result[0];\n  }\n}\n\nexport const storage = new DatabaseStorage();","size_bytes":34360},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"shared/chatSchema.ts":{"content":"import {\n  pgTable,\n  text,\n  varchar,\n  timestamp,\n  serial,\n  integer,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Chat messages table\nexport const chatMessages = pgTable(\"chat_messages\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull(),\n  username: varchar(\"username\", { length: 15 }).notNull(),\n  profilePicture: text(\"profile_picture\"), // Base64 encoded profile picture or URL\n  message: text(\"message\").notNull(),\n  tournamentId: integer(\"tournament_id\"), // null for global chat, specific ID for tournament chat\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Zod schemas\nexport const insertChatMessageSchema = createInsertSchema(chatMessages);\nexport const selectChatMessageSchema = createInsertSchema(chatMessages);\n\n// TypeScript types\nexport type ChatMessage = typeof chatMessages.$inferSelect;\nexport type InsertChatMessage = z.infer<typeof insertChatMessageSchema>;","size_bytes":990},"shared/schema.ts":{"content":"import {\n  pgTable,\n  text,\n  varchar,\n  timestamp,\n  jsonb,\n  index,\n  serial,\n  boolean,\n  integer,\n  numeric,\n  unique,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n\n\n// Session storage table for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table with email/password authentication\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").unique(), // New field for admin identification (Lucas=0, Murilo=1)\n  email: varchar(\"email\", { length: 255 }).unique().notNull(),\n  username: varchar(\"username\", { length: 15 }).unique().notNull(), // 3-15 characters, letters/numbers/underscores only\n  profilePicture: text(\"profile_picture\"), // Base64 encoded profile picture or URL\n  lastUsernameChange: timestamp(\"last_username_change\"), // Track when username was last changed (for 2-week restriction)\n  password: varchar(\"password\", { length: 255 }).notNull(), // hashed password\n  country: varchar(\"country\", { length: 100 }), // User's country\n  language: varchar(\"language\", { length: 50 }).default(\"English\"), // User's preferred language\n  currency: varchar(\"currency\", { length: 10 }).default(\"USD\"), // User's preferred currency\n  balance: numeric(\"balance\", { precision: 15, scale: 2 }).default(\"10000.00\").notNull(), // Starting balance of $10,000 - DEPRECATED, use siteCash instead\n  siteCash: numeric(\"site_cash\", { precision: 15, scale: 2 }).default(\"10000.00\").notNull(), // Main site balance for tournaments and header display\n  subscriptionTier: varchar(\"subscription_tier\", { length: 50 }).default(\"free\").notNull(), // free, administrator\n  premiumUpgradeDate: timestamp(\"premium_upgrade_date\"), // Deprecated - kept for data compatibility\n  personalBalance: numeric(\"personal_balance\", { precision: 15, scale: 2 }).default(\"10000.00\").notNull(), // Personal portfolio balance\n  totalDeposited: numeric(\"total_deposited\", { precision: 15, scale: 2 }).default(\"10000.00\").notNull(), // Total amount deposited into personal account\n  personalPortfolioStartDate: timestamp(\"personal_portfolio_start_date\"), // When user started personal portfolio\n  tournamentWins: integer(\"tournament_wins\").default(0).notNull(), // Private counter for tournament wins\n  totalTrades: integer(\"total_trades\").default(0).notNull(), // Total number of buy/sell trades made by user\n  adminNote: text(\"admin_note\").default(\"\"), // Admin notes for user management\n  banned: boolean(\"banned\").default(false), // User banned status\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n\n\n// User watchlist table\nexport const watchlist = pgTable(\"watchlist\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  symbol: varchar(\"symbol\").notNull(),\n  companyName: varchar(\"company_name\").notNull(),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Stock purchases table for tracking user trading activity\nexport const stockPurchases = pgTable(\"stock_purchases\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  symbol: varchar(\"symbol\").notNull(),\n  companyName: varchar(\"company_name\").notNull(),\n  shares: integer(\"shares\").notNull(),\n  purchasePrice: numeric(\"purchase_price\", { precision: 15, scale: 2 }).notNull(),\n  totalCost: numeric(\"total_cost\", { precision: 15, scale: 2 }).notNull(),\n  purchaseDate: timestamp(\"purchase_date\").defaultNow().notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Personal stock purchases table (separate from tournament purchases)\nexport const personalStockPurchases = pgTable(\"personal_stock_purchases\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  symbol: varchar(\"symbol\").notNull(),\n  companyName: varchar(\"company_name\").notNull(),\n  shares: integer(\"shares\").notNull(),\n  purchasePrice: numeric(\"purchase_price\", { precision: 15, scale: 2 }).notNull(),\n  totalCost: numeric(\"total_cost\", { precision: 15, scale: 2 }).notNull(),\n  purchaseDate: timestamp(\"purchase_date\").defaultNow().notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Portfolio history table for tracking portfolio value over time\nexport const portfolioHistory = pgTable(\"portfolio_history\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  portfolioType: varchar(\"portfolio_type\").notNull(), // 'personal' or 'tournament'\n  tournamentId: integer(\"tournament_id\"), // null for personal portfolio\n  totalValue: numeric(\"total_value\", { precision: 15, scale: 2 }).notNull(),\n  cashBalance: numeric(\"cash_balance\", { precision: 15, scale: 2 }).notNull(),\n  stockValue: numeric(\"stock_value\", { precision: 15, scale: 2 }).notNull(),\n  recordedAt: timestamp(\"recorded_at\").defaultNow().notNull(),\n});\n\n// Contact form submissions\nexport const contactSubmissions = pgTable(\"contact_submissions\", {\n  id: serial(\"id\").primaryKey(),\n  name: varchar(\"name\").notNull(),\n  email: varchar(\"email\").notNull(),\n  subject: varchar(\"subject\").notNull(),\n  message: text(\"message\").notNull(),\n  status: varchar(\"status\").default(\"new\"), // new, read, replied\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n\n\n// Admin logs table for tracking administrative actions\nexport const adminLogs = pgTable(\"admin_logs\", {\n  id: serial(\"id\").primaryKey(),\n  adminUserId: integer(\"admin_user_id\").references(() => users.id).notNull(),\n  targetUserId: integer(\"target_user_id\").references(() => users.id).notNull(),\n  action: varchar(\"action\").notNull(), // subscription_change, role_change, account_suspension, etc.\n  oldValue: text(\"old_value\"),\n  newValue: text(\"new_value\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Tournament games table\nexport const tournaments = pgTable(\"tournaments\", {\n  id: serial(\"id\").primaryKey(),\n  name: varchar(\"name\").notNull(),\n  code: varchar(\"code\", { length: 8 }).unique().notNull(), // 8-character unique code\n  creatorId: integer(\"creator_id\").references(() => users.id).notNull(),\n  maxPlayers: integer(\"max_players\").default(10).notNull(),\n  currentPlayers: integer(\"current_players\").default(1).notNull(),\n  startingBalance: numeric(\"starting_balance\", { precision: 15, scale: 2 }).default(\"10000.00\").notNull(),\n  timeframe: varchar(\"timeframe\").default(\"4 weeks\").notNull(), // Tournament duration\n  status: varchar(\"status\").default(\"waiting\"), // waiting, active, completed\n  buyInAmount: numeric(\"buy_in_amount\", { precision: 15, scale: 2 }).default(\"0.00\").notNull(), // Real money buy-in amount\n  currentPot: numeric(\"current_pot\", { precision: 15, scale: 2 }).default(\"0.00\").notNull(), // Total accumulated buy-ins\n  tradingRestriction: varchar(\"trading_restriction\", { length: 50 }).default(\"none\").notNull(), // Trading category restrictions\n  tournamentType: varchar(\"tournament_type\", { length: 20 }).default(\"stocks\").notNull(), // 'stocks' or 'crypto'\n  isPublic: boolean(\"is_public\").default(true).notNull(), // Public/private tournament setting\n  scheduledStartTime: timestamp(\"scheduled_start_time\"), // When tournament is scheduled to start\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  startedAt: timestamp(\"started_at\"),\n  endedAt: timestamp(\"ended_at\"),\n});\n\n// Tournament participants table\nexport const tournamentParticipants = pgTable(\"tournament_participants\", {\n  id: serial(\"id\").primaryKey(),\n  tournamentId: integer(\"tournament_id\").references(() => tournaments.id).notNull(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  balance: numeric(\"balance\", { precision: 15, scale: 2 }).default(\"10000.00\").notNull(),\n  joinedAt: timestamp(\"joined_at\").defaultNow(),\n}, (table) => ({\n  // Unique constraint: user can only participate in each tournament once\n  uniqueUserTournament: unique(\"unique_user_tournament\").on(table.tournamentId, table.userId),\n}));\n\n// Tournament-specific stock purchases\nexport const tournamentStockPurchases = pgTable(\"tournament_stock_purchases\", {\n  id: serial(\"id\").primaryKey(),\n  tournamentId: integer(\"tournament_id\").references(() => tournaments.id).notNull(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  symbol: varchar(\"symbol\").notNull(),\n  companyName: varchar(\"company_name\").notNull(),\n  shares: integer(\"shares\").notNull(),\n  purchasePrice: numeric(\"purchase_price\", { precision: 15, scale: 2 }).notNull(),\n  totalCost: numeric(\"total_cost\", { precision: 15, scale: 2 }).notNull(),\n  purchaseDate: timestamp(\"purchase_date\").defaultNow().notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// User achievements table for tracking earned achievements\nexport const userAchievements = pgTable(\"user_achievements\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  achievementType: varchar(\"achievement_type\").notNull(), // 'tournament_winner', 'tournament_top3', 'first_trade', etc.\n  achievementTier: varchar(\"achievement_tier\").notNull(), // 'common', 'uncommon', 'rare', 'epic', 'legendary', 'mythic'\n  achievementName: varchar(\"achievement_name\").notNull(),\n  achievementDescription: text(\"achievement_description\").notNull(),\n  earnedAt: timestamp(\"earned_at\").defaultNow().notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n}, (table) => ({\n  // Unique constraint: user can only have one of each achievement type globally\n  uniqueUserAchievement: unique(\"unique_user_achievement\").on(table.userId, table.achievementType),\n}));\n\n// Tournament creator rewards table for tracking 5% creator benefits\nexport const tournamentCreatorRewards = pgTable(\"tournament_creator_rewards\", {\n  id: serial(\"id\").primaryKey(),\n  tournamentId: integer(\"tournament_id\").references(() => tournaments.id).notNull(),\n  creatorId: integer(\"creator_id\").references(() => users.id).notNull(),\n  totalJackpot: numeric(\"total_jackpot\", { precision: 15, scale: 2 }).notNull(), // Total buy-in amount collected\n  creatorReward: numeric(\"creator_reward\", { precision: 15, scale: 2 }).notNull(), // 5% of total jackpot\n  participantCount: integer(\"participant_count\").notNull(), // Number of participants who paid buy-in\n  rewardPaid: boolean(\"reward_paid\").default(false).notNull(), // Whether reward has been distributed\n  calculatedAt: timestamp(\"calculated_at\").defaultNow().notNull(),\n  paidAt: timestamp(\"paid_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Zod schemas for validation\nexport const insertWatchlistSchema = createInsertSchema(watchlist).pick({\n  symbol: true,\n  companyName: true,\n  notes: true,\n});\n\nexport const insertStockPurchaseSchema = createInsertSchema(stockPurchases).pick({\n  symbol: true,\n  companyName: true,\n  shares: true,\n  purchasePrice: true,\n  totalCost: true,\n});\n\nexport const insertContactSchema = createInsertSchema(contactSubmissions).pick({\n  name: true,\n  email: true,\n  subject: true,\n  message: true,\n});\n\nexport const insertAdminLogSchema = createInsertSchema(adminLogs).pick({\n  adminUserId: true,\n  targetUserId: true,\n  action: true,\n  oldValue: true,\n  newValue: true,\n  notes: true,\n});\n\nexport const insertTournamentSchema = createInsertSchema(tournaments).pick({\n  name: true,\n  maxPlayers: true,\n  startingBalance: true,\n  timeframe: true,\n  buyInAmount: true,\n  tradingRestriction: true,\n  isPublic: true,\n});\n\nexport const insertCreatorRewardSchema = createInsertSchema(tournamentCreatorRewards).pick({\n  tournamentId: true,\n  creatorId: true,\n  totalJackpot: true,\n  creatorReward: true,\n  participantCount: true,\n});\n\nexport const insertTournamentParticipantSchema = createInsertSchema(tournamentParticipants).pick({\n  tournamentId: true,\n  userId: true,\n});\n\nexport const insertTournamentStockPurchaseSchema = createInsertSchema(tournamentStockPurchases).pick({\n  tournamentId: true,\n  symbol: true,\n  companyName: true,\n  shares: true,\n  purchasePrice: true,\n  totalCost: true,\n});\n\nexport const insertPersonalStockPurchaseSchema = createInsertSchema(personalStockPurchases).pick({\n  symbol: true,\n  companyName: true,\n  shares: true,\n  purchasePrice: true,\n  totalCost: true,\n});\n\nexport const insertPortfolioHistorySchema = createInsertSchema(portfolioHistory).pick({\n  userId: true,\n  portfolioType: true,\n  tournamentId: true,\n  totalValue: true,\n  cashBalance: true,\n  stockValue: true,\n});\n\n// Trade history table for tracking all trading actions (buy/sell)\nexport const tradeHistory = pgTable(\"trade_history\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull().references(() => users.id),\n  tournamentId: integer(\"tournament_id\").references(() => tournaments.id), // null for personal trades\n  symbol: text(\"symbol\").notNull(),\n  companyName: text(\"company_name\").notNull(),\n  tradeType: text(\"trade_type\").notNull(), // 'buy' or 'sell'\n  shares: integer(\"shares\").notNull(),\n  price: numeric(\"price\", { precision: 10, scale: 2 }).notNull(),\n  totalValue: numeric(\"total_value\", { precision: 10, scale: 2 }).notNull(),\n  tradeDate: timestamp(\"trade_date\").defaultNow().notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const insertTradeHistorySchema = createInsertSchema(tradeHistory).pick({\n  userId: true,\n  tournamentId: true,\n  symbol: true,\n  companyName: true,\n  tradeType: true,\n  shares: true,\n  price: true,\n  totalValue: true,\n});\n\nexport const insertUserAchievementSchema = createInsertSchema(userAchievements).pick({\n  userId: true,\n  achievementType: true,\n  achievementTier: true,\n  achievementName: true,\n  achievementDescription: true,\n});\n\n// Type exports\n// Username validation schema\nexport const usernameSchema = z.string()\n  .min(3, \"Username must be at least 3 characters\")\n  .max(15, \"Username must be no more than 15 characters\")\n  .regex(/^[a-zA-Z0-9_]+$/, \"Username can only contain letters, numbers, and underscores\");\n\n// User schemas for new authentication system\nexport const insertUserSchema = createInsertSchema(users).pick({\n  email: true,\n  username: true,\n  password: true,\n  userId: true,\n  country: true,\n  language: true,\n  currency: true,\n}).extend({\n  username: usernameSchema,\n});\n\nexport const loginSchema = z.object({\n  username: usernameSchema,\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n});\n\n// Registration schema for signup\nexport const registrationSchema = z.object({\n  email: z.string().email(\"Please enter a valid email address\"),\n  username: usernameSchema,\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n  country: z.string().optional(),\n  language: z.string().default(\"English\"),\n  currency: z.string().default(\"USD\"),\n});\n\nexport const registerSchema = z.object({\n  email: z.string().email(\"Please enter a valid email address\"),\n  username: usernameSchema,\n  password: z.string().min(6, \"Password must be at least 6 characters\"),\n  country: z.string().optional(),\n  language: z.string().default(\"English\"),\n  currency: z.string().default(\"USD\"),\n\n});\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type LoginUser = z.infer<typeof loginSchema>;\nexport type RegisterUser = z.infer<typeof registerSchema>;\nexport type WatchlistItem = typeof watchlist.$inferSelect;\nexport type InsertWatchlistItem = z.infer<typeof insertWatchlistSchema>;\nexport type StockPurchase = typeof stockPurchases.$inferSelect;\nexport type InsertStockPurchase = z.infer<typeof insertStockPurchaseSchema>;\nexport type ContactSubmission = typeof contactSubmissions.$inferSelect;\nexport type InsertContactSubmission = z.infer<typeof insertContactSchema>;\nexport type AdminLog = typeof adminLogs.$inferSelect;\nexport type InsertAdminLog = z.infer<typeof insertAdminLogSchema>;\nexport type Tournament = typeof tournaments.$inferSelect;\nexport type InsertTournament = z.infer<typeof insertTournamentSchema>;\nexport type TournamentParticipant = typeof tournamentParticipants.$inferSelect;\nexport type InsertTournamentParticipant = z.infer<typeof insertTournamentParticipantSchema>;\nexport type TournamentStockPurchase = typeof tournamentStockPurchases.$inferSelect;\nexport type InsertTournamentStockPurchase = z.infer<typeof insertTournamentStockPurchaseSchema>;\nexport type PersonalStockPurchase = typeof personalStockPurchases.$inferSelect;\nexport type InsertPersonalStockPurchase = z.infer<typeof insertPersonalStockPurchaseSchema>;\nexport type TradeHistory = typeof tradeHistory.$inferSelect;\nexport type InsertTradeHistory = z.infer<typeof insertTradeHistorySchema>;\nexport type UserAchievement = typeof userAchievements.$inferSelect;\nexport type InsertUserAchievement = z.infer<typeof insertUserAchievementSchema>;\nexport type PortfolioHistory = typeof portfolioHistory.$inferSelect;\nexport type InsertPortfolioHistory = z.infer<typeof insertPortfolioHistorySchema>;\n\n// Export chat schema\nexport * from \"./chatSchema\";\n","size_bytes":17238},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useAuth, AuthProvider } from \"@/hooks/use-auth\";\nimport { ThemeProvider } from \"@/hooks/use-theme\";\nimport { UserPreferencesProvider } from \"@/contexts/UserPreferencesContext\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/landing\";\nimport UnauthenticatedHome from \"@/pages/unauthenticated-home\";\nimport Hub from \"@/pages/hub\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Portfolio from \"@/pages/portfolio\";\nimport Tournaments from \"@/pages/tournaments\";\nimport Leaderboard from \"@/pages/leaderboard\";\nimport People from \"@/pages/people\";\nimport Events from \"@/pages/events\";\nimport Shop from \"@/pages/shop\";\nimport Withdraw from \"@/pages/withdraw\";\n\nimport Contact from \"@/pages/contact\";\nimport About from \"@/pages/about\";\nimport Privacy from \"@/pages/privacy\";\nimport Terms from \"@/pages/terms\";\nimport Login from \"@/pages/login\";\nimport Signup from \"@/pages/signup\";\nimport Profile from \"@/pages/profile\";\nimport Admin from \"@/pages/admin\";\nimport Archive from \"@/pages/archive\";\nimport Layout from \"@/components/layout/layout\";\nimport Footer from \"@/components/layout/footer\";\n\nfunction Router() {\n  const { user, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-black\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <Layout>\n      <Switch>\n        {!user ? (\n          <>\n            {/* Unauthenticated users see the conversion-focused home page */}\n            <Route path=\"/\" component={UnauthenticatedHome} />\n            <Route path=\"/contact\" component={Contact} />\n            <Route path=\"/about\" component={About} />\n            <Route path=\"/privacy\" component={Privacy} />\n            <Route path=\"/terms\" component={Terms} />\n            <Route path=\"/login\" component={Login} />\n            <Route path=\"/signup\" component={Signup} />\n          </>\n        ) : (\n          <>\n            {/* Authenticated users: root redirects to dashboard, hub accessible via logo */}\n            <Route path=\"/\" component={Dashboard} />\n            <Route path=\"/hub\" component={Hub} />\n            <Route path=\"/dashboard\" component={Dashboard} />\n            <Route path=\"/portfolio\" component={Dashboard} />\n            <Route path=\"/tournaments\" component={Tournaments} />\n            <Route path=\"/leaderboard\" component={Leaderboard} />\n            <Route path=\"/people\" component={People} />\n            <Route path=\"/people/:userId\" component={People} />\n            <Route path=\"/events\" component={Events} />\n            <Route path=\"/shop\" component={Shop} />\n            <Route path=\"/withdraw\" component={Withdraw} />\n\n            <Route path=\"/contact\" component={Contact} />\n            <Route path=\"/about\" component={About} />\n            <Route path=\"/privacy\" component={Privacy} />\n            <Route path=\"/terms\" component={Terms} />\n            <Route path=\"/profile\" component={Profile} />\n            <Route path=\"/admin\" component={Admin} />\n            <Route path=\"/archive\" component={Archive} />\n          </>\n        )}\n        <Route component={NotFound} />\n      </Switch>\n      {user && <Footer />}\n    </Layout>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>\n        <UserPreferencesProvider>\n          <ThemeProvider defaultTheme=\"dark\" storageKey=\"orsath-ui-theme\">\n            <TooltipProvider>\n              <Router />\n              <Toaster />\n            </TooltipProvider>\n          </ThemeProvider>\n        </UserPreferencesProvider>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":3973},"client/src/index.css":{"content":"@import \"react-grid-layout/css/styles.css\";\n@import \"react-resizable/css/styles.css\";\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(240, 10%, 8%);\n  --foreground: hsl(0, 0%, 98%);\n  --card: hsl(240, 12%, 12%);\n  --card-foreground: hsl(0, 0%, 98%);\n  --popover: hsl(240, 12%, 12%);\n  --popover-foreground: hsl(0, 0%, 98%);\n  --primary: hsl(142, 76%, 36%);\n  --primary-foreground: hsl(0, 0%, 0%);\n  --secondary: hsl(240, 6%, 20%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  --muted: hsl(240, 6%, 16%);\n  --muted-foreground: hsl(0, 0%, 65%);\n  --accent: hsl(51, 100%, 50%);\n  --accent-foreground: hsl(0, 0%, 0%);\n  --destructive: hsl(0, 84%, 60%);\n  --destructive-foreground: hsl(0, 0%, 98%);\n  --border: hsl(240, 6%, 24%);\n  --input: hsl(240, 6%, 16%);\n  --ring: hsl(142, 76%, 36%);\n  --radius: 0.75rem;\n  \n  /* Gaming-themed colors */\n  --neon-green: hsl(142, 76%, 36%);\n  --neon-blue: hsl(200, 100%, 50%);\n  --neon-purple: hsl(280, 100%, 60%);\n  --neon-orange: hsl(30, 100%, 50%);\n  --gold: hsl(51, 100%, 50%);\n  --red-loss: hsl(0, 84%, 60%);\n  --green-profit: hsl(142, 76%, 36%);\n  \n  /* Gradients */\n  --gradient-primary: linear-gradient(135deg, hsl(142, 76%, 36%), hsl(142, 76%, 46%));\n  --gradient-secondary: linear-gradient(135deg, hsl(240, 12%, 12%), hsl(240, 12%, 18%));\n  --gradient-accent: linear-gradient(135deg, hsl(51, 100%, 50%), hsl(30, 100%, 50%));\n  --gradient-card: linear-gradient(135deg, hsl(240, 12%, 12%) 0%, hsl(240, 12%, 15%) 100%);\n  \n  /* Shadows and glows */\n  --shadow-neon: 0 0 20px hsl(142, 76%, 36% / 0.3);\n  --shadow-gold: 0 0 20px hsl(51, 100%, 50% / 0.3);\n  --shadow-card: 0 4px 32px hsl(0, 0%, 0% / 0.3);\n}\n\n/* React Grid Layout Styles */\n.react-grid-layout {\n  position: relative;\n}\n\n.react-grid-item {\n  transition: all 200ms ease;\n  transition-property: left, top, width, height;\n}\n\n.react-grid-item.cssTransforms {\n  transition-property: transform, width, height;\n}\n\n.react-grid-item > .react-resizable-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  bottom: 0;\n  right: 0;\n  background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB2aWV3Qm94PSIwIDAgNiA2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZG90cyBmaWxsPSIjODg4IiBkPSJtIDQsNCAwLDIgMiwwIDAsLTIgeiIvPgo8L3N2Zz4K');\n  background-position: bottom right;\n  padding: 0 3px 3px 0;\n  background-repeat: no-repeat;\n  background-origin: content-box;\n  box-sizing: border-box;\n  cursor: se-resize;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.react-grid-item:hover > .react-resizable-handle {\n  opacity: 1;\n}\n\n.react-grid-item.react-grid-placeholder {\n  background: hsl(var(--primary) / 0.2);\n  opacity: 0.2;\n  transition-duration: 100ms;\n  z-index: 2;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n  border: 2px dashed hsl(var(--primary));\n  border-radius: 8px;\n}\n\n.dark {\n  --background: hsl(240, 10%, 8%);\n  --foreground: hsl(0, 0%, 98%);\n  --card: hsl(240, 12%, 12%);\n  --card-foreground: hsl(0, 0%, 98%);\n  --popover: hsl(240, 12%, 12%);\n  --popover-foreground: hsl(0, 0%, 98%);\n  --primary: hsl(142, 76%, 36%);\n  --primary-foreground: hsl(0, 0%, 0%);\n  --secondary: hsl(240, 6%, 20%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  --muted: hsl(240, 6%, 16%);\n  --muted-foreground: hsl(0, 0%, 65%);\n  --accent: hsl(51, 100%, 50%);\n  --accent-foreground: hsl(0, 0%, 0%);\n  --destructive: hsl(0, 84%, 60%);\n  --destructive-foreground: hsl(0, 0%, 98%);\n  --border: hsl(240, 6%, 24%);\n  --input: hsl(240, 6%, 16%);\n  --ring: hsl(142, 76%, 36%);\n}\n\n/* React Grid Layout Styles */\n.react-grid-layout {\n  position: relative;\n}\n\n.react-grid-item {\n  transition: all 200ms ease;\n  transition-property: left, top;\n}\n\n.react-grid-item.cssTransforms {\n  transition-property: transform;\n}\n\n.react-grid-item > .react-resizable-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  bottom: 0;\n  right: 0;\n  background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB2aWV3Qm94PSIwIDAgNiA2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZG90cyBmaWxsPSIjOTk5IiBvcGFjaXR5PSIwLjMiIGN4PSIxIiBjeT0iMSIgcj0iMSIvPgo8ZG90cyBmaWxsPSIjOTk5IiBvcGFjaXR5PSIwLjMiIGN4PSI1IiBjeT0iMSIgcj0iMSIvPgo8ZG90cyBmaWxsPSIjOTk5IiBvcGFjaXR5PSIwLjMiIGN4PSIxIiBjeT0iNSIgcj0iMSIvPgo8ZG90cyBmaWxsPSIjOTk5IiBvcGFjaXR5PSIwLjMiIGN4PSI1IiBjeT0iNSIgcj0iMSIvPgo8L3N2Zz4=');\n  background-position: bottom right;\n  padding: 0 3px 3px 0;\n  background-repeat: no-repeat;\n  background-origin: content-box;\n  box-sizing: border-box;\n  cursor: se-resize;\n}\n\n.react-grid-item.react-grid-placeholder {\n  background: hsl(var(--primary)) !important;\n  opacity: 0.2;\n  transition-duration: 100ms;\n  z-index: 2;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n}\n\n.react-grid-item > .react-resizable-handle::after {\n  content: \"\";\n  position: absolute;\n  right: 3px;\n  bottom: 3px;\n  width: 5px;\n  height: 5px;\n  border-right: 2px solid rgba(0, 0, 0, 0.4);\n  border-bottom: 2px solid rgba(0, 0, 0, 0.4);\n}\n\n.widget-container {\n  height: 100%;\n}\n\n.widget-container .card {\n  height: 100%;\n  overflow: hidden;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  \n  body {\n    @apply bg-background text-foreground;\n    font-family: 'Inter', 'Segoe UI', 'Roboto', system-ui, -apple-system, sans-serif;\n    font-feature-settings: 'cv11', 'ss01';\n    font-variation-settings: 'opsz' 32;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    background: radial-gradient(ellipse at top, hsl(240, 10%, 10%) 0%, hsl(240, 10%, 8%) 100%);\n    min-height: 100vh;\n  }\n  \n  /* Scrollbar styling */\n  ::-webkit-scrollbar {\n    width: 8px;\n  }\n  \n  ::-webkit-scrollbar-track {\n    background: hsl(240, 6%, 16%);\n  }\n  \n  ::-webkit-scrollbar-thumb {\n    background: hsl(240, 6%, 24%);\n    border-radius: 4px;\n  }\n  \n  ::-webkit-scrollbar-thumb:hover {\n    background: hsl(142, 76%, 36%);\n  }\n}\n\n@layer utilities {\n  .text-balance {\n    text-wrap: balance;\n  }\n  \n  /* Gaming-inspired utilities */\n  .neon-glow {\n    box-shadow: var(--shadow-neon);\n  }\n  \n  .gold-glow {\n    box-shadow: var(--shadow-gold);\n  }\n  \n  .card-glow {\n    box-shadow: var(--shadow-card);\n  }\n  \n  .gradient-primary {\n    background: var(--gradient-primary);\n  }\n  \n  .gradient-secondary {\n    background: var(--gradient-secondary);\n  }\n  \n  .gradient-accent {\n    background: var(--gradient-accent);\n  }\n  \n  .gradient-card {\n    background: var(--gradient-card);\n  }\n  \n  /* Enhanced animations */\n  .animate-pulse-slow {\n    /* Removed pulse animation to prevent moving gradients */\n  }\n  \n  .animate-glow {\n    /* Removed glow animation to prevent moving gradients */\n  }\n  \n  .animate-slide-up {\n    animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  \n  .animate-fade-in {\n    animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  \n  .animate-float {\n    /* Removed float animation to prevent moving gradients */\n  }\n  \n  /* Interactive hover effects */\n  .hover-lift {\n    transition: transform 0.2s ease;\n  }\n  \n  .hover-lift:hover {\n    transform: translateY(-1px);\n  }\n  \n  .hover-glow:hover {\n    box-shadow: var(--shadow-neon);\n  }\n  \n  .hover-scale:hover {\n    transform: scale(1.02);\n  }\n  \n  /* Navigation styling */\n  .nav-link {\n    @apply transition-all duration-300 ease-in-out relative;\n    position: relative;\n  }\n  \n  .nav-link::after {\n    content: '';\n    position: absolute;\n    bottom: -2px;\n    left: 50%;\n    width: 0;\n    height: 2px;\n    background: var(--gradient-primary);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    transform: translateX(-50%);\n  }\n  \n  .nav-link:hover::after {\n    width: 100%;\n  }\n  \n  /* Gaming-themed borders */\n  .border-neon {\n    border-color: var(--neon-green);\n  }\n  \n  .border-gold {\n    border-color: var(--gold);\n  }\n  \n  /* Status indicators */\n  .status-active {\n    background: var(--gradient-primary);\n    color: hsl(0, 0%, 0%);\n  }\n  \n  /* More opaque navigation bars and sidebars */\n  .card {\n    background-color: hsl(var(--card) / 0.8) !important;\n    backdrop-filter: blur(12px);\n  }\n  \n  .status-profit {\n    color: var(--green-profit);\n  }\n  \n  .status-loss {\n    color: var(--red-loss);\n  }\n  \n  /* Button enhancements */\n  .btn-primary {\n    background: hsl(var(--primary));\n    border: none;\n    color: hsl(var(--primary-foreground));\n    font-weight: 600;\n    transition: opacity 0.2s ease;\n  }\n  \n  .btn-primary:hover {\n    opacity: 0.9;\n  }\n  \n  .btn-secondary {\n    background: hsl(var(--secondary));\n    border: 1px solid hsl(var(--border));\n    transition: border-color 0.2s ease;\n  }\n  \n  .btn-secondary:hover {\n    border-color: hsl(var(--primary));\n  }\n  \n  .btn-accent {\n    background: var(--gradient-accent);\n    color: hsl(0, 0%, 0%);\n    font-weight: 600;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  \n  .btn-accent:hover {\n    transform: translateY(-1px);\n    box-shadow: var(--shadow-gold);\n  }\n  \n  /* Interactive card effects */\n  .interactive-card {\n    @apply transition-colors duration-200;\n    background: var(--card);\n    border: 1px solid var(--border);\n  }\n  \n  .interactive-card:hover {\n    border-color: hsl(var(--border));\n  }\n  \n  /* Gradient text effects */\n  .gradient-text {\n    color: hsl(var(--foreground));\n  }\n  \n  .gradient-text-profit {\n    background: linear-gradient(135deg, var(--green-profit), hsl(142, 76%, 46%));\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n  }\n  \n  .gradient-text-loss {\n    background: linear-gradient(135deg, var(--red-loss), hsl(0, 84%, 70%));\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n  }\n\n  @keyframes scroll {\n    0% {\n      transform: translateX(0);\n    }\n    100% {\n      transform: translateX(-50%);\n    }\n  }\n\n  /* Ensure proper transitions for all elements */\n  * {\n    transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out, border-color 0.3s ease-in-out;\n  }\n  \n  /* Dark mode specific overrides for footer and other components */\n  .dark .bg-gray-900 {\n    background-color: hsl(0, 0%, 98%);\n  }\n  \n  .dark .text-gray-400 {\n    color: hsl(0, 0%, 40%);\n  }\n  \n  .dark .border-gray-800 {\n    border-color: hsl(0, 0%, 20%);\n  }\n}\n\n/* Keyframe animations */\n@keyframes glow {\n  from {\n    text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green), 0 0 30px var(--neon-green);\n  }\n  to {\n    text-shadow: 0 0 20px var(--neon-green), 0 0 30px var(--neon-green), 0 0 40px var(--neon-green);\n  }\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes float {\n  0%, 100% {\n    transform: translateY(0px);\n  }\n  50% {\n    transform: translateY(-20px);\n  }\n}\n\n@keyframes slideInFromLeft {\n  from {\n    opacity: 0;\n    transform: translateX(-50px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n@keyframes slideInFromRight {\n  from {\n    opacity: 0;\n    transform: translateX(50px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n.animate-fade-in {\n  animation: fadeIn 0.6s ease-out;\n}\n\n.animate-slide-in-left {\n  animation: slideInFromLeft 0.6s ease-out;\n}\n\n.animate-slide-in-right {\n  animation: slideInFromRight 0.6s ease-out;\n}\n\n/* Smooth transitions */\n.smooth-transition {\n  transition: all 0.3s ease;\n}\n\n/* Hover effects */\n.hover-lift:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);\n}\n\n.card-hover:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);\n}\n\n/* Loading animations */\n.loading-bar {\n  height: 2px;\n  background: linear-gradient(90deg, #000 0%, #666 50%, #000 100%);\n  animation: loading 1.5s infinite;\n}\n\n@keyframes loading {\n  0% { transform: scaleX(0); }\n  100% { transform: scaleX(1); }\n}\n\n/* Typography improvements */\nh1, h2, h3, h4, h5, h6 {\n  font-weight: 600;\n  line-height: 1.2;\n}\n\np {\n  line-height: 1.6;\n}\n\n/* Focus styles */\nbutton:focus-visible,\ninput:focus-visible,\ntextarea:focus-visible {\n  outline: 2px solid hsl(var(--ring));\n  outline-offset: 2px;\n}\n\n/* Enhanced scrollbar */\n::-webkit-scrollbar {\n  width: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: hsl(var(--muted));\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb {\n  background: hsl(var(--muted-foreground));\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: hsl(var(--border));\n}\n\n/* React Grid Layout Styles */\n.react-grid-layout {\n  position: relative;\n}\n\n.react-grid-item {\n  transition: all 200ms ease;\n  transition-property: left, top;\n}\n\n.react-grid-item.cssTransforms {\n  transition-property: transform;\n}\n\n.react-grid-item > .react-resizable-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  bottom: 0;\n  right: 0;\n  background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB2aWV3Qm94PSIwIDAgNiA2IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9IiM0NEE2OEYiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0ibTUgNWgtNHYtNGg0em0tNCAzaDN2LTNoLTN6Ii8+PC9nPjwvc3ZnPg==') no-repeat;\n  background-position: bottom right;\n  padding: 0 3px 3px 0;\n  background-repeat: no-repeat;\n  background-origin: content-box;\n  box-sizing: border-box;\n  cursor: se-resize;\n  opacity: 0.4;\n}\n\n.react-grid-item > .react-resizable-handle:hover {\n  opacity: 0.8;\n}\n\n.react-grid-item.react-grid-placeholder {\n  background: hsl(var(--primary) / 0.2);\n  opacity: 0.8;\n  transition-duration: 100ms;\n  z-index: 2;\n  user-select: none;\n  border-radius: 8px;\n}\n\n.widget-container {\n  height: 100%;\n  position: relative;\n}\n\n/* Gaming-themed special effects */\n.particle-effect {\n  position: relative;\n  overflow: hidden;\n}\n\n.particle-effect::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: radial-gradient(\n    circle at 20% 50%,\n    var(--neon-green) 0%,\n    transparent 50%\n  ),\n  radial-gradient(\n    circle at 80% 20%,\n    var(--gold) 0%,\n    transparent 50%\n  ),\n  radial-gradient(\n    circle at 40% 80%,\n    var(--neon-blue) 0%,\n    transparent 50%\n  );\n  opacity: 0.1;\n  /* Removed float animation to prevent moving gradients */\n  pointer-events: none;\n}\n\n/* Status badge styles */\n.status-active {\n  background: linear-gradient(135deg, var(--neon-green), hsl(142, 76%, 46%));\n  color: hsl(0, 0%, 100%);\n  @apply text-white font-semibold;\n  box-shadow: 0 0 20px var(--neon-green);\n  /* Removed pulse-glow animation to prevent moving gradients */\n}\n\n.status-inactive {\n  background: linear-gradient(135deg, var(--red-loss), hsl(0, 84%, 70%));\n  @apply text-white font-semibold;\n}\n\n.status-waiting {\n  background: linear-gradient(135deg, var(--gold), hsl(51, 100%, 60%));\n  @apply text-black font-semibold;\n}\n\n/* Sidebar and Chat Panel Enhancements */\n.sidebar-nav-item {\n  position: relative;\n  overflow: hidden;\n}\n\n.sidebar-nav-item::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);\n  transition: left 0.5s;\n}\n\n.sidebar-nav-item:hover::before {\n  left: 100%;\n}\n\n.chat-message-animation {\n  animation: slideUp 0.3s ease-out;\n}\n\n/* Enhanced overlay */\n.overlay-blur {\n  backdrop-filter: blur(4px);\n  -webkit-backdrop-filter: blur(4px);\n}\n","size_bytes":15493},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"server/routes/api.ts":{"content":"import { Router } from 'express';\nimport { \n  getStockQuote, \n  searchStocks, \n  getHistoricalData, \n  getCompanyProfile,\n  getPopularStocks,\n  getStockPerformance,\n  getAllSectors,\n  TimeFrame\n} from '../services/yahooFinance.js';\nimport { getExchangeRate, convertCurrency, getAllExchangeRates } from '../services/exchangeRates.js';\nimport { \n  asyncHandler, \n  validateSymbol, \n  sanitizeInput, \n  ValidationError, \n  NotFoundError \n} from '../utils/errorHandler.js';\nimport { storage } from '../storage.js';\nimport { db } from '../db.js';\nimport { tournaments, tournamentParticipants, tradeHistory } from '../../shared/schema.js';\nimport { eq, sql } from 'drizzle-orm';\nimport { requireAuth } from '../auth.js';\n\nconst router = Router();\n\n/**\n * Helper function to calculate portfolio growth and award achievements\n */\nasync function checkPersonalPortfolioGrowthAchievements(userId: number) {\n  try {\n    const user = await storage.getUser(userId);\n    if (!user) return;\n\n    const purchases = await storage.getPersonalStockPurchases(userId);\n    const currentBalance = parseFloat(user.personalBalance) || 10000;\n    const initialDeposit = parseFloat(user.totalDeposited) || 10000;\n    \n    // Calculate current portfolio value\n    let currentPortfolioValue = currentBalance;\n    \n    for (const purchase of purchases) {\n      // Get current price for each stock\n      try {\n        const quote = await getStockQuote(purchase.symbol);\n        const currentValue = purchase.shares * quote.price;\n        currentPortfolioValue += currentValue;\n      } catch (error) {\n        // If unable to get current price, use purchase price as fallback\n        const purchaseValue = purchase.shares * purchase.purchasePrice;\n        currentPortfolioValue += purchaseValue;\n      }\n    }\n    \n    // Calculate growth percentage\n    const growthPercentage = ((currentPortfolioValue - initialDeposit) / initialDeposit) * 100;\n    \n    console.log(`Portfolio growth check for user ${userId}: ${growthPercentage.toFixed(2)}% (${currentPortfolioValue} vs ${initialDeposit})`);\n    \n    // Award 5% Portfolio Growth achievement\n    if (growthPercentage >= 5) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '5_percent_growth',\n        achievementTier: 'uncommon',\n        achievementName: '5% Portfolio Growth',\n        achievementDescription: 'Made over 5% on any portfolio'\n      });\n    }\n    \n    // Award 10% Portfolio Growth achievement\n    if (growthPercentage >= 10) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '10_percent_growth',\n        achievementTier: 'rare',\n        achievementName: '10% Portfolio Growth',\n        achievementDescription: 'Made over 10% on any portfolio'\n      });\n    }\n    \n    // Award 25% Portfolio Growth achievement\n    if (growthPercentage >= 25) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '25_percent_growth',\n        achievementTier: 'legendary',\n        achievementName: '25% Portfolio Growth',\n        achievementDescription: 'Made over 25% on any portfolio'\n      });\n    }\n    \n    // Award 100% Portfolio Growth achievement\n    if (growthPercentage >= 100) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '100_percent_growth',\n        achievementTier: 'mythic',\n        achievementName: '100% Portfolio Growth',\n        achievementDescription: 'Made over 100% on any portfolio'\n      });\n    }\n  } catch (error) {\n    console.log('Error checking portfolio growth achievements:', error);\n  }\n}\n\n/**\n * GET /api/quote/:symbol\n * Fetch current stock quote data\n */\nrouter.get('/quote/:symbol', asyncHandler(async (req: any, res: any) => {\n  const symbol = sanitizeInput(req.params.symbol.toUpperCase());\n  \n  if (!validateSymbol(symbol)) {\n    throw new ValidationError('Invalid symbol format');\n  }\n\n  try {\n    const quote = await getStockQuote(symbol);\n    res.json({\n      success: true,\n      data: quote,\n    });\n  } catch (error) {\n    throw new NotFoundError(`Stock quote not found for symbol: ${symbol}`);\n  }\n}));\n\n/**\n * GET /api/search/:query\n * Search for stock symbols by company name\n */\nrouter.get('/search/:query', asyncHandler(async (req: any, res: any) => {\n  const query = sanitizeInput(req.params.query);\n  \n  if (!query || query.length < 2) {\n    throw new ValidationError('Query must be at least 2 characters long');\n  }\n\n  const results = await searchStocks(query);\n  \n  res.json({\n    success: true,\n    data: results,\n  });\n}));\n\n/**\n * GET /api/historical/:symbol\n * Get historical price data with query parameter timeframe\n */\nrouter.get('/historical/:symbol', asyncHandler(async (req: any, res: any) => {\n  const symbol = sanitizeInput(req.params.symbol.toUpperCase());\n  const timeFrame = sanitizeInput(req.query.timeframe as string || '1M') as TimeFrame;\n  \n  if (!validateSymbol(symbol)) {\n    throw new ValidationError('Invalid symbol format');\n  }\n\n  // Validate timeframe\n  const validTimeframes: TimeFrame[] = ['1D', '5D', '1W', '1M', '3M', '6M', 'YTD', '1Y', '5Y'];\n  if (!validTimeframes.includes(timeFrame)) {\n    throw new ValidationError('Invalid timeframe. Valid timeframes: ' + validTimeframes.join(', '));\n  }\n\n  try {\n    const historicalData = await getHistoricalData(symbol, timeFrame);\n    res.json({\n      success: true,\n      data: historicalData,\n      timeFrame,\n    });\n  } catch (error) {\n    throw new NotFoundError(`Historical data not found for symbol: ${symbol}`);\n  }\n}));\n\n/**\n * GET /api/historical/:symbol/:timeframe\n * Get historical price data with path parameter timeframe\n */\nrouter.get('/historical/:symbol/:timeframe', asyncHandler(async (req: any, res: any) => {\n  const symbol = sanitizeInput(req.params.symbol.toUpperCase());\n  const timeFrame = sanitizeInput(req.params.timeframe.toUpperCase()) as TimeFrame;\n  \n  if (!validateSymbol(symbol)) {\n    throw new ValidationError('Invalid symbol format');\n  }\n\n  // Validate timeframe\n  const validTimeframes: TimeFrame[] = ['1D', '5D', '1W', '1M', '3M', '6M', 'YTD', '1Y', '5Y'];\n  if (!validTimeframes.includes(timeFrame)) {\n    throw new ValidationError('Invalid timeframe. Valid timeframes: ' + validTimeframes.join(', '));\n  }\n\n  try {\n    const historicalData = await getHistoricalData(symbol, timeFrame);\n    res.json({\n      success: true,\n      data: historicalData,\n      timeFrame,\n    });\n  } catch (error) {\n    throw new NotFoundError(`Historical data not found for symbol: ${symbol}`);\n  }\n}));\n\n/**\n * GET /api/performance/:symbol/:timeframe\n * Get stock performance for specific timeframe\n */\nrouter.get('/performance/:symbol/:timeframe', asyncHandler(async (req, res) => {\n  const symbol = sanitizeInput(req.params.symbol.toUpperCase());\n  const timeFrame = sanitizeInput(req.params.timeframe.toUpperCase()) as TimeFrame;\n  \n  if (!validateSymbol(symbol)) {\n    throw new ValidationError('Invalid symbol format');\n  }\n\n  // Validate timeframe\n  const validTimeframes: TimeFrame[] = ['1D', '5D', '1W', '1M', '3M', '6M', 'YTD', '1Y', '5Y'];\n  if (!validTimeframes.includes(timeFrame)) {\n    throw new ValidationError('Invalid timeframe. Valid timeframes: ' + validTimeframes.join(', '));\n  }\n\n  try {\n    const performance = await getStockPerformance(symbol, timeFrame);\n    res.json({\n      success: true,\n      data: performance,\n    });\n  } catch (error) {\n    throw new NotFoundError(`Performance data not found for symbol: ${symbol}`);\n  }\n}));\n\n/**\n * GET /api/summary/:symbol\n * Get detailed company information\n */\nrouter.get('/summary/:symbol', asyncHandler(async (req, res) => {\n  const symbol = sanitizeInput(req.params.symbol.toUpperCase());\n  \n  if (!validateSymbol(symbol)) {\n    throw new ValidationError('Invalid symbol format');\n  }\n\n  try {\n    const profile = await getCompanyProfile(symbol);\n    res.json({\n      success: true,\n      data: profile,\n    });\n  } catch (error) {\n    throw new NotFoundError(`Company profile not found for symbol: ${symbol}`);\n  }\n}));\n\n/**\n * GET /api/popular\n * Get popular/trending stocks\n */\nrouter.get('/popular', asyncHandler(async (req, res) => {\n  const popularStocks = await getPopularStocks();\n  \n  res.json({\n    success: true,\n    data: popularStocks,\n  });\n}));\n\n/**\n * GET /api/sectors\n * Get all available sectors\n */\nrouter.get('/sectors', asyncHandler(async (req, res) => {\n  const sectors = getAllSectors();\n  \n  res.json({\n    success: true,\n    data: sectors,\n  });\n}));\n\n/**\n * GET /api/health\n * Health check endpoint\n */\nrouter.get('/health', (req, res) => {\n  res.json({\n    success: true,\n    message: 'Yahoo Finance API is healthy',\n    timestamp: new Date().toISOString(),\n  });\n});\n\n/**\n * POST /api/tournaments\n * Create a new tournament\n */\nrouter.post('/tournaments', requireAuth, asyncHandler(async (req, res) => {\n  const { \n    name, \n    maxPlayers, \n    tournamentType, \n    startingBalance, \n    duration, \n    scheduledStartTime,\n    buyInAmount, \n    tradingRestriction, \n    isPublic \n  } = req.body;\n  const userId = req.user.id;\n  \n  if (!userId) {\n    throw new ValidationError('User not authenticated');\n  }\n\n  const user = await storage.getUser(userId);\n\n  if (!name || !startingBalance) {\n    throw new ValidationError('Tournament name and starting balance are required');\n  }\n\n  const buyIn = parseFloat(buyInAmount) || 0;\n  \n  // The buy-in deduction will be handled by the storage layer\n\n  const tournament = await storage.createTournament({\n    name: sanitizeInput(name),\n    maxPlayers: maxPlayers || 10,\n    tournamentType: tournamentType || 'stocks',\n    startingBalance: parseFloat(startingBalance),\n    timeframe: duration || '1 week',\n    scheduledStartTime: scheduledStartTime ? new Date(scheduledStartTime) : null,\n    buyInAmount: buyIn,\n    currentPot: 0, // Will be set by storage layer after buy-in deduction\n    tradingRestriction: tradingRestriction || 'none',\n    isPublic: isPublic !== undefined ? isPublic : true\n  }, userId);\n\n  // Award Tournament Creator achievement (rare)\n  await storage.awardAchievement({\n    userId: userId,\n    achievementType: 'tournament_creator',\n    achievementTier: 'rare',\n    achievementName: 'Tournament Creator',\n    achievementDescription: 'Created a tournament',\n    earnedAt: new Date(),\n    createdAt: new Date()\n  });\n\n  // Award Tournament Participant achievement\n  await storage.awardAchievement({\n    userId: userId,\n    achievementType: 'tournament_participant',\n    achievementTier: 'common',\n    achievementName: 'Tournament Participant',\n    achievementDescription: 'Joined a tournament',\n    earnedAt: new Date(),\n    createdAt: new Date()\n  });\n\n  res.json({\n    success: true,\n    data: tournament,\n  });\n}));\n\n/**\n * POST /api/tournaments/:id/start-early\n * Start a private tournament early (creator only)\n */\nrouter.post('/tournaments/:id/start-early', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n  \n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  const tournament = await storage.getTournamentById(tournamentId);\n  if (!tournament) {\n    throw new NotFoundError('Tournament not found');\n  }\n\n  // Check if user is the creator\n  if (tournament.creatorId !== userId) {\n    throw new ValidationError('Only tournament creators can start tournaments early');\n  }\n\n  // Check if tournament is private\n  if (tournament.isPublic) {\n    throw new ValidationError('Only private tournaments can be started early');\n  }\n\n  // Check if tournament hasn't started yet\n  if (tournament.status !== 'waiting') {\n    throw new ValidationError('Tournament has already started or ended');\n  }\n\n  // Check minimum participants\n  if (tournament.currentPlayers < 2) {\n    throw new ValidationError('Need at least 2 participants to start tournament');\n  }\n\n  // Start the tournament\n  await storage.updateTournament(tournamentId, {\n    status: 'active',\n    startedAt: new Date()\n  });\n\n  res.json({\n    success: true,\n    message: 'Tournament started successfully'\n  });\n}));\n\n/**\n * DELETE /api/tournaments/:id/cancel\n * Cancel a private tournament (creator only, before it starts)\n */\nrouter.delete('/tournaments/:id/cancel', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n  \n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  const tournament = await storage.getTournamentById(tournamentId);\n  if (!tournament) {\n    throw new NotFoundError('Tournament not found');\n  }\n\n  // Check if user is the creator\n  if (tournament.creatorId !== userId) {\n    throw new ValidationError('Only tournament creators can cancel tournaments');\n  }\n\n  // Check if tournament is private\n  if (tournament.isPublic) {\n    throw new ValidationError('Only private tournaments can be cancelled');\n  }\n\n  // Check if tournament hasn't started yet\n  if (tournament.status !== 'waiting') {\n    throw new ValidationError('Cannot cancel tournaments that have already started');\n  }\n\n  // Delete the tournament and all related data\n  await storage.deleteTournament(tournamentId);\n\n  res.json({\n    success: true,\n    message: 'Tournament cancelled successfully'\n  });\n}));\n\n/**\n * DELETE /api/tournaments/:id/participants/:participantId\n * Kick a participant from a private tournament (creator only, before it starts)\n */\nrouter.delete('/tournaments/:id/participants/:participantId', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const participantId = parseInt(req.params.participantId);\n  const userId = req.user.id;\n  \n  if (isNaN(tournamentId) || isNaN(participantId)) {\n    throw new ValidationError('Invalid tournament or participant ID');\n  }\n\n  const tournament = await storage.getTournamentById(tournamentId);\n  if (!tournament) {\n    throw new NotFoundError('Tournament not found');\n  }\n\n  // Check if user is the creator\n  if (tournament.creatorId !== userId) {\n    throw new ValidationError('Only tournament creators can kick participants');\n  }\n\n  // Check if tournament is private\n  if (tournament.isPublic) {\n    throw new ValidationError('Cannot kick participants from public tournaments');\n  }\n\n  // Check if tournament hasn't started yet\n  if (tournament.status !== 'waiting') {\n    throw new ValidationError('Cannot kick participants from tournaments that have already started');\n  }\n\n  // Cannot kick the creator\n  if (participantId === userId) {\n    throw new ValidationError('Tournament creators cannot kick themselves');\n  }\n\n  // Remove participant\n  await storage.removeTournamentParticipant(tournamentId, participantId);\n\n  res.json({\n    success: true,\n    message: 'Participant removed successfully'\n  });\n}));\n\n/**\n * POST /api/tournaments/code/:code/join\n * Join a tournament by code\n */\nrouter.post('/tournaments/code/:code/join', requireAuth, asyncHandler(async (req, res) => {\n  const code = sanitizeInput(req.params.code.toUpperCase());\n  const userId = req.user.id;\n  \n  if (!userId) {\n    throw new ValidationError('User not authenticated');\n  }\n\n  const tournament = await storage.getTournamentByCode(code);\n  if (!tournament) {\n    throw new NotFoundError('Tournament not found');\n  }\n\n  if (tournament.currentPlayers >= tournament.maxPlayers) {\n    throw new ValidationError('Tournament is full');\n  }\n\n  // Check buy-in requirements\n  const buyIn = parseFloat(tournament.buyInAmount?.toString() || '0');\n  if (buyIn > 0) {\n    const user = await storage.getUser(userId);\n    const currentSiteCash = parseFloat(user?.siteCash?.toString() || '0');\n    \n    if (buyIn > currentSiteCash) {\n      throw new ValidationError(`Insufficient funds. You need ${buyIn.toFixed(2)} but only have ${currentSiteCash.toFixed(2)} in your account.`);\n    }\n    \n    // Deduct buy-in from user's siteCash\n    const newSiteCash = currentSiteCash - buyIn;\n    await storage.updateUser(userId, { siteCash: newSiteCash.toString() });\n    \n    // Add buy-in to tournament pot\n    const newPot = parseFloat(tournament.currentPot?.toString() || '0') + buyIn;\n    await storage.updateTournament(tournament.id, { currentPot: newPot.toString() });\n    \n    // Log the transaction\n    await storage.createAdminLog({\n      adminUserId: userId,\n      targetUserId: userId,\n      action: 'tournament_buyin_deduction',\n      oldValue: currentSiteCash.toString(),\n      newValue: newSiteCash.toString(),\n      notes: `Buy-in deducted for joining tournament: ${tournament.name} ($${buyIn.toFixed(2)})`\n    });\n  }\n\n  try {\n    const participant = await storage.joinTournament(tournament.id, userId);\n\n    // Award Tournament Participant achievement\n    await storage.awardAchievement({\n      userId: userId,\n      achievementType: 'tournament_participant',\n      achievementTier: 'common',\n      achievementName: 'Tournament Participant',\n      achievementDescription: 'Joined a tournament',\n      earnedAt: new Date(),\n      createdAt: new Date()\n    });\n\n    res.json({\n      success: true,\n      data: participant,\n    });\n  } catch (error: any) {\n    if (error.message === 'User is already participating in this tournament') {\n      throw new ValidationError('You are already participating in this tournament');\n    }\n    throw error;\n  }\n}));\n\n/**\n * POST /api/tournaments/:id/join\n * Join a tournament by ID\n */\nrouter.post('/tournaments/:id/join', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n  \n  if (!userId) {\n    throw new ValidationError('User not authenticated');\n  }\n\n  const tournament = await storage.getTournamentById(tournamentId);\n  if (!tournament) {\n    throw new NotFoundError('Tournament not found');\n  }\n\n  if (tournament.currentPlayers >= tournament.maxPlayers) {\n    throw new ValidationError('Tournament is full');\n  }\n\n  // Check buy-in requirements\n  const buyIn = parseFloat(tournament.buyInAmount?.toString() || '0');\n  if (buyIn > 0) {\n    const user = await storage.getUser(userId);\n    const currentSiteCash = parseFloat(user?.siteCash?.toString() || '0');\n    \n    if (buyIn > currentSiteCash) {\n      throw new ValidationError(`Insufficient funds. You need ${buyIn.toFixed(2)} but only have ${currentSiteCash.toFixed(2)} in your account.`);\n    }\n    \n    // Deduct buy-in from user's siteCash\n    const newSiteCash = currentSiteCash - buyIn;\n    await storage.updateUser(userId, { siteCash: newSiteCash.toString() });\n    \n    // Add buy-in to tournament pot\n    const newPot = parseFloat(tournament.currentPot?.toString() || '0') + buyIn;\n    await storage.updateTournament(tournament.id, { currentPot: newPot.toString() });\n    \n    // Log the transaction\n    await storage.createAdminLog({\n      adminUserId: userId,\n      targetUserId: userId,\n      action: 'tournament_buyin_deduction',\n      oldValue: currentSiteCash.toString(),\n      newValue: newSiteCash.toString(),\n      notes: `Buy-in deducted for joining tournament: ${tournament.name} ($${buyIn.toFixed(2)})`\n    });\n  }\n\n  try {\n    const participant = await storage.joinTournament(tournament.id, userId);\n\n    // Award Tournament Participant achievement\n    await storage.awardAchievement({\n      userId: userId,\n      achievementType: 'tournament_participant',\n      achievementTier: 'common',\n      achievementName: 'Tournament Participant',\n      achievementDescription: 'Joined a tournament',\n      earnedAt: new Date(),\n      createdAt: new Date()\n    });\n\n    res.json({\n      success: true,\n      data: participant,\n    });\n  } catch (error: any) {\n    if (error.message === 'User is already participating in this tournament') {\n      throw new ValidationError('You are already participating in this tournament');\n    }\n    throw error;\n  }\n}));\n\n/**\n * GET /api/tournaments\n * Get user's tournaments\n */\nrouter.get('/tournaments', requireAuth, asyncHandler(async (req: any, res: any) => {\n  const userId = req.user.id;\n\n  const tournaments = await storage.getUserTournaments(userId);\n\n  res.json({\n    success: true,\n    data: tournaments,\n  });\n}));\n\n/**\n * GET /api/tournaments/public\n * Get public tournaments for browsing\n */\nrouter.get('/tournaments/public', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n\n  const publicTournaments = await storage.getPublicTournaments();\n\n  res.json({\n    success: true,\n    data: publicTournaments,\n  });\n}));\n\n/**\n * GET /api/tournaments/:id/leaderboard\n * Get tournament leaderboard with rankings and portfolio values\n */\nrouter.get('/tournaments/:id/leaderboard', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  \n  const participants = await storage.getTournamentParticipants(tournamentId);\n\n  // Calculate portfolio values with current stock prices\n  const participantsWithValues = await Promise.all(\n    participants.map(async (participant) => {\n      let stockValue = 0;\n      const stockSymbols = [...new Set(participant.stockPurchases.map((p: any) => p.symbol))];\n      \n      // Get current prices for all symbols\n      const stockPrices: { [symbol: string]: number } = {};\n      for (const symbol of stockSymbols) {\n        try {\n          const { getStockQuote } = await import('../services/yahooFinance');\n          const quote = await getStockQuote(symbol);\n          stockPrices[symbol] = quote.price;\n        } catch (error) {\n          console.error(`Error fetching price for ${symbol}:`, error);\n          stockPrices[symbol] = 0;\n        }\n      }\n\n      // Calculate total stock value\n      const stockHoldings: { [symbol: string]: { quantity: number; averagePrice: number } } = {};\n      \n      participant.stockPurchases.forEach((purchase: any) => {\n        const symbol = purchase.symbol;\n        const quantity = parseInt(purchase.shares);\n        const price = parseFloat(purchase.purchasePrice);\n        \n        if (!stockHoldings[symbol]) {\n          stockHoldings[symbol] = { quantity: 0, averagePrice: 0 };\n        }\n        \n        const currentHolding = stockHoldings[symbol];\n        const totalQuantity = currentHolding.quantity + quantity;\n        const totalCost = (currentHolding.quantity * currentHolding.averagePrice) + (quantity * price);\n        \n        stockHoldings[symbol] = {\n          quantity: totalQuantity,\n          averagePrice: totalCost / totalQuantity\n        };\n      });\n\n      // Calculate current value of all holdings\n      Object.entries(stockHoldings).forEach(([symbol, holding]) => {\n        const currentPrice = stockPrices[symbol] || 0;\n        stockValue += holding.quantity * currentPrice;\n      });\n\n      const balance = parseFloat(participant.balance);\n      const portfolioValue = balance + stockValue;\n\n      return {\n        userId: participant.userId,\n        firstName: participant.firstName,\n        displayName: participant.displayName,\n        portfolioValue,\n        balance,\n        stockValue\n      };\n    })\n  );\n\n  // Sort by portfolio value (highest first)\n  participantsWithValues.sort((a, b) => b.portfolioValue - a.portfolioValue);\n\n  res.json({\n    success: true,\n    participants: participantsWithValues,\n  });\n}));\n\n/**\n * GET /api/tournaments/:id/participants\n * Get tournament participants with user names and portfolio values\n */\nrouter.get('/tournaments/:id/participants', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  const participants = await storage.getTournamentParticipants(tournamentId);\n\n  // Calculate portfolio values with current stock prices\n  const participantsWithValues = await Promise.all(\n    participants.map(async (participant) => {\n      let stockValue = 0;\n      const stockSymbols = [...new Set(participant.stockPurchases.map((p: any) => p.symbol))];\n      \n      // Get current prices for all symbols\n      const stockPrices: { [symbol: string]: number } = {};\n      for (const symbol of stockSymbols) {\n        try {\n          const { getStockQuote } = await import('../services/yahooFinance');\n          const quote = await getStockQuote(symbol);\n          stockPrices[symbol] = quote.price;\n        } catch (error) {\n          console.error(`Error fetching price for ${symbol}:`, error);\n          stockPrices[symbol] = 0;\n        }\n      }\n\n      // Calculate total stock value\n      const stockHoldings: { [symbol: string]: { quantity: number; averagePrice: number } } = {};\n      \n      participant.stockPurchases.forEach((purchase: any) => {\n        const symbol = purchase.symbol;\n        const quantity = parseInt(purchase.shares);\n        const price = parseFloat(purchase.purchasePrice);\n        \n        if (!stockHoldings[symbol]) {\n          stockHoldings[symbol] = { quantity: 0, averagePrice: 0 };\n        }\n        \n        const currentHolding = stockHoldings[symbol];\n        const totalQuantity = currentHolding.quantity + quantity;\n        const totalCost = (currentHolding.quantity * currentHolding.averagePrice) + (quantity * price);\n        \n        stockHoldings[symbol] = {\n          quantity: totalQuantity,\n          averagePrice: totalCost / totalQuantity\n        };\n      });\n\n      // Calculate current value of all holdings\n      Object.entries(stockHoldings).forEach(([symbol, holding]) => {\n        const currentPrice = stockPrices[symbol] || 0;\n        stockValue += holding.quantity * currentPrice;\n      });\n\n      const balance = parseFloat(participant.balance);\n      const totalValue = balance + stockValue;\n\n      return {\n        ...participant,\n        stockValue,\n        totalValue,\n        stockHoldings: Object.entries(stockHoldings).map(([symbol, holding]) => ({\n          symbol,\n          quantity: holding.quantity,\n          averagePrice: holding.averagePrice,\n          currentPrice: stockPrices[symbol] || 0,\n          currentValue: holding.quantity * (stockPrices[symbol] || 0)\n        }))\n      };\n    })\n  );\n\n  // Sort by total value (highest first)\n  participantsWithValues.sort((a, b) => b.totalValue - a.totalValue);\n\n  res.json({\n    success: true,\n    data: participantsWithValues,\n  });\n}));\n\n/**\n * GET /api/tournaments/:id/balance\n * Get tournament balance for user\n */\nrouter.get('/tournaments/:id/balance', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  const balance = await storage.getTournamentBalance(tournamentId, userId);\n\n  res.json({\n    success: true,\n    data: { balance },\n  });\n}));\n\n/**\n * GET /api/tournaments/:id/purchases\n * Get tournament purchases for user\n */\nrouter.get('/tournaments/:id/purchases', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  const purchases = await storage.getTournamentStockPurchases(tournamentId, userId);\n\n  res.json({\n    success: true,\n    data: purchases,\n  });\n}));\n\n/**\n * GET /api/portfolio/tournament/:id\n * Get tournament portfolio for user\n */\nrouter.get('/portfolio/tournament/:id', requireAuth, asyncHandler(async (req, res) => {\n  console.log('Tournament portfolio route hit, user:', req.user);\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  // Get tournament stock purchases\n  const purchases = await storage.getTournamentStockPurchases(tournamentId, userId);\n  \n  // Group purchases by symbol and calculate holdings\n  const stockHoldings: { [symbol: string]: { \n    symbol: string;\n    companyName: string;\n    shares: number; \n    averagePurchasePrice: number;\n    totalCost: number;\n    currentPrice?: number;\n    currentValue?: number;\n    profitLoss?: number;\n    profitLossPercent?: number;\n  } } = {};\n  \n  // Process all purchases to calculate holdings\n  for (const purchase of purchases) {\n    const symbol = purchase.symbol;\n    const shares = purchase.shares;\n    const purchasePrice = parseFloat(purchase.purchasePrice);\n    const totalCost = parseFloat(purchase.totalCost);\n    \n    if (!stockHoldings[symbol]) {\n      stockHoldings[symbol] = {\n        symbol,\n        companyName: purchase.companyName,\n        shares: 0,\n        averagePurchasePrice: 0,\n        totalCost: 0\n      };\n    }\n    \n    const holding = stockHoldings[symbol];\n    const newTotalShares = holding.shares + shares;\n    const newTotalCost = holding.totalCost + totalCost;\n    \n    stockHoldings[symbol] = {\n      ...holding,\n      shares: newTotalShares,\n      totalCost: newTotalCost,\n      averagePurchasePrice: newTotalCost / newTotalShares\n    };\n  }\n  \n  // Get current prices and calculate profit/loss\n  for (const holding of Object.values(stockHoldings)) {\n    try {\n      const quote = await getStockQuote(holding.symbol);\n      holding.currentPrice = quote.price;\n      holding.currentValue = holding.shares * quote.price;\n      holding.profitLoss = holding.currentValue - holding.totalCost;\n      holding.profitLossPercent = (holding.profitLoss / holding.totalCost) * 100;\n    } catch (error) {\n      console.error(`Error fetching quote for ${holding.symbol}:`, error);\n      // Fallback to purchase price\n      holding.currentPrice = holding.averagePurchasePrice;\n      holding.currentValue = holding.shares * holding.averagePurchasePrice;\n      holding.profitLoss = 0;\n      holding.profitLossPercent = 0;\n    }\n  }\n\n  res.json({\n    success: true,\n    data: Object.values(stockHoldings)\n  });\n}));\n\n/**\n * POST /api/tournaments/:id/sell\n * Sell stock in a tournament\n */\nrouter.post('/tournaments/:id/sell', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n  const { symbol, sharesToSell, currentPrice } = req.body;\n\n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  if (!symbol || !sharesToSell || !currentPrice) {\n    throw new ValidationError('Symbol, shares to sell, and current price are required');\n  }\n\n  const sharesToSellNum = parseInt(sharesToSell);\n  if (isNaN(sharesToSellNum) || sharesToSellNum <= 0) {\n    throw new ValidationError('Invalid number of shares to sell');\n  }\n\n  // Check if tournament is completed (no trading allowed)\n  const tournaments = await storage.getAllTournaments();\n  const tournament = tournaments.find(t => t.id === tournamentId);\n  if (tournament && tournament.status === 'completed') {\n    throw new ValidationError('Cannot trade in completed tournaments');\n  }\n\n  // Get user's tournament stock purchases for this symbol\n  const allPurchases = await storage.getTournamentStockPurchases(tournamentId, userId);\n  const symbolPurchases = allPurchases.filter(p => p.symbol === symbol);\n  \n  if (symbolPurchases.length === 0) {\n    throw new ValidationError('No holdings found for this stock');\n  }\n\n  // Calculate total shares owned\n  const totalShares = symbolPurchases.reduce((sum, purchase) => sum + purchase.shares, 0);\n  \n  if (sharesToSellNum > totalShares) {\n    throw new ValidationError(`Cannot sell ${sharesToSellNum} shares. You only own ${totalShares} shares.`);\n  }\n\n  // Calculate sale value\n  const saleValue = sharesToSellNum * parseFloat(currentPrice);\n\n  // Get current balance\n  const currentBalance = await storage.getTournamentBalance(tournamentId, userId);\n\n  // Process the sale by removing shares (FIFO - First In, First Out)\n  let remainingToSell = sharesToSellNum;\n  \n  for (const purchase of symbolPurchases) {\n    if (remainingToSell <= 0) break;\n    \n    if (purchase.shares <= remainingToSell) {\n      // Sell all shares from this purchase\n      remainingToSell -= purchase.shares;\n      await storage.deleteTournamentPurchase(tournamentId, userId, purchase.id);\n    } else {\n      // Partially sell shares from this purchase\n      const newShares = purchase.shares - remainingToSell;\n      const purchasePrice = parseFloat(purchase.purchasePrice);\n      \n      // Delete the old record and create a new one with remaining shares\n      await storage.deleteTournamentPurchase(tournamentId, userId, purchase.id);\n      await storage.purchaseTournamentStock(tournamentId, userId, {\n        symbol: purchase.symbol,\n        companyName: purchase.companyName,\n        shares: newShares,\n        purchasePrice: purchasePrice,\n        totalCost: newShares * purchasePrice\n      });\n      \n      remainingToSell = 0;\n    }\n  }\n\n  // Update tournament balance\n  await storage.updateTournamentBalance(tournamentId, userId, currentBalance + saleValue);\n\n  // Record the trade in trade history\n  const firstPurchase = symbolPurchases[0]; // Get company name from first purchase\n  await storage.recordTrade({\n    userId: userId,\n    tournamentId: tournamentId,\n    symbol: sanitizeInput(symbol),\n    companyName: sanitizeInput(firstPurchase.companyName),\n    tradeType: 'sell',\n    shares: sharesToSellNum,\n    price: parseFloat(currentPrice).toString(),\n    totalValue: saleValue.toString()\n  });\n\n  res.json({\n    success: true,\n    data: { \n      saleValue,\n      newBalance: currentBalance + saleValue,\n      sharesSold: sharesToSellNum\n    },\n  });\n}));\n\n/**\n * POST /api/tournaments/:id/purchase\n * Purchase stock in a tournament\n */\nrouter.post('/tournaments/:id/purchase', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  const { symbol, companyName, shares, purchasePrice } = req.body;\n  \n  if (!symbol || !companyName || !shares || !purchasePrice) {\n    throw new ValidationError('All purchase fields are required');\n  }\n\n  const totalCost = shares * purchasePrice;\n\n  // Check if tournament is completed (no trading allowed)\n  const tournaments = await storage.getAllTournaments();\n  const tournament = tournaments.find(t => t.id === tournamentId);\n  if (tournament && tournament.status === 'completed') {\n    throw new ValidationError('Cannot trade in completed tournaments');\n  }\n\n  // Check if user has enough balance\n  const currentBalance = await storage.getTournamentBalance(tournamentId, userId);\n  if (currentBalance < totalCost) {\n    throw new ValidationError('Insufficient balance for this purchase');\n  }\n\n  // Create purchase record\n  const purchase = await storage.purchaseTournamentStock(tournamentId, userId, {\n    symbol: sanitizeInput(symbol),\n    companyName: sanitizeInput(companyName),\n    shares: parseInt(shares),\n    purchasePrice: parseFloat(purchasePrice).toString(),\n    totalCost: totalCost.toString()\n  });\n\n  // Record the trade in trade history\n  await storage.recordTrade({\n    userId: userId,\n    tournamentId: tournamentId,\n    symbol: sanitizeInput(symbol),\n    companyName: sanitizeInput(companyName),\n    tradeType: 'buy',\n    shares: parseInt(shares),\n    price: parseFloat(purchasePrice).toString(),\n    totalValue: totalCost.toString()\n  });\n\n  // Update user balance\n  await storage.updateTournamentBalance(tournamentId, userId, currentBalance - totalCost);\n\n  // Award First Trade achievement\n  await storage.awardAchievement({\n    userId: userId,\n    achievementType: 'first_trade',\n    achievementTier: 'common',\n    achievementName: 'First Trade',\n    achievementDescription: 'Made your first trade'\n  });\n\n  res.status(201).json({\n    success: true,\n    data: { purchase },\n  });\n}));\n\n/**\n * POST /api/tournaments/:id/sell\n * Sell stock in a tournament\n */\nrouter.post('/tournaments/:id/sell', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  const { purchaseId, sharesToSell, currentPrice } = req.body;\n  \n  if (!purchaseId || !sharesToSell || !currentPrice) {\n    throw new ValidationError('Purchase ID, shares to sell, and current price are required');\n  }\n\n  // Get the original purchase\n  const purchases = await storage.getTournamentStockPurchases(tournamentId, userId);\n  const purchase = purchases.find(p => p.id === parseInt(purchaseId));\n  \n  if (!purchase) {\n    throw new ValidationError('Purchase not found');\n  }\n\n  const sharesToSellNum = parseInt(sharesToSell);\n  if (sharesToSellNum <= 0 || sharesToSellNum > purchase.shares) {\n    throw new ValidationError('Invalid number of shares to sell');\n  }\n\n  const saleValue = sharesToSellNum * parseFloat(currentPrice);\n  \n  // Check if tournament is completed (no trading allowed)\n  const tournaments = await storage.getAllTournaments();\n  const tournament = tournaments.find(t => t.id === tournamentId);\n  if (tournament && tournament.status === 'completed') {\n    throw new ValidationError('Cannot trade in completed tournaments');\n  }\n  \n  // Record the sell trade in trade history\n  await storage.recordTrade({\n    userId: userId,\n    tournamentId: tournamentId,\n    symbol: purchase.symbol,\n    companyName: purchase.companyName,\n    tradeType: 'sell',\n    shares: sharesToSellNum,\n    price: parseFloat(currentPrice),\n    totalValue: saleValue\n  });\n  \n  // Get current balance\n  const currentBalance = await storage.getTournamentBalance(tournamentId, userId);\n  \n  // Update balance with sale proceeds\n  await storage.updateTournamentBalance(tournamentId, userId, currentBalance + saleValue);\n\n  // If selling all shares, delete the purchase record\n  if (sharesToSellNum === purchase.shares) {\n    await storage.deleteTournamentPurchase(tournamentId, userId, purchase.id);\n  } else {\n    // Update the purchase record to reduce shares\n    // Note: This would need to be implemented in storage\n    // For now, we'll delete and recreate with remaining shares\n    await storage.deleteTournamentPurchase(tournamentId, userId, purchase.id);\n    \n    if (purchase.shares - sharesToSellNum > 0) {\n      await storage.purchaseTournamentStock(tournamentId, userId, {\n        symbol: purchase.symbol,\n        companyName: purchase.companyName,\n        shares: purchase.shares - sharesToSellNum,\n        purchasePrice: purchase.purchasePrice,\n        totalCost: (purchase.shares - sharesToSellNum) * purchase.purchasePrice\n      });\n    }\n  }\n\n  res.json({\n    success: true,\n    data: { \n      saleValue,\n      newBalance: currentBalance + saleValue \n    },\n  });\n}));\n\n\n\n\n\n/**\n * GET /api/tournaments/:id/balance\n * Get user's balance in a specific tournament\n */\nrouter.get('/tournaments/:id/balance', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  const balance = await storage.getTournamentBalance(tournamentId, userId);\n\n  res.json({\n    success: true,\n    data: { balance },\n  });\n}));\n\n/**\n * GET /api/tournaments/:id/purchases\n * Get user's stock purchases in a specific tournament\n */\nrouter.get('/tournaments/:id/purchases', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.id);\n  const userId = req.user.id;\n\n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  const purchases = await storage.getTournamentStockPurchases(tournamentId, userId);\n\n  res.json({\n    success: true,\n    data: purchases,\n  });\n}));\n\n/**\n * Helper function to calculate trading streak\n */\nasync function calculateTradingStreak(userId: number): Promise<number> {\n  try {\n    // Get all trades for the user ordered by date (most recent first)\n    const trades = await db.query.tradeHistory.findMany({\n      where: (tradeHistory, { eq }) => eq(tradeHistory.userId, userId),\n      orderBy: (tradeHistory, { desc }) => [desc(tradeHistory.createdAt)]\n    });\n\n    if (trades.length === 0) {\n      return 0;\n    }\n\n    // Group trades by date\n    const tradesByDate = new Map<string, any[]>();\n    trades.forEach(trade => {\n      const dateStr = trade.createdAt.toISOString().split('T')[0];\n      if (!tradesByDate.has(dateStr)) {\n        tradesByDate.set(dateStr, []);\n      }\n      tradesByDate.get(dateStr)!.push(trade);\n    });\n\n    // Get all unique trading dates and sort them\n    const tradingDates = Array.from(tradesByDate.keys()).sort().reverse(); // Most recent first\n    \n    if (tradingDates.length === 0) {\n      return 0;\n    }\n\n    // Calculate streak: count consecutive days starting from the most recent trading day\n    let streak = 0;\n    const today = new Date().toISOString().split('T')[0];\n    \n    // Start checking from today going backwards\n    const startDate = new Date();\n    let currentStreakCount = 0;\n    \n    for (let i = 0; i < 365; i++) { // Check up to 365 days\n      const checkDate = new Date(startDate);\n      checkDate.setDate(startDate.getDate() - i);\n      const dateStr = checkDate.toISOString().split('T')[0];\n      \n      if (tradesByDate.has(dateStr)) {\n        currentStreakCount++;\n      } else {\n        // If we've started counting and hit a gap, stop\n        if (currentStreakCount > 0) {\n          break;\n        }\n        // If we haven't started counting yet, continue looking backward\n      }\n    }\n\n    console.log(`Trading streak calculation for user ${userId}:`, {\n      totalTrades: trades.length,\n      uniqueTradingDays: tradingDates.length,\n      mostRecentTradingDay: tradingDates[0],\n      calculatedStreak: currentStreakCount,\n      today\n    });\n\n    return currentStreakCount;\n  } catch (error) {\n    console.error('Error calculating trading streak:', error);\n    return 0;\n  }\n}\n\n/**\n * Helper function to award streak achievements\n */\nasync function awardStreakAchievements(userId: number, streak: number) {\n  try {\n    // 5 day streak - Uncommon\n    if (streak >= 5) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '5_day_streak',\n        achievementTier: 'uncommon',\n        achievementName: '5 Day Streak',\n        achievementDescription: 'Traded for 5 consecutive days'\n      });\n    }\n\n    // 15 day streak - Rare\n    if (streak >= 15) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '15_day_streak',\n        achievementTier: 'rare',\n        achievementName: '15 Day Streak',\n        achievementDescription: 'Traded for 15 consecutive days'\n      });\n    }\n\n    // 50 day streak - Epic\n    if (streak >= 50) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '50_day_streak',\n        achievementTier: 'epic',\n        achievementName: '50 Day Streak',\n        achievementDescription: 'Traded for 50 consecutive days'\n      });\n    }\n\n    // 100 day streak - Legendary\n    if (streak >= 100) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '100_day_streak',\n        achievementTier: 'legendary',\n        achievementName: '100 Day Streak',\n        achievementDescription: 'Traded for 100 consecutive days'\n      });\n    }\n\n    // 365 day streak - Mythic\n    if (streak >= 365) {\n      await storage.awardAchievement({\n        userId,\n        achievementType: '365_day_streak',\n        achievementTier: 'mythic',\n        achievementName: '365 Day Streak',\n        achievementDescription: 'Traded every day for a full year'\n      });\n    }\n  } catch (error) {\n    console.error('Error awarding streak achievements:', error);\n  }\n}\n\n/**\n * GET /api/personal-portfolio\n * Get personal portfolio data with holdings\n */\nrouter.get('/personal-portfolio', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n\n  const user = await storage.getUser(userId);\n  const purchases = await storage.getPersonalStockPurchases(userId);\n\n  // Calculate trading streak\n  const tradingStreak = await calculateTradingStreak(userId);\n\n  // Award streak achievements based on current streak\n  await awardStreakAchievements(userId, tradingStreak);\n\n  // Group purchases by symbol to create holdings\n  const holdingsMap = new Map();\n  \n  for (const purchase of purchases) {\n    const symbol = purchase.symbol;\n    \n    if (holdingsMap.has(symbol)) {\n      const existing = holdingsMap.get(symbol);\n      const totalShares = existing.shares + purchase.shares;\n      const totalCost = (existing.shares * existing.averagePrice) + (purchase.shares * parseFloat(purchase.purchasePrice));\n      const averagePrice = totalCost / totalShares;\n      \n      holdingsMap.set(symbol, {\n        symbol,\n        companyName: purchase.companyName,\n        shares: totalShares,\n        averagePrice,\n        currentPrice: 0, // Will be updated below\n        change: 0,\n        changePercent: 0\n      });\n    } else {\n      holdingsMap.set(symbol, {\n        symbol,\n        companyName: purchase.companyName,\n        shares: purchase.shares,\n        averagePrice: parseFloat(purchase.purchasePrice),\n        currentPrice: 0, // Will be updated below\n        change: 0,\n        changePercent: 0\n      });\n    }\n  }\n\n  // Get current prices for all holdings\n  const holdings = [];\n  for (const holding of holdingsMap.values()) {\n    try {\n      const currentQuote = await getStockQuote(holding.symbol);\n      holding.currentPrice = currentQuote.price;\n      holding.change = currentQuote.change || 0;\n      holding.changePercent = currentQuote.changePercent || 0;\n    } catch (error) {\n      // If stock quote fails, use average price as fallback\n      holding.currentPrice = holding.averagePrice;\n      holding.change = 0;\n      holding.changePercent = 0;\n    }\n    holdings.push(holding);\n  }\n\n  res.json({\n    success: true,\n    data: {\n      balance: user.personalBalance || 10000,\n      portfolioCreatedAt: user.portfolioCreatedAt,\n      tradingStreak: tradingStreak,\n      holdings: holdings\n    },\n  });\n}));\n\n/**\n * GET /api/personal-purchases\n * Get personal stock purchases\n */\nrouter.get('/personal-purchases', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n\n  const user = await storage.getUser(userId);\n\n  const purchases = await storage.getPersonalStockPurchases(userId);\n\n  res.json({\n    success: true,\n    data: purchases,\n  });\n}));\n\n/**\n * POST /api/personal-portfolio/purchase\n * Purchase stock in personal portfolio\n */\nrouter.post('/personal-portfolio/purchase', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n\n  const user = await storage.getUser(userId);\n\n  const { symbol, companyName, shares, purchasePrice } = req.body;\n  \n  if (!symbol || !companyName || !shares || !purchasePrice) {\n    throw new ValidationError('All purchase fields are required');\n  }\n\n  const totalCost = shares * purchasePrice;\n  const currentBalance = user.personalBalance || 10000;\n\n  // Check if user has enough balance\n  if (currentBalance < totalCost) {\n    throw new ValidationError('Insufficient balance for this purchase');\n  }\n\n  // Create purchase record\n  const purchase = await storage.purchasePersonalStock(userId, {\n    symbol: sanitizeInput(symbol),\n    companyName: sanitizeInput(companyName),\n    shares: parseInt(shares),\n    purchasePrice: parseFloat(purchasePrice),\n    totalCost: totalCost\n  });\n\n  // Record the trade in trade history\n  await storage.recordTrade({\n    userId: userId,\n    tournamentId: null, // null for personal trades\n    symbol: sanitizeInput(symbol),\n    companyName: sanitizeInput(companyName),\n    tradeType: 'buy',\n    shares: parseInt(shares),\n    price: parseFloat(purchasePrice),\n    totalValue: totalCost\n  });\n\n  // Update user balance\n  await storage.updateUser(userId, {\n    personalBalance: currentBalance - totalCost\n  });\n\n  // Award First Trade achievement\n  await storage.awardAchievement({\n    userId: userId,\n    achievementType: 'first_trade',\n    achievementTier: 'common',\n    achievementName: 'First Trade',\n    achievementDescription: 'Made your first trade',\n    earnedAt: new Date(),\n    createdAt: new Date()\n  });\n\n  // Check for portfolio growth achievements\n  await checkPersonalPortfolioGrowthAchievements(userId);\n\n  // Check for streak achievements after purchase\n  const tradingStreak = await calculateTradingStreak(userId);\n  await awardStreakAchievements(userId, tradingStreak);\n\n  res.status(201).json({\n    success: true,\n    data: { purchase },\n  });\n}));\n\n/**\n * POST /api/personal-portfolio/sell\n * Sell stock in personal portfolio\n */\nrouter.post('/personal-portfolio/sell', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n\n  const user = await storage.getUser(userId);\n\n  const { symbol, sharesToSell, currentPrice } = req.body;\n  \n  if (!symbol || !sharesToSell || !currentPrice) {\n    throw new ValidationError('Symbol, shares to sell, and current price are required');\n  }\n\n  // Get all purchases for this symbol (FIFO - First In, First Out)\n  const purchases = await storage.getPersonalStockPurchases(userId);\n  const symbolPurchases = purchases.filter(p => p.symbol === symbol).sort((a, b) => \n    new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()\n  );\n  \n  if (symbolPurchases.length === 0) {\n    throw new ValidationError('No holdings found for this symbol');\n  }\n\n  // Calculate total shares owned for this symbol\n  const totalShares = symbolPurchases.reduce((sum, p) => sum + p.shares, 0);\n  const sharesToSellNum = parseInt(sharesToSell);\n  \n  if (sharesToSellNum <= 0 || sharesToSellNum > totalShares) {\n    throw new ValidationError(`Invalid number of shares to sell. You own ${totalShares} shares of ${symbol}`);\n  }\n\n  const saleValue = sharesToSellNum * parseFloat(currentPrice);\n  const currentBalance = parseFloat(user.personalBalance) || 10000;\n  \n  // Record the sell trade in trade history\n  await storage.recordTrade({\n    userId: userId,\n    tournamentId: null, // null for personal trades\n    symbol: symbol,\n    companyName: symbolPurchases[0].companyName,\n    tradeType: 'sell',\n    shares: sharesToSellNum,\n    price: parseFloat(currentPrice),\n    totalValue: saleValue\n  });\n  \n  // Update balance with sale proceeds\n  await storage.updateUser(userId, {\n    personalBalance: currentBalance + saleValue\n  });\n\n  // Sell shares using FIFO method\n  let remainingToSell = sharesToSellNum;\n  \n  for (const purchase of symbolPurchases) {\n    if (remainingToSell <= 0) break;\n    \n    if (purchase.shares <= remainingToSell) {\n      // Sell all shares from this purchase\n      remainingToSell -= purchase.shares;\n      await storage.deletePersonalPurchase(userId, purchase.id);\n    } else {\n      // Partially sell shares from this purchase\n      const newShares = purchase.shares - remainingToSell;\n      const purchasePrice = parseFloat(purchase.purchasePrice);\n      \n      // Delete the old record and create a new one with remaining shares\n      await storage.deletePersonalPurchase(userId, purchase.id);\n      await storage.purchasePersonalStock(userId, {\n        symbol: purchase.symbol,\n        companyName: purchase.companyName,\n        shares: newShares,\n        purchasePrice: purchasePrice,\n        totalCost: newShares * purchasePrice\n      });\n      \n      remainingToSell = 0;\n    }\n  }\n\n  // Check for portfolio growth achievements after selling\n  await checkPersonalPortfolioGrowthAchievements(userId);\n\n  // Check for streak achievements after selling\n  const tradingStreak = await calculateTradingStreak(userId);\n  await awardStreakAchievements(userId, tradingStreak);\n\n  res.json({\n    success: true,\n    data: { \n      saleValue,\n      newBalance: currentBalance + saleValue,\n      sharesSold: sharesToSellNum\n    },\n  });\n}));\n\n/**\n * GET /api/tournaments/leaderboard\n * Get tournaments leaderboard data\n */\nrouter.get('/tournaments/leaderboard', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  \n  // Get all tournaments with participants and their portfolio values\n  const tournaments = await storage.getAllTournaments();\n  const allParticipants = [];\n  let activeTournaments = 0;\n  \n  for (const tournament of tournaments) {\n    // Skip expired/completed tournaments\n    if (tournament.status === 'completed') {\n      continue;\n    }\n    \n    const participants = await storage.getTournamentParticipants(tournament.id);\n    \n    // Count as active if it has participants\n    if (participants.length > 0) {\n      activeTournaments++;\n    }\n    \n    for (const participant of participants) {\n      // Calculate portfolio value for each participant\n      const purchases = await storage.getTournamentStockPurchases(tournament.id, participant.userId);\n      let portfolioValue = parseFloat(participant.balance);\n      \n      // Add current value of all stock holdings\n      for (const purchase of purchases) {\n        try {\n          const currentQuote = await getStockQuote(purchase.symbol);\n          const currentValue = purchase.shares * currentQuote.price;\n          portfolioValue += currentValue;\n        } catch (error) {\n          // If stock quote fails, use purchase price as fallback\n          portfolioValue += purchase.shares * parseFloat(purchase.purchasePrice);\n        }\n      }\n      \n      // Calculate percentage change from tournament's actual starting balance\n      const startingBalance = parseFloat(tournament.startingBalance);\n      const percentageChange = ((portfolioValue - startingBalance) / startingBalance) * 100;\n      \n      allParticipants.push({\n        ...participant,\n        portfolioValue,\n        percentageChange,\n        tournamentName: tournament.name,\n        tournamentId: tournament.id,\n        startingBalance\n      });\n    }\n  }\n  \n  // Sort by percentage change (highest first)\n  allParticipants.sort((a, b) => b.percentageChange - a.percentageChange);\n  \n  // Award special achievement to #1 ranked user\n  if (allParticipants.length > 0) {\n    const topUser = allParticipants[0];\n    try {\n      await storage.awardAchievement({\n        userId: topUser.userId,\n        achievementType: 'tournament_overlord',\n        achievementTier: 'special',\n        achievementName: 'Tournament Overlord',\n        achievementDescription: 'Ranked #1 on tournament leaderboard'\n      });\n    } catch (error) {\n      console.error('Error awarding Tournament Overlord achievement:', error);\n    }\n  }\n  \n  // Find user's rank\n  const userRank = allParticipants.findIndex(p => p.userId === userId) + 1;\n  \n  res.json({\n    success: true,\n    data: {\n      rankings: allParticipants.slice(0, 50), // Top 50\n      totalTournaments: activeTournaments,\n      totalParticipants: allParticipants.length,\n      yourRank: userRank || null\n    }\n  });\n}));\n\n/**\n * GET /api/personal/leaderboard\n * Get personal portfolio leaderboard data\n */\nrouter.get('/personal/leaderboard', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  \n  // Get all users with personal portfolios\n  const users = await storage.getAllUsers();\n  const userPortfolios = [];\n  \n  for (const user of users) {\n    // Calculate portfolio value for all users\n    const purchases = await storage.getPersonalStockPurchases(user.id);\n    let portfolioValue = parseFloat(user.personalBalance) || 10000;\n    \n    // Add current value of all stock holdings\n    for (const purchase of purchases) {\n      try {\n        const currentQuote = await getStockQuote(purchase.symbol);\n        const currentValue = purchase.shares * currentQuote.price;\n        portfolioValue += currentValue;\n      } catch (error) {\n        // If stock quote fails, use purchase price as fallback\n        portfolioValue += purchase.shares * parseFloat(purchase.purchasePrice);\n      }\n    }\n    \n    // Calculate percentage change from total deposited amount\n    const totalDeposited = parseFloat(user.totalDeposited) || 10000;\n    const percentageChange = ((portfolioValue - totalDeposited) / totalDeposited) * 100;\n    \n    userPortfolios.push({\n      ...user,\n      portfolioValue,\n      percentageChange,\n      startingBalance: totalDeposited\n    });\n  }\n  \n  // Sort by percentage change (highest first)\n  userPortfolios.sort((a, b) => b.percentageChange - a.percentageChange);\n  \n  // Award special achievement to #1 ranked user\n  if (userPortfolios.length > 0) {\n    const topUser = userPortfolios[0];\n    try {\n      await storage.awardAchievement({\n        userId: topUser.id,\n        achievementType: 'portfolio_emperor',\n        achievementTier: 'special',\n        achievementName: 'Portfolio Emperor',\n        achievementDescription: 'Ranked #1 on personal portfolio leaderboard'\n      });\n    } catch (error) {\n      console.error('Error awarding Portfolio Emperor achievement:', error);\n    }\n  }\n  \n  // Find user's rank\n  const userRank = userPortfolios.findIndex(p => p.id === userId) + 1;\n  \n  res.json({\n    success: true,\n    data: {\n      rankings: userPortfolios.slice(0, 50), // Top 50\n      totalTraders: userPortfolios.length,\n      premiumUsers: userPortfolios.length,\n      yourRank: userRank || null\n    }\n  });\n}));\n\n/**\n * GET /api/streak/leaderboard\n * Get trading streak leaderboard data\n */\nrouter.get('/streak/leaderboard', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  \n  // Get all users with personal portfolios\n  const users = await storage.getAllUsers();\n  const userStreaks = [];\n  \n  for (const user of users) {\n    // Calculate trading streak for all users\n    const tradingStreak = await calculateTradingStreak(user.id);\n    \n    userStreaks.push({\n      ...user,\n      tradingStreak\n    });\n  }\n  \n  // Sort by trading streak (highest first)\n  userStreaks.sort((a, b) => b.tradingStreak - a.tradingStreak);\n  \n  // Award special achievement to #1 ranked user\n  if (userStreaks.length > 0) {\n    const topUser = userStreaks[0];\n    try {\n      await storage.awardAchievement({\n        userId: topUser.id,\n        achievementType: 'streak_master',\n        achievementTier: 'special',\n        achievementName: 'Streak Master',\n        achievementDescription: 'Ranked #1 on trading streak leaderboard'\n      });\n    } catch (error) {\n      console.error('Error awarding Streak Master achievement:', error);\n    }\n  }\n  \n  // Find user's rank\n  const userRank = userStreaks.findIndex(p => p.id === userId) + 1;\n  \n  res.json({\n    success: true,\n    data: {\n      rankings: userStreaks.slice(0, 50), // Top 50\n      totalTraders: userStreaks.length,\n      premiumUsers: userStreaks.length,\n      yourRank: userRank || null\n    }\n  });\n}));\n\n/**\n * GET /api/admin/users\n * Get all users for admin management\n */\nrouter.get('/admin/users', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  \n  // Check if user is admin\n  const user = await storage.getUser(userId);\n  if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n    return res.status(403).json({ \n      success: false, \n      error: 'Admin access required'\n    });\n  }\n\n  const users = await storage.getAllUsers();\n  res.json(users);\n}));\n\n/**\n * PATCH /api/admin/users/:userId/username\n * Update user username (admin only)\n */\nrouter.patch('/admin/users/:userId/username', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const targetUserId = parseInt(req.params.userId);\n  const { username } = req.body;\n  \n  // Check if user is admin\n  const user = await storage.getUser(userId);\n  if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n    return res.status(403).json({ error: 'Admin access required' });\n  }\n  \n  if (!username || username.trim().length < 3) {\n    return res.status(400).json({ error: 'Username must be at least 3 characters' });\n  }\n  \n  await storage.updateUserUsername(targetUserId, username.trim());\n  res.json({ success: true, message: 'Username updated successfully' });\n}));\n\n/**\n * PATCH /api/admin/users/:userId/balance\n * Update user balance (admin only)\n */\nrouter.patch('/admin/users/:userId/balance', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const targetUserId = parseInt(req.params.userId);\n  const { amount, operation } = req.body;\n  \n  // Check if user is admin\n  const user = await storage.getUser(userId);\n  if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n    return res.status(403).json({ error: 'Admin access required' });\n  }\n  \n  if (!amount || amount <= 0) {\n    return res.status(400).json({ error: 'Amount must be greater than 0' });\n  }\n  \n  if (!['add', 'remove'].includes(operation)) {\n    return res.status(400).json({ error: 'Operation must be add or remove' });\n  }\n  \n  await storage.adminUpdateUserBalance(targetUserId, amount, operation);\n  res.json({ success: true, message: 'Balance updated successfully' });\n}));\n\n/**\n * PATCH /api/admin/users/:userId/note\n * Update user admin note (admin only)\n */\nrouter.patch('/admin/users/:userId/note', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const targetUserId = parseInt(req.params.userId);\n  const { note } = req.body;\n  \n  // Check if user is admin\n  const user = await storage.getUser(userId);\n  if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n    return res.status(403).json({ error: 'Admin access required' });\n  }\n  \n  await storage.updateUserAdminNote(targetUserId, note || '');\n  res.json({ success: true, message: 'Admin note updated successfully' });\n}));\n\n/**\n * PATCH /api/admin/users/:userId/ban\n * Ban user (admin only)\n */\nrouter.patch('/admin/users/:userId/ban', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const targetUserId = parseInt(req.params.userId);\n  \n  // Check if user is admin\n  const user = await storage.getUser(userId);\n  if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n    return res.status(403).json({ error: 'Admin access required' });\n  }\n  \n  await storage.banUser(targetUserId);\n  res.json({ success: true, message: 'User banned successfully' });\n}));\n\n/**\n * GET /api/admin/tournaments\n * Get all tournaments for admin management\n */\nrouter.get('/admin/tournaments', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n\n  // Check if user is admin (using subscription tier)\n  const user = await storage.getUser(userId);\n  if (!user || (user.subscriptionTier !== 'administrator' && user.subscriptionTier !== 'admin')) {\n    throw new ValidationError('Access denied. Admin privileges required.');\n  }\n\n  // Get all tournaments\n  const allTournaments = await storage.getAllTournaments();\n  \n  // Filter out completed tournaments\n  const activeTournaments = allTournaments.filter(tournament => tournament.status !== 'completed');\n  \n  // Get participant counts for each tournament and calculate end dates\n  const tournamentsWithCounts = await Promise.all(\n    activeTournaments.map(async (tournament) => {\n      const participants = await storage.getTournamentParticipants(tournament.id);\n      \n      // Calculate end date based on creation date and timeframe\n      const createdAt = new Date(tournament.createdAt);\n      \n      // Parse timeframe properly for different units (minutes, days, weeks, months)\n      const parseTimeframe = (timeframe: string): number => {\n        const match = timeframe.match(/(\\d+)\\s*(minute|minutes|day|days|week|weeks|month|months)/i);\n        if (!match) return 28 * 24 * 60 * 60 * 1000; // Default to 4 weeks\n        \n        const value = parseInt(match[1]);\n        const unit = match[2].toLowerCase();\n        \n        switch (unit) {\n          case 'minute':\n          case 'minutes':\n            return value * 60 * 1000;\n          case 'day':\n          case 'days':\n            return value * 24 * 60 * 60 * 1000;\n          case 'week':\n          case 'weeks':\n            return value * 7 * 24 * 60 * 60 * 1000;\n          case 'month':\n          case 'months':\n            return value * 30 * 24 * 60 * 60 * 1000;\n          default:\n            return 28 * 24 * 60 * 60 * 1000;\n        }\n      };\n      \n      const timeframeMs = parseTimeframe(tournament.timeframe);\n      const endDate = new Date(createdAt.getTime() + timeframeMs);\n      \n      return {\n        ...tournament,\n        memberCount: participants.length,\n        endsAt: endDate.toISOString(), // Add calculated end date\n      };\n    })\n  );\n\n  res.json({\n    success: true,\n    data: tournamentsWithCounts\n  });\n}));\n\n/**\n * DELETE /api/admin/tournaments/:id\n * Delete a tournament completely (admin only)\n */\nrouter.delete('/admin/tournaments/:id', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const tournamentId = parseInt(req.params.id);\n\n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  // Check if user is admin\n  const user = await storage.getUser(userId);\n  if (!user || (user.userId !== 0 && user.userId !== 1 && user.userId !== 2)) {\n    throw new ValidationError('Access denied. Admin privileges required.');\n  }\n\n  // Get the tournament\n  const tournaments = await storage.getAllTournaments();\n  const tournament = tournaments.find(t => t.id === tournamentId);\n  \n  if (!tournament) {\n    throw new NotFoundError('Tournament not found');\n  }\n\n  // Delete related data in the correct order (foreign key constraints)\n  // Update trade_history to null out tournament_id instead of deleting (preserves user trade count)\n  await db.execute(sql`UPDATE trade_history SET tournament_id = NULL WHERE tournament_id = ${tournamentId}`);\n  await db.execute(sql`DELETE FROM tournament_stock_purchases WHERE tournament_id = ${tournamentId}`);\n  await db.execute(sql`DELETE FROM tournament_participants WHERE tournament_id = ${tournamentId}`);\n  await db.execute(sql`DELETE FROM tournaments WHERE id = ${tournamentId}`);\n\n  // Log the admin action\n  await storage.createAdminLog({\n    adminUserId: userId,\n    targetUserId: tournament.creatorId,\n    action: 'tournament_deleted',\n    oldValue: 'active',\n    newValue: 'deleted',\n    notes: `Admin deleted tournament \"${tournament.name}\" (${tournament.code}) completely`\n  });\n\n  res.json({\n    success: true,\n    message: `Tournament \"${tournament.name}\" has been deleted successfully`\n  });\n}));\n\n/**\n * GET /api/users/public\n * Get all users with public profile information\n */\nrouter.get('/users/public', asyncHandler(async (req, res) => {\n  \n  // Get all users with only public information\n  const users = await storage.getAllUsers();\n  \n  const publicUsers = await Promise.all(users.map(async (user) => {\n    // Get achievement count (this will automatically ensure Welcome achievement exists)\n    const achievements = await storage.getUserAchievements(user.id);\n    const achievementCount = achievements.length;\n    \n    return {\n      id: user.id,\n      username: user.username,\n      displayName: user.displayName,\n      subscriptionTier: user.subscriptionTier,\n      createdAt: user.createdAt,\n      totalTrades: user.totalTrades || 0,\n      achievementCount: achievementCount,\n      // Don't include sensitive information like email, password, balances, etc.\n    };\n  }));\n  \n  res.json({\n    success: true,\n    data: publicUsers\n  });\n}));\n\n/**\n * GET /api/users/public/:userId\n * Get specific user's public profile information\n */\nrouter.get('/users/public/:userId', asyncHandler(async (req, res) => {\n  const targetUserId = parseInt(req.params.userId);\n  \n  if (isNaN(targetUserId)) {\n    throw new ValidationError('Invalid user ID');\n  }\n  \n  // Get the target user\n  const targetUser = await storage.getUser(targetUserId);\n  \n  if (!targetUser) {\n    throw new NotFoundError('User not found');\n  }\n  \n  // Get total trade count from trade history\n  const totalTrades = await storage.getUserTradeCount(targetUserId);\n\n  // Return only public information\n  const publicUser = {\n    id: targetUser.id,\n    username: targetUser.username,\n    displayName: targetUser.displayName,\n    subscriptionTier: targetUser.subscriptionTier,\n    createdAt: targetUser.createdAt,\n    totalTrades: totalTrades,\n    // Don't include sensitive information like email, password, balances, etc.\n  };\n  \n  res.json({\n    success: true,\n    data: publicUser\n  });\n}));\n\n/**\n * GET /api/tournaments/archived\n * Get archived tournaments for the current user\n */\nrouter.get('/tournaments/archived', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const archivedTournaments = await storage.getArchivedTournaments(userId);\n  \n  res.json({\n    success: true,\n    data: archivedTournaments\n  });\n}));\n\n/**\n * GET /api/achievements/:userId\n * Get user achievements\n */\nrouter.get('/achievements/:userId', asyncHandler(async (req, res) => {\n  const userId = parseInt(req.params.userId);\n  \n  if (isNaN(userId)) {\n    throw new ValidationError('Invalid user ID');\n  }\n  \n  const achievements = await storage.getUserAchievements(userId);\n  \n  res.json({\n    success: true,\n    data: achievements\n  });\n}));\n\n/**\n * POST /api/tournaments/check-expiration\n * Check and process expired tournaments (admin only)\n */\nrouter.post('/tournaments/check-expiration', requireAuth, asyncHandler(async (req, res) => {\n  // Check if user is admin\n  if (!req.user.email.includes('admin')) {\n    throw new UnauthorizedError('Admin access required');\n  }\n  \n  const { tournamentExpirationService } = await import('../services/tournamentExpiration');\n  await tournamentExpirationService.processExpiredTournaments();\n  \n  res.json({\n    success: true,\n    message: 'Expired tournaments processed successfully'\n  });\n}));\n\n/**\n * PUT /api/user/display-name\n * Update user's display name\n */\nrouter.put('/user/display-name', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const { displayName } = req.body;\n  \n  // Validate display name\n  if (displayName && (typeof displayName !== 'string' || displayName.trim().length === 0 || displayName.trim().length > 255)) {\n    throw new ValidationError('Display name must be a non-empty string with maximum 255 characters');\n  }\n  \n  // Update user's display name\n  const updatedUser = await storage.updateUser(userId, { \n    displayName: displayName ? displayName.trim() : null \n  });\n  \n  res.json({\n    success: true,\n    data: {\n      id: updatedUser.id,\n      firstName: updatedUser.firstName,\n      lastName: updatedUser.lastName,\n      displayName: updatedUser.displayName,\n      email: updatedUser.email,\n      subscriptionTier: updatedUser.subscriptionTier,\n      createdAt: updatedUser.createdAt\n    }\n  });\n}));\n\n/**\n * POST /api/check-portfolio-growth\n * Manual trigger for portfolio growth achievement check\n */\nrouter.post('/check-portfolio-growth', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  \n  // Manually trigger portfolio growth check\n  await checkPersonalPortfolioGrowthAchievements(userId);\n\n  res.json({\n    success: true,\n    message: 'Portfolio growth check completed',\n  });\n}));\n\n// Portfolio history endpoints\nrouter.get('/portfolio-history/:userId', asyncHandler(async (req, res) => {\n  const userId = parseInt(req.params.userId);\n  const portfolioType = req.query.type as 'personal' | 'tournament' || 'personal';\n  const tournamentId = req.query.tournamentId ? parseInt(req.query.tournamentId as string) : undefined;\n\n  if (isNaN(userId)) {\n    throw new ValidationError('Invalid user ID');\n  }\n\n  const history = await storage.getUserPortfolioHistory(userId, portfolioType, tournamentId);\n  \n  res.json({\n    success: true,\n    data: history\n  });\n}));\n\nrouter.post('/portfolio-history', requireAuth, asyncHandler(async (req, res) => {\n  const { userId, portfolioType, tournamentId, totalValue, cashBalance, stockValue } = req.body;\n\n  if (!userId || !portfolioType || !totalValue || !cashBalance || !stockValue) {\n    throw new ValidationError('Missing required fields');\n  }\n\n  const record = await storage.recordPortfolioValue({\n    userId,\n    portfolioType,\n    tournamentId: tournamentId || null,\n    totalValue: totalValue.toString(),\n    cashBalance: cashBalance.toString(),\n    stockValue: stockValue.toString()\n  });\n\n  res.json({\n    success: true,\n    data: record\n  });\n}));\n\n\n\n/**\n * PATCH /api/profile/picture\n * Update user profile picture\n */\nrouter.patch('/profile/picture', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const { profilePicture } = req.body;\n\n  if (!profilePicture) {\n    throw new ValidationError('Profile picture data is required');\n  }\n\n  // Validate base64 image\n  if (!profilePicture.startsWith('data:image/')) {\n    throw new ValidationError('Invalid image format');\n  }\n\n  await storage.updateProfilePicture(userId, profilePicture);\n\n  res.json({\n    success: true,\n    message: 'Profile picture updated successfully'\n  });\n}));\n\n/**\n * GET /api/chat/global\n * Get global chat messages\n */\nrouter.get('/chat/global', requireAuth, asyncHandler(async (req, res) => {\n  const messages = await storage.getChatMessages();\n  res.json({\n    success: true,\n    data: messages\n  });\n}));\n\n/**\n * POST /api/chat/global\n * Send message to global chat\n */\nrouter.post('/chat/global', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const { message } = req.body;\n\n  if (!message || !message.trim()) {\n    throw new ValidationError('Message is required');\n  }\n\n  const user = await storage.getUser(userId);\n  if (!user) {\n    throw new ValidationError('User not found');\n  }\n\n  const chatMessage = await storage.createChatMessage({\n    userId,\n    username: user.username,\n    profilePicture: user.profilePicture || null,\n    message: message.trim(),\n    tournamentId: null\n  });\n\n  res.json({\n    success: true,\n    data: chatMessage\n  });\n}));\n\n/**\n * GET /api/chat/global\n * Get global chat messages\n */\nrouter.get('/chat/global', requireAuth, asyncHandler(async (req, res) => {\n  const messages = await storage.getChatMessages(null); // null for global chat\n  res.json({\n    success: true,\n    data: messages\n  });\n}));\n\n/**\n * POST /api/chat/global\n * Send message to global chat\n */\nrouter.post('/chat/global', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const { message } = req.body;\n\n  if (!message || !message.trim()) {\n    throw new ValidationError('Message is required');\n  }\n\n  const user = await storage.getUser(userId);\n  if (!user) {\n    throw new ValidationError('User not found');\n  }\n\n  const chatMessage = await storage.createChatMessage({\n    userId,\n    username: user.username,\n    profilePicture: user.profilePicture || null,\n    message: message.trim(),\n    tournamentId: null // null for global chat\n  });\n\n  res.json({\n    success: true,\n    data: chatMessage\n  });\n}));\n\n/**\n * GET /api/chat/tournament/:tournamentId\n * Get tournament-specific chat messages\n */\nrouter.get('/chat/tournament/:tournamentId', requireAuth, asyncHandler(async (req, res) => {\n  const tournamentId = parseInt(req.params.tournamentId);\n  \n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  const messages = await storage.getChatMessages(tournamentId);\n  res.json({\n    success: true,\n    data: messages\n  });\n}));\n\n/**\n * POST /api/chat/tournament/:tournamentId\n * Send message to tournament chat\n */\nrouter.post('/chat/tournament/:tournamentId', requireAuth, asyncHandler(async (req, res) => {\n  const userId = req.user.id;\n  const tournamentId = parseInt(req.params.tournamentId);\n  const { message } = req.body;\n\n  if (isNaN(tournamentId)) {\n    throw new ValidationError('Invalid tournament ID');\n  }\n\n  if (!message || !message.trim()) {\n    throw new ValidationError('Message is required');\n  }\n\n  const user = await storage.getUser(userId);\n  if (!user) {\n    throw new ValidationError('User not found');\n  }\n\n  const chatMessage = await storage.createChatMessage({\n    userId,\n    username: user.username,\n    profilePicture: user.profilePicture || null,\n    message: message.trim(),\n    tournamentId\n  });\n\n  res.json({\n    success: true,\n    data: chatMessage\n  });\n}));\n\n/**\n * GET /api/exchange-rates/:baseCurrency\n * Get exchange rates for all supported currencies\n */\nrouter.get('/exchange-rates/:baseCurrency', asyncHandler(async (req, res) => {\n  const { baseCurrency } = req.params;\n  \n  if (!baseCurrency) {\n    throw new ValidationError('Base currency is required');\n  }\n  \n  const rates = await getAllExchangeRates(baseCurrency.toUpperCase());\n  \n  res.json({\n    success: true,\n    data: {\n      baseCurrency: baseCurrency.toUpperCase(),\n      rates,\n      timestamp: new Date().toISOString()\n    }\n  });\n}));\n\n/**\n * GET /api/exchange-rate/:from/:to\n * Get specific exchange rate between two currencies\n */\nrouter.get('/exchange-rate/:from/:to', asyncHandler(async (req, res) => {\n  const { from, to } = req.params;\n  \n  if (!from || !to) {\n    throw new ValidationError('Both from and to currencies are required');\n  }\n  \n  const rate = await getExchangeRate(from.toUpperCase(), to.toUpperCase());\n  \n  res.json({\n    success: true,\n    data: {\n      from: from.toUpperCase(),\n      to: to.toUpperCase(),\n      rate,\n      timestamp: new Date().toISOString()\n    }\n  });\n}));\n\n/**\n * POST /api/convert-currency\n * Convert amount from one currency to another\n */\nrouter.post('/convert-currency', asyncHandler(async (req, res) => {\n  const { amount, from, to } = req.body;\n  \n  if (!amount || !from || !to) {\n    throw new ValidationError('Amount, from currency, and to currency are required');\n  }\n  \n  const amountNum = parseFloat(amount);\n  if (isNaN(amountNum)) {\n    throw new ValidationError('Invalid amount');\n  }\n  \n  const convertedAmount = await convertCurrency(amountNum, from.toUpperCase(), to.toUpperCase());\n  const rate = await getExchangeRate(from.toUpperCase(), to.toUpperCase());\n  \n  res.json({\n    success: true,\n    data: {\n      originalAmount: amountNum,\n      convertedAmount,\n      from: from.toUpperCase(),\n      to: to.toUpperCase(),\n      rate,\n      timestamp: new Date().toISOString()\n    }\n  });\n}));\n\nexport default router;","size_bytes":77589},"server/services/exchangeRates.ts":{"content":"import yahooFinance from 'yahoo-finance2';\nimport memoize from 'memoizee';\n\n// Cache exchange rates for 15 minutes to avoid excessive API calls\nconst getCachedExchangeRate = memoize(\n  async (fromCurrency: string, toCurrency: string): Promise<number> => {\n    if (fromCurrency === toCurrency) return 1;\n    \n    try {\n      // Yahoo Finance format for exchange rates: USDEUR=X, USDBRL=X, etc.\n      const symbol = `${fromCurrency}${toCurrency}=X`;\n      \n      const quote = await yahooFinance.quote(symbol);\n      const rate = quote.regularMarketPrice;\n      \n      if (!rate || typeof rate !== 'number') {\n        throw new Error(`Invalid exchange rate for ${symbol}`);\n      }\n      \n      return rate;\n    } catch (error) {\n      console.error(`Error fetching exchange rate ${fromCurrency}/${toCurrency}:`, error);\n      // Fallback to 1 if we can't get the rate\n      return 1;\n    }\n  },\n  { maxAge: 15 * 60 * 1000 } // 15 minutes cache\n);\n\nexport async function getExchangeRate(fromCurrency: string, toCurrency: string): Promise<number> {\n  return getCachedExchangeRate(fromCurrency, toCurrency);\n}\n\nexport async function convertCurrency(amount: number, fromCurrency: string, toCurrency: string): Promise<number> {\n  const rate = await getExchangeRate(fromCurrency, toCurrency);\n  return amount * rate;\n}\n\n// Common currency pairs and their Yahoo Finance symbols\nexport const supportedCurrencies = [\n  'USD', 'BRL', 'ARS', 'MXN', 'CAD', 'COP', 'CLP', 'PEN', 'UYU', 'EUR'\n];\n\n// Get all exchange rates for a base currency\nexport async function getAllExchangeRates(baseCurrency: string): Promise<Record<string, number>> {\n  const rates: Record<string, number> = {};\n  \n  for (const currency of supportedCurrencies) {\n    if (currency !== baseCurrency) {\n      rates[currency] = await getExchangeRate(baseCurrency, currency);\n    } else {\n      rates[currency] = 1;\n    }\n  }\n  \n  return rates;\n}","size_bytes":1900},"server/services/systemMonitor.ts":{"content":"import { db, pool } from '../db';\nimport yahooFinance from 'yahoo-finance2';\nimport fetch from 'node-fetch';\n\n// Track server start time for uptime calculation\nconst serverStartTime = Date.now();\n\n// Track active connections and requests\nlet activeConnections = 0;\nlet totalRequests = 0;\nlet errorCount = 0;\nlet responseTimes: number[] = [];\n\n// Track API health with individual timestamps\ninterface APIHealth {\n  yahooFinance: { status: boolean; lastChecked: number };\n  finnhub: { status: boolean; lastChecked: number };\n  twelveData: { status: boolean; lastChecked: number };\n  polygon: { status: boolean; lastChecked: number };\n}\n\nconst apiHealth: APIHealth = {\n  yahooFinance: { status: false, lastChecked: 0 },\n  finnhub: { status: false, lastChecked: 0 },\n  twelveData: { status: false, lastChecked: 0 },\n  polygon: { status: false, lastChecked: 0 }\n};\n\n// Middleware to track requests\nexport function trackRequest(req: any, res: any, next: any) {\n  const startTime = Date.now();\n  totalRequests++;\n  activeConnections++;\n  \n  res.on('finish', () => {\n    activeConnections--;\n    const responseTime = Date.now() - startTime;\n    responseTimes.push(responseTime);\n    \n    // Keep only last 100 response times\n    if (responseTimes.length > 100) {\n      responseTimes.shift();\n    }\n    \n    // Track errors\n    if (res.statusCode >= 400) {\n      errorCount++;\n    }\n  });\n  \n  next();\n}\n\n// Check database connectivity\nexport async function checkDatabaseHealth(): Promise<{\n  connected: boolean;\n  tableCount: number;\n  connectionCount: number;\n}> {\n  try {\n    // Test database connection\n    const testQuery = await db.execute('SELECT 1');\n    \n    // Get table count\n    const tableCountResult = await db.execute(`\n      SELECT COUNT(*) as count \n      FROM information_schema.tables \n      WHERE table_schema = 'public'\n    `);\n    \n    // Get active connections\n    const connectionResult = await db.execute(`\n      SELECT COUNT(*) as count \n      FROM pg_stat_activity \n      WHERE state = 'active'\n    `);\n    \n    return {\n      connected: true,\n      tableCount: Number(tableCountResult[0]?.count || 0),\n      connectionCount: Number(connectionResult[0]?.count || 0)\n    };\n  } catch (error) {\n    console.error('Database health check failed:', error);\n    return {\n      connected: false,\n      tableCount: 0,\n      connectionCount: 0\n    };\n  }\n}\n\n// Check Yahoo Finance API health (every minute)\nexport async function checkYahooFinanceHealth(): Promise<boolean> {\n  const now = Date.now();\n  const oneMinute = 60 * 1000;\n  \n  // Check if we need to update (every minute)\n  if (now - apiHealth.yahooFinance.lastChecked < oneMinute) {\n    return apiHealth.yahooFinance.status;\n  }\n  \n  try {\n    // Test with a simple quote request\n    const quote = await yahooFinance.quote('AAPL');\n    const isHealthy = quote && quote.regularMarketPrice !== undefined;\n    \n    apiHealth.yahooFinance.status = isHealthy;\n    apiHealth.yahooFinance.lastChecked = now;\n    \n    return isHealthy;\n  } catch (error) {\n    console.error('Yahoo Finance health check failed:', error);\n    apiHealth.yahooFinance.status = false;\n    apiHealth.yahooFinance.lastChecked = now;\n    return false;\n  }\n}\n\n// Check Finnhub API health (every hour)\nexport async function checkFinnhubHealth(): Promise<boolean> {\n  const now = Date.now();\n  const oneHour = 60 * 60 * 1000;\n  \n  // Check if we need to update (every hour)\n  if (now - apiHealth.finnhub.lastChecked < oneHour) {\n    return apiHealth.finnhub.status;\n  }\n  \n  try {\n    if (!process.env.FINNHUB_API_KEY) {\n      apiHealth.finnhub.status = false;\n      apiHealth.finnhub.lastChecked = now;\n      return false;\n    }\n    \n    const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=AAPL&token=${process.env.FINNHUB_API_KEY}`);\n    const data = await response.json();\n    \n    const isHealthy = response.ok && data.c !== undefined; // c = current price\n    apiHealth.finnhub.status = isHealthy;\n    apiHealth.finnhub.lastChecked = now;\n    \n    return isHealthy;\n  } catch (error) {\n    console.error('Finnhub health check failed:', error);\n    apiHealth.finnhub.status = false;\n    apiHealth.finnhub.lastChecked = now;\n    return false;\n  }\n}\n\n// Check Twelve Data API health (every hour)\nexport async function checkTwelveDataHealth(): Promise<boolean> {\n  const now = Date.now();\n  const oneHour = 60 * 60 * 1000;\n  \n  // Check if we need to update (every hour)\n  if (now - apiHealth.twelveData.lastChecked < oneHour) {\n    return apiHealth.twelveData.status;\n  }\n  \n  try {\n    if (!process.env.TWELVE_DATA_API_KEY) {\n      apiHealth.twelveData.status = false;\n      apiHealth.twelveData.lastChecked = now;\n      return false;\n    }\n    \n    const response = await fetch(`https://api.twelvedata.com/price?symbol=AAPL&apikey=${process.env.TWELVE_DATA_API_KEY}`);\n    const data = await response.json();\n    \n    const isHealthy = response.ok && data.price !== undefined;\n    apiHealth.twelveData.status = isHealthy;\n    apiHealth.twelveData.lastChecked = now;\n    \n    return isHealthy;\n  } catch (error) {\n    console.error('Twelve Data health check failed:', error);\n    apiHealth.twelveData.status = false;\n    apiHealth.twelveData.lastChecked = now;\n    return false;\n  }\n}\n\n// Check Polygon API health (every hour)\nexport async function checkPolygonHealth(): Promise<boolean> {\n  const now = Date.now();\n  const oneHour = 60 * 60 * 1000;\n  \n  // Check if we need to update (every hour)\n  if (now - apiHealth.polygon.lastChecked < oneHour) {\n    return apiHealth.polygon.status;\n  }\n  \n  try {\n    if (!process.env.POLYGON_API_KEY) {\n      apiHealth.polygon.status = false;\n      apiHealth.polygon.lastChecked = now;\n      return false;\n    }\n    \n    // Use the previous day's aggregates endpoint which works with basic access\n    const response = await fetch(`https://api.polygon.io/v2/aggs/ticker/AAPL/prev?adjusted=true&apikey=${process.env.POLYGON_API_KEY}`);\n    const data = await response.json();\n    \n    const isHealthy = response.ok && (data.status === 'OK' || data.results?.length > 0);\n    apiHealth.polygon.status = isHealthy;\n    apiHealth.polygon.lastChecked = now;\n    \n    return isHealthy;\n  } catch (error) {\n    console.error('Polygon health check failed:', error);\n    apiHealth.polygon.status = false;\n    apiHealth.polygon.lastChecked = now;\n    return false;\n  }\n}\n\n// Get system uptime\nexport function getSystemUptime(): {\n  uptimeMs: number;\n  uptimeFormatted: string;\n  uptimePercentage: number;\n} {\n  const uptimeMs = Date.now() - serverStartTime;\n  const uptimeSeconds = Math.floor(uptimeMs / 1000);\n  const uptimeMinutes = Math.floor(uptimeSeconds / 60);\n  const uptimeHours = Math.floor(uptimeMinutes / 60);\n  const uptimeDays = Math.floor(uptimeHours / 24);\n  \n  let uptimeFormatted = '';\n  if (uptimeDays > 0) {\n    uptimeFormatted = `${uptimeDays}d ${uptimeHours % 24}h ${uptimeMinutes % 60}m`;\n  } else if (uptimeHours > 0) {\n    uptimeFormatted = `${uptimeHours}h ${uptimeMinutes % 60}m`;\n  } else {\n    uptimeFormatted = `${uptimeMinutes}m`;\n  }\n  \n  // Calculate uptime percentage (assuming 99.9% target)\n  const uptimePercentage = Math.min(99.9, (uptimeMs / (24 * 60 * 60 * 1000)) * 99.9);\n  \n  return {\n    uptimeMs,\n    uptimeFormatted,\n    uptimePercentage: Number(uptimePercentage.toFixed(1))\n  };\n}\n\n// Get error rate\nexport function getErrorRate(): number {\n  if (totalRequests === 0) return 0;\n  return Number(((errorCount / totalRequests) * 100).toFixed(2));\n}\n\n// Get average response time\nexport function getAverageResponseTime(): number {\n  if (responseTimes.length === 0) return 0;\n  const sum = responseTimes.reduce((acc, time) => acc + time, 0);\n  return Number((sum / responseTimes.length).toFixed(0));\n}\n\n// Get active user count (connections)\nexport function getActiveConnections(): number {\n  return activeConnections;\n}\n\n// Get total requests\nexport function getTotalRequests(): number {\n  return totalRequests;\n}\n\n// Get comprehensive system status\nexport async function getSystemStatus() {\n  const dbHealth = await checkDatabaseHealth();\n  \n  // Check all APIs in parallel\n  const [yahooHealth, finnhubHealth, twelveDataHealth, polygonHealth] = await Promise.all([\n    checkYahooFinanceHealth(),\n    checkFinnhubHealth(),\n    checkTwelveDataHealth(),\n    checkPolygonHealth()\n  ]);\n  \n  const uptime = getSystemUptime();\n  const errorRate = getErrorRate();\n  const avgResponseTime = getAverageResponseTime();\n  const activeUsers = getActiveConnections();\n  const totalReqs = getTotalRequests();\n  \n  return {\n    database: {\n      connected: dbHealth.connected,\n      tableCount: dbHealth.tableCount,\n      activeConnections: dbHealth.connectionCount,\n      type: 'PostgreSQL'\n    },\n    apis: {\n      yahooFinance: {\n        status: yahooHealth,\n        lastChecked: apiHealth.yahooFinance.lastChecked,\n        checkInterval: '1 minute'\n      },\n      finnhub: {\n        status: finnhubHealth,\n        keyExists: !!process.env.FINNHUB_API_KEY,\n        lastChecked: apiHealth.finnhub.lastChecked,\n        checkInterval: '1 hour'\n      },\n      twelveData: {\n        status: twelveDataHealth,\n        keyExists: !!process.env.TWELVE_DATA_API_KEY,\n        lastChecked: apiHealth.twelveData.lastChecked,\n        checkInterval: '1 hour'\n      },\n      polygon: {\n        status: polygonHealth,\n        keyExists: !!process.env.POLYGON_API_KEY,\n        lastChecked: apiHealth.polygon.lastChecked,\n        checkInterval: '1 hour'\n      },\n      cache: {\n        enabled: true,\n        status: 'active'\n      }\n    },\n    system: {\n      uptime: uptime.uptimeFormatted,\n      uptimePercentage: uptime.uptimePercentage,\n      errorRate,\n      avgResponseTime,\n      activeUsers,\n      totalRequests: totalReqs\n    },\n    timestamp: new Date().toISOString()\n  };\n}\n\n// Reset counters (for testing)\nexport function resetCounters() {\n  totalRequests = 0;\n  errorCount = 0;\n  responseTimes = [];\n}","size_bytes":9911},"server/services/tournamentExpiration.ts":{"content":"import { storage } from \"../storage\";\nimport { getStockQuote } from \"./yahooFinance\";\n\ninterface TournamentResult {\n  userId: number;\n  finalBalance: number;\n  totalValue: number;\n  rank: number;\n  firstName: string;\n  lastName: string;\n}\n\nexport class TournamentExpirationService {\n  /**\n   * Check for expired tournaments and process them\n   */\n  async processExpiredTournaments(): Promise<void> {\n    // First, start any waiting tournaments that should be active\n    await this.startWaitingTournaments();\n    \n    // Then process expired tournaments\n    const expiredTournaments = await storage.getExpiredTournaments();\n    \n    for (const tournament of expiredTournaments) {\n      console.log(`Processing expired tournament: ${tournament.name} (ID: ${tournament.id})`);\n      \n      // Calculate final standings\n      const results = await this.calculateFinalStandings(tournament.id);\n      \n      // Distribute prize money to the winner\n      await this.distributePrizeMoney(tournament, results);\n      \n      // Award achievements based on results\n      await this.awardTournamentAchievements(tournament.id, results);\n      \n      // Mark tournament as completed\n      await storage.updateTournamentStatus(tournament.id, 'completed', new Date());\n      \n      console.log(`Tournament ${tournament.name} completed successfully`);\n    }\n  }\n\n  /**\n   * Start waiting tournaments that should be active\n   */\n  private async startWaitingTournaments(): Promise<void> {\n    const waitingTournaments = await storage.getWaitingTournaments();\n    console.log(`Found ${waitingTournaments.length} waiting tournaments`);\n    \n    const now = new Date();\n    \n    for (const tournament of waitingTournaments) {\n      // Check if the tournament's scheduled start time has passed\n      if (tournament.scheduledStartTime && tournament.scheduledStartTime <= now) {\n        console.log(`Starting tournament: ${tournament.name} (ID: ${tournament.id}) - scheduled start time reached`);\n        await storage.updateTournamentStatus(tournament.id, 'active', new Date());\n      } else if (tournament.scheduledStartTime) {\n        const timeUntilStart = tournament.scheduledStartTime.getTime() - now.getTime();\n        const minutesUntilStart = Math.ceil(timeUntilStart / (1000 * 60));\n        console.log(`Tournament ${tournament.name} (ID: ${tournament.id}) starts in ${minutesUntilStart} minutes`);\n      }\n    }\n  }\n\n  /**\n   * Calculate final standings for a tournament\n   */\n  private async calculateFinalStandings(tournamentId: number): Promise<TournamentResult[]> {\n    const participants = await storage.getTournamentParticipants(tournamentId);\n    const results: TournamentResult[] = [];\n\n    for (const participant of participants) {\n      const purchases = await storage.getTournamentStockPurchases(tournamentId, participant.userId);\n      \n      let totalValue = participant.balance;\n      \n      // Calculate current value of all holdings\n      for (const purchase of purchases) {\n        try {\n          const currentQuote = await getStockQuote(purchase.symbol);\n          const currentValue = purchase.shares * Number(currentQuote.price);\n          totalValue += currentValue;\n        } catch (error) {\n          console.error(`Error fetching quote for ${purchase.symbol}:`, error);\n          // Use purchase price as fallback\n          totalValue += purchase.shares * Number(purchase.purchasePrice);\n        }\n      }\n\n      results.push({\n        userId: participant.userId,\n        finalBalance: participant.balance,\n        totalValue,\n        rank: 0, // Will be set after sorting\n        firstName: participant.firstName,\n        lastName: participant.lastName\n      });\n    }\n\n    // Sort by total value (descending) and assign ranks\n    results.sort((a, b) => b.totalValue - a.totalValue);\n    results.forEach((result, index) => {\n      result.rank = index + 1;\n    });\n\n    return results;\n  }\n\n  /**\n   * Distribute prize money to the tournament winner and creator\n   */\n  private async distributePrizeMoney(tournament: any, results: TournamentResult[]): Promise<void> {\n    // Only distribute if there are participants and a pot to distribute\n    if (results.length === 0 || !tournament.currentPot || Number(tournament.currentPot) <= 0) {\n      console.log(`No prize money to distribute for tournament ${tournament.name} (pot: ${tournament.currentPot})`);\n      return;\n    }\n\n    const winner = results.find(result => result.rank === 1);\n    if (!winner) {\n      console.log(`No winner found for tournament ${tournament.name}`);\n      return;\n    }\n\n    const totalPot = Number(tournament.currentPot);\n    const winnerAmount = Math.round(totalPot * 0.95 * 100) / 100; // 95% to winner, rounded to nearest cent\n    const creatorAmount = Math.round(totalPot * 0.05 * 100) / 100; // 5% to creator, rounded to nearest cent\n    \n    try {\n      // Add 95% of the tournament pot to the winner's siteCash\n      await storage.addUserBalance(winner.userId, winnerAmount);\n      \n      // Add 5% of the tournament pot to the creator's siteCash\n      await storage.addUserBalance(tournament.creatorId, creatorAmount);\n      \n      console.log(`Distributed $${winnerAmount} (95%) to winner user ${winner.userId} (${winner.firstName} ${winner.lastName}) and $${creatorAmount} (5%) to creator user ${tournament.creatorId} for tournament ${tournament.name}`);\n    } catch (error) {\n      console.error(`Failed to distribute prize money for tournament ${tournament.name}:`, error);\n    }\n  }\n\n  /**\n   * Award achievements based on tournament results\n   */\n  private async awardTournamentAchievements(tournamentId: number, results: TournamentResult[]): Promise<void> {\n    for (const result of results) {\n      const { userId, rank, totalValue } = result;\n      \n      // Award based on rank\n      if (rank === 1) {\n        // Award Tournament Champion as global achievement (can only be earned once)\n        await this.awardGlobalAchievement(userId, {\n          type: 'tournament_winner',\n          tier: 'legendary',\n          name: 'Tournament Champion',\n          description: 'Won 1st place in a tournament'\n        });\n      } else if (rank === 2) {\n        await this.awardGlobalAchievement(userId, {\n          type: 'tournament_second',\n          tier: 'epic',\n          name: 'Silver Medalist',\n          description: 'Finished 2nd in a tournament'\n        });\n      } else if (rank === 3) {\n        await this.awardGlobalAchievement(userId, {\n          type: 'tournament_third',\n          tier: 'rare',\n          name: 'Bronze Medalist',\n          description: 'Finished 3rd in a tournament'\n        });\n      } else if (rank <= 5) {\n        await this.awardGlobalAchievement(userId, {\n          type: 'tournament_top5',\n          tier: 'uncommon',\n          name: 'Top 5 Finisher',\n          description: 'Finished in the top 5 of a tournament'\n        });\n      }\n\n      // Award based on performance (global achievements)\n      if (totalValue >= 15000) {\n        await this.awardGlobalAchievement(userId, {\n          type: 'high_performer',\n          tier: 'epic',\n          name: 'High Performer',\n          description: 'Achieved over 50% profit in a tournament'\n        });\n      } else if (totalValue >= 12000) {\n        await this.awardGlobalAchievement(userId, {\n          type: 'profit_maker',\n          tier: 'rare',\n          name: 'Profit Maker',\n          description: 'Achieved over 20% profit in a tournament'\n        });\n      }\n\n      // Check for Tournament Legend achievement (global - 10 tournament wins)\n      if (rank === 1) {\n        // Increment the private win counter\n        await storage.incrementTournamentWins(userId);\n        \n        const winCount = await storage.getTournamentWins(userId);\n        if (winCount >= 10) {\n          await this.awardGlobalAchievement(userId, {\n            type: 'tournament_legend',\n            tier: 'mythic',\n            name: 'Tournament Legend',\n            description: 'Won 10 tournaments'\n          });\n        }\n      }\n\n      // Participation achievement is awarded when joining tournaments, not at expiration\n    }\n  }\n\n\n\n  /**\n   * Award a global achievement to a user (max 1 per person)\n   */\n  private async awardGlobalAchievement(\n    userId: number, \n    achievement: {\n      type: string;\n      tier: string;\n      name: string;\n      description: string;\n    }\n  ): Promise<void> {\n    await storage.awardAchievement({\n      userId,\n      achievementType: achievement.type,\n      achievementTier: achievement.tier,\n      achievementName: achievement.name,\n      achievementDescription: achievement.description\n    });\n    \n    console.log(`Awarded global ${achievement.name} to user ${userId}`);\n  }\n\n\n\n  /**\n   * Check if a tournament has expired\n   */\n  async isTournamentExpired(tournamentId: number): Promise<boolean> {\n    const tournament = await storage.getTournamentByCode(''); // We need to get by ID, not code\n    if (!tournament) return false;\n    \n    const createdAt = new Date(tournament.createdAt!);\n    const timeframeDays = this.parseTimeframe(tournament.timeframe);\n    const expirationDate = new Date(createdAt.getTime() + timeframeDays * 24 * 60 * 60 * 1000);\n    \n    return new Date() > expirationDate;\n  }\n\n  /**\n   * Parse timeframe string to days\n   */\n  private parseTimeframe(timeframe: string): number {\n    const match = timeframe.match(/(\\d+)\\s*(day|days|week|weeks|month|months)/i);\n    if (!match) return 28; // Default to 4 weeks\n    \n    const value = parseInt(match[1]);\n    const unit = match[2].toLowerCase();\n    \n    switch (unit) {\n      case 'day':\n      case 'days':\n        return value;\n      case 'week':\n      case 'weeks':\n        return value * 7;\n      case 'month':\n      case 'months':\n        return value * 30;\n      default:\n        return 28;\n    }\n  }\n}\n\nexport const tournamentExpirationService = new TournamentExpirationService();","size_bytes":9874},"server/services/tournamentScheduler.ts":{"content":"import { tournamentExpirationService } from './tournamentExpiration';\n\nexport class TournamentScheduler {\n  private intervalId: NodeJS.Timeout | null = null;\n\n  /**\n   * Start the tournament expiration checker\n   * Runs every 5 minutes to check for expired tournaments\n   */\n  start(): void {\n    if (this.intervalId) {\n      console.log('Tournament scheduler is already running');\n      return;\n    }\n\n    console.log('Starting tournament expiration scheduler...');\n    \n    // Run immediately on startup\n    this.checkExpiredTournaments();\n    \n    // Then run every 5 minutes\n    this.intervalId = setInterval(() => {\n      this.checkExpiredTournaments();\n    }, 5 * 60 * 1000); // 5 minutes\n  }\n\n  /**\n   * Stop the tournament expiration checker\n   */\n  stop(): void {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n      console.log('Tournament scheduler stopped');\n    }\n  }\n\n  /**\n   * Check for expired tournaments and process them\n   */\n  private async checkExpiredTournaments(): Promise<void> {\n    try {\n      console.log('Checking for expired tournaments...');\n      await tournamentExpirationService.processExpiredTournaments();\n      console.log('Tournament expiration check completed');\n    } catch (error) {\n      console.error('Error processing expired tournaments:', error);\n    }\n  }\n}\n\nexport const tournamentScheduler = new TournamentScheduler();","size_bytes":1415},"server/services/yahooFinance.ts":{"content":"import yahooFinance from 'yahoo-finance2';\nimport { StockQuote, HistoricalDataPoint, CompanyProfile, SearchResult } from '../types/finance.js';\n\n// Define timeframe options\nexport type TimeFrame = '1D' | '5D' | '1W' | '1M' | '3M' | '6M' | 'YTD' | '1Y' | '5Y';\n\n// Helper function to calculate date ranges\nexport function getDateRange(timeFrame: TimeFrame): { period1: string; period2: string; interval: string } {\n  const now = new Date();\n  const today = now.toISOString().split('T')[0];\n  \n  // Helper to get date N days ago\n  const getDaysAgo = (days: number): string => {\n    const date = new Date(now);\n    date.setDate(date.getDate() - days);\n    return date.toISOString().split('T')[0];\n  };\n  \n  // Helper to get start of current year (first trading day)\n  const getYearStart = (): string => {\n    return `${now.getFullYear()}-01-02`;\n  };\n  \n  // Helper to get date N years ago\n  const getYearsAgo = (years: number): string => {\n    const date = new Date(now);\n    date.setFullYear(date.getFullYear() - years);\n    return date.toISOString().split('T')[0];\n  };\n\n  switch (timeFrame) {\n    case '1D':\n      return {\n        period1: getDaysAgo(2), // Get 2 days ago to ensure we get at least 1 trading day\n        period2: today,\n        interval: '5m' // Use 5-minute intervals for better reliability\n      };\n    \n    case '5D':\n      return {\n        period1: getDaysAgo(7), // Get 7 days ago to ensure we have 5 trading days\n        period2: today,\n        interval: '30m' // Use 30-minute intervals for 5D timeframe\n      };\n    \n    case '1W':\n      return {\n        period1: getDaysAgo(8), // Get 8 days ago to ensure we have 1 week of trading data\n        period2: today,\n        interval: '1d' // Daily intervals\n      };\n    \n    case '1M':\n      return {\n        period1: getDaysAgo(30),\n        period2: today,\n        interval: '1d' // Daily intervals\n      };\n    \n    case '3M':\n      return {\n        period1: getDaysAgo(90),\n        period2: today,\n        interval: '1d' // Daily intervals\n      };\n    \n    case '6M':\n      return {\n        period1: getDaysAgo(180),\n        period2: today,\n        interval: '1d' // Daily intervals\n      };\n    \n    case 'YTD':\n      return {\n        period1: getYearStart(),\n        period2: today,\n        interval: '1d' // Daily intervals\n      };\n    \n    case '1Y':\n      return {\n        period1: getYearsAgo(1),\n        period2: today,\n        interval: '1d' // Daily intervals\n      };\n    \n    case '5Y':\n      return {\n        period1: getYearsAgo(5),\n        period2: today,\n        interval: '1wk' // Weekly intervals for longer timeframes\n      };\n    \n    default:\n      throw new Error(`Unsupported timeframe: ${timeFrame}`);\n  }\n}\n\n// Cache for storing API responses to avoid excessive calls\nconst cache = new Map<string, { data: any; timestamp: number; ttl: number }>();\n\nconst CACHE_TTL = {\n  QUOTE: 5 * 60 * 1000, // 5 minutes\n  HISTORICAL: 30 * 60 * 1000, // 30 minutes - for daily data\n  HISTORICAL_MINUTE: 2 * 60 * 1000, // 2 minutes - for minute data (1D)\n  HISTORICAL_30MIN: 5 * 60 * 1000, // 5 minutes - for 30-minute data (5D)\n  PROFILE: 60 * 60 * 1000, // 1 hour\n  SEARCH: 30 * 60 * 1000, // 30 minutes\n};\n\n/**\n * Get cached data or return null if expired\n */\nfunction getCachedData(key: string): any | null {\n  const cached = cache.get(key);\n  if (cached && Date.now() - cached.timestamp < cached.ttl) {\n    return cached.data;\n  }\n  if (cached) {\n    cache.delete(key);\n  }\n  return null;\n}\n\n/**\n * Set data in cache with TTL\n */\nfunction setCachedData(key: string, data: any, ttl: number): void {\n  cache.set(key, {\n    data,\n    timestamp: Date.now(),\n    ttl,\n  });\n}\n\n/**\n * Format large numbers with appropriate suffixes\n */\nfunction formatLargeNumber(num: number): string {\n  if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';\n  if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';\n  if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';\n  if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';\n  return num.toString();\n}\n\n/**\n * Comprehensive sector mapping for thousands of stocks\n */\nfunction getSectorFallback(symbol: string): string {\n  const sectorMap: Record<string, string> = {\n    // Technology\n    'AAPL': 'Technology', 'MSFT': 'Technology', 'NVDA': 'Technology', 'AMD': 'Technology',\n    'INTC': 'Technology', 'CRM': 'Technology', 'ADBE': 'Technology', 'ORCL': 'Technology',\n    'IBM': 'Technology', 'UBER': 'Technology', 'LYFT': 'Technology', 'ZOOM': 'Technology',\n    'PLTR': 'Technology', 'SNOW': 'Technology', 'SQ': 'Technology', 'SHOP': 'Technology',\n    'TWLO': 'Technology', 'OKTA': 'Technology', 'DOCU': 'Technology', 'ZM': 'Technology',\n    'CRWD': 'Technology', 'NET': 'Technology', 'DDOG': 'Technology', 'MDB': 'Technology',\n    'WDAY': 'Technology', 'NOW': 'Technology', 'TEAM': 'Technology', 'ATLASSIAN': 'Technology',\n    'SALESFORCE': 'Technology', 'SERVICENOW': 'Technology', 'WORKDAY': 'Technology',\n    \n    // Communication Services\n    'GOOGL': 'Communication Services', 'GOOG': 'Communication Services', 'META': 'Communication Services',\n    'NFLX': 'Communication Services', 'DIS': 'Communication Services', 'SPOT': 'Communication Services',\n    'TWTR': 'Communication Services', 'SNAP': 'Communication Services', 'PINS': 'Communication Services',\n    'ROKU': 'Communication Services', 'T': 'Communication Services', 'VZ': 'Communication Services',\n    'CMCSA': 'Communication Services', 'CHTR': 'Communication Services', 'TMUS': 'Communication Services',\n    'DISH': 'Communication Services', 'SIRI': 'Communication Services', 'WBD': 'Communication Services',\n    \n    // Consumer Discretionary\n    'AMZN': 'Consumer Discretionary', 'TSLA': 'Consumer Discretionary', 'HD': 'Consumer Discretionary',\n    'NKE': 'Consumer Discretionary', 'SBUX': 'Consumer Discretionary', 'LOW': 'Consumer Discretionary',\n    'TJX': 'Consumer Discretionary', 'BKNG': 'Consumer Discretionary', 'MCD': 'Consumer Discretionary',\n    'CMG': 'Consumer Discretionary', 'LULU': 'Consumer Discretionary', 'ABNB': 'Consumer Discretionary',\n    'GM': 'Consumer Discretionary', 'F': 'Consumer Discretionary', 'RIVN': 'Consumer Discretionary',\n    'LCID': 'Consumer Discretionary', 'YUM': 'Consumer Discretionary', 'QSR': 'Consumer Discretionary',\n    'DKNG': 'Consumer Discretionary', 'ETSY': 'Consumer Discretionary', 'EBAY': 'Consumer Discretionary',\n    \n    // Consumer Staples\n    'PEP': 'Consumer Staples', 'KO': 'Consumer Staples', 'WMT': 'Consumer Staples',\n    'PG': 'Consumer Staples', 'COST': 'Consumer Staples', 'KHC': 'Consumer Staples',\n    'CL': 'Consumer Staples', 'GIS': 'Consumer Staples', 'K': 'Consumer Staples',\n    'CPB': 'Consumer Staples', 'CAG': 'Consumer Staples', 'HSY': 'Consumer Staples',\n    'MDLZ': 'Consumer Staples', 'KMB': 'Consumer Staples', 'CLX': 'Consumer Staples',\n    'SJM': 'Consumer Staples', 'TAP': 'Consumer Staples', 'STZ': 'Consumer Staples',\n    \n    // Healthcare\n    'JNJ': 'Healthcare', 'UNH': 'Healthcare', 'PFE': 'Healthcare', 'ABT': 'Healthcare',\n    'TMO': 'Healthcare', 'DHR': 'Healthcare', 'BMY': 'Healthcare', 'LLY': 'Healthcare',\n    'AMGN': 'Healthcare', 'GILD': 'Healthcare', 'REGN': 'Healthcare', 'VRTX': 'Healthcare',\n    'BIIB': 'Healthcare', 'ILMN': 'Healthcare', 'ISRG': 'Healthcare', 'SYK': 'Healthcare',\n    'BSX': 'Healthcare', 'MDT': 'Healthcare', 'EW': 'Healthcare', 'DXCM': 'Healthcare',\n    'MRNA': 'Healthcare', 'BNTX': 'Healthcare', 'ZTS': 'Healthcare', 'IDEXX': 'Healthcare',\n    \n    // Financial Services\n    'JPM': 'Financial Services', 'BAC': 'Financial Services', 'WFC': 'Financial Services',\n    'C': 'Financial Services', 'GS': 'Financial Services', 'MS': 'Financial Services',\n    'V': 'Financial Services', 'MA': 'Financial Services', 'PYPL': 'Financial Services',\n    'AXP': 'Financial Services', 'BRK.A': 'Financial Services', 'BRK.B': 'Financial Services',\n    'USB': 'Financial Services', 'TFC': 'Financial Services', 'PNC': 'Financial Services',\n    'COF': 'Financial Services', 'SCHW': 'Financial Services', 'BLK': 'Financial Services',\n    'SPGI': 'Financial Services', 'ICE': 'Financial Services', 'CME': 'Financial Services',\n    \n    // Energy\n    'XOM': 'Energy', 'CVX': 'Energy', 'COP': 'Energy', 'EOG': 'Energy',\n    'SLB': 'Energy', 'PSX': 'Energy', 'VLO': 'Energy', 'MPC': 'Energy',\n    'OXY': 'Energy', 'KMI': 'Energy', 'WMB': 'Energy', 'ENB': 'Energy',\n    'TRP': 'Energy', 'EPD': 'Energy', 'ET': 'Energy', 'MPLX': 'Energy',\n    'DVN': 'Energy', 'FANG': 'Energy', 'PXD': 'Energy', 'CNQ': 'Energy',\n    \n    // Industrials\n    'UAL': 'Industrials', 'AAL': 'Industrials', 'DAL': 'Industrials', 'LUV': 'Industrials',\n    'BA': 'Industrials', 'HON': 'Industrials', 'UPS': 'Industrials', 'FDX': 'Industrials',\n    'LMT': 'Industrials', 'RTX': 'Industrials', 'NOC': 'Industrials', 'GD': 'Industrials',\n    'CAT': 'Industrials', 'DE': 'Industrials', 'MMM': 'Industrials', 'GE': 'Industrials',\n    'EMR': 'Industrials', 'ITW': 'Industrials', 'PH': 'Industrials', 'TDG': 'Industrials',\n    'CTAS': 'Industrials', 'VRSK': 'Industrials', 'PCAR': 'Industrials', 'NSC': 'Industrials',\n    \n    // Materials\n    'LIN': 'Materials', 'APD': 'Materials', 'SHW': 'Materials', 'FCX': 'Materials',\n    'NEM': 'Materials', 'CTVA': 'Materials', 'DD': 'Materials', 'DOW': 'Materials',\n    'PPG': 'Materials', 'ECL': 'Materials', 'FMC': 'Materials', 'ALB': 'Materials',\n    'CF': 'Materials', 'MOS': 'Materials', 'IFF': 'Materials', 'PKG': 'Materials',\n    'AMCR': 'Materials', 'IP': 'Materials', 'WRK': 'Materials', 'BALL': 'Materials',\n    \n    // Utilities\n    'NEE': 'Utilities', 'DUK': 'Utilities', 'SO': 'Utilities', 'D': 'Utilities',\n    'AEP': 'Utilities', 'EXC': 'Utilities', 'XEL': 'Utilities', 'SRE': 'Utilities',\n    'PEG': 'Utilities', 'ED': 'Utilities', 'AWK': 'Utilities', 'ATO': 'Utilities',\n    'WEC': 'Utilities', 'DTE': 'Utilities', 'PPL': 'Utilities', 'CMS': 'Utilities',\n    \n    // Real Estate\n    'PLD': 'Real Estate', 'AMT': 'Real Estate', 'CCI': 'Real Estate', 'EQIX': 'Real Estate',\n    'WELL': 'Real Estate', 'SPG': 'Real Estate', 'PSA': 'Real Estate', 'O': 'Real Estate',\n    'CBRE': 'Real Estate', 'DLR': 'Real Estate', 'BXP': 'Real Estate', 'ARE': 'Real Estate',\n    'VTR': 'Real Estate', 'ESS': 'Real Estate', 'MAA': 'Real Estate', 'UDR': 'Real Estate',\n    \n    // Cryptocurrency & Blockchain\n    'COIN': 'Financial Services', 'MSTR': 'Technology', 'RIOT': 'Technology', 'MARA': 'Technology',\n    'HUT': 'Technology', 'BTBT': 'Technology', 'CAN': 'Technology', 'BITF': 'Technology',\n    \n    // Popular ETFs (assign broad sectors)\n    'SPY': 'Diversified', 'QQQ': 'Technology', 'IWM': 'Diversified', 'VTI': 'Diversified',\n    'VOO': 'Diversified', 'VEA': 'Diversified', 'VWO': 'Diversified', 'BND': 'Fixed Income',\n    'AGG': 'Fixed Income', 'TLT': 'Fixed Income', 'GLD': 'Commodities', 'SLV': 'Commodities',\n    'USO': 'Energy', 'XLE': 'Energy', 'XLF': 'Financial Services', 'XLK': 'Technology',\n    'XLV': 'Healthcare', 'XLI': 'Industrials', 'XLY': 'Consumer Discretionary', 'XLP': 'Consumer Staples',\n    'XLU': 'Utilities', 'XLB': 'Materials', 'XLRE': 'Real Estate', 'XLC': 'Communication Services',\n  };\n  \n  return sectorMap[symbol] || 'Technology';\n}\n\n/**\n * Get all available sectors from Yahoo Finance\n */\nexport function getAllSectors(): string[] {\n  return [\n    'Technology',\n    'Communication Services', \n    'Consumer Discretionary',\n    'Consumer Staples',\n    'Healthcare',\n    'Financial Services',\n    'Energy',\n    'Industrials',\n    'Materials',\n    'Utilities',\n    'Real Estate',\n    'Consumer Defensive',\n    'Consumer Cyclical',\n    'Basic Materials',\n    'Diversified',\n    'Fixed Income',\n    'Commodities'\n  ];\n}\n\n/**\n * Fetch current stock quote data\n */\nexport async function getStockQuote(symbol: string): Promise<StockQuote> {\n  const cacheKey = `quote_${symbol}`;\n  const cached = getCachedData(cacheKey);\n  \n  if (cached) {\n    return cached;\n  }\n\n  try {\n    // Fetch both quote and quoteSummary to get sector information\n    const [result, summary] = await Promise.all([\n      yahooFinance.quote(symbol),\n      yahooFinance.quoteSummary(symbol, {\n        modules: ['assetProfile', 'summaryProfile']\n      }).catch(() => null) // Don't fail if summary is not available\n    ]);\n    \n    if (!result || !result.regularMarketPrice) {\n      throw new Error(`No data found for symbol: ${symbol}`);\n    }\n\n    // Get previous trading day's market close price for accurate 1-day change calculation\n    let previousClosePrice = result.regularMarketPreviousClose;\n    let currentPrice = result.regularMarketPrice;\n    \n    // Try to get more accurate historical data for previous close if needed\n    try {\n      // Get the last 3 trading days to ensure we have accurate previous close\n      const threeDaysAgo = new Date();\n      threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);\n      \n      const historicalData = await yahooFinance.chart(symbol, {\n        period1: threeDaysAgo,\n        period2: new Date(),\n        interval: '1d' // Daily intervals\n      });\n      \n      if (historicalData && historicalData.quotes && historicalData.quotes.length >= 2) {\n        // Get the second to last quote as the previous trading day's close\n        const previousDayQuote = historicalData.quotes[historicalData.quotes.length - 2];\n        if (previousDayQuote && previousDayQuote.close) {\n          previousClosePrice = previousDayQuote.close;\n        }\n      }\n    } catch (historicalError) {\n      // If historical data fails, use the regular market previous close\n      console.log(`Could not fetch historical data for ${symbol}, using regular market previous close`);\n    }\n\n    // Calculate 1-day change manually using previous trading day's close price\n    const change = currentPrice - previousClosePrice;\n    const percentChange = ((change / previousClosePrice) * 100);\n\n    const quote: StockQuote = {\n      symbol: result.symbol || symbol,\n      price: currentPrice,\n      change: change,\n      percentChange: percentChange,\n      previousClose: previousClosePrice,\n      volume: result.regularMarketVolume || 0,\n      marketCap: result.marketCap || 0,\n      currency: result.currency || 'USD',\n      sector: summary?.summaryProfile?.sector || summary?.assetProfile?.sector || getSectorFallback(symbol),\n      industry: summary?.summaryProfile?.industry || summary?.assetProfile?.industry || undefined,\n    };\n\n    setCachedData(cacheKey, quote, CACHE_TTL.QUOTE);\n    return quote;\n  } catch (error) {\n    console.error(`Error fetching quote for ${symbol}:`, error);\n    throw new Error(`Failed to fetch quote for ${symbol}: ${error instanceof Error ? error.message : 'Unknown error'}`);\n  }\n}\n\n/**\n * Search for stock symbols by company name\n */\nexport async function searchStocks(query: string): Promise<SearchResult[]> {\n  const cacheKey = `search_${query.toLowerCase()}`;\n  const cached = getCachedData(cacheKey);\n  \n  if (cached) {\n    return cached;\n  }\n\n  try {\n    const result = await yahooFinance.search(query);\n    \n    if (!result || !result.quotes) {\n      return [];\n    }\n\n    // Enhanced search results with sector information\n    const searchResults: SearchResult[] = await Promise.all(\n      result.quotes\n        .filter(item => item.symbol && item.shortname)\n        .slice(0, 10) // Limit to top 10 results\n        .map(async item => {\n          // Try to get sector information from quoteSummary\n          let sector = item.sector;\n          let industry = item.industry;\n          \n          if (!sector) {\n            try {\n              const summary = await yahooFinance.quoteSummary(item.symbol!, {\n                modules: ['assetProfile', 'summaryProfile']\n              });\n              sector = summary?.summaryProfile?.sector || summary?.assetProfile?.sector;\n              industry = summary?.summaryProfile?.industry || summary?.assetProfile?.industry;\n            } catch (error) {\n              // If we can't get sector info, use fallback\n              sector = getSectorFallback(item.symbol!);\n            }\n          }\n          \n          return {\n            symbol: item.symbol!,\n            name: item.shortname || item.longname || item.symbol!,\n            exchange: item.exchange || 'N/A',\n            type: item.typeDisp || 'Stock',\n            sector: sector || getSectorFallback(item.symbol!),\n            industry: industry || undefined,\n          };\n        })\n    );\n\n    setCachedData(cacheKey, searchResults, CACHE_TTL.SEARCH);\n    return searchResults;\n  } catch (error) {\n    console.error(`Error searching for ${query}:`, error);\n    throw new Error(`Failed to search for ${query}: ${error instanceof Error ? error.message : 'Unknown error'}`);\n  }\n}\n\n/**\n * Get historical price data for a stock with timeframe support\n */\nexport async function getHistoricalData(symbol: string, timeFrame: TimeFrame = '1M'): Promise<HistoricalDataPoint[]> {\n  const cacheKey = `historical_${symbol}_${timeFrame}`;\n  const cached = getCachedData(cacheKey);\n  \n  if (cached) {\n    return cached;\n  }\n\n  try {\n    // For 1D timeframe, get data from last trading day (excluding weekends)\n    if (timeFrame === '1D') {\n      try {\n        // Function to get the most recent trading day\n        const getLastTradingDay = (): Date => {\n          const now = new Date();\n          const dayOfWeek = now.getDay(); // Sunday = 0, Monday = 1, ..., Saturday = 6\n          \n          if (dayOfWeek === 0) { // Sunday\n            const friday = new Date(now);\n            friday.setDate(now.getDate() - 2); // Go back to Friday\n            return friday;\n          } else if (dayOfWeek === 6) { // Saturday\n            const friday = new Date(now);\n            friday.setDate(now.getDate() - 1); // Go back to Friday\n            return friday;\n          } else if (dayOfWeek === 1) { // Monday\n            // If it's early Monday (before market open), might want Friday's data\n            const currentHour = now.getHours();\n            if (currentHour < 9 || (currentHour === 9 && now.getMinutes() < 30)) {\n              const friday = new Date(now);\n              friday.setDate(now.getDate() - 3); // Go back to Friday\n              return friday;\n            }\n          }\n          \n          // For Tuesday-Friday or Monday after market open, use current day\n          return now;\n        };\n\n        const lastTradingDay = getLastTradingDay();\n        \n        // Get data from 7 days ago to ensure we have enough trading days\n        const sevenDaysAgo = new Date(lastTradingDay);\n        sevenDaysAgo.setDate(lastTradingDay.getDate() - 7);\n        \n        // Use the next day as period2 to ensure we get the full trading day\n        const nextDay = new Date(lastTradingDay);\n        nextDay.setDate(lastTradingDay.getDate() + 1);\n        \n        const chartResult = await yahooFinance.chart(symbol, {\n          period1: sevenDaysAgo.toISOString().split('T')[0],\n          period2: nextDay.toISOString().split('T')[0],\n          interval: '5m' as any,\n          includePrePost: false\n        });\n\n        if (chartResult && chartResult.quotes && chartResult.quotes.length > 0) {\n          // Get the target date in YYYY-MM-DD format for comparison\n          const targetDateStr = lastTradingDay.toISOString().split('T')[0];\n          \n          const intradayData: HistoricalDataPoint[] = chartResult.quotes\n            .filter((quote: any) => {\n              const quoteDate = new Date(quote.date);\n              const quoteDateStr = quoteDate.toISOString().split('T')[0];\n              const quoteDayOfWeek = quoteDate.getDay();\n              \n              // Exclude weekends (Saturday = 6, Sunday = 0)\n              if (quoteDayOfWeek === 0 || quoteDayOfWeek === 6) {\n                return false;\n              }\n              \n              // Filter for market hours only (9:30 AM to 4:00 PM Eastern)\n              // Market hours in UTC: 13:30 to 20:00 (assuming EDT, UTC-4)\n              const quoteHour = quoteDate.getUTCHours();\n              const quoteMinute = quoteDate.getUTCMinutes();\n              const utcTime = quoteHour + (quoteMinute / 60);\n              \n              // Market hours in UTC: 13:30 (9:30 AM ET) to just before 20:00 (4:00 PM ET)\n              const isMarketHours = utcTime >= 13.5 && utcTime <= 20.0;\n              \n              // Include data from the specific last trading day during market hours\n              return quoteDateStr === targetDateStr && \n                     quote.close !== null && \n                     quote.close !== undefined &&\n                     isMarketHours;\n            })\n            .map((quote: any) => ({\n              date: Math.floor(quote.date.getTime() / 1000), // Convert to Unix timestamp\n              open: quote.open || quote.close || 0,\n              high: quote.high || quote.close || 0,\n              low: quote.low || quote.close || 0,\n              close: quote.close || 0,\n              volume: quote.volume || 0,\n            }));\n\n          if (intradayData.length > 0) {\n            setCachedData(cacheKey, intradayData, CACHE_TTL.HISTORICAL_MINUTE);\n            return intradayData;\n          }\n        }\n      } catch (error) {\n        console.log(`1D chart data failed for ${symbol}, trying historical fallback`);\n      }\n      \n      // Fallback to recent daily data if chart API fails\n      try {\n        const fiveDaysAgo = new Date();\n        fiveDaysAgo.setDate(fiveDaysAgo.getDate() - 5);\n        \n        const historicalResult = await yahooFinance.historical(symbol, {\n          period1: fiveDaysAgo.toISOString().split('T')[0],\n          period2: new Date().toISOString().split('T')[0],\n          interval: '1d' as any,\n          events: 'history'\n        });\n\n        if (historicalResult && Array.isArray(historicalResult) && historicalResult.length > 0) {\n          // Return the most recent trading days\n          const recentData: HistoricalDataPoint[] = historicalResult\n            .slice(-2) // Get last 2 days\n            .map((item: any) => ({\n              date: item.date.toISOString().split('T')[0],\n              open: item.open || item.close || 0,\n              high: item.high || item.close || 0,\n              low: item.low || item.close || 0,\n              close: item.close || 0,\n              volume: item.volume || 0,\n            }));\n\n          setCachedData(cacheKey, recentData, CACHE_TTL.HISTORICAL_MINUTE);\n          return recentData;\n        }\n      } catch (error) {\n        console.log(`Historical fallback also failed for ${symbol}`);\n      }\n    }\n\n    // For all other timeframes or 1D fallback, use regular historical data\n    const { period1, period2, interval } = getDateRange(timeFrame);\n    \n    const result = await yahooFinance.historical(symbol, {\n      period1,\n      period2,\n      interval: interval as any,\n      events: 'history'\n    });\n\n    if (!result || !Array.isArray(result) || result.length === 0) {\n      throw new Error(`No historical data found for symbol: ${symbol}`);\n    }\n\n    const historicalData: HistoricalDataPoint[] = result\n      .filter((item: any) => item.close !== null && item.close !== undefined)\n      .map((item: any) => ({\n        date: item.date.toISOString().split('T')[0],\n        open: item.open || item.close || 0,\n        high: item.high || item.close || 0,\n        low: item.low || item.close || 0,\n        close: item.close || 0,\n        volume: item.volume || 0,\n      }));\n\n    // Use different cache TTL based on data granularity\n    const cacheTTL = timeFrame === '1D' ? CACHE_TTL.HISTORICAL_MINUTE :\n                     timeFrame === '5D' ? CACHE_TTL.HISTORICAL_30MIN :\n                     CACHE_TTL.HISTORICAL;\n    setCachedData(cacheKey, historicalData, cacheTTL);\n    return historicalData;\n  } catch (error) {\n    console.error(`Error fetching historical data for ${symbol}:`, error);\n    throw new Error(`Failed to fetch historical data for ${symbol}: ${error instanceof Error ? error.message : 'Unknown error'}`);\n  }\n}\n\n/**\n * Calculate percentage change between two prices\n */\nexport function calculatePercentChange(currentPrice: number, previousPrice: number): number {\n  if (previousPrice === 0) return 0;\n  return ((currentPrice - previousPrice) / previousPrice) * 100;\n}\n\n/**\n * Get stock performance data for different timeframes\n */\nexport async function getStockPerformance(symbol: string, timeFrame: TimeFrame): Promise<{\n  symbol: string;\n  timeFrame: TimeFrame;\n  currentPrice: number;\n  previousPrice: number;\n  startPrice: number;\n  change: number;\n  percentChange: number;\n}> {\n  const cacheKey = `performance_${symbol}_${timeFrame}`;\n  const cached = getCachedData(cacheKey);\n  \n  if (cached) {\n    return cached;\n  }\n\n  try {\n    const [currentQuote, historicalData] = await Promise.all([\n      getStockQuote(symbol),\n      getHistoricalData(symbol, timeFrame)\n    ]);\n\n    if (!historicalData || historicalData.length === 0) {\n      throw new Error(`No historical data available for ${symbol}`);\n    }\n\n    // Sort historical data by date to get the earliest entry\n    const sortedData = historicalData.sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\n    \n    // For accurate timeframe calculation, use the earliest available data point\n    const startPrice = sortedData[0].close; // The close price from the start of the timeframe\n    const currentPrice = currentQuote.price;\n    const change = currentPrice - startPrice;\n    const percentChange = calculatePercentChange(currentPrice, startPrice);\n\n    const performance = {\n      symbol,\n      timeFrame,\n      currentPrice,\n      previousPrice: startPrice, // Use start price as previous price for timeframe calculations\n      startPrice,\n      change,\n      percentChange,\n    };\n\n    setCachedData(cacheKey, performance, CACHE_TTL.QUOTE);\n    return performance;\n  } catch (error) {\n    console.error(`Error fetching performance for ${symbol}:`, error);\n    throw new Error(`Failed to fetch performance for ${symbol}: ${error instanceof Error ? error.message : 'Unknown error'}`);\n  }\n}\n\n/**\n * Get detailed company information\n */\nexport async function getCompanyProfile(symbol: string): Promise<CompanyProfile> {\n  const cacheKey = `profile_${symbol}`;\n  const cached = getCachedData(cacheKey);\n  \n  if (cached) {\n    return cached;\n  }\n\n  try {\n    const [quoteResult, summaryResult] = await Promise.all([\n      yahooFinance.quote(symbol),\n      yahooFinance.quoteSummary(symbol, { \n        modules: ['summaryProfile', 'defaultKeyStatistics', 'price'] \n      }).catch(() => null)\n    ]);\n\n    if (!quoteResult) {\n      throw new Error(`No data found for symbol: ${symbol}`);\n    }\n\n    const profile: CompanyProfile = {\n      name: quoteResult.longName || quoteResult.shortName || symbol,\n      description: summaryResult?.summaryProfile?.longBusinessSummary || 'No description available',\n      sector: summaryResult?.summaryProfile?.sector || 'N/A',\n      industry: summaryResult?.summaryProfile?.industry || 'N/A',\n      marketCap: quoteResult.marketCap || 0,\n      volume: quoteResult.regularMarketVolume || 0,\n      currency: quoteResult.currency || 'USD',\n      exchange: quoteResult.fullExchangeName || 'N/A',\n      website: summaryResult?.summaryProfile?.website || undefined,\n      employees: summaryResult?.summaryProfile?.fullTimeEmployees || undefined,\n    };\n\n    setCachedData(cacheKey, profile, CACHE_TTL.PROFILE);\n    return profile;\n  } catch (error) {\n    console.error(`Error fetching profile for ${symbol}:`, error);\n    throw new Error(`Failed to fetch profile for ${symbol}: ${error instanceof Error ? error.message : 'Unknown error'}`);\n  }\n}\n\n/**\n * Get multiple stock quotes efficiently\n */\nexport async function getMultipleQuotes(symbols: string[]): Promise<StockQuote[]> {\n  const promises = symbols.map(symbol => \n    getStockQuote(symbol).catch(error => {\n      console.error(`Error fetching quote for ${symbol}:`, error);\n      return null;\n    })\n  );\n  \n  const results = await Promise.all(promises);\n  return results.filter((quote): quote is StockQuote => quote !== null);\n}\n\n/**\n * Get popular/trending stocks\n */\nexport async function getPopularStocks(): Promise<StockQuote[]> {\n  const popularSymbols = ['AAPL', 'GOOGL', 'MSFT', 'TSLA', 'AMZN', 'META', 'NVDA', 'NFLX'];\n  return getMultipleQuotes(popularSymbols);\n}\n\n/**\n * Clear expired cache entries\n */\nexport function clearExpiredCache(): void {\n  const now = Date.now();\n  for (const [key, value] of cache.entries()) {\n    if (now - value.timestamp >= value.ttl) {\n      cache.delete(key);\n    }\n  }\n}\n\n// Clean up cache every 10 minutes\nsetInterval(clearExpiredCache, 10 * 60 * 1000);","size_bytes":28557},"server/types/finance.ts":{"content":"// TypeScript interfaces for Yahoo Finance data structures\n\nexport interface StockQuote {\n  symbol: string;\n  price: number;\n  change: number;\n  percentChange: number;\n  previousClose: number;\n  volume: number;\n  marketCap: number;\n  currency: string;\n  sector?: string;\n  industry?: string;\n}\n\nexport interface HistoricalDataPoint {\n  date: string;\n  open: number;\n  high: number;\n  low: number;\n  close: number;\n  volume: number;\n}\n\nexport interface CompanyProfile {\n  name: string;\n  description: string;\n  sector: string;\n  industry: string;\n  marketCap: number;\n  volume: number;\n  currency: string;\n  exchange: string;\n  website?: string;\n  employees?: number;\n}\n\nexport interface SearchResult {\n  symbol: string;\n  name: string;\n  exchange: string;\n  type: string;\n  sector?: string;\n  industry?: string;\n}\n\nexport interface APIResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\nexport interface ErrorResponse {\n  success: false;\n  error: string;\n  statusCode: number;\n}","size_bytes":993},"server/utils/errorHandler.ts":{"content":"import { Request, Response, NextFunction } from 'express';\n\nexport interface AppError extends Error {\n  statusCode: number;\n  isOperational: boolean;\n}\n\nexport class CustomError extends Error implements AppError {\n  statusCode: number;\n  isOperational: boolean;\n\n  constructor(message: string, statusCode: number = 500) {\n    super(message);\n    this.statusCode = statusCode;\n    this.isOperational = true;\n    \n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\nexport class ValidationError extends CustomError {\n  constructor(message: string) {\n    super(message, 400);\n  }\n}\n\nexport class NotFoundError extends CustomError {\n  constructor(message: string) {\n    super(message, 404);\n  }\n}\n\nexport class RateLimitError extends CustomError {\n  constructor(message: string = 'Rate limit exceeded') {\n    super(message, 429);\n  }\n}\n\n/**\n * Log error with timestamp\n */\nexport function logError(error: Error, req?: Request): void {\n  const timestamp = new Date().toISOString();\n  const url = req ? `${req.method} ${req.url}` : 'Unknown';\n  \n  console.error(`[${timestamp}] ${url} - ${error.message}`);\n  if (process.env.NODE_ENV === 'development') {\n    console.error(error.stack);\n  }\n}\n\n/**\n * Express error handling middleware\n */\nexport function errorHandler(\n  error: Error | AppError,\n  req: Request,\n  res: Response,\n  next: NextFunction\n): void {\n  logError(error, req);\n\n  // Handle known operational errors\n  if ('isOperational' in error && error.isOperational) {\n    res.status(error.statusCode).json({\n      success: false,\n      error: error.message,\n      statusCode: error.statusCode,\n    });\n    return;\n  }\n\n  // Handle Yahoo Finance API errors\n  if (error.message.includes('Not Found') || error.message.includes('Invalid symbol')) {\n    res.status(404).json({\n      success: false,\n      error: 'Symbol not found',\n      statusCode: 404,\n    });\n    return;\n  }\n\n  if (error.message.includes('Rate limit') || error.message.includes('429')) {\n    res.status(429).json({\n      success: false,\n      error: 'Rate limit exceeded. Please try again later.',\n      statusCode: 429,\n    });\n    return;\n  }\n\n  // Handle network/timeout errors\n  if (error.message.includes('timeout') || error.message.includes('ECONNRESET')) {\n    res.status(503).json({\n      success: false,\n      error: 'Service temporarily unavailable. Please try again.',\n      statusCode: 503,\n    });\n    return;\n  }\n\n  // Default error response\n  res.status(500).json({\n    success: false,\n    error: process.env.NODE_ENV === 'development' ? error.message : 'Internal server error',\n    statusCode: 500,\n  });\n}\n\n/**\n * Async error wrapper for route handlers\n */\nexport function asyncHandler(fn: Function) {\n  return (req: Request, res: Response, next: NextFunction) => {\n    Promise.resolve(fn(req, res, next)).catch(next);\n  };\n}\n\n/**\n * Validate stock symbol format\n */\nexport function validateSymbol(symbol: string): boolean {\n  // Basic validation: alphanumeric, 1-5 characters, optionally with dots or dashes\n  const symbolRegex = /^[A-Za-z0-9.-]{1,10}$/;\n  return symbolRegex.test(symbol);\n}\n\n/**\n * Sanitize input strings\n */\nexport function sanitizeInput(input: string): string {\n  return input.trim().replace(/[<>]/g, '');\n}","size_bytes":3224},"client/src/components/MarketStatusDisclaimer.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Clock, AlertTriangle } from \"lucide-react\";\n\ninterface MarketHours {\n  isOpen: boolean;\n  nextOpen: Date | null;\n  timezone: string;\n}\n\nexport function MarketStatusDisclaimer() {\n  const [marketStatus, setMarketStatus] = useState<MarketHours | null>(null);\n\n  useEffect(() => {\n    const checkMarketStatus = () => {\n      const now = new Date();\n      const easternTime = new Date(now.toLocaleString(\"en-US\", { timeZone: \"America/New_York\" }));\n      \n      // Get day of week (0 = Sunday, 1 = Monday, etc.)\n      const dayOfWeek = easternTime.getDay();\n      const hour = easternTime.getHours();\n      const minute = easternTime.getMinutes();\n      const currentTime = hour * 60 + minute; // Convert to minutes\n\n      // Market hours: Monday-Friday 9:30 AM - 4:00 PM ET\n      const marketOpen = 9 * 60 + 30; // 9:30 AM in minutes\n      const marketClose = 16 * 60; // 4:00 PM in minutes\n\n      // Check if it's a weekday and within market hours\n      const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5;\n      const isDuringMarketHours = currentTime >= marketOpen && currentTime < marketClose;\n      const isOpen = isWeekday && isDuringMarketHours;\n\n      let nextOpen: Date | null = null;\n\n      if (!isOpen) {\n        // Calculate next market open\n        const nextOpenDate = new Date(easternTime);\n        \n        if (isWeekday && currentTime < marketOpen) {\n          // Same day, before market open\n          nextOpenDate.setHours(9, 30, 0, 0);\n        } else if (isWeekday && currentTime >= marketClose) {\n          // Same day, after market close - next business day\n          nextOpenDate.setDate(nextOpenDate.getDate() + 1);\n          nextOpenDate.setHours(9, 30, 0, 0);\n          // Skip weekend\n          if (nextOpenDate.getDay() === 6) { // Saturday\n            nextOpenDate.setDate(nextOpenDate.getDate() + 2);\n          } else if (nextOpenDate.getDay() === 0) { // Sunday\n            nextOpenDate.setDate(nextOpenDate.getDate() + 1);\n          }\n        } else {\n          // Weekend - next Monday\n          const daysUntilMonday = dayOfWeek === 0 ? 1 : (8 - dayOfWeek); // Sunday = 1 day, Saturday = 2 days\n          nextOpenDate.setDate(nextOpenDate.getDate() + daysUntilMonday);\n          nextOpenDate.setHours(9, 30, 0, 0);\n        }\n\n        nextOpen = nextOpenDate;\n      }\n\n      setMarketStatus({\n        isOpen,\n        nextOpen,\n        timezone: \"ET\"\n      });\n    };\n\n    // Check immediately\n    checkMarketStatus();\n\n    // Update every minute\n    const interval = setInterval(checkMarketStatus, 60000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  if (!marketStatus || marketStatus.isOpen) {\n    return null;\n  }\n\n  const formatNextOpen = (date: Date) => {\n    const now = new Date();\n    const diffMs = date.getTime() - now.getTime();\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n    const diffDays = Math.floor(diffHours / 24);\n\n    if (diffDays > 0) {\n      return `${date.toLocaleDateString()} at ${date.toLocaleTimeString([], { \n        hour: '2-digit', \n        minute: '2-digit',\n        timeZone: 'America/New_York'\n      })} ET`;\n    } else {\n      return `${date.toLocaleTimeString([], { \n        hour: '2-digit', \n        minute: '2-digit',\n        timeZone: 'America/New_York'\n      })} ET`;\n    }\n  };\n\n  return (\n    <Alert className=\"border-orange-200 bg-orange-50 dark:bg-orange-950/20 mb-4\">\n      <AlertTriangle className=\"h-4 w-4 text-orange-600\" />\n      <AlertDescription className=\"text-orange-800 dark:text-orange-200\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <strong>Stock Market is Closed</strong> - Will reopen {marketStatus.nextOpen && formatNextOpen(marketStatus.nextOpen)}\n          </div>\n          <div className=\"text-sm\">\n            Only crypto tournaments available • Stock trades scheduled for market open\n          </div>\n        </div>\n      </AlertDescription>\n    </Alert>\n  );\n}","size_bytes":4047},"client/src/components/WidgetGrid.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { Responsive, WidthProvider, Layout } from \"react-grid-layout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { PortfolioGraphWidget } from \"./widgets/PortfolioGraphWidget\";\nimport { StockGraphWidget } from \"./widgets/StockGraphWidget\";\nimport { WatchlistWidget } from \"./widgets/WatchlistWidget\";\nimport { PositionsWidget } from \"./widgets/PositionsWidget\";\nimport { TradingWidget } from \"./widgets/TradingWidget\";\nimport { \n  Plus, \n  Settings, \n  BarChart3, \n  TrendingUp, \n  Eye, \n  Briefcase, \n  ShoppingCart,\n  X,\n  Maximize2,\n  Minimize2\n} from \"lucide-react\";\n\nconst ResponsiveGridLayout = WidthProvider(Responsive);\n\ninterface Widget {\n  id: string;\n  type: string;\n  title: string;\n  component: React.ComponentType<any>;\n  icon: React.ComponentType<any>;\n  defaultSize: { w: number; h: number };\n}\n\nconst availableWidgets: Widget[] = [\n  {\n    id: \"portfolio-graph\",\n    type: \"portfolio-graph\",\n    title: \"Portfolio Performance\",\n    component: PortfolioGraphWidget,\n    icon: BarChart3,\n    defaultSize: { w: 6, h: 4 }\n  },\n  {\n    id: \"stock-graph\",\n    type: \"stock-graph\", \n    title: \"Stock Chart\",\n    component: StockGraphWidget,\n    icon: TrendingUp,\n    defaultSize: { w: 6, h: 4 }\n  },\n  {\n    id: \"watchlist\",\n    type: \"watchlist\",\n    title: \"Watchlist\",\n    component: WatchlistWidget,\n    icon: Eye,\n    defaultSize: { w: 4, h: 4 }\n  },\n  {\n    id: \"positions\",\n    type: \"positions\",\n    title: \"Positions\", \n    component: PositionsWidget,\n    icon: Briefcase,\n    defaultSize: { w: 4, h: 4 }\n  },\n  {\n    id: \"trading\",\n    type: \"trading\",\n    title: \"Trading\",\n    component: TradingWidget,\n    icon: ShoppingCart,\n    defaultSize: { w: 4, h: 5 }\n  }\n];\n\ninterface WidgetGridProps {\n  className?: string;\n}\n\nexport function WidgetGrid({ className }: WidgetGridProps) {\n  // Initialize with default layout\n  const [widgets, setWidgets] = useState(() => {\n    const defaultWidgets = [\n      availableWidgets[0], // Portfolio graph\n      availableWidgets[2], // Watchlist\n      availableWidgets[3], // Positions\n      availableWidgets[4]  // Trading\n    ];\n    return defaultWidgets;\n  });\n\n  const [layouts, setLayouts] = useState<{ [key: string]: Layout[] }>({\n    lg: [\n      { i: \"portfolio-graph\", x: 0, y: 0, w: 8, h: 4 },\n      { i: \"watchlist\", x: 8, y: 0, w: 4, h: 4 },\n      { i: \"positions\", x: 0, y: 4, w: 6, h: 4 },\n      { i: \"trading\", x: 6, y: 4, w: 4, h: 5 }\n    ]\n  });\n\n  const [editMode, setEditMode] = useState(false);\n\n  const addWidget = useCallback((widgetType: string) => {\n    const widget = availableWidgets.find(w => w.type === widgetType);\n    if (!widget) return;\n\n    // Check if widget already exists\n    const exists = widgets.find(w => w.type === widgetType);\n    if (exists) return;\n\n    // Create unique ID for multiple instances\n    const widgetId = `${widgetType}-${Date.now()}`;\n    const newWidget = { ...widget, id: widgetId };\n\n    setWidgets(prev => [...prev, newWidget]);\n\n    // Add to layout\n    const newLayout = {\n      i: widgetId,\n      x: (widgets.length * 2) % 12,\n      y: Math.floor(widgets.length / 6) * 4,\n      w: widget.defaultSize.w,\n      h: widget.defaultSize.h\n    };\n\n    setLayouts(prev => ({\n      ...prev,\n      lg: [...(prev.lg || []), newLayout]\n    }));\n  }, [widgets]);\n\n  const removeWidget = useCallback((widgetId: string) => {\n    setWidgets(prev => prev.filter(w => w.id !== widgetId));\n    setLayouts(prev => ({\n      ...prev,\n      lg: prev.lg?.filter(layout => layout.i !== widgetId) || []\n    }));\n  }, []);\n\n  const onLayoutChange = useCallback((layout: Layout[], layouts: { [key: string]: Layout[] }) => {\n    setLayouts(layouts);\n  }, []);\n\n  return (\n    <div className={`w-full h-full ${className}`}>\n      {/* Toolbar */}\n      <div className=\"flex items-center justify-between mb-4 p-2 bg-card rounded-lg border\">\n        <div className=\"flex items-center gap-2\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"outline\" size=\"sm\" className=\"flex items-center gap-2\">\n                <Plus className=\"w-4 h-4\" />\n                Add Widget\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              {availableWidgets.map((widget) => {\n                const Icon = widget.icon;\n                const exists = widgets.find(w => w.type === widget.type);\n                return (\n                  <DropdownMenuItem\n                    key={widget.type}\n                    onClick={() => addWidget(widget.type)}\n                    disabled={!!exists}\n                    className=\"flex items-center gap-2\"\n                  >\n                    <Icon className=\"w-4 h-4\" />\n                    {widget.title}\n                    {exists && <span className=\"text-xs text-muted-foreground ml-auto\">Added</span>}\n                  </DropdownMenuItem>\n                );\n              })}\n            </DropdownMenuContent>\n          </DropdownMenu>\n          \n          <Button\n            variant={editMode ? \"default\" : \"outline\"}\n            size=\"sm\"\n            onClick={() => setEditMode(!editMode)}\n            className=\"flex items-center gap-2\"\n          >\n            <Settings className=\"w-4 h-4\" />\n            {editMode ? \"Done\" : \"Edit Layout\"}\n          </Button>\n        </div>\n\n        <div className=\"text-sm text-muted-foreground\">\n          {widgets.length} widget{widgets.length !== 1 ? 's' : ''}\n        </div>\n      </div>\n\n      {/* Grid */}\n      <div className=\"w-full\" style={{ minHeight: 'calc(100vh - 200px)' }}>\n        <ResponsiveGridLayout\n          className=\"layout\"\n          layouts={layouts}\n          onLayoutChange={onLayoutChange}\n          breakpoints={{ lg: 1200, md: 996, sm: 768, xs: 480, xxs: 0 }}\n          cols={{ lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 }}\n          rowHeight={60}\n          isDraggable={editMode}\n          isResizable={editMode}\n          margin={[8, 8]}\n          containerPadding={[0, 0]}\n          useCSSTransforms={true}\n        >\n          {widgets.map((widget) => {\n            const WidgetComponent = widget.component;\n            const layout = layouts.lg?.find(l => l.i === widget.id);\n            const widgetHeight = layout ? layout.h * 60 + (layout.h - 1) * 8 : 240;\n\n            return (\n              <div key={widget.id} className=\"widget-container\">\n                <Card className=\"h-full relative group\">\n                  {editMode && (\n                    <Button\n                      variant=\"destructive\"\n                      size=\"sm\"\n                      className=\"absolute top-2 right-2 z-10 opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 p-0\"\n                      onClick={() => removeWidget(widget.id)}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </Button>\n                  )}\n                  <WidgetComponent height={widgetHeight} />\n                </Card>\n              </div>\n            );\n          })}\n        </ResponsiveGridLayout>\n      </div>\n\n      {/* Help text for edit mode */}\n      {editMode && (\n        <div className=\"mt-4 p-3 bg-muted/50 rounded-lg text-sm text-muted-foreground text-center\">\n          Drag widgets to rearrange them. Resize by dragging the bottom-right corner. Click the X to remove widgets.\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":7592},"client/src/components/balance-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { DollarSign, TrendingUp, TrendingDown, CreditCard, Wallet } from \"lucide-react\";\n\ninterface BalanceDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  currentBalance: number;\n}\n\nexport function BalanceDialog({ open, onOpenChange, currentBalance }: BalanceDialogProps) {\n  const { formatCurrency, t } = useUserPreferences();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [depositAmount, setDepositAmount] = useState(\"\");\n  const [withdrawAmount, setWithdrawAmount] = useState(\"\");\n\n  // Deposit mutation\n  const depositMutation = useMutation({\n    mutationFn: async (amount: number) => {\n      const response = await apiRequest(\"POST\", \"/api/balance/deposit\", { amount });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Failed to process deposit\");\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: t('success'),\n        description: `${formatCurrency(parseFloat(depositAmount))} ${t('addedToAccount')}`,\n      });\n      setDepositAmount(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: t('error'),\n        description: error.message || t('errorOccurred'),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Withdrawal mutation\n  const withdrawMutation = useMutation({\n    mutationFn: async (amount: number) => {\n      const response = await apiRequest(\"POST\", \"/api/balance/withdraw\", { amount });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Failed to process withdrawal\");\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: t('success'),\n        description: `${formatCurrency(parseFloat(withdrawAmount))} ${t('withdrawnFromAccount')}`,\n      });\n      setWithdrawAmount(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Withdrawal Failed\",\n        description: error.message || \"There was an error processing your withdrawal.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleDeposit = () => {\n    const amount = parseFloat(depositAmount);\n    if (isNaN(amount) || amount <= 0) {\n      toast({\n        title: \"Invalid Amount\",\n        description: \"Please enter a valid deposit amount greater than 0.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (amount < 1) {\n      toast({\n        title: \"Minimum Deposit\",\n        description: \"Minimum deposit amount is $1.00.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (amount > 10000) {\n      toast({\n        title: \"Maximum Deposit\",\n        description: \"Maximum deposit amount is $10,000.00 per transaction.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    depositMutation.mutate(amount);\n  };\n\n  const handleWithdraw = () => {\n    const amount = parseFloat(withdrawAmount);\n    if (isNaN(amount) || amount <= 0) {\n      toast({\n        title: \"Invalid Amount\",\n        description: \"Please enter a valid withdrawal amount greater than 0.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (amount < 1) {\n      toast({\n        title: \"Minimum Withdrawal\",\n        description: \"Minimum withdrawal amount is $1.00.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (amount > currentBalance) {\n      toast({\n        title: \"Insufficient Funds\",\n        description: \"You cannot withdraw more than your current balance.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    withdrawMutation.mutate(amount);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <DollarSign className=\"w-5 h-5\" />\n            My Balance\n          </DialogTitle>\n        </DialogHeader>\n\n        {/* Current Balance Display */}\n        <Card className=\"mb-4\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">Current Balance</CardTitle>\n          </CardHeader>\n          <CardContent className=\"pt-0\">\n            <div className=\"text-3xl font-bold text-green-600\">\n              {formatCurrency(currentBalance)}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Tabs defaultValue=\"deposit\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"deposit\" className=\"flex items-center gap-2\">\n              <TrendingUp className=\"w-4 h-4\" />\n              Deposit\n            </TabsTrigger>\n            <TabsTrigger value=\"withdraw\" className=\"flex items-center gap-2\">\n              <TrendingDown className=\"w-4 h-4\" />\n              Withdraw\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"deposit\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <CreditCard className=\"w-5 h-5\" />\n                  Deposit Funds\n                </CardTitle>\n                <CardDescription>\n                  Add money to your trading account. Minimum: $1.00, Maximum: $10,000.00\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"deposit-amount\">Amount</Label>\n                  <div className=\"relative\">\n                    <DollarSign className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      id=\"deposit-amount\"\n                      type=\"number\"\n                      placeholder=\"0.00\"\n                      value={depositAmount}\n                      onChange={(e) => setDepositAmount(e.target.value)}\n                      className=\"pl-10\"\n                      min=\"1\"\n                      max=\"10000\"\n                      step=\"0.01\"\n                    />\n                  </div>\n                </div>\n                <Button \n                  onClick={handleDeposit}\n                  disabled={depositMutation.isPending || !depositAmount}\n                  className=\"w-full\"\n                >\n                  {depositMutation.isPending ? \"Processing...\" : \"Deposit Funds\"}\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"withdraw\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Wallet className=\"w-5 h-5\" />\n                  Withdraw Funds\n                </CardTitle>\n                <CardDescription>\n                  Withdraw money from your trading account. Available: {formatCurrency(currentBalance)}\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"withdraw-amount\">Amount</Label>\n                  <div className=\"relative\">\n                    <DollarSign className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      id=\"withdraw-amount\"\n                      type=\"number\"\n                      placeholder=\"0.00\"\n                      value={withdrawAmount}\n                      onChange={(e) => setWithdrawAmount(e.target.value)}\n                      className=\"pl-10\"\n                      min=\"1\"\n                      max={currentBalance}\n                      step=\"0.01\"\n                    />\n                  </div>\n                </div>\n                <Button \n                  onClick={handleWithdraw}\n                  disabled={withdrawMutation.isPending || !withdrawAmount || currentBalance <= 0}\n                  className=\"w-full\"\n                  variant=\"outline\"\n                >\n                  {withdrawMutation.isPending ? \"Processing...\" : \"Withdraw Funds\"}\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":9200},"client/src/components/code-redemption-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Gift, Sparkles, DollarSign, Trophy, Star } from \"lucide-react\";\n\ninterface CodeRedemptionDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport function CodeRedemptionDialog({ open, onOpenChange }: CodeRedemptionDialogProps) {\n  const { formatCurrency } = useUserPreferences();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [code, setCode] = useState(\"\");\n\n  // Code redemption mutation\n  const redeemCodeMutation = useMutation({\n    mutationFn: async (redeemCode: string) => {\n      const response = await apiRequest(\"POST\", \"/api/codes/redeem\", { code: redeemCode });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Failed to redeem code\");\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Code Redeemed Successfully! 🎉\",\n        description: data.message || `You've received ${data.reward}!`,\n      });\n      setCode(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Code Redemption Failed\",\n        description: error.message || \"Invalid or expired code. Please check and try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleRedeemCode = () => {\n    const trimmedCode = code.trim().toUpperCase();\n    if (!trimmedCode) {\n      toast({\n        title: \"Invalid Code\",\n        description: \"Please enter a valid redemption code.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    if (trimmedCode.length < 4) {\n      toast({\n        title: \"Code Too Short\",\n        description: \"Redemption codes must be at least 4 characters long.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    redeemCodeMutation.mutate(trimmedCode);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\") {\n      handleRedeemCode();\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Gift className=\"w-5 h-5 text-purple-600\" />\n            Redeem Code\n          </DialogTitle>\n        </DialogHeader>\n\n        {/* Header Description */}\n        <Card className=\"border-dashed border-2 border-purple-200 dark:border-purple-800 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/30 dark:to-pink-900/30\">\n          <CardContent className=\"flex items-center gap-4 p-6\">\n            <div className=\"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center\">\n              <Sparkles className=\"w-8 h-8 text-white\" />\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-lg\">Got a Code?</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Enter your redemption code below to unlock exclusive rewards!\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Code Input Section */}\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"redemption-code\" className=\"text-base font-medium\">\n              Redemption Code\n            </Label>\n            <Input\n              id=\"redemption-code\"\n              type=\"text\"\n              placeholder=\"Enter your code here...\"\n              value={code}\n              onChange={(e) => setCode(e.target.value.toUpperCase())}\n              onKeyPress={handleKeyPress}\n              className=\"text-center text-lg font-mono tracking-wider\"\n              maxLength={20}\n            />\n            <p className=\"text-xs text-muted-foreground text-center\">\n              Codes are case-insensitive and will be automatically converted to uppercase\n            </p>\n          </div>\n\n          <Button \n            onClick={handleRedeemCode}\n            disabled={redeemCodeMutation.isPending || !code.trim()}\n            className=\"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-semibold py-3\"\n            size=\"lg\"\n          >\n            {redeemCodeMutation.isPending ? (\n              <>\n                <Sparkles className=\"w-4 h-4 mr-2 animate-spin\" />\n                Redeeming Code...\n              </>\n            ) : (\n              <>\n                <Gift className=\"w-4 h-4 mr-2\" />\n                Redeem Code\n              </>\n            )}\n          </Button>\n        </div>\n\n        {/* Possible Rewards Info */}\n        <Card className=\"mt-4\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n              Possible Rewards\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"pt-0\">\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div className=\"flex items-center gap-2\">\n                <DollarSign className=\"w-4 h-4 text-green-500\" />\n                <span>Balance Boosts</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Trophy className=\"w-4 h-4 text-yellow-500\" />\n                <span>Tournament Access</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Star className=\"w-4 h-4 text-purple-500\" />\n                <span>Premium Features</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Sparkles className=\"w-4 h-4 text-pink-500\" />\n                <span>Exclusive Items</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":6461},"client/src/components/market-status.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Clock, Globe, Moon, Sun } from \"lucide-react\";\n\ninterface MarketStatusProps {\n  variant?: \"badge\" | \"card\" | \"inline\";\n  showScheduleNote?: boolean;\n}\n\nexport function MarketStatus({ variant = \"badge\", showScheduleNote = false }: MarketStatusProps) {\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [isMarketOpen, setIsMarketOpen] = useState(false);\n  const [timeUntilOpen, setTimeUntilOpen] = useState(\"\");\n  const [timeUntilClose, setTimeUntilClose] = useState(\"\");\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      const now = new Date();\n      setCurrentTime(now);\n      \n      // Calculate market status (NYSE hours: 9:30 AM - 4:00 PM ET, Mon-Fri)\n      const nyTime = new Date(now.toLocaleString(\"en-US\", {timeZone: \"America/New_York\"}));\n      const day = nyTime.getDay(); // 0 = Sunday, 1 = Monday, etc.\n      const hour = nyTime.getHours();\n      const minute = nyTime.getMinutes();\n      const totalMinutes = hour * 60 + minute;\n      \n      // Market is closed on weekends (Saturday = 6, Sunday = 0)\n      const isWeekend = day === 0 || day === 6;\n      \n      // Market hours: 9:30 AM (570 minutes) to 4:00 PM (960 minutes)\n      const marketOpen = 9 * 60 + 30; // 9:30 AM in minutes\n      const marketClose = 16 * 60; // 4:00 PM in minutes\n      \n      const isOpen = !isWeekend && totalMinutes >= marketOpen && totalMinutes < marketClose;\n      setIsMarketOpen(isOpen);\n      \n      // Calculate time until next market event\n      if (isOpen) {\n        // Market is open, calculate time until close\n        const minutesUntilClose = marketClose - totalMinutes;\n        const hoursUntilClose = Math.floor(minutesUntilClose / 60);\n        const minsUntilClose = minutesUntilClose % 60;\n        setTimeUntilClose(`${hoursUntilClose}h ${minsUntilClose}m`);\n        setTimeUntilOpen(\"\");\n      } else {\n        // Market is closed, calculate time until open\n        let minutesUntilOpen;\n        \n        if (isWeekend) {\n          // If it's weekend, calculate until Monday 9:30 AM\n          const daysUntilMonday = day === 0 ? 1 : (7 - day + 1); // If Sunday, 1 day. Otherwise, days until next Monday\n          minutesUntilOpen = (daysUntilMonday * 24 * 60) + marketOpen - totalMinutes;\n        } else if (totalMinutes < marketOpen) {\n          // Same day, before market open\n          minutesUntilOpen = marketOpen - totalMinutes;\n        } else {\n          // Same day, after market close - next trading day\n          minutesUntilOpen = (24 * 60) - totalMinutes + marketOpen;\n        }\n        \n        const hoursUntilOpen = Math.floor(minutesUntilOpen / 60);\n        const minsUntilOpen = minutesUntilOpen % 60;\n        \n        if (hoursUntilOpen >= 24) {\n          const daysUntilOpen = Math.floor(hoursUntilOpen / 24);\n          const remainingHours = hoursUntilOpen % 24;\n          setTimeUntilOpen(`${daysUntilOpen}d ${remainingHours}h`);\n        } else {\n          setTimeUntilOpen(`${hoursUntilOpen}h ${minsUntilOpen}m`);\n        }\n        setTimeUntilClose(\"\");\n      }\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  const getStatusColor = () => {\n    return isMarketOpen ? \"bg-green-500\" : \"bg-red-500\";\n  };\n\n  const getStatusText = () => {\n    return isMarketOpen ? \"Markets Open\" : \"Markets Closed\";\n  };\n\n  const getStatusIcon = () => {\n    return isMarketOpen ? Sun : Moon;\n  };\n\n  const StatusIcon = getStatusIcon();\n\n  if (variant === \"badge\") {\n    return (\n      <Badge variant=\"secondary\" className=\"flex items-center space-x-2\">\n        <div className={`w-2 h-2 rounded-full ${getStatusColor()} ${isMarketOpen ? 'animate-pulse' : ''}`}></div>\n        <StatusIcon className=\"w-3 h-3\" />\n        <span className=\"text-xs\">{getStatusText()}</span>\n      </Badge>\n    );\n  }\n\n  if (variant === \"inline\") {\n    return (\n      <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n        <div className={`w-2 h-2 rounded-full ${getStatusColor()} ${isMarketOpen ? 'animate-pulse' : ''}`}></div>\n        <StatusIcon className=\"w-4 h-4\" />\n        <span>{getStatusText()}</span>\n        {isMarketOpen && timeUntilClose && (\n          <span className=\"text-xs\">• Closes in {timeUntilClose}</span>\n        )}\n        {!isMarketOpen && timeUntilOpen && (\n          <span className=\"text-xs\">• Opens in {timeUntilOpen}</span>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <Card className={`border-0 ${isMarketOpen ? 'bg-green-50 dark:bg-green-950/20' : 'bg-red-50 dark:bg-red-950/20'}`}>\n      <CardContent className=\"p-4\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <div className=\"flex items-center space-x-2\">\n            <div className={`w-3 h-3 rounded-full ${getStatusColor()} ${isMarketOpen ? 'animate-pulse' : ''}`}></div>\n            <StatusIcon className=\"w-5 h-5\" />\n            <span className=\"font-medium\">{getStatusText()}</span>\n          </div>\n          <Badge variant=\"outline\" className=\"text-xs\">\n            <Globe className=\"w-3 h-3 mr-1\" />\n            NYSE\n          </Badge>\n        </div>\n        \n        <div className=\"text-sm text-muted-foreground\">\n          {isMarketOpen ? (\n            <div className=\"flex items-center space-x-2\">\n              <Clock className=\"w-4 h-4\" />\n              <span>Closes in {timeUntilClose}</span>\n            </div>\n          ) : (\n            <div className=\"flex items-center space-x-2\">\n              <Clock className=\"w-4 h-4\" />\n              <span>Opens in {timeUntilOpen}</span>\n            </div>\n          )}\n        </div>\n\n        {showScheduleNote && !isMarketOpen && (\n          <div className=\"mt-3 p-2 bg-blue-50 dark:bg-blue-950/30 rounded text-xs text-blue-800 dark:text-blue-200\">\n            <strong>Off-Market Trading:</strong> Stock orders placed now will be scheduled and executed when markets open.\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":6060},"client/src/contexts/UserPreferencesContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { useAuth } from '@/hooks/use-auth';\n\n// Language translations\nexport const translations = {\n  English: {\n    // Navigation\n    dashboard: \"Dashboard\",\n    portfolio: \"Portfolio\", \n    leaderboard: \"Leaderboard\",\n    people: \"People\",\n    plans: \"Plans\",\n    about: \"About\",\n    contact: \"Contact\",\n    settings: \"Settings\",\n    archive: \"Archive\",\n    logout: \"Logout\",\n    \n    // Common terms\n    welcome: \"Welcome\",\n    loading: \"Loading...\",\n    error: \"Error\",\n    success: \"Success\",\n    save: \"Save\",\n    cancel: \"Cancel\",\n    delete: \"Delete\",\n    edit: \"Edit\",\n    view: \"View\",\n    back: \"Back\",\n    next: \"Next\",\n    finish: \"Finish\",\n    \n    // Financial terms\n    balance: \"Balance\",\n    shares: \"Shares\",\n    price: \"Price\",\n    change: \"Change\",\n    volume: \"Volume\",\n    marketCap: \"Market Cap\",\n    totalValue: \"Total Value\",\n    currentValue: \"Current Value\",\n    purchasePrice: \"Purchase Price\",\n    currentPrice: \"Current Price\",\n    gain: \"Gain\",\n    loss: \"Loss\",\n    \n    // Tournament terms\n    tournament: \"Tournament\",\n    tournaments: \"Tournaments\",\n    participants: \"Participants\",\n    timeRemaining: \"Time Remaining\",\n    joinTournament: \"Join Tournament\",\n    createTournament: \"Create Tournament\",\n    \n    // User interface\n    firstName: \"First Name\",\n    lastName: \"Last Name\",\n    displayName: \"Display Name\",\n    email: \"Email\",\n    password: \"Password\",\n    country: \"Country\",\n    language: \"Language\",\n    currency: \"Currency\",\n    subscriptionTier: \"Subscription Tier\",\n    \n    // Account settings\n    accountSettings: \"Account Settings\",\n    personalInformation: \"Personal Information\",\n    preferences: \"Preferences\",\n    updateProfile: \"Update Profile\",\n    changePassword: \"Change Password\",\n    \n    // Signup flow\n    getStarted: \"Get Started\",\n    chooseLocation: \"Choose Your Location\",\n    enterDetails: \"Enter Your Details\",\n    createAccount: \"Create Account\",\n    choosePlan: \"Choose Your Plan\",\n    signupComplete: \"Welcome to ORSATH!\",\n    \n    // Subscription plans\n    free: \"Free\",\n    premium: \"Premium\",\n    administrator: \"Administrator\",\n    upgrade: \"Upgrade\",\n    upgraded: \"Upgraded\",\n    \n\n    \n    // Portfolio\n    initialDeposit: \"Initial Deposit\",\n    totalGainLoss: \"Total Gain/Loss\",\n    totalInvested: \"Total Invested\",\n    availableCash: \"Available Cash\",\n    \n    // Authentication\n    signIn: \"Sign in to\",\n    signInDescription: \"Access your paper trading competition platform\",\n    welcomeBack: \"Welcome Back\",\n    signUp: \"Sign up\",\n    dontHaveAccount: \"Don't have an account?\",\n    emailAddress: \"Email address\",\n    enterEmail: \"Enter your email\",\n    enterPassword: \"Enter your password\",\n    logIn: \"Log in\",\n    loggingIn: \"Logging in...\",\n    \n    // Support\n    support: \"Support\",\n    helpCenter: \"Help Center\",\n    faq: \"FAQs\",\n    guides: \"Guides\",\n    contactUs: \"Contact Us\",\n    \n    // Trading Actions\n    buy: \"Buy\",\n    sell: \"Sell\",\n    buyStock: \"Buy Stock\",\n    sellStock: \"Sell Stock\",\n    search: \"Search\",\n    searchStocks: \"Search stocks...\",\n    addToWatchlist: \"Add to Watchlist\",\n    removeFromWatchlist: \"Remove from Watchlist\",\n    \n    // Dashboard & Portfolio\n    overview: \"Overview\",\n    holdings: \"Holdings\",\n    watchlist: \"Watchlist\",\n    history: \"History\",\n    analytics: \"Analytics\",\n    totalPortfolioValue: \"Total Portfolio Value\",\n    dayChange: \"Day Change\",\n    totalReturn: \"Total Return\",\n    totalReturnPercent: \"Total Return %\",\n    availableBalance: \"Available Balance\",\n    investedAmount: \"Invested Amount\",\n    unrealizedGains: \"Unrealized Gains\",\n    realizedGains: \"Realized Gains\",\n    \n    // Stock Information\n    symbol: \"Symbol\",\n    company: \"Company\",\n    lastPrice: \"Last Price\",\n    priceChange: \"Price Change\",\n    priceChangePercent: \"Price Change %\",\n    previousClose: \"Previous Close\",\n    dayRange: \"Day Range\",\n    week52Range: \"52 Week Range\",\n    averageVolume: \"Average Volume\",\n    marketCapitalization: \"Market Capitalization\",\n    peRatio: \"P/E Ratio\",\n    dividend: \"Dividend\",\n    beta: \"Beta\",\n    \n    // Tournament Features\n    joinTournamentBtn: \"Join Tournament\",\n    createTournamentBtn: \"Create Tournament\",\n    tournamentName: \"Tournament Name\",\n    startingBalance: \"Starting Balance\",\n    endDate: \"End Date\",\n    buyIn: \"Buy-in\",\n    prizePool: \"Prize Pool\",\n    status: \"Status\",\n    rank: \"Rank\",\n    participantCount: \"Participants\",\n    timeLeft: \"Time Left\",\n    tournamentRules: \"Tournament Rules\",\n    leaderboardPosition: \"Leaderboard Position\",\n    \n    // Account & Profile\n    profile: \"Profile\",\n    account: \"Account\",\n    profilePicture: \"Profile Picture\",\n    username: \"Username\",\n    fullName: \"Full Name\",\n    dateOfBirth: \"Date of Birth\",\n    phoneNumber: \"Phone Number\",\n    address: \"Address\",\n    city: \"City\",\n    state: \"State\",\n    postalCode: \"Postal Code\",\n    bio: \"Bio\",\n    \n    // Financial Management\n    deposit: \"Deposit\",\n    withdraw: \"Withdraw\",\n    transfer: \"Transfer\",\n    transaction: \"Transaction\",\n    transactions: \"Transactions\",\n    amount: \"Amount\",\n    fee: \"Fee\",\n    total: \"Total\",\n    processingTime: \"Processing Time\",\n    bankAccount: \"Bank Account\",\n    creditCard: \"Credit Card\",\n    paymentMethod: \"Payment Method\",\n    siteCash: \"Site Cash\",\n    \n    // Time & Dates\n    today: \"Today\",\n    yesterday: \"Yesterday\",\n    thisWeek: \"This Week\",\n    thisMonth: \"This Month\",\n    thisYear: \"This Year\",\n    allTime: \"All Time\",\n    dateRange: \"Date Range\",\n    from: \"From\",\n    to: \"To\",\n    \n    // Actions & Buttons\n    submit: \"Submit\",\n    confirm: \"Confirm\",\n    apply: \"Apply\",\n    reset: \"Reset\",\n    clear: \"Clear\",\n    refresh: \"Refresh\",\n    update: \"Update\",\n    create: \"Create\",\n    join: \"Join\",\n    leave: \"Leave\",\n    close: \"Close\",\n    open: \"Open\",\n    \n    // Status & Messages\n    active: \"Active\",\n    inactive: \"Inactive\",\n    completed: \"Completed\",\n    pending: \"Pending\",\n    processing: \"Processing\",\n    approved: \"Approved\",\n    rejected: \"Rejected\",\n    cancelled: \"Cancelled\",\n    expired: \"Expired\",\n    \n    // Notifications & Alerts\n    notification: \"Notification\",\n    notifications: \"Notifications\",\n    alert: \"Alert\",\n    warning: \"Warning\",\n    info: \"Information\",\n    noData: \"No data available\",\n    noResults: \"No results found\",\n    searchNoResults: \"No stocks found matching your search\",\n    \n    // Navigation & Layout\n    home: \"Home\",\n    hub: \"Hub\",\n    menu: \"Menu\",\n    sidebar: \"Sidebar\",\n    header: \"Header\",\n    footer: \"Footer\",\n    breadcrumb: \"Breadcrumb\",\n    pagination: \"Pagination\",\n    \n    // Forms & Validation\n    required: \"Required\",\n    optional: \"Optional\",\n    invalid: \"Invalid\",\n    valid: \"Valid\",\n    pleaseEnter: \"Please enter\",\n    pleaseSelect: \"Please select\",\n    fieldRequired: \"This field is required\",\n    invalidEmail: \"Invalid email address\",\n    passwordTooShort: \"Password too short\",\n    \n    // Market Status\n    marketOpen: \"Market Open\",\n    marketClosed: \"Market Closed\",\n    marketHours: \"Market Hours\",\n    afterHours: \"After Hours\",\n    preMarket: \"Pre Market\",\n    tradingHalted: \"Trading Halted\",\n    \n    // Performance & Statistics\n    performance: \"Performance\",\n    statistics: \"Statistics\",\n    winRate: \"Win Rate\",\n    profitLoss: \"Profit/Loss\",\n    bestPerformance: \"Best Performance\",\n    worstPerformance: \"Worst Performance\",\n    averageReturn: \"Average Return\",\n    sharpeRatio: \"Sharpe Ratio\",\n    volatility: \"Volatility\",\n    \n    // Social & Community\n    chat: \"Chat\",\n    message: \"Message\",\n    send: \"Send\",\n    online: \"Online\",\n    offline: \"Offline\",\n    members: \"Members\",\n    community: \"Community\",\n    social: \"Social\",\n    \n    // Help & Documentation\n    help: \"Help\",\n    documentation: \"Documentation\",\n    tutorial: \"Tutorial\",\n    gettingStarted: \"Getting Started\",\n    userManual: \"User Manual\",\n    videoTutorials: \"Video Tutorials\",\n    \n    // Settings & Preferences\n    general: \"General\",\n    security: \"Security\",\n    privacy: \"Privacy\",\n    notificationsSettings: \"Notifications\",\n    appearance: \"Appearance\",\n    theme: \"Theme\",\n    darkMode: \"Dark Mode\",\n    lightMode: \"Light Mode\",\n    \n    // Subscription & Billing\n    subscription: \"Subscription\",\n    billing: \"Billing\",\n    plan: \"Plan\",\n    upgradeAccount: \"Upgrade\",\n    downgrade: \"Downgrade\",\n    renew: \"Renew\",\n    expire: \"Expire\",\n    invoice: \"Invoice\",\n    receipt: \"Receipt\",\n    \n    // Errors & Issues\n    errorOccurred: \"An error occurred\",\n    tryAgain: \"Try again\",\n    contactSupport: \"Contact support\",\n    pageNotFound: \"Page not found\",\n    accessDenied: \"Access denied\",\n    sessionExpired: \"Session expired\",\n    connectionLost: \"Connection lost\",\n    \n    // Brand & Legal\n    brandName: \"ORSATH\",\n    tagline: \"Paper trading competition platform for aspiring traders\",\n    termsOfService: \"Terms of Service\",\n    privacyPolicy: \"Privacy Policy\",\n    cookiePolicy: \"Cookie Policy\",\n    disclaimer: \"Disclaimer\",\n    \n    // Miscellaneous\n    more: \"More\",\n    less: \"Less\",\n    all: \"All\",\n    none: \"None\",\n    other: \"Other\",\n    misc: \"Miscellaneous\",\n    details: \"Details\",\n    summary: \"Summary\",\n    advanced: \"Advanced\",\n    basic: \"Basic\",\n    actions: \"Actions\",\n    processing: \"Processing...\",\n    totalValue: \"Total Value\",\n    \n    // Greetings\n    goodMorning: \"Good Morning\",\n    goodAfternoon: \"Good Afternoon\",\n    goodEvening: \"Good Evening\",\n    \n    // Hub specific\n    hubWelcomeMessage: \"Ready to make your mark on the markets?\",\n    dashboardDescription: \"Jump into your personal trading dashboard\",\n    joinTournamentDescription: \"Compete against traders worldwide\",\n    leaderboardDescription: \"See where you stand globally\",\n    events: \"Events\",\n    \n    // Additional UI messages\n    startTradingMessage: \"Start trading to see your positions here\",\n    addedToAccount: \"has been added to your account\",\n    withdrawnFromAccount: \"has been withdrawn from your account\",\n    enterUsername: \"Enter your username\",\n    currentHoldings: \"Current Holdings\",\n    adminRole: \"Admin\",\n    supportTeam: \"Support\",\n    invalidShares: \"Please enter a valid number of shares\",\n    stockPurchased: \"Bought stock\",\n    sharesUnit: \"shares\",\n    sellPosition: \"Sell stock\",\n  },\n  \n  Portuguese: {\n    // Navigation\n    dashboard: \"Painel\",\n    portfolio: \"Portfólio\",\n    leaderboard: \"Classificação\",\n    people: \"Pessoas\",\n    plans: \"Planos\",\n    about: \"Sobre\",\n    contact: \"Contato\",\n    settings: \"Configurações\",\n    archive: \"Arquivo\",\n    logout: \"Sair\",\n    \n    // Common terms\n    welcome: \"Bem-vindo\",\n    loading: \"Carregando...\",\n    error: \"Erro\",\n    success: \"Sucesso\",\n    save: \"Salvar\",\n    cancel: \"Cancelar\",\n    delete: \"Excluir\",\n    edit: \"Editar\",\n    view: \"Ver\",\n    back: \"Voltar\",\n    next: \"Próximo\",\n    finish: \"Finalizar\",\n    \n    // Financial terms\n    balance: \"Saldo\",\n    shares: \"Ações\",\n    price: \"Preço\",\n    change: \"Mudança\",\n    volume: \"Volume\",\n    marketCap: \"Cap. Mercado\",\n    totalValue: \"Valor Total\",\n    currentValue: \"Valor Atual\",\n    purchasePrice: \"Preço Compra\",\n    currentPrice: \"Preço Atual\",\n    gain: \"Ganho\",\n    loss: \"Perda\",\n    \n    // Tournament terms\n    tournament: \"Torneio\",\n    tournaments: \"Torneios\",\n    participants: \"Participantes\",\n    timeRemaining: \"Tempo Restante\",\n    joinTournament: \"Entrar no Torneio\",\n    createTournament: \"Criar Torneio\",\n    \n    // User interface\n    firstName: \"Primeiro Nome\",\n    lastName: \"Sobrenome\",\n    displayName: \"Nome de Exibição\",\n    email: \"Email\",\n    password: \"Senha\",\n    country: \"País\",\n    language: \"Idioma\",\n    currency: \"Moeda\",\n    subscriptionTier: \"Nível de Assinatura\",\n    \n    // Account settings\n    accountSettings: \"Configurações da Conta\",\n    personalInformation: \"Informações Pessoais\",\n    preferences: \"Preferências\",\n    updateProfile: \"Atualizar Perfil\",\n    changePassword: \"Alterar Senha\",\n    \n    // Signup flow\n    getStarted: \"Começar\",\n    chooseLocation: \"Escolha Sua Localização\",\n    enterDetails: \"Digite Seus Dados\",\n    createAccount: \"Criar Conta\",\n    choosePlan: \"Escolha Seu Plano\",\n    signupComplete: \"Bem-vindo ao ORSATH!\",\n    \n    // Subscription plans\n    free: \"Gratuito\",\n    premium: \"Premium\",\n    administrator: \"Administrador\",\n    upgrade: \"Atualizar\",\n    upgraded: \"Atualizado\",\n    \n\n    \n    // Portfolio\n    initialDeposit: \"Depósito Inicial\",\n    totalGainLoss: \"Ganho/Perda Total\",\n    totalInvested: \"Total Investido\",\n    availableCash: \"Dinheiro Disponível\",\n    \n    // Authentication\n    signIn: \"Entrar em\",\n    signInDescription: \"Acesse sua plataforma de competição de negociação simulada\",\n    welcomeBack: \"Bem-vindo de Volta\",\n    signUp: \"Cadastrar-se\",\n    dontHaveAccount: \"Não tem uma conta?\",\n    emailAddress: \"Endereço de e-mail\",\n    enterEmail: \"Digite seu e-mail\",\n    enterPassword: \"Digite sua senha\",\n    logIn: \"Entrar\",\n    loggingIn: \"Entrando...\",\n    \n    // Support\n    support: \"Suporte\",\n    helpCenter: \"Central de Ajuda\",\n    faq: \"Perguntas Frequentes\",\n    guides: \"Guias\",\n    contactUs: \"Contate-nos\",\n    \n    // Trading Actions\n    buy: \"Comprar\",\n    sell: \"Vender\",\n    buyStock: \"Comprar Ação\",\n    sellStock: \"Vender Ação\",\n    search: \"Pesquisar\",\n    searchStocks: \"Pesquisar ações...\",\n    addToWatchlist: \"Adicionar à Lista de Observação\",\n    removeFromWatchlist: \"Remover da Lista de Observação\",\n    \n    // Dashboard & Portfolio\n    overview: \"Visão Geral\",\n    holdings: \"Participações\",\n    watchlist: \"Lista de Observação\",\n    history: \"Histórico\",\n    analytics: \"Análises\",\n    totalPortfolioValue: \"Valor Total do Portfólio\",\n    dayChange: \"Mudança do Dia\",\n    totalReturn: \"Retorno Total\",\n    totalReturnPercent: \"% Retorno Total\",\n    availableBalance: \"Saldo Disponível\",\n    investedAmount: \"Valor Investido\",\n    unrealizedGains: \"Ganhos Não Realizados\",\n    realizedGains: \"Ganhos Realizados\",\n    \n    // Stock Information\n    symbol: \"Símbolo\",\n    company: \"Empresa\",\n    lastPrice: \"Último Preço\",\n    priceChange: \"Mudança de Preço\",\n    priceChangePercent: \"% Mudança de Preço\",\n    previousClose: \"Fechamento Anterior\",\n    dayRange: \"Faixa do Dia\",\n    week52Range: \"Faixa 52 Semanas\",\n    averageVolume: \"Volume Médio\",\n    marketCapitalization: \"Capitalização de Mercado\",\n    peRatio: \"Relação P/L\",\n    dividend: \"Dividendo\",\n    beta: \"Beta\",\n    \n    // Tournament Features\n    joinTournamentBtn: \"Participar do Torneio\",\n    createTournamentBtn: \"Criar Torneio\",\n    tournamentName: \"Nome do Torneio\",\n    startingBalance: \"Saldo Inicial\",\n    endDate: \"Data de Término\",\n    buyIn: \"Buy-in\",\n    prizePool: \"Prêmio Acumulado\",\n    status: \"Status\",\n    rank: \"Posição\",\n    participantCount: \"Participantes\",\n    timeLeft: \"Tempo Restante\",\n    tournamentRules: \"Regras do Torneio\",\n    leaderboardPosition: \"Posição no Ranking\",\n    \n    // Account & Profile\n    profile: \"Perfil\",\n    account: \"Conta\",\n    profilePicture: \"Foto do Perfil\",\n    username: \"Nome de Usuário\",\n    fullName: \"Nome Completo\",\n    dateOfBirth: \"Data de Nascimento\",\n    phoneNumber: \"Número de Telefone\",\n    address: \"Endereço\",\n    city: \"Cidade\",\n    state: \"Estado\",\n    postalCode: \"CEP\",\n    bio: \"Biografia\",\n    \n    // Financial Management\n    deposit: \"Depositar\",\n    withdraw: \"Sacar\",\n    transfer: \"Transferir\",\n    transaction: \"Transação\",\n    transactions: \"Transações\",\n    amount: \"Valor\",\n    fee: \"Taxa\",\n    total: \"Total\",\n    processingTime: \"Tempo de Processamento\",\n    bankAccount: \"Conta Bancária\",\n    creditCard: \"Cartão de Crédito\",\n    paymentMethod: \"Método de Pagamento\",\n    siteCash: \"Dinheiro do Site\",\n    \n    // Time & Dates\n    today: \"Hoje\",\n    yesterday: \"Ontem\",\n    thisWeek: \"Esta Semana\",\n    thisMonth: \"Este Mês\",\n    thisYear: \"Este Ano\",\n    allTime: \"Todo o Tempo\",\n    dateRange: \"Período\",\n    from: \"De\",\n    to: \"Para\",\n    \n    // Actions & Buttons\n    submit: \"Enviar\",\n    confirm: \"Confirmar\",\n    apply: \"Aplicar\",\n    reset: \"Redefinir\",\n    clear: \"Limpar\",\n    refresh: \"Atualizar\",\n    update: \"Atualizar\",\n    create: \"Criar\",\n    join: \"Participar\",\n    leave: \"Sair\",\n    close: \"Fechar\",\n    open: \"Abrir\",\n    \n    // Status & Messages\n    active: \"Ativo\",\n    inactive: \"Inativo\",\n    completed: \"Concluído\",\n    pending: \"Pendente\",\n    processing: \"Processando\",\n    approved: \"Aprovado\",\n    rejected: \"Rejeitado\",\n    cancelled: \"Cancelado\",\n    expired: \"Expirado\",\n    \n    // Notifications & Alerts\n    notification: \"Notificação\",\n    notifications: \"Notificações\",\n    alert: \"Alerta\",\n    warning: \"Aviso\",\n    info: \"Informação\",\n    noData: \"Nenhum dado disponível\",\n    noResults: \"Nenhum resultado encontrado\",\n    searchNoResults: \"Nenhuma ação encontrada para sua pesquisa\",\n    \n    // Navigation & Layout\n    home: \"Início\",\n    hub: \"Central\",\n    menu: \"Menu\",\n    sidebar: \"Barra Lateral\",\n    header: \"Cabeçalho\",\n    footer: \"Rodapé\",\n    breadcrumb: \"Navegação\",\n    pagination: \"Paginação\",\n    \n    // Forms & Validation\n    required: \"Obrigatório\",\n    optional: \"Opcional\",\n    invalid: \"Inválido\",\n    valid: \"Válido\",\n    pleaseEnter: \"Por favor digite\",\n    pleaseSelect: \"Por favor selecione\",\n    fieldRequired: \"Este campo é obrigatório\",\n    invalidEmail: \"Endereço de email inválido\",\n    passwordTooShort: \"Senha muito curta\",\n    \n    // Market Status\n    marketOpen: \"Mercado Aberto\",\n    marketClosed: \"Mercado Fechado\",\n    marketHours: \"Horário do Mercado\",\n    afterHours: \"Após o Horário\",\n    preMarket: \"Pré-Mercado\",\n    tradingHalted: \"Negociação Suspensa\",\n    \n    // Performance & Statistics\n    performance: \"Desempenho\",\n    statistics: \"Estatísticas\",\n    winRate: \"Taxa de Vitória\",\n    profitLoss: \"Lucro/Prejuízo\",\n    bestPerformance: \"Melhor Desempenho\",\n    worstPerformance: \"Pior Desempenho\",\n    averageReturn: \"Retorno Médio\",\n    sharpeRatio: \"Índice de Sharpe\",\n    volatility: \"Volatilidade\",\n    \n    // Social & Community\n    chat: \"Chat\",\n    message: \"Mensagem\",\n    send: \"Enviar\",\n    online: \"Online\",\n    offline: \"Offline\",\n    members: \"Membros\",\n    community: \"Comunidade\",\n    social: \"Social\",\n    \n    // Help & Documentation\n    help: \"Ajuda\",\n    documentation: \"Documentação\",\n    tutorial: \"Tutorial\",\n    gettingStarted: \"Começando\",\n    userManual: \"Manual do Usuário\",\n    videoTutorials: \"Tutoriais em Vídeo\",\n    \n    // Settings & Preferences\n    general: \"Geral\",\n    security: \"Segurança\",\n    privacy: \"Privacidade\",\n    notificationsSettings: \"Notificações\",\n    appearance: \"Aparência\",\n    theme: \"Tema\",\n    darkMode: \"Modo Escuro\",\n    lightMode: \"Modo Claro\",\n    \n    // Subscription & Billing\n    subscription: \"Assinatura\",\n    billing: \"Cobrança\",\n    plan: \"Plano\",\n    upgradeAccount: \"Fazer Upgrade\",\n    downgrade: \"Fazer Downgrade\",\n    renew: \"Renovar\",\n    expire: \"Expirar\",\n    invoice: \"Fatura\",\n    receipt: \"Recibo\",\n    \n    // Errors & Issues\n    errorOccurred: \"Ocorreu um erro\",\n    tryAgain: \"Tente novamente\",\n    contactSupport: \"Contate o suporte\",\n    pageNotFound: \"Página não encontrada\",\n    accessDenied: \"Acesso negado\",\n    sessionExpired: \"Sessão expirada\",\n    connectionLost: \"Conexão perdida\",\n    \n    // Brand & Legal\n    brandName: \"ORSATH\",\n    tagline: \"Plataforma de competição de trading simulado para traders aspirantes\",\n    termsOfService: \"Termos de Serviço\",\n    privacyPolicy: \"Política de Privacidade\",\n    cookiePolicy: \"Política de Cookies\",\n    disclaimer: \"Isenção de Responsabilidade\",\n    \n    // Miscellaneous\n    more: \"Mais\",\n    less: \"Menos\",\n    all: \"Todos\",\n    none: \"Nenhum\",\n    other: \"Outro\",\n    misc: \"Diversos\",\n    details: \"Detalhes\",\n    summary: \"Resumo\",\n    advanced: \"Avançado\",\n    basic: \"Básico\",\n    actions: \"Ações\",\n    processing: \"Processando...\",\n    totalValue: \"Valor Total\",\n    \n    // Greetings\n    goodMorning: \"Bom Dia\",\n    goodAfternoon: \"Boa Tarde\",\n    goodEvening: \"Boa Noite\",\n    \n    // Hub specific\n    hubWelcomeMessage: \"Pronto para deixar sua marca nos mercados?\",\n    dashboardDescription: \"Entre no seu painel de negociação pessoal\",\n    joinTournamentDescription: \"Compita contra traders de todo o mundo\",\n    leaderboardDescription: \"Veja onde você está globalmente\",\n    events: \"Eventos\",\n    \n    // Additional UI messages\n    startTradingMessage: \"Comece a negociar para ver suas posições aqui\",\n    addedToAccount: \"foi adicionado à sua conta\",\n    withdrawnFromAccount: \"foi retirado da sua conta\",\n    enterUsername: \"Digite seu nome de usuário\",\n    currentHoldings: \"Posições Atuais\",\n    adminRole: \"Administrador\",\n    supportTeam: \"Suporte\",\n    invalidShares: \"Por favor, digite um número válido de ações\",\n    stockPurchased: \"Ação comprada\",\n    sharesUnit: \"ações\",\n    sellPosition: \"Vender ação\",\n  },\n  \n  Spanish: {\n    // Navigation\n    dashboard: \"Panel\",\n    portfolio: \"Portafolio\",\n    leaderboard: \"Clasificación\",\n    people: \"Personas\",\n    plans: \"Planes\",\n    about: \"Acerca\",\n    contact: \"Contacto\",\n    settings: \"Configuración\",\n    archive: \"Archivo\",\n    logout: \"Salir\",\n    \n    // Common terms\n    welcome: \"Bienvenido\",\n    loading: \"Cargando...\",\n    error: \"Error\",\n    success: \"Éxito\",\n    save: \"Guardar\",\n    cancel: \"Cancelar\",\n    delete: \"Eliminar\",\n    edit: \"Editar\",\n    view: \"Ver\",\n    back: \"Atrás\",\n    next: \"Siguiente\",\n    finish: \"Finalizar\",\n    \n    // Financial terms\n    balance: \"Balance\",\n    shares: \"Acciones\",\n    price: \"Precio\",\n    change: \"Cambio\",\n    volume: \"Volumen\",\n    marketCap: \"Cap. Mercado\",\n    totalValue: \"Valor Total\",\n    currentValue: \"Valor Actual\",\n    purchasePrice: \"Precio Compra\",\n    currentPrice: \"Precio Actual\",\n    gain: \"Ganancia\",\n    loss: \"Pérdida\",\n    \n    // Tournament terms\n    tournament: \"Torneo\",\n    tournaments: \"Torneos\",\n    participants: \"Participantes\",\n    timeRemaining: \"Tiempo Restante\",\n    joinTournament: \"Unirse al Torneo\",\n    createTournament: \"Crear Torneo\",\n    \n    // User interface\n    firstName: \"Nombre\",\n    lastName: \"Apellido\",\n    displayName: \"Nombre Mostrado\",\n    email: \"Email\",\n    country: \"País\",\n    language: \"Idioma\",\n    currency: \"Moneda\",\n    subscriptionTier: \"Nivel de Suscripción\",\n    \n    // Account settings\n    accountSettings: \"Configuración de Cuenta\",\n    personalInformation: \"Información Personal\",\n    preferences: \"Preferencias\",\n    updateProfile: \"Actualizar Perfil\",\n    changePassword: \"Cambiar Contraseña\",\n    \n    // Signup flow\n    getStarted: \"Comenzar\",\n    chooseLocation: \"Elige Tu Ubicación\",\n    enterDetails: \"Ingresa Tus Datos\",\n    createAccount: \"Crear Cuenta\",\n    choosePlan: \"Elige Tu Plan\",\n    signupComplete: \"¡Bienvenido a ORSATH!\",\n    \n    // Subscription plans\n    free: \"Gratis\",\n    premium: \"Premium\",\n    administrator: \"Administrador\",\n    upgrade: \"Mejorar\",\n    upgraded: \"Mejorado\",\n    \n\n    \n    // Portfolio\n    initialDeposit: \"Depósito Inicial\",\n    totalGainLoss: \"Ganancia/Pérdida Total\",\n    totalInvested: \"Total Invertido\",\n    availableCash: \"Efectivo Disponible\",\n    \n    // Authentication\n    signIn: \"Iniciar sesión en\",\n    signInDescription: \"Accede a tu plataforma de competición de trading simulado\",\n    welcomeBack: \"Bienvenido de Vuelta\",\n    signUp: \"Registrarse\",\n    dontHaveAccount: \"¿No tienes una cuenta?\",\n    emailAddress: \"Dirección de correo electrónico\",\n    password: \"Contraseña\",\n    enterEmail: \"Ingresa tu email\",\n    enterPassword: \"Ingresa tu contraseña\",\n    logIn: \"Iniciar sesión\",\n    loggingIn: \"Iniciando sesión...\",\n    \n    // Support\n    support: \"Soporte\",\n    helpCenter: \"Centro de Ayuda\",\n    faq: \"Preguntas Frecuentes\",\n    guides: \"Guías\",\n    contactUs: \"Contáctanos\",\n    \n    // Trading Actions\n    buy: \"Comprar\",\n    sell: \"Vender\",\n    buyStock: \"Comprar Acción\",\n    sellStock: \"Vender Acción\",\n    search: \"Buscar\",\n    searchStocks: \"Buscar acciones...\",\n    addToWatchlist: \"Agregar a Lista de Seguimiento\",\n    removeFromWatchlist: \"Quitar de Lista de Seguimiento\",\n    \n    // Dashboard & Portfolio\n    overview: \"Resumen\",\n    holdings: \"Tenencias\",\n    watchlist: \"Lista de Seguimiento\",\n    history: \"Historial\",\n    analytics: \"Análisis\",\n    totalPortfolioValue: \"Valor Total del Portafolio\",\n    dayChange: \"Cambio del Día\",\n    totalReturn: \"Retorno Total\",\n    totalReturnPercent: \"% Retorno Total\",\n    availableBalance: \"Balance Disponible\",\n    investedAmount: \"Cantidad Invertida\",\n    unrealizedGains: \"Ganancias No Realizadas\",\n    realizedGains: \"Ganancias Realizadas\",\n    \n    // Stock Information\n    symbol: \"Símbolo\",\n    company: \"Empresa\",\n    lastPrice: \"Último Precio\",\n    priceChange: \"Cambio de Precio\",\n    priceChangePercent: \"% Cambio de Precio\",\n    previousClose: \"Cierre Anterior\",\n    dayRange: \"Rango del Día\",\n    week52Range: \"Rango 52 Semanas\",\n    averageVolume: \"Volumen Promedio\",\n    marketCapitalization: \"Capitalización de Mercado\",\n    peRatio: \"Relación P/E\",\n    dividend: \"Dividendo\",\n    beta: \"Beta\",\n    \n    // Tournament Features\n    joinTournamentBtn: \"Unirse al Torneo\",\n    createTournamentBtn: \"Crear Torneo\",\n    tournamentName: \"Nombre del Torneo\",\n    startingBalance: \"Balance Inicial\",\n    endDate: \"Fecha de Finalización\",\n    buyIn: \"Entrada\",\n    prizePool: \"Pozo de Premios\",\n    status: \"Estado\",\n    rank: \"Posición\",\n    participantCount: \"Participantes\",\n    timeLeft: \"Tiempo Restante\",\n    tournamentRules: \"Reglas del Torneo\",\n    leaderboardPosition: \"Posición en la Clasificación\",\n    \n    // Account & Profile\n    profile: \"Perfil\",\n    account: \"Cuenta\",\n    profilePicture: \"Foto de Perfil\",\n    username: \"Nombre de Usuario\",\n    fullName: \"Nombre Completo\",\n    dateOfBirth: \"Fecha de Nacimiento\",\n    phoneNumber: \"Número de Teléfono\",\n    address: \"Dirección\",\n    city: \"Ciudad\",\n    state: \"Estado\",\n    postalCode: \"Código Postal\",\n    bio: \"Biografía\",\n    \n    // Financial Management\n    deposit: \"Depositar\",\n    withdraw: \"Retirar\",\n    transfer: \"Transferir\",\n    transaction: \"Transacción\",\n    transactions: \"Transacciones\",\n    amount: \"Cantidad\",\n    fee: \"Comisión\",\n    total: \"Total\",\n    processingTime: \"Tiempo de Procesamiento\",\n    bankAccount: \"Cuenta Bancaria\",\n    creditCard: \"Tarjeta de Crédito\",\n    paymentMethod: \"Método de Pago\",\n    siteCash: \"Efectivo del Sitio\",\n    \n    // Time & Dates\n    today: \"Hoy\",\n    yesterday: \"Ayer\",\n    thisWeek: \"Esta Semana\",\n    thisMonth: \"Este Mes\",\n    thisYear: \"Este Año\",\n    allTime: \"Todo el Tiempo\",\n    dateRange: \"Rango de Fechas\",\n    from: \"Desde\",\n    to: \"Hasta\",\n    \n    // Actions & Buttons\n    submit: \"Enviar\",\n    confirm: \"Confirmar\",\n    apply: \"Aplicar\",\n    reset: \"Restablecer\",\n    clear: \"Limpiar\",\n    refresh: \"Actualizar\",\n    update: \"Actualizar\",\n    create: \"Crear\",\n    join: \"Unirse\",\n    leave: \"Salir\",\n    close: \"Cerrar\",\n    open: \"Abrir\",\n    \n    // Status & Messages\n    active: \"Activo\",\n    inactive: \"Inactivo\",\n    completed: \"Completado\",\n    pending: \"Pendiente\",\n    processing: \"Procesando\",\n    approved: \"Aprobado\",\n    rejected: \"Rechazado\",\n    cancelled: \"Cancelado\",\n    expired: \"Expirado\",\n    \n    // Notifications & Alerts\n    notification: \"Notificación\",\n    notifications: \"Notificaciones\",\n    alert: \"Alerta\",\n    warning: \"Advertencia\",\n    info: \"Información\",\n    noData: \"No hay datos disponibles\",\n    noResults: \"No se encontraron resultados\",\n    searchNoResults: \"No se encontraron acciones que coincidan con tu búsqueda\",\n    \n    // Navigation & Layout\n    home: \"Inicio\",\n    hub: \"Centro\",\n    menu: \"Menú\",\n    sidebar: \"Barra Lateral\",\n    header: \"Encabezado\",\n    footer: \"Pie de Página\",\n    breadcrumb: \"Ruta de Navegación\",\n    pagination: \"Paginación\",\n    \n    // Forms & Validation\n    required: \"Requerido\",\n    optional: \"Opcional\",\n    invalid: \"Inválido\",\n    valid: \"Válido\",\n    pleaseEnter: \"Por favor ingresa\",\n    pleaseSelect: \"Por favor selecciona\",\n    fieldRequired: \"Este campo es requerido\",\n    invalidEmail: \"Dirección de correo inválida\",\n    passwordTooShort: \"Contraseña muy corta\",\n    \n    // Market Status\n    marketOpen: \"Mercado Abierto\",\n    marketClosed: \"Mercado Cerrado\",\n    marketHours: \"Horario del Mercado\",\n    afterHours: \"Fuera de Horario\",\n    preMarket: \"Previo al Mercado\",\n    tradingHalted: \"Trading Suspendido\",\n    \n    // Performance & Statistics\n    performance: \"Rendimiento\",\n    statistics: \"Estadísticas\",\n    winRate: \"Tasa de Ganancia\",\n    profitLoss: \"Ganancia/Pérdida\",\n    bestPerformance: \"Mejor Rendimiento\",\n    worstPerformance: \"Peor Rendimiento\",\n    averageReturn: \"Retorno Promedio\",\n    sharpeRatio: \"Ratio de Sharpe\",\n    volatility: \"Volatilidad\",\n    \n    // Social & Community\n    chat: \"Chat\",\n    message: \"Mensaje\",\n    send: \"Enviar\",\n    online: \"En Línea\",\n    offline: \"Desconectado\",\n    members: \"Miembros\",\n    community: \"Comunidad\",\n    social: \"Social\",\n    \n    // Help & Documentation\n    help: \"Ayuda\",\n    documentation: \"Documentación\",\n    tutorial: \"Tutorial\",\n    gettingStarted: \"Comenzando\",\n    userManual: \"Manual de Usuario\",\n    videoTutorials: \"Tutoriales en Video\",\n    \n    // Settings & Preferences\n    general: \"General\",\n    security: \"Seguridad\",\n    privacy: \"Privacidad\",\n    notificationsSettings: \"Notificaciones\",\n    appearance: \"Apariencia\",\n    theme: \"Tema\",\n    darkMode: \"Modo Oscuro\",\n    lightMode: \"Modo Claro\",\n    \n    // Subscription & Billing\n    subscription: \"Suscripción\",\n    billing: \"Facturación\",\n    plan: \"Plan\",\n    upgradeAccount: \"Mejorar\",\n    downgrade: \"Degradar\",\n    renew: \"Renovar\",\n    expire: \"Expirar\",\n    invoice: \"Factura\",\n    receipt: \"Recibo\",\n    \n    // Errors & Issues\n    errorOccurred: \"Ocurrió un error\",\n    tryAgain: \"Intentar nuevamente\",\n    contactSupport: \"Contactar soporte\",\n    pageNotFound: \"Página no encontrada\",\n    accessDenied: \"Acceso denegado\",\n    sessionExpired: \"Sesión expirada\",\n    connectionLost: \"Conexión perdida\",\n    \n    // Brand & Legal\n    brandName: \"ORSATH\",\n    tagline: \"Plataforma de competición de trading simulado para traders aspirantes\",\n    termsOfService: \"Términos de Servicio\",\n    privacyPolicy: \"Política de Privacidad\",\n    cookiePolicy: \"Política de Cookies\",\n    disclaimer: \"Descargo de Responsabilidad\",\n    \n    // Miscellaneous\n    more: \"Más\",\n    less: \"Menos\",\n    all: \"Todo\",\n    none: \"Ninguno\",\n    other: \"Otro\",\n    misc: \"Misceláneo\",\n    details: \"Detalles\",\n    summary: \"Resumen\",\n    advanced: \"Avanzado\",\n    basic: \"Básico\",\n    actions: \"Acciones\",\n    processing: \"Procesando...\",\n    totalValue: \"Valor Total\",\n    \n    // Greetings\n    goodMorning: \"Buenos Días\",\n    goodAfternoon: \"Buenas Tardes\",\n    goodEvening: \"Buenas Noches\",\n    \n    // Hub specific\n    hubWelcomeMessage: \"¿Listo para dejar tu marca en los mercados?\",\n    dashboardDescription: \"Accede a tu panel de trading personal\",\n    joinTournamentDescription: \"Compite contra traders de todo el mundo\",\n    leaderboardDescription: \"Ve dónde te encuentras globalmente\",\n    events: \"Eventos\",\n    \n    // Additional UI messages\n    startTradingMessage: \"Comienza a operar para ver tus posiciones aquí\",\n    addedToAccount: \"ha sido agregado a tu cuenta\",\n    withdrawnFromAccount: \"ha sido retirado de tu cuenta\",\n    enterUsername: \"Ingresa tu nombre de usuario\",\n    currentHoldings: \"Posiciones Actuales\",\n    adminRole: \"Administrador\",\n    supportTeam: \"Soporte\",\n    invalidShares: \"Por favor, ingresa un número válido de acciones\",\n    stockPurchased: \"Acción comprada\",\n    sharesUnit: \"acciones\",\n    sellPosition: \"Vender acción\",\n  },\n};\n\n// Currency configurations\nexport const currencies = {\n  USD: { symbol: '$', position: 'before', decimals: 2 },\n  BRL: { symbol: 'R$', position: 'before', decimals: 2 },\n  ARS: { symbol: '$', position: 'before', decimals: 2 },\n  MXN: { symbol: '$', position: 'before', decimals: 2 },\n  CAD: { symbol: 'C$', position: 'before', decimals: 2 },\n  COP: { symbol: '$', position: 'before', decimals: 2 },\n  CLP: { symbol: '$', position: 'before', decimals: 0 },\n  PEN: { symbol: 'S/', position: 'before', decimals: 2 },\n  UYU: { symbol: '$U', position: 'before', decimals: 2 },\n  EUR: { symbol: '€', position: 'after', decimals: 2 },\n};\n\ninterface UserPreferencesContextType {\n  language: string;\n  currency: string;\n  t: (key: string) => string;\n  formatCurrency: (amount: number, sourceCurrency?: string) => string;\n  convertAndFormatCurrency: (amount: number, sourceCurrency: string) => string;\n  exchangeRates: Record<string, number>;\n  updatePreferences: (language?: string, currency?: string) => Promise<void>;\n}\n\nconst UserPreferencesContext = createContext<UserPreferencesContextType | undefined>(undefined);\n\ninterface UserPreferencesProviderProps {\n  children: ReactNode;\n}\n\nexport function UserPreferencesProvider({ children }: UserPreferencesProviderProps) {\n  const { user } = useAuth();\n  const [language, setLanguage] = useState<string>('English');\n  const [currency, setCurrency] = useState<string>('USD');\n  const [exchangeRates, setExchangeRates] = useState<Record<string, number>>({});\n\n  // Initialize preferences from user data\n  useEffect(() => {\n    if (user) {\n      setLanguage(user.language || 'English');\n      setCurrency(user.currency || 'USD');\n    }\n  }, [user]);\n\n  // Fetch exchange rates when currency changes\n  useEffect(() => {\n    const fetchExchangeRates = async () => {\n      if (currency !== 'USD') {\n        try {\n          const response = await fetch(`/api/exchange-rates/USD`);\n          if (response.ok) {\n            const data = await response.json();\n            setExchangeRates(data.data.rates || {});\n          }\n        } catch (error) {\n          console.error('Error fetching exchange rates:', error);\n          setExchangeRates({});\n        }\n      } else {\n        setExchangeRates({});\n      }\n    };\n\n    fetchExchangeRates();\n  }, [currency]);\n\n  // Translation function\n  const t = (key: string): string => {\n    const langTranslations = translations[language as keyof typeof translations] || translations.English;\n    return langTranslations[key as keyof typeof langTranslations] || key;\n  };\n\n  // Currency formatting function (backwards compatible)\n  const formatCurrency = (amount: number, sourceCurrency: string = 'USD'): string => {\n    // Convert amount if needed\n    let convertedAmount = amount;\n    if (sourceCurrency !== currency && exchangeRates[currency]) {\n      convertedAmount = amount * exchangeRates[currency];\n    }\n    \n    const currencyConfig = currencies[currency as keyof typeof currencies] || currencies.USD;\n    const formatted = convertedAmount.toLocaleString('en-US', {\n      minimumFractionDigits: currencyConfig.decimals,\n      maximumFractionDigits: currencyConfig.decimals,\n    });\n    \n    if (currencyConfig.position === 'before') {\n      return `${currencyConfig.symbol}${formatted}`;\n    } else {\n      return `${formatted}${currencyConfig.symbol}`;\n    }\n  };\n\n  // Convert and format currency function\n  const convertAndFormatCurrency = (amount: number, sourceCurrency: string): string => {\n    return formatCurrency(amount, sourceCurrency);\n  };\n\n  // Update preferences function\n  const updatePreferences = async (newLanguage?: string, newCurrency?: string) => {\n    if (!user) return;\n\n    const updates: any = {};\n    if (newLanguage && newLanguage !== language) {\n      updates.language = newLanguage;\n    }\n    if (newCurrency && newCurrency !== currency) {\n      updates.currency = newCurrency;\n    }\n\n    if (Object.keys(updates).length > 0) {\n      try {\n        const response = await fetch('/api/user/preferences', {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(updates),\n        });\n\n        if (!response.ok) {\n          throw new Error('Failed to update preferences');\n        }\n\n        // Update state after successful API call\n        if (newLanguage) setLanguage(newLanguage);\n        if (newCurrency) setCurrency(newCurrency);\n      } catch (error) {\n        console.error('Error updating preferences:', error);\n        throw error; // Propagate error to caller\n      }\n    }\n  };\n\n  const value: UserPreferencesContextType = {\n    language,\n    currency,\n    t,\n    formatCurrency,\n    convertAndFormatCurrency,\n    exchangeRates,\n    updatePreferences,\n  };\n\n  return (\n    <UserPreferencesContext.Provider value={value}>\n      {children}\n    </UserPreferencesContext.Provider>\n  );\n}\n\nexport function useUserPreferences(): UserPreferencesContextType {\n  const context = useContext(UserPreferencesContext);\n  if (context === undefined) {\n    throw new Error('useUserPreferences must be used within a UserPreferencesProvider');\n  }\n  return context;\n}","size_bytes":37155},"client/src/hooks/use-auth.tsx":{"content":"import { createContext, ReactNode, useContext } from \"react\";\nimport {\n  useQuery,\n  useMutation,\n  UseMutationResult,\n} from \"@tanstack/react-query\";\nimport { User, LoginUser, RegisterUser } from \"@shared/schema\";\nimport { apiRequest } from \"../lib/queryClient\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\n\ntype AuthContextType = {\n  user: User | null;\n  isLoading: boolean;\n  error: Error | null;\n  loginMutation: UseMutationResult<User, Error, LoginUser>;\n  logoutMutation: UseMutationResult<void, Error, void>;\n  registerMutation: UseMutationResult<User, Error, RegisterUser>;\n};\n\nexport const AuthContext = createContext<AuthContextType | null>(null);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, navigate] = useLocation();\n  \n  const {\n    data: user,\n    error,\n    isLoading,\n  } = useQuery<User | undefined, Error>({\n    queryKey: [\"/api/user\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/user\");\n      if (res.status === 401) {\n        return null;\n      }\n      if (!res.ok) {\n        throw new Error(\"Failed to fetch user\");\n      }\n      return res.json();\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (credentials: LoginUser) => {\n      const res = await apiRequest(\"POST\", \"/api/login\", credentials);\n      return await res.json();\n    },\n    onSuccess: (user: User) => {\n      queryClient.setQueryData([\"/api/user\"], user);\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      toast({\n        title: \"Welcome back!\",\n        description: `Good to see you again, ${user.username || user.email}`,\n      });\n      navigate(\"/dashboard\");\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Login failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: async (credentials: RegisterUser) => {\n      const res = await apiRequest(\"POST\", \"/api/register\", credentials);\n      return await res.json();\n    },\n    onSuccess: (user: User) => {\n      queryClient.setQueryData([\"/api/user\"], user);\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      toast({\n        title: \"Account created!\",\n        description: `Welcome to ORSATH, ${user.name}`,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Registration failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      await apiRequest(\"POST\", \"/api/logout\");\n    },\n    onSuccess: () => {\n      queryClient.setQueryData([\"/api/user\"], null);\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      toast({\n        title: \"Logged out\",\n        description: \"You have been logged out successfully\",\n      });\n      // Navigate to home page after logout\n      navigate(\"/\");\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Logout failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user: user ?? null,\n        isLoading,\n        error,\n        loginMutation,\n        logoutMutation,\n        registerMutation,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}","size_bytes":3719},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-theme.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ntype ThemeProviderProps = {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n  storageKey?: string;\n};\n\ntype ThemeProviderState = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n};\n\nconst initialState: ThemeProviderState = {\n  theme: \"dark\",\n  setTheme: () => null,\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"light\",\n  storageKey = \"orsath-ui-theme\",\n  ...props\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\"dark\");\n\n  useEffect(() => {\n    const root = window.document.documentElement;\n\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(\"dark\");\n  }, []);\n\n  const value = {\n    theme,\n    setTheme: (theme: Theme) => {\n      localStorage.setItem(storageKey, theme);\n      setTheme(theme);\n    },\n  };\n\n  return (\n    <ThemeProviderContext.Provider {...props} value={value}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n\n  return context;\n};","size_bytes":1300},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/hooks/useAuth.ts":{"content":"export function useAuth() {\n  // Simulate authentication state based on localStorage\n  const authData = localStorage.getItem('orsath_auth');\n  const isAuthenticated = authData === 'true';\n  \n  const mockUser = isAuthenticated ? {\n    id: '1',\n    username: 'alex_thompson',\n    email: 'alex.thompson@email.com',\n    profileImageUrl: null\n  } : null;\n\n  return {\n    user: mockUser,\n    isLoading: false,\n    isAuthenticated,\n  };\n}\n","size_bytes":432},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"client/src/lib/protected-route.tsx":{"content":"import { useAuth } from \"@/hooks/use-auth\";\nimport { Loader2 } from \"lucide-react\";\nimport { Redirect, Route } from \"wouter\";\n\nexport function ProtectedRoute({\n  path,\n  component: Component,\n}: {\n  path: string;\n  component: () => React.JSX.Element;\n}) {\n  const { user, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <Route path={path}>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-gray-500\" />\n        </div>\n      </Route>\n    );\n  }\n\n  if (!user) {\n    return (\n      <Route path={path}>\n        <Redirect to=\"/auth\" />\n      </Route>\n    );\n  }\n\n  return <Route path={path} component={Component} />;\n}","size_bytes":707},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/about.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Award, Brain, TrendingUp, Users } from \"lucide-react\";\n\nconst founders = [\n  {\n    name: \"Marcus Orellana\",\n    role: \"CEO & Chief Investment Officer\",\n    description: \"Former Goldman Sachs analyst with 15+ years in qualitative research. Specializes in technology and healthcare sectors.\",\n    expertise: [\"Tech Analysis\", \"Healthcare\", \"M&A Research\"]\n  },\n  {\n    name: \"Isabella Santos\",\n    role: \"CTO & Head of Research\",\n    description: \"Previously at McKinsey & Company, leading digital transformation in financial services. Expert in emerging markets analysis.\",\n    expertise: [\"Emerging Markets\", \"Digital Finance\", \"ESG Analysis\"]\n  },\n  {\n    name: \"Alexander Thompson\",\n    role: \"Head of Client Relations\",\n    description: \"Former institutional sales director at Morgan Stanley. Focused on building long-term client relationships and custom research solutions.\",\n    expertise: [\"Institutional Sales\", \"Client Strategy\", \"Custom Research\"]\n  }\n];\n\nconst values = [\n  {\n    icon: <Brain className=\"w-8 h-8\" />,\n    title: \"Qualitative Focus\",\n    description: \"We believe the best investment decisions come from understanding the human factors behind market movements, not just the numbers.\"\n  },\n  {\n    icon: <TrendingUp className=\"w-8 h-8\" />,\n    title: \"Independent Research\",\n    description: \"Our research is completely independent, unbiased, and focused solely on providing value to our subscribers.\"\n  },\n  {\n    icon: <Users className=\"w-8 h-8\" />,\n    title: \"Client-Centric\",\n    description: \"Every piece of research is designed with our clients' investment success in mind, delivered with clarity and actionable insights.\"\n  },\n  {\n    icon: <Award className=\"w-8 h-8\" />,\n    title: \"Excellence Standard\",\n    description: \"We maintain the highest standards in research quality, ensuring every analysis meets institutional-grade requirements.\"\n  }\n];\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function About() {\n  return (\n    <div className=\"min-h-screen bg-white\">\n      {/* Hero Section */}\n      <motion.section \n        className=\"py-20 px-4\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-4xl mx-auto text-center\">\n          <motion.h1 \n            className=\"text-4xl md:text-5xl font-bold mb-6 text-black\"\n            variants={fadeInUp}\n          >\n            About ORSATH\n          </motion.h1>\n          <motion.p \n            className=\"text-xl text-gray-600 mb-8 max-w-2xl mx-auto\"\n            variants={fadeInUp}\n          >\n            Founded by three high school juniors with a passion for qualitative investment research, ORSATH represents the next generation of financial analysis.\n          </motion.p>\n        </div>\n      </motion.section>\n\n      {/* Mission Section */}\n      <motion.section \n        className=\"py-16 px-4 bg-gray-50\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-6xl mx-auto\">\n          <motion.div className=\"text-center mb-12\" variants={fadeInUp}>\n            <h2 className=\"text-3xl font-bold mb-6 text-black\">Our Mission</h2>\n            <p className=\"text-lg text-gray-600 max-w-3xl mx-auto\">\n              To democratize access to institutional-quality investment research by focusing on the qualitative factors that drive market success. We believe that understanding the human elements behind financial decisions is key to superior investment outcomes.\n            </p>\n          </motion.div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {values.map((value, index) => (\n              <motion.div key={index} variants={fadeInUp}>\n                <Card className=\"h-full border-0 bg-white shadow-lg hover:shadow-xl transition-shadow duration-300\">\n                  <CardHeader className=\"text-center pb-4\">\n                    <div className=\"flex justify-center mb-4\">\n                      <div className=\"p-3 rounded-full bg-black text-white\">\n                        {value.icon}\n                      </div>\n                    </div>\n                    <CardTitle className=\"text-xl font-bold text-black\">\n                      {value.title}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <p className=\"text-gray-600 text-center\">{value.description}</p>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </motion.section>\n\n      {/* Team Section */}\n      <motion.section \n        className=\"py-20 px-4\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-6xl mx-auto\">\n          <motion.div className=\"text-center mb-16\" variants={fadeInUp}>\n            <h2 className=\"text-3xl font-bold mb-6 text-black\">Meet the Founders</h2>\n            <p className=\"text-lg text-gray-600 max-w-2xl mx-auto\">\n              Three ambitious students combining traditional investment principles with modern analytical techniques.\n            </p>\n          </motion.div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            {founders.map((founder, index) => (\n              <motion.div key={index} variants={fadeInUp}>\n                <Card className=\"h-full border-2 border-gray-200 hover:border-black transition-colors duration-300\">\n                  <CardHeader className=\"text-center pb-4\">\n                    <div className=\"w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center\">\n                      <Users className=\"w-12 h-12 text-gray-400\" />\n                    </div>\n                    <CardTitle className=\"text-xl font-bold text-black\">\n                      {founder.name}\n                    </CardTitle>\n                    <CardDescription className=\"text-gray-600 font-medium\">\n                      {founder.role}\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <p className=\"text-gray-600 mb-4\">{founder.description}</p>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {founder.expertise.map((skill, skillIndex) => (\n                        <Badge key={skillIndex} variant=\"secondary\" className=\"bg-gray-100\">\n                          {skill}\n                        </Badge>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </motion.section>\n\n      {/* Stats Section */}\n      <motion.section \n        className=\"py-16 px-4 bg-black text-white\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-6xl mx-auto\">\n          <motion.div className=\"text-center mb-12\" variants={fadeInUp}>\n            <h2 className=\"text-3xl font-bold mb-6\">Our Impact</h2>\n            <p className=\"text-xl text-gray-300\">\n              Building the future of investment research, one analysis at a time.\n            </p>\n          </motion.div>\n\n          <div className=\"grid md:grid-cols-4 gap-8 text-center\">\n            <motion.div variants={fadeInUp}>\n              <div className=\"text-4xl font-bold mb-2\">500+</div>\n              <div className=\"text-gray-300\">Research Studies</div>\n            </motion.div>\n            <motion.div variants={fadeInUp}>\n              <div className=\"text-4xl font-bold mb-2\">10k+</div>\n              <div className=\"text-gray-300\">Active Subscribers</div>\n            </motion.div>\n            <motion.div variants={fadeInUp}>\n              <div className=\"text-4xl font-bold mb-2\">95%</div>\n              <div className=\"text-gray-300\">Client Satisfaction</div>\n            </motion.div>\n            <motion.div variants={fadeInUp}>\n              <div className=\"text-4xl font-bold mb-2\">24/7</div>\n              <div className=\"text-gray-300\">Research Coverage</div>\n            </motion.div>\n          </div>\n        </div>\n      </motion.section>\n    </div>\n  );\n}","size_bytes":8604},"client/src/pages/admin.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { UserManagementDialog } from \"@/components/admin/UserManagementDialog\";\nimport { \n  Shield, \n  Users, \n  Crown, \n  Calendar, \n  Mail,\n  AlertCircle,\n  Settings,\n  Trash2,\n  MoreHorizontal,\n  Eye,\n  Edit,\n  UserPlus,\n  Server,\n  Activity,\n  Globe,\n  Database,\n  Clock,\n  AlertTriangle,\n  Trophy,\n  GamepadIcon,\n  DollarSign,\n  RefreshCw\n} from \"lucide-react\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Admin() {\n  const { user, isLoading: authLoading } = useAuth();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [deleteState, setDeleteState] = useState<{\n    userEmail: string | null;\n    step: 'first' | 'second' | null;\n  }>({\n    userEmail: null,\n    step: null,\n  });\n\n  const [selectedUser, setSelectedUser] = useState<any>(null);\n  const [userManagementOpen, setUserManagementOpen] = useState(false);\n  const [activeTab, setActiveTab] = useState(\"users\");\n  const [selectedTournament, setSelectedTournament] = useState<any>(null);\n  const [endTournamentOpen, setEndTournamentOpen] = useState(false);\n\n  // Check if user is admin (based on subscription tier)\n  const isAdmin = user?.subscriptionTier === 'administrator';\n\n  // Redirect if not admin\n  useEffect(() => {\n    if (!authLoading && (!user || !isAdmin)) {\n      toast({\n        title: \"Access Denied\",\n        description: \"You don't have permission to access this page.\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/dashboard\");\n    }\n  }, [user, isAdmin, authLoading, toast, setLocation]);\n\n  // Fetch all users (only if admin)\n  const { data: allUsers = [], isLoading: usersLoading, refetch: refetchUsers } = useQuery<any[]>({\n    queryKey: [\"/api/admin/users\"],\n    enabled: isAdmin,\n    staleTime: 0, // Always refetch for fresh balance data\n    gcTime: 0, // Don't cache balance data (renamed from cacheTime in v5)\n  });\n\n  // Fetch system status\n  const { data: systemStatus = {}, isLoading: systemLoading } = useQuery<any>({\n    queryKey: [\"/api/system/status\"],\n    enabled: isAdmin,\n    refetchInterval: 15000, // Refresh every 15 seconds to show Yahoo Finance updates\n  });\n\n  // Fetch all tournaments\n  const { data: tournamentData = {}, isLoading: tournamentsLoading } = useQuery<any>({\n    queryKey: [\"/api/admin/tournaments\"],\n    enabled: isAdmin,\n  });\n\n  // Extract tournaments from the response data\n  const allTournaments = Array.isArray(tournamentData) ? tournamentData : (tournamentData as any)?.data || [];\n\n  // Delete user mutation\n  const deleteMutation = useMutation({\n    mutationFn: async (email: string) => {\n      await apiRequest(\"DELETE\", `/api/admin/users/${email}`);\n    },\n    onSuccess: (_, deletedEmail) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      setDeleteState({ userEmail: null, step: null });\n      toast({\n        title: \"User deleted\",\n        description: `User ${deletedEmail} has been successfully deleted.`,\n        variant: \"default\",\n      });\n    },\n    onError: (error: Error) => {\n      if (error.message.includes(\"401\")) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n\n\n  // Handle delete confirmation\n  const handleDeleteConfirm = () => {\n    if (deleteState.userEmail) {\n      deleteMutation.mutate(deleteState.userEmail);\n    }\n  };\n\n  // Handle delete initiation\n  const handleDeleteUser = (email: string) => {\n    setDeleteState({ userEmail: email, step: 'first' });\n  };\n\n  // Handle manage user\n  const handleManageUser = (user: any) => {\n    setSelectedUser(user);\n    setUserManagementOpen(true);\n  };\n\n  // Handle tournament actions\n  const handleViewTournamentDetails = (tournament: any) => {\n    const timeLeft = new Date(tournament.endsAt).getTime() - new Date().getTime();\n    const isActive = timeLeft > 0;\n    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));\n    \n    const timeDisplay = isActive \n      ? `${days > 0 ? days + 'd ' : ''}${hours > 0 ? hours + 'h ' : ''}${minutes}m remaining`\n      : 'Tournament ended';\n    \n    toast({\n      title: `Tournament: ${tournament.name}`,\n      description: `Code: ${tournament.code} | ${tournament.memberCount} participants | ${timeDisplay} | Starting Balance: $${tournament.startingBalance}`,\n      duration: 5000,\n    });\n  };\n\n  const handleViewTournamentParticipants = async (tournament: any) => {\n    try {\n      const response = await fetch(`/api/tournaments/${tournament.id}/participants`, {\n        credentials: 'include',\n      });\n      const data = await response.json();\n      \n      if (data.success) {\n        const participantNames = data.data.map((p: any) => `${p.firstName} ${p.lastName}`).join(', ');\n        toast({\n          title: `${tournament.name} Participants (${tournament.memberCount})`,\n          description: participantNames || 'No participants yet',\n          duration: 8000,\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: \"Failed to load participants\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to load participants\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleDeleteTournament = (tournament: any) => {\n    setSelectedTournament(tournament);\n    setEndTournamentOpen(true);\n  };\n\n  const confirmDeleteTournament = async () => {\n    if (!selectedTournament) return;\n    \n    try {\n      const response = await apiRequest('DELETE', `/api/admin/tournaments/${selectedTournament.id}`);\n      const data = await response.json();\n      \n      if (data.success) {\n        toast({\n          title: \"Tournament Deleted\",\n          description: data.message,\n          variant: \"default\",\n        });\n        \n        // Refresh the tournaments list\n        queryClient.invalidateQueries({ queryKey: [\"/api/admin/tournaments\"] });\n        setEndTournamentOpen(false);\n        setSelectedTournament(null);\n      } else {\n        toast({\n          title: \"Error\",\n          description: data.message || \"Failed to delete tournament\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete tournament\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Show loading state\n  if (authLoading || usersLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-black\"></div>\n      </div>\n    );\n  }\n\n  // Don't render anything if not admin (redirect will happen in useEffect)\n  if (!isAdmin) {\n    return null;\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto p-8\">\n      <motion.div\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n        className=\"space-y-8\"\n      >\n        {/* Header */}\n        <motion.div variants={fadeInUp} className=\"text-center\">\n          <h1 className=\"text-4xl font-bold mb-4\">Admin Dashboard</h1>\n          <p className=\"text-gray-600\">Comprehensive user management and system administration</p>\n        </motion.div>\n\n        {/* Admin Tabs */}\n        <motion.div variants={fadeInUp}>\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\n            <TabsList className=\"grid w-full grid-cols-3\">\n              <TabsTrigger value=\"users\">User Management</TabsTrigger>\n              <TabsTrigger value=\"tournaments\">Tournament Management</TabsTrigger>\n              <TabsTrigger value=\"system\">System Status</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"users\" className=\"space-y-6\">\n              {/* User Stats */}\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Total Users</CardTitle>\n                    <Users className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{allUsers.length || 0}</div>\n                    <p className=\"text-xs text-gray-500\">Registered accounts</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Admin Users</CardTitle>\n                    <Crown className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {allUsers?.filter((u: any) => u.subscriptionTier === 'administrator').length || 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">System administrators</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Users</CardTitle>\n                    <Activity className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {allUsers.length || 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">Platform users</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Administrators</CardTitle>\n                    <Crown className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {allUsers.filter((u: any) => u.subscriptionTier === 'administrator').length || 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">Admin accounts</p>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Users Table */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"h-5 w-5\" />\n                    User Management\n                  </CardTitle>\n                  <CardDescription>\n                    Manage user accounts and permissions\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead className=\"w-24\">User ID</TableHead>\n                        <TableHead className=\"w-32\">Username</TableHead>\n                        <TableHead className=\"w-64\">Email</TableHead>\n                        <TableHead className=\"w-24\">Balance</TableHead>\n                        <TableHead className=\"w-28\">Created</TableHead>\n                        <TableHead className=\"w-20\">Role</TableHead>\n                        <TableHead className=\"w-20\">Actions</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {usersLoading ? (\n                        <TableRow>\n                          <TableCell colSpan={7} className=\"text-center py-8\">\n                            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n                            <p className=\"mt-2 text-sm text-muted-foreground\">Loading users...</p>\n                          </TableCell>\n                        </TableRow>\n                      ) : allUsers.map((user: any) => (\n                        <TableRow key={user.id}>\n                          <TableCell>\n                            <div className=\"flex items-center gap-2\">\n                              {user.subscriptionTier === 'administrator' && (\n                                <Crown className=\"h-4 w-4 text-yellow-500\" />\n                              )}\n                              <span className=\"font-mono text-sm\">{user.id}</span>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"font-medium\">{user.username}</div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"text-sm\" title={user.email}>\n                              {user.email}\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex items-center gap-1\">\n                              <DollarSign className=\"h-3 w-3 text-green-600\" />\n                              <span className=\"font-mono text-sm\">\n                                ${parseFloat(user.siteCash || \"0\").toLocaleString()}\n                              </span>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"text-sm text-muted-foreground\">\n                              {user.createdAt ? new Date(user.createdAt).toLocaleDateString() : '-'}\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <Badge variant={user.subscriptionTier === 'administrator' ? 'default' : 'secondary'}>\n                              {user.subscriptionTier === 'administrator' ? 'Admin' : 'User'}\n                            </Badge>\n                          </TableCell>\n                          <TableCell>\n                            <Button \n                              variant=\"ghost\" \n                              size=\"sm\"\n                              onClick={() => handleManageUser(user)}\n                            >\n                              <Settings className=\"h-4 w-4\" />\n                            </Button>\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            <TabsContent value=\"tournaments\" className=\"space-y-6\">\n              {/* Tournament Stats */}\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Total Tournaments</CardTitle>\n                    <Trophy className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{allTournaments.length || 0}</div>\n                    <p className=\"text-xs text-gray-500\">Active competitions</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Players</CardTitle>\n                    <GamepadIcon className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {allTournaments.reduce((total: number, tournament: any) => total + (tournament.memberCount || 0), 0) || 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">Tournament participants</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Avg. Players</CardTitle>\n                    <Users className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {allTournaments.length ? Math.round((allTournaments.reduce((total: number, tournament: any) => total + (tournament.memberCount || 0), 0) || 0) / allTournaments.length) : 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">Players per tournament</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Tournaments</CardTitle>\n                    <Activity className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {allTournaments.filter((t: any) => new Date(t.endsAt) > new Date()).length || 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">Still running</p>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Tournaments Table */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Trophy className=\"h-5 w-5\" />\n                    Tournament Management\n                  </CardTitle>\n                  <CardDescription>\n                    Manage active tournaments and competitions\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {tournamentsLoading ? (\n                      <div className=\"text-center py-8\">\n                        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto\"></div>\n                        <p className=\"mt-2 text-sm text-gray-600\">Loading tournaments...</p>\n                      </div>\n                    ) : (\n                      <div className=\"rounded-lg border\">\n                        <div className=\"grid grid-cols-6 gap-4 p-4 border-b bg-gray-50 dark:bg-gray-800 font-semibold\">\n                          <div>Tournament ID</div>\n                          <div>Name</div>\n                          <div>Members</div>\n                          <div>Time Left</div>\n                          <div>Status</div>\n                          <div>Actions</div>\n                        </div>\n                        <div className=\"divide-y\">\n                          {allTournaments?.map((tournament) => {\n                            const timeLeft = new Date(tournament.endsAt).getTime() - new Date().getTime();\n                            const isActive = timeLeft > 0;\n                            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));\n                            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n                            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));\n                            \n                            return (\n                              <div key={tournament.id} className=\"grid grid-cols-6 gap-4 p-4 items-center\">\n                                <div className=\"flex items-center gap-2\">\n                                  <Badge variant=\"secondary\">\n                                    <Trophy className=\"h-3 w-3 mr-1\" />\n                                    {tournament.id}\n                                  </Badge>\n                                </div>\n                                <div>\n                                  <div className=\"font-medium\">{tournament.name}</div>\n                                  <div className=\"text-sm text-gray-500\">Code: {tournament.code}</div>\n                                </div>\n                                <div>\n                                  <Badge variant=\"outline\" className=\"text-blue-600\">\n                                    <Users className=\"h-3 w-3 mr-1\" />\n                                    {tournament.memberCount}\n                                  </Badge>\n                                </div>\n                                <div>\n                                  {isActive ? (\n                                    <div className=\"text-sm\">\n                                      <div className=\"font-medium\">\n                                        {days > 0 ? `${days}d ` : ''}\n                                        {hours > 0 ? `${hours}h ` : ''}\n                                        {minutes}m\n                                      </div>\n                                      <div className=\"text-gray-500\">remaining</div>\n                                    </div>\n                                  ) : (\n                                    <div className=\"text-sm text-gray-500\">\n                                      <div className=\"font-medium\">Ended</div>\n                                      <div>{new Date(tournament.endsAt).toLocaleDateString()}</div>\n                                    </div>\n                                  )}\n                                </div>\n                                <div>\n                                  <Badge variant=\"outline\" className={isActive ? \"text-green-600\" : \"text-red-600\"}>\n                                    <Clock className=\"h-3 w-3 mr-1\" />\n                                    {isActive ? 'Active' : 'Ended'}\n                                  </Badge>\n                                </div>\n                                <div>\n                                  <DropdownMenu>\n                                    <DropdownMenuTrigger asChild>\n                                      <Button variant=\"ghost\" size=\"sm\">\n                                        <MoreHorizontal className=\"h-4 w-4\" />\n                                      </Button>\n                                    </DropdownMenuTrigger>\n                                    <DropdownMenuContent align=\"end\">\n                                      <DropdownMenuItem onClick={() => handleViewTournamentDetails(tournament)}>\n                                        <Eye className=\"h-4 w-4 mr-2\" />\n                                        View Details\n                                      </DropdownMenuItem>\n                                      <DropdownMenuItem onClick={() => handleViewTournamentParticipants(tournament)}>\n                                        <Users className=\"h-4 w-4 mr-2\" />\n                                        View Participants\n                                      </DropdownMenuItem>\n                                      <DropdownMenuSeparator />\n                                      <DropdownMenuItem\n                                        onClick={() => handleDeleteTournament(tournament)}\n                                        className=\"text-red-600 hover:text-red-700\"\n                                      >\n                                        <Trash2 className=\"h-4 w-4 mr-2\" />\n                                        Delete Tournament\n                                      </DropdownMenuItem>\n                                    </DropdownMenuContent>\n                                  </DropdownMenu>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            <TabsContent value=\"system\" className=\"space-y-6\">\n              {/* System Status */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Server className=\"h-5 w-5\" />\n                    System Status\n                  </CardTitle>\n                  <CardDescription>\n                    Monitor system health and performance metrics\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  {systemLoading ? (\n                    <div className=\"text-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto\"></div>\n                      <p className=\"mt-2 text-sm text-gray-600\">Loading system status...</p>\n                    </div>\n                  ) : (\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                      <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold\">Database</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Status</span>\n                            <Badge variant=\"outline\" className={(systemStatus as any)?.database?.connected ? \"text-green-600\" : \"text-red-600\"}>\n                              <Database className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.database?.connected ? \"Connected\" : \"Disconnected\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Type</span>\n                            <Badge variant=\"outline\">{(systemStatus as any)?.database?.type || \"PostgreSQL\"}</Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Tables</span>\n                            <Badge variant=\"outline\">{(systemStatus as any)?.database?.tableCount || \"0\"}</Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Connections</span>\n                            <Badge variant=\"outline\">{(systemStatus as any)?.database?.activeConnections || \"0\"}</Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold\">API Services</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Yahoo Finance</span>\n                            <Badge variant=\"outline\" className={(systemStatus as any)?.apis?.yahooFinance?.status ? \"text-green-600\" : \"text-red-600\"}>\n                              <Globe className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.apis?.yahooFinance?.status ? \"Active\" : \"Inactive\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Finnhub</span>\n                            <Badge variant=\"outline\" className={(systemStatus as any)?.apis?.finnhub?.status ? \"text-green-600\" : (systemStatus as any)?.apis?.finnhub?.keyExists ? \"text-yellow-600\" : \"text-gray-600\"}>\n                              <Globe className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.apis?.finnhub?.status ? \"Active\" : (systemStatus as any)?.apis?.finnhub?.keyExists ? \"Key Found\" : \"No Key\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Twelve Data</span>\n                            <Badge variant=\"outline\" className={(systemStatus as any)?.apis?.twelveData?.status ? \"text-green-600\" : (systemStatus as any)?.apis?.twelveData?.keyExists ? \"text-yellow-600\" : \"text-gray-600\"}>\n                              <Globe className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.apis?.twelveData?.status ? \"Active\" : (systemStatus as any)?.apis?.twelveData?.keyExists ? \"Key Found\" : \"No Key\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Polygon</span>\n                            <Badge variant=\"outline\" className={(systemStatus as any)?.apis?.polygon?.status ? \"text-green-600\" : (systemStatus as any)?.apis?.polygon?.keyExists ? \"text-yellow-600\" : \"text-gray-600\"}>\n                              <Globe className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.apis?.polygon?.status ? \"Active\" : (systemStatus as any)?.apis?.polygon?.keyExists ? \"Key Found\" : \"No Key\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Cache</span>\n                            <Badge variant=\"outline\" className={(systemStatus as any)?.apis?.cache?.enabled ? \"text-green-600\" : \"text-red-600\"}>\n                              <Settings className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.apis?.cache?.enabled ? \"Enabled\" : \"Disabled\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Active Users</span>\n                            <Badge variant=\"outline\" className=\"text-blue-600\">\n                              <Users className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.system?.activeUsers || \"0\"}\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold\">System Health</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Uptime</span>\n                            <Badge variant=\"outline\" className=\"text-green-600\">\n                              <Clock className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.system?.uptime || \"0m\"}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Error Rate</span>\n                            <Badge variant=\"outline\" className={((systemStatus as any)?.system?.errorRate || 0) > 5 ? \"text-red-600\" : \"text-green-600\"}>\n                              <AlertTriangle className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.system?.errorRate || \"0\"}%\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Response Time</span>\n                            <Badge variant=\"outline\" className={((systemStatus as any)?.system?.avgResponseTime || 0) > 1000 ? \"text-red-600\" : \"text-green-600\"}>\n                              <Activity className=\"h-3 w-3 mr-1\" />\n                              {(systemStatus as any)?.system?.avgResponseTime || \"0\"}ms\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Total Requests</span>\n                            <Badge variant=\"outline\" className=\"text-blue-600\">\n                              <Activity className=\"h-3 w-3 mr-1\" />\n                              {systemStatus?.system?.totalRequests || \"0\"}\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* IT Administration */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Settings className=\"h-5 w-5\" />\n                    IT Administration\n                  </CardTitle>\n                  <CardDescription>\n                    System configuration and administrative tools\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"space-y-4\">\n                      <h3 className=\"font-semibold\">Quick Actions</h3>\n                      <div className=\"space-y-2\">\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Database className=\"h-4 w-4 mr-2\" />\n                          Database Backup\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Settings className=\"h-4 w-4 mr-2\" />\n                          Clear Cache\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Activity className=\"h-4 w-4 mr-2\" />\n                          System Restart\n                        </Button>\n                      </div>\n                    </div>\n                    <div className=\"space-y-4\">\n                      <h3 className=\"font-semibold\">Monitoring</h3>\n                      <div className=\"space-y-2\">\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Eye className=\"h-4 w-4 mr-2\" />\n                          View Logs\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <AlertTriangle className=\"h-4 w-4 mr-2\" />\n                          Error Reports\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Activity className=\"h-4 w-4 mr-2\" />\n                          Performance Metrics\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            <TabsContent value=\"system\" className=\"space-y-6\">\n              {/* System Status */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Server className=\"h-5 w-5\" />\n                    System Status\n                  </CardTitle>\n                  <CardDescription>\n                    Monitor system health and performance metrics\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  {systemLoading ? (\n                    <div className=\"text-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto\"></div>\n                      <p className=\"mt-2 text-sm text-gray-600\">Loading system status...</p>\n                    </div>\n                  ) : (\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                      <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold\">Database</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Status:</span>\n                            <Badge variant=\"outline\" className=\"text-green-600\">\n                              <Database className=\"h-3 w-3 mr-1\" />\n                              Connected\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Type:</span>\n                            <Badge variant=\"outline\">PostgreSQL</Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Tables:</span>\n                            <Badge variant=\"outline\">10</Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Active Connections:</span>\n                            <Badge variant=\"outline\">2</Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold\">APIs</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Yahoo Finance:</span>\n                            <Badge variant=\"outline\" className=\"text-green-600\">\n                              <Activity className=\"h-3 w-3 mr-1\" />\n                              Active\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Cache:</span>\n                            <Badge variant=\"outline\" className=\"text-green-600\">\n                              <Database className=\"h-3 w-3 mr-1\" />\n                              Enabled\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold\">Performance</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Active Users:</span>\n                            <Badge variant=\"outline\">{allUsers.length}</Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Total Tournaments:</span>\n                            <Badge variant=\"outline\">{allTournaments.length}</Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm\">Error Rate:</span>\n                            <Badge variant=\"outline\" className=\"text-green-600\">0%</Badge>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* System Actions */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Settings className=\"h-5 w-5\" />\n                    System Actions\n                  </CardTitle>\n                  <CardDescription>\n                    Administrative controls and maintenance operations\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    <div className=\"space-y-4\">\n                      <h3 className=\"font-semibold\">Cache Management</h3>\n                      <div className=\"space-y-2\">\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <RefreshCw className=\"h-4 w-4 mr-2\" />\n                          Clear Cache\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Database className=\"h-4 w-4 mr-2\" />\n                          Refresh Data\n                        </Button>\n                      </div>\n                    </div>\n                    <div className=\"space-y-4\">\n                      <h3 className=\"font-semibold\">System Control</h3>\n                      <div className=\"space-y-2\">\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <RefreshCw className=\"h-4 w-4 mr-2\" />\n                          System Restart\n                        </Button>\n                      </div>\n                    </div>\n                    <div className=\"space-y-4\">\n                      <h3 className=\"font-semibold\">Monitoring</h3>\n                      <div className=\"space-y-2\">\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <Eye className=\"h-4 w-4 mr-2\" />\n                          View Logs\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full justify-start\">\n                          <AlertTriangle className=\"h-4 w-4 mr-2\" />\n                          Error Reports\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n          </Tabs>\n        </motion.div>\n\n\n\n        {/* Delete Tournament Confirmation Dialog */}\n        <AlertDialog open={endTournamentOpen} onOpenChange={setEndTournamentOpen}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle>Delete Tournament Permanently?</AlertDialogTitle>\n              <AlertDialogDescription>\n                This will permanently delete the tournament <strong>\"{selectedTournament?.name}\"</strong> and all its data.\n                This action cannot be undone and will remove all participants, purchases, and tournament history.\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel onClick={() => setEndTournamentOpen(false)}>\n                Cancel\n              </AlertDialogCancel>\n              <AlertDialogAction onClick={confirmDeleteTournament} className=\"bg-red-600 hover:bg-red-700\">\n                Delete Tournament\n              </AlertDialogAction>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n\n        {/* Delete Confirmation Dialog */}\n        <AlertDialog open={deleteState.step === 'first'} onOpenChange={(open) => {\n          if (!open) setDeleteState({ userEmail: null, step: null });\n        }}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>\n              <AlertDialogDescription>\n                This action cannot be undone. This will permanently delete the user account for{' '}\n                <strong>{deleteState.userEmail}</strong> and remove all their data from our servers.\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel>Cancel</AlertDialogCancel>\n              <AlertDialogAction\n                onClick={() => setDeleteState({ ...deleteState, step: 'second' })}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                Continue\n              </AlertDialogAction>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n\n        {/* Second Confirmation Dialog */}\n        <AlertDialog open={deleteState.step === 'second'} onOpenChange={(open) => {\n          if (!open) setDeleteState({ userEmail: null, step: null });\n        }}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle>Final Confirmation</AlertDialogTitle>\n              <AlertDialogDescription>\n                You are about to permanently delete the user account for{' '}\n                <strong>{deleteState.userEmail}</strong>. This will also delete:\n                <ul className=\"mt-2 list-disc list-inside text-sm\">\n                  <li>All watchlist items</li>\n                  <li>All user preferences</li>\n                  <li>All session data</li>\n                  <li>All related records</li>\n                </ul>\n                <br />\n                Are you sure you want to proceed?\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel>Cancel</AlertDialogCancel>\n              <AlertDialogAction\n                onClick={handleDeleteConfirm}\n                disabled={deleteMutation.isPending}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                {deleteMutation.isPending ? \"Deleting...\" : \"Delete User\"}\n              </AlertDialogAction>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n\n        {/* User Management Dialog */}\n        <UserManagementDialog\n          user={selectedUser}\n          open={userManagementOpen}\n          onOpenChange={setUserManagementOpen}\n        />\n      </motion.div>\n    </div>\n  );\n}","size_bytes":47889},"client/src/pages/archive.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Calendar, Trophy, Users, TrendingUp, Archive, Crown, Medal, Award, FileText, ArrowUpDown, DollarSign } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\ninterface Participant {\n  userId: number;\n  name: string;\n  finalBalance: number;\n  portfolioValue: number;\n  position: number;\n}\n\ninterface ArchivedTournament {\n  id: number;\n  name: string;\n  code: string;\n  maxPlayers: number;\n  currentPlayers: number;\n  timeframe: string;\n  createdAt: string;\n  endedAt: string;\n  startingBalance: number;\n  participants: Participant[];\n}\n\n\n\nexport default function ArchivePage() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  const { data: archivedTournaments, isLoading: tournamentsLoading } = useQuery({\n    queryKey: ['/api/tournaments/archived'],\n    queryFn: async () => {\n      const res = await fetch('/api/tournaments/archived');\n      if (!res.ok) {\n        throw new Error('Failed to fetch archived tournaments');\n      }\n      const data = await res.json();\n      return data.data as ArchivedTournament[];\n    }\n  });\n\n  // Fetch transaction history for personal portfolio\n  const { data: transactionHistory, isLoading: transactionsLoading } = useQuery({\n    queryKey: ['/api/portfolio/personal/transactions'],\n    queryFn: async () => {\n      const res = await fetch('/api/portfolio/personal/transactions');\n      if (!res.ok) {\n        throw new Error('Failed to fetch transaction history');\n      }\n      const data = await res.json();\n      return data.data || [];\n    },\n    enabled: !!user\n  });\n\n\n\n  return (\n    <div className=\"container mx-auto p-4 max-w-7xl\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold mb-2 flex items-center gap-2\">\n          <Archive className=\"w-8 h-8\" />\n          Archive\n        </h1>\n        <p className=\"text-muted-foreground\">\n          View your completed tournaments and transaction history\n        </p>\n      </div>\n\n      <Tabs defaultValue=\"tournaments\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"tournaments\" className=\"flex items-center space-x-2\">\n            <Trophy className=\"w-4 h-4\" />\n            <span>Completed Tournaments</span>\n          </TabsTrigger>\n          <TabsTrigger value=\"transactions\" className=\"flex items-center space-x-2\">\n            <FileText className=\"w-4 h-4\" />\n            <span>Transaction History</span>\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"tournaments\" className=\"mt-6\">\n          <div className=\"grid gap-4\">\n        {tournamentsLoading ? (\n          <div className=\"text-center py-8\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n            <p className=\"mt-2 text-muted-foreground\">Loading archived tournaments...</p>\n          </div>\n        ) : archivedTournaments?.length === 0 ? (\n          <Card>\n            <CardContent className=\"py-8 text-center\">\n              <Trophy className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No Completed Tournaments</h3>\n              <p className=\"text-muted-foreground\">\n                You haven't participated in any completed tournaments yet.\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          archivedTournaments?.map((tournament) => (\n            <Card key={tournament.id} className=\"hover:shadow-md transition-shadow\">\n              <CardHeader>\n                <div className=\"flex justify-between items-start\">\n                  <div>\n                    <CardTitle className=\"text-xl\">{tournament.name}</CardTitle>\n                    <p className=\"text-sm text-muted-foreground\">Tournament ID: {tournament.id}</p>\n                  </div>\n                  <Badge variant=\"secondary\" className=\"bg-green-100 text-green-800\">\n                    Completed\n                  </Badge>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-6\">\n                  <div className=\"flex items-center gap-2\">\n                    <Users className=\"w-4 h-4 text-muted-foreground\" />\n                    <span>{tournament.currentPlayers}/{tournament.maxPlayers} players</span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <TrendingUp className=\"w-4 h-4 text-muted-foreground\" />\n                    <span>Duration: {tournament.timeframe}</span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-4 h-4 text-muted-foreground\" />\n                    <span>Started: {format(new Date(tournament.createdAt), 'MMM d, yyyy')}</span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-4 h-4 text-muted-foreground\" />\n                    <span>Ended: {format(new Date(tournament.endedAt), 'MMM d, yyyy')}</span>\n                  </div>\n                </div>\n                \n                {/* Final Results */}\n                <div className=\"border-t pt-4\">\n                  <h4 className=\"font-semibold mb-3 flex items-center gap-2\">\n                    <Trophy className=\"w-4 h-4\" />\n                    Final Results\n                  </h4>\n                  <div className=\"space-y-2\">\n                    {tournament.participants?.map((participant, index) => {\n                      const getPositionIcon = (position: number) => {\n                        switch (position) {\n                          case 1: return <Crown className=\"w-4 h-4 text-yellow-500\" />;\n                          case 2: return <Medal className=\"w-4 h-4 text-gray-400\" />;\n                          case 3: return <Award className=\"w-4 h-4 text-amber-600\" />;\n                          default: return null;\n                        }\n                      };\n                      \n                      const getPositionBadge = (position: number) => {\n                        switch (position) {\n                          case 1: return \"bg-yellow-100 text-yellow-800\";\n                          case 2: return \"bg-gray-100 text-gray-800\";\n                          case 3: return \"bg-amber-100 text-amber-800\";\n                          default: return \"bg-blue-100 text-blue-800\";\n                        }\n                      };\n                      \n                      return (\n                        <div key={participant.userId} className=\"flex items-center justify-between p-2 rounded-lg bg-muted/50\">\n                          <div className=\"flex items-center gap-3\">\n                            <Badge variant=\"secondary\" className={`${getPositionBadge(participant.position)} min-w-[3rem] justify-center`}>\n                              #{participant.position}\n                            </Badge>\n                            <div className=\"flex items-center gap-2\">\n                              {getPositionIcon(participant.position)}\n                              <span className=\"font-medium\">{participant.name}</span>\n                            </div>\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"font-semibold\">${participant.portfolioValue?.toLocaleString() || 0}</div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"transactions\" className=\"mt-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center space-x-2\">\n                <ArrowUpDown className=\"w-5 h-5\" />\n                <span>Personal Portfolio Transaction History</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {transactionsLoading ? (\n                <div className=\"text-center py-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n                  <p className=\"mt-2 text-muted-foreground\">Loading transaction history...</p>\n                </div>\n              ) : transactionHistory?.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <FileText className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">No Transaction History</h3>\n                  <p className=\"text-muted-foreground\">\n                    You haven't made any trades in your personal portfolio yet.\n                  </p>\n                </div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {transactionHistory?.map((transaction: any, index: number) => (\n                    <div\n                      key={index}\n                      className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors\"\n                    >\n                      <div className=\"flex items-center space-x-4\">\n                        <Badge\n                          variant={transaction.type === 'buy' ? 'default' : 'secondary'}\n                          className={transaction.type === 'buy' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}\n                        >\n                          {transaction.type === 'buy' ? 'BUY' : 'SELL'}\n                        </Badge>\n                        <div>\n                          <div className=\"font-semibold\">{transaction.symbol}</div>\n                          <div className=\"text-sm text-muted-foreground\">\n                            {format(new Date(transaction.createdAt), 'MMM d, yyyy h:mm a')}\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"font-medium\">\n                          {formatCurrency(transaction.amount)}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          @ {formatCurrency(transaction.pricePerShare || 0)}/share\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","size_bytes":11023},"client/src/pages/auth-page.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { LoginUser, RegisterUser, loginSchema, registerSchema } from \"@shared/schema\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Loader2, TrendingUp, Shield, Users } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useEffect } from \"react\";\n\nexport default function AuthPage() {\n  const [location, navigate] = useLocation();\n  const { user, loginMutation, registerMutation } = useAuth();\n  const [activeTab, setActiveTab] = useState(() => {\n    if (location === \"/signup\") return \"register\";\n    return \"login\";\n  });\n\n  // Redirect if already logged in\n  useEffect(() => {\n    if (user) {\n      navigate(\"/dashboard\");\n    }\n  }, [user, navigate]);\n\n  // Update active tab based on route\n  useEffect(() => {\n    if (location === \"/signup\") {\n      setActiveTab(\"register\");\n    } else {\n      setActiveTab(\"login\");\n    }\n  }, [location]);\n\n  const loginForm = useForm<LoginUser>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const registerForm = useForm<RegisterUser>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const onLogin = (data: LoginUser) => {\n    loginMutation.mutate(data, {\n      onSuccess: () => {\n        navigate(\"/dashboard\");\n      }\n    });\n  };\n\n  const onRegister = (data: RegisterUser) => {\n    registerMutation.mutate(data, {\n      onSuccess: () => {\n        navigate(\"/dashboard\");\n      }\n    });\n  };\n\n  if (user) {\n    return null; // Will redirect via useEffect\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"grid lg:grid-cols-2 gap-8 items-center min-h-[calc(100vh-4rem)]\">\n          {/* Left side - Authentication forms */}\n          <div className=\"flex flex-col justify-center space-y-6\">\n            <div className=\"text-center space-y-2\">\n              <h1 className=\"text-3xl font-bold tracking-tight\">Welcome to ORSATH</h1>\n              <p className=\"text-muted-foreground\">\n                Orellana, Santos & Thompson Investment Research\n              </p>\n            </div>\n\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full max-w-md mx-auto\">\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"login\">Sign In</TabsTrigger>\n                <TabsTrigger value=\"register\">Sign Up</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"login\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Sign In</CardTitle>\n                    <CardDescription>\n                      Enter your credentials to access your account\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <form onSubmit={loginForm.handleSubmit(onLogin)} className=\"space-y-4\">\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"login-email\">Email</Label>\n                        <Input\n                          id=\"login-email\"\n                          type=\"email\"\n                          placeholder=\"your@email.com\"\n                          {...loginForm.register(\"email\")}\n                        />\n                        {loginForm.formState.errors.email && (\n                          <p className=\"text-sm text-red-500\">\n                            {loginForm.formState.errors.email.message}\n                          </p>\n                        )}\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"login-password\">Password</Label>\n                        <Input\n                          id=\"login-password\"\n                          type=\"password\"\n                          placeholder=\"••••••••\"\n                          {...loginForm.register(\"password\")}\n                        />\n                        {loginForm.formState.errors.password && (\n                          <p className=\"text-sm text-red-500\">\n                            {loginForm.formState.errors.password.message}\n                          </p>\n                        )}\n                      </div>\n\n                      <Button\n                        type=\"submit\"\n                        className=\"w-full\"\n                        disabled={loginMutation.isPending}\n                      >\n                        {loginMutation.isPending ? (\n                          <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                        ) : null}\n                        Sign In\n                      </Button>\n                    </form>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"register\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Create Account</CardTitle>\n                    <CardDescription>\n                      Join ORSATH for professional investment research\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <form onSubmit={registerForm.handleSubmit(onRegister)} className=\"space-y-4\">\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"register-firstName\">First Name</Label>\n                          <Input\n                            id=\"register-firstName\"\n                            placeholder=\"John\"\n                            {...registerForm.register(\"firstName\")}\n                          />\n                          {registerForm.formState.errors.firstName && (\n                            <p className=\"text-sm text-red-500\">\n                              {registerForm.formState.errors.firstName.message}\n                            </p>\n                          )}\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"register-lastName\">Last Name</Label>\n                          <Input\n                            id=\"register-lastName\"\n                            placeholder=\"Doe\"\n                            {...registerForm.register(\"lastName\")}\n                          />\n                          {registerForm.formState.errors.lastName && (\n                            <p className=\"text-sm text-red-500\">\n                              {registerForm.formState.errors.lastName.message}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"register-email\">Email</Label>\n                        <Input\n                          id=\"register-email\"\n                          type=\"email\"\n                          placeholder=\"your@email.com\"\n                          {...registerForm.register(\"email\")}\n                        />\n                        {registerForm.formState.errors.email && (\n                          <p className=\"text-sm text-red-500\">\n                            {registerForm.formState.errors.email.message}\n                          </p>\n                        )}\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"register-password\">Password</Label>\n                        <Input\n                          id=\"register-password\"\n                          type=\"password\"\n                          placeholder=\"••••••••\"\n                          {...registerForm.register(\"password\")}\n                        />\n                        {registerForm.formState.errors.password && (\n                          <p className=\"text-sm text-red-500\">\n                            {registerForm.formState.errors.password.message}\n                          </p>\n                        )}\n                      </div>\n\n                      <Button\n                        type=\"submit\"\n                        className=\"w-full\"\n                        disabled={registerMutation.isPending}\n                      >\n                        {registerMutation.isPending ? (\n                          <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                        ) : null}\n                        Create Account\n                      </Button>\n                    </form>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </div>\n\n          {/* Right side - Hero section */}\n          <div className=\"hidden lg:block\">\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 bg-gradient-to-r from-black/20 to-black/5 rounded-lg\" />\n              <div className=\"relative bg-white dark:bg-gray-800 rounded-lg p-8 shadow-xl\">\n                <div className=\"space-y-6\">\n                  <div className=\"text-center\">\n                    <h2 className=\"text-2xl font-bold mb-2\">\n                      Professional Investment Research\n                    </h2>\n                    <p className=\"text-muted-foreground\">\n                      Access in-depth qualitative analysis and market insights from our expert research team\n                    </p>\n                  </div>\n\n                  <div className=\"grid gap-4\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex-shrink-0\">\n                        <TrendingUp className=\"h-6 w-6 text-blue-500\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold\">Real-Time Market Data</h3>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Live stock quotes and comprehensive market analysis\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex-shrink-0\">\n                        <Shield className=\"h-6 w-6 text-green-500\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold\">Personalized Watchlists</h3>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Track your investments with custom watchlists that save automatically\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex-shrink-0\">\n                        <Users className=\"h-6 w-6 text-purple-500\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold\">Expert Research</h3>\n                        <p className=\"text-sm text-muted-foreground\">\n                          In-depth studies and analysis from our research team\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":11932},"client/src/pages/auth.tsx":{"content":"import { useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Eye, EyeOff, Mail, Lock, User } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nexport default function Auth() {\n  const [showPassword, setShowPassword] = useState(false);\n  const { toast } = useToast();\n  const { loginMutation, registerMutation } = useAuth();\n\n  const handleLogin = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    const credentials = {\n      username: formData.get('username') as string,\n      password: formData.get('password') as string,\n    };\n    \n    loginMutation.mutate(credentials);\n  };\n\n  const handleSignup = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    const credentials = {\n      email: formData.get('email') as string,\n      username: formData.get('username') as string,\n      password: formData.get('password') as string,\n      country: formData.get('country') as string || undefined,\n      language: formData.get('language') as string || 'English',\n      currency: formData.get('currency') as string || 'USD',\n      wantsPremium: false,\n    };\n    \n    registerMutation.mutate(credentials);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4\">\n      <div className=\"w-full max-w-md\">\n        <motion.div\n          initial=\"initial\"\n          animate=\"animate\"\n          variants={fadeInUp}\n        >\n          <div className=\"text-center mb-8\">\n            <div className=\"flex items-center justify-center space-x-2 mb-4\">\n              <div className=\"w-10 h-10 bg-black rounded-sm flex items-center justify-center\">\n                <span className=\"text-white font-bold\">O</span>\n              </div>\n              <span className=\"text-2xl font-bold text-black\">ORSATH</span>\n            </div>\n            <p className=\"text-gray-600\">Access professional investment research</p>\n          </div>\n\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader className=\"text-center pb-4\">\n              <CardTitle className=\"text-2xl font-bold text-black\">Welcome</CardTitle>\n              <CardDescription>\n                Sign in to your account or create a new one\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Tabs defaultValue=\"login\" className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-2 mb-6\">\n                  <TabsTrigger value=\"login\">Login</TabsTrigger>\n                  <TabsTrigger value=\"signup\">Sign Up</TabsTrigger>\n                </TabsList>\n                \n                <TabsContent value=\"login\">\n                  <form onSubmit={handleLogin} className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"username\">Username</Label>\n                      <div className=\"relative\">\n                        <User className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                        <Input\n                          id=\"username\"\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"Enter your username\"\n                          className=\"pl-10\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"password\">Password</Label>\n                      <div className=\"relative\">\n                        <Lock className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                        <Input\n                          id=\"password\"\n                          name=\"password\"\n                          type={showPassword ? \"text\" : \"password\"}\n                          placeholder=\"Enter your password\"\n                          className=\"pl-10 pr-10\"\n                          required\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => setShowPassword(!showPassword)}\n                          className=\"absolute right-3 top-3 text-gray-400 hover:text-gray-600\"\n                        >\n                          {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                        </button>\n                      </div>\n                    </div>\n\n                    <Button \n                      type=\"submit\" \n                      className=\"w-full bg-black hover:bg-gray-800\"\n                      disabled={loginMutation.isPending}\n                    >\n                      {loginMutation.isPending ? \"Signing in...\" : \"Sign In\"}\n                    </Button>\n\n                    <div className=\"text-center\">\n                      <a href=\"#\" className=\"text-sm text-gray-600 hover:text-black\">\n                        Forgot your password?\n                      </a>\n                    </div>\n                  </form>\n                </TabsContent>\n                \n                <TabsContent value=\"signup\">\n                  <form onSubmit={handleSignup} className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"signup-email\">Email</Label>\n                      <div className=\"relative\">\n                        <Mail className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                        <Input\n                          id=\"signup-email\"\n                          name=\"email\"\n                          type=\"email\"\n                          placeholder=\"Enter your email\"\n                          className=\"pl-10\"\n                          required\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"signup-username\">Username</Label>\n                      <div className=\"relative\">\n                        <User className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                        <Input\n                          id=\"signup-username\"\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"Choose a username\"\n                          className=\"pl-10\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"signup-password\">Password</Label>\n                      <div className=\"relative\">\n                        <Lock className=\"absolute left-3 top-3 h-4 w-4 text-gray-400\" />\n                        <Input\n                          id=\"signup-password\"\n                          name=\"password\"\n                          type={showPassword ? \"text\" : \"password\"}\n                          placeholder=\"Create a password\"\n                          className=\"pl-10 pr-10\"\n                          required\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => setShowPassword(!showPassword)}\n                          className=\"absolute right-3 top-3 text-gray-400 hover:text-gray-600\"\n                        >\n                          {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                        </button>\n                      </div>\n                    </div>\n\n                    <Button \n                      type=\"submit\" \n                      className=\"w-full bg-black hover:bg-gray-800\"\n                      disabled={registerMutation.isPending}\n                    >\n                      {registerMutation.isPending ? \"Creating account...\" : \"Create Account\"}\n                    </Button>\n\n                    <p className=\"text-xs text-gray-600 text-center\">\n                      By creating an account, you agree to our{\" \"}\n                      <a href=\"/terms\" className=\"text-black hover:underline\">Terms of Service</a>\n                      {\" \"}and{\" \"}\n                      <a href=\"/privacy\" className=\"text-black hover:underline\">Privacy Policy</a>\n                    </p>\n                  </form>\n                </TabsContent>\n              </Tabs>\n            </CardContent>\n          </Card>\n\n          <div className=\"text-center mt-6\">\n            <p className=\"text-sm text-gray-600\">\n              Need help?{\" \"}\n              <a href=\"/contact\" className=\"text-black hover:underline\">\n                Contact our support team\n              </a>\n            </p>\n          </div>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","size_bytes":9356},"client/src/pages/contact.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \"@/components/ui/accordion\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Mail, Phone, Clock, HelpCircle, BookOpen, MessageCircle, Shield, Zap, Users, TrendingUp, ChevronRight, Search } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { z } from \"zod\";\n\nconst contactSchema = z.object({\n  name: z.string().min(1, \"Name is required\"),\n  email: z.string().email(\"Invalid email address\"),\n  subject: z.string().min(1, \"Subject is required\"),\n  message: z.string().min(10, \"Message must be at least 10 characters\"),\n});\n\ntype ContactForm = z.infer<typeof contactSchema>;\n\nexport default function Support() {\n  const { toast } = useToast();\n  const { t } = useUserPreferences();\n  const [formData, setFormData] = useState<ContactForm>({\n    name: \"\",\n    email: \"\",\n    subject: \"\",\n    message: \"\",\n  });\n  const [errors, setErrors] = useState<Partial<ContactForm>>({});\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const contactMutation = useMutation({\n    mutationFn: async (data: ContactForm) => {\n      await apiRequest(\"POST\", \"/api/contact\", data);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Your message has been sent successfully! We'll get back to you soon.\",\n      });\n      setFormData({ name: \"\", email: \"\", subject: \"\", message: \"\" });\n      setErrors({});\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to send message. Please try again later.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      contactSchema.parse(formData);\n      setErrors({});\n      contactMutation.mutate(formData);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        const fieldErrors: Partial<ContactForm> = {};\n        error.errors.forEach((err) => {\n          if (err.path[0]) {\n            fieldErrors[err.path[0] as keyof ContactForm] = err.message;\n          }\n        });\n        setErrors(fieldErrors);\n      }\n    }\n  };\n\n  const handleChange = (field: keyof ContactForm, value: string) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: undefined }));\n    }\n  };\n\n  const faqs = [\n    {\n      category: \"Getting Started\",\n      questions: [\n        {\n          question: \"How do I create my first portfolio?\",\n          answer: \"Sign up for ORSATH, then navigate to your Dashboard. You'll automatically receive $10,000 in virtual money to start trading. Use the search function to find stocks and click 'Buy' to build your portfolio.\"\n        },\n        {\n          question: \"What's the difference between tournaments and personal portfolio?\",\n          answer: \"Tournaments are competitive events with specific timeframes where you compete against other traders. Personal portfolio is your ongoing trading account where you can practice anytime without competition pressure.\"\n        },\n        {\n          question: \"How do I join a tournament?\",\n          answer: \"Go to your Dashboard and look for available tournaments. Click 'Join Tournament' and enter the tournament code. You'll receive a separate virtual balance for each tournament you join.\"\n        }\n      ]\n    },\n    {\n      category: \"Trading & Portfolio\",\n      questions: [\n        {\n          question: \"Is my money at risk?\",\n          answer: \"No! ORSATH uses only virtual money for paper trading. You never risk real money - it's a safe environment to learn and practice trading strategies.\"\n        },\n        {\n          question: \"How often are stock prices updated?\",\n          answer: \"Stock prices are updated in real-time during market hours for all users.\"\n        },\n        {\n          question: \"Can I sell my stocks anytime?\",\n          answer: \"Yes, you can buy and sell stocks anytime during your trading session. Your transactions are processed immediately with current market prices.\"\n        },\n        {\n          question: \"How are my portfolio gains calculated?\",\n          answer: \"Your gains are calculated as (Current Portfolio Value - Initial Deposit). This includes both your cash balance and the current value of your stock holdings.\"\n        }\n      ]\n    },\n    {\n      category: \"Achievements & Leaderboards\",\n      questions: [\n        {\n          question: \"How do I earn achievements?\",\n          answer: \"Achievements are earned automatically by reaching milestones like making your first trade, joining tournaments, or achieving portfolio growth targets (10%, 25%, 100%).\"\n        },\n        {\n          question: \"What are trading streaks?\",\n          answer: \"Trading streaks track consecutive days where you make at least one trade in your personal portfolio. Maintain daily trading activity to build longer streaks and earn special achievements.\"\n        },\n        {\n          question: \"How do leaderboards work?\",\n          answer: \"Leaderboards rank users by tournament performance, personal portfolio value, and trading streaks. Rankings update in real-time as you trade and compete.\"\n        }\n      ]\n    },\n    {\n      category: \"Account Features\",\n      questions: [\n        {\n          question: \"What features are available?\",\n          answer: \"All users have access to tournament participation, personal portfolio trading, watchlists, leaderboards, and real-time market data.\"\n        },\n        {\n          question: \"How do I create tournaments?\",\n          answer: \"Visit the tournaments page to create and manage your own trading competitions. All users can participate in any tournament.\"\n        },\n        {\n          question: \"Can I change my display name?\",\n          answer: \"Yes! Go to your Profile page, click on Account Settings, and update your display name. This name appears on leaderboards and public profiles.\"\n        }\n      ]\n    }\n  ];\n\n  const helpResources = [\n    {\n      title: \"Quick Start Guide\",\n      description: \"Get up and running with your first trades in 5 minutes\",\n      icon: Zap,\n      items: [\"Create account\", \"Join tournament\", \"Buy your first stock\", \"Track performance\"]\n    },\n    {\n      title: \"Trading Basics\",\n      description: \"Learn fundamental trading concepts and strategies\",\n      icon: BookOpen,\n      items: [\"Stock selection\", \"Portfolio balance\", \"Risk management\", \"Market analysis\"]\n    },\n    {\n      title: \"Competition Rules\",\n      description: \"Understand tournament formats and scoring\",\n      icon: Users,\n      items: [\"Tournament types\", \"Scoring system\", \"Time limits\", \"Fair play rules\"]\n    },\n    {\n      title: \"Platform Features\",\n      description: \"Master all ORSATH tools and capabilities\",\n      icon: TrendingUp,\n      items: [\"Portfolio tracking\", \"Achievement system\", \"Social features\", \"Analytics\"]\n    }\n  ];\n\n  const filteredFaqs = faqs.map(category => ({\n    ...category,\n    questions: category.questions.filter(q => \n      searchQuery === \"\" || \n      q.question.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      q.answer.toLowerCase().includes(searchQuery.toLowerCase())\n    )\n  })).filter(category => category.questions.length > 0);\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <section className=\"py-16 bg-card\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <h1 className=\"text-5xl font-bold text-foreground mb-6\">Help & Support Center</h1>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                Everything you need to succeed in paper trading competitions. Find answers, learn strategies, and get support.\n              </p>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Support Content */}\n      <section className=\"py-16\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-7xl mx-auto\">\n            <Tabs defaultValue=\"help\" className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-4 mb-8\">\n                <TabsTrigger value=\"help\" className=\"flex items-center space-x-2\">\n                  <HelpCircle className=\"w-4 h-4\" />\n                  <span>Help Center</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"faq\" className=\"flex items-center space-x-2\">\n                  <BookOpen className=\"w-4 h-4\" />\n                  <span>FAQs</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"guides\" className=\"flex items-center space-x-2\">\n                  <Shield className=\"w-4 h-4\" />\n                  <span>Guides</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"contact\" className=\"flex items-center space-x-2\">\n                  <MessageCircle className=\"w-4 h-4\" />\n                  <span>Contact Us</span>\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"help\" className=\"space-y-8\">\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.6 }}\n                >\n                  <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                    {helpResources.map((resource, index) => (\n                      <Card key={index} className=\"group hover:shadow-lg transition-all duration-300 cursor-pointer border-border\">\n                        <CardHeader className=\"pb-4\">\n                          <div className=\"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mb-4 group-hover:bg-primary/20 transition-colors\">\n                            <resource.icon className=\"w-6 h-6 text-primary\" />\n                          </div>\n                          <CardTitle className=\"text-lg font-semibold\">{resource.title}</CardTitle>\n                          <p className=\"text-sm text-muted-foreground\">{resource.description}</p>\n                        </CardHeader>\n                        <CardContent>\n                          <ul className=\"space-y-2\">\n                            {resource.items.map((item, itemIndex) => (\n                              <li key={itemIndex} className=\"flex items-center text-sm text-muted-foreground\">\n                                <ChevronRight className=\"w-3 h-3 mr-2 text-primary\" />\n                                {item}\n                              </li>\n                            ))}\n                          </ul>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                </motion.div>\n\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.6, delay: 0.2 }}\n                >\n                  <Card className=\"bg-gradient-to-r from-primary/5 to-primary/10 border-primary/20\">\n                    <CardContent className=\"p-8\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h3 className=\"text-xl font-bold text-foreground mb-2\">Need Personal Help?</h3>\n                          <p className=\"text-muted-foreground\">Our support team is here to help with any questions or issues.</p>\n                        </div>\n                        <Button onClick={() => document.querySelector('[value=\"contact\"]')?.click()} className=\"bg-primary hover:bg-primary/90\">\n                          Contact Support\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              </TabsContent>\n\n              <TabsContent value=\"faq\" className=\"space-y-6\">\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.6 }}\n                >\n                  <Card className=\"mb-6\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"relative\">\n                        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4\" />\n                        <Input\n                          placeholder=\"Search FAQs...\"\n                          value={searchQuery}\n                          onChange={(e) => setSearchQuery(e.target.value)}\n                          className=\"pl-10 bg-background\"\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  {filteredFaqs.map((category, categoryIndex) => (\n                    <motion.div\n                      key={categoryIndex}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ duration: 0.6, delay: categoryIndex * 0.1 }}\n                    >\n                      <Card className=\"mb-6\">\n                        <CardHeader>\n                          <CardTitle className=\"flex items-center space-x-2\">\n                            <Badge variant=\"secondary\">{category.category}</Badge>\n                            <span className=\"text-sm text-muted-foreground\">({category.questions.length} questions)</span>\n                          </CardTitle>\n                        </CardHeader>\n                        <CardContent>\n                          <Accordion type=\"single\" collapsible className=\"w-full\">\n                            {category.questions.map((faq, faqIndex) => (\n                              <AccordionItem key={faqIndex} value={`item-${categoryIndex}-${faqIndex}`}>\n                                <AccordionTrigger className=\"text-left hover:no-underline\">\n                                  {faq.question}\n                                </AccordionTrigger>\n                                <AccordionContent className=\"text-muted-foreground leading-relaxed\">\n                                  {faq.answer}\n                                </AccordionContent>\n                              </AccordionItem>\n                            ))}\n                          </Accordion>\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  ))}\n\n                  {filteredFaqs.length === 0 && (\n                    <Card>\n                      <CardContent className=\"p-8 text-center\">\n                        <HelpCircle className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                        <h3 className=\"text-lg font-semibold text-foreground mb-2\">No FAQs found</h3>\n                        <p className=\"text-muted-foreground\">Try adjusting your search terms or browse all categories.</p>\n                        <Button variant=\"outline\" className=\"mt-4\" onClick={() => setSearchQuery(\"\")}>\n                          Clear Search\n                        </Button>\n                      </CardContent>\n                    </Card>\n                  )}\n                </motion.div>\n              </TabsContent>\n\n              <TabsContent value=\"guides\" className=\"space-y-6\">\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.6 }}\n                  className=\"grid md:grid-cols-2 gap-6\"\n                >\n                  <Card className=\"border-border\">\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center space-x-2\">\n                        <Zap className=\"w-5 h-5 text-primary\" />\n                        <span>Getting Started</span>\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-4\">\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-6 h-6 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-xs font-bold\">1</div>\n                          <div>\n                            <h4 className=\"font-medium\">Create Your Account</h4>\n                            <p className=\"text-sm text-muted-foreground\">Sign up with email and complete the onboarding process</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-6 h-6 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-xs font-bold\">2</div>\n                          <div>\n                            <h4 className=\"font-medium\">Explore Dashboard</h4>\n                            <p className=\"text-sm text-muted-foreground\">Familiarize yourself with the trading interface and tools</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-6 h-6 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-xs font-bold\">3</div>\n                          <div>\n                            <h4 className=\"font-medium\">Make Your First Trade</h4>\n                            <p className=\"text-sm text-muted-foreground\">Buy your first stock and start building your portfolio</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-6 h-6 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-xs font-bold\">4</div>\n                          <div>\n                            <h4 className=\"font-medium\">Join Competitions</h4>\n                            <p className=\"text-sm text-muted-foreground\">Enter tournaments and compete with other traders</p>\n                          </div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"border-border\">\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center space-x-2\">\n                        <TrendingUp className=\"w-5 h-5 text-green-500\" />\n                        <span>Trading Best Practices</span>\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-3\">\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2\"></div>\n                          <div>\n                            <p className=\"text-sm\"><strong>Diversify your portfolio</strong> across different sectors and companies</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2\"></div>\n                          <div>\n                            <p className=\"text-sm\"><strong>Research before buying</strong> - check company profiles and performance</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2\"></div>\n                          <div>\n                            <p className=\"text-sm\"><strong>Monitor your investments</strong> regularly and track performance</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2\"></div>\n                          <div>\n                            <p className=\"text-sm\"><strong>Learn from losses</strong> - analyze what went wrong and improve</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2\"></div>\n                          <div>\n                            <p className=\"text-sm\"><strong>Stay consistent</strong> with daily trading to build streaks</p>\n                          </div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              </TabsContent>\n\n              <TabsContent value=\"contact\" className=\"space-y-6\">\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.6 }}\n                  className=\"grid lg:grid-cols-2 gap-8\"\n                >\n                  {/* Contact Information */}\n                  <Card className=\"bg-card border-border\">\n                    <CardHeader>\n                      <CardTitle className=\"text-2xl\">Contact Information</CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-6\">\n                      <div className=\"flex items-center space-x-4\">\n                        <div className=\"w-12 h-12 bg-primary rounded-lg flex items-center justify-center\">\n                          <Mail className=\"w-6 h-6 text-primary-foreground\" />\n                        </div>\n                        <div>\n                          <h3 className=\"font-semibold text-foreground\">Email Support</h3>\n                          <p className=\"text-muted-foreground\">support@orsath.com</p>\n                          <p className=\"text-xs text-muted-foreground\">Response within 24 hours</p>\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex items-center space-x-4\">\n                        <div className=\"w-12 h-12 bg-primary rounded-lg flex items-center justify-center\">\n                          <MessageCircle className=\"w-6 h-6 text-primary-foreground\" />\n                        </div>\n                        <div>\n                          <h3 className=\"font-semibold text-foreground\">Live Chat</h3>\n                          <p className=\"text-muted-foreground\">Available during support hours</p>\n                          <p className=\"text-xs text-muted-foreground\">Instant assistance</p>\n                        </div>\n                      </div>\n\n                      <div className=\"mt-8\">\n                        <h3 className=\"text-lg font-bold text-foreground mb-4\">Support Hours</h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center space-x-3\">\n                            <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                            <div className=\"flex-1\">\n                              <div className=\"flex justify-between\">\n                                <span className=\"text-muted-foreground\">Monday - Friday</span>\n                                <span className=\"text-foreground font-medium\">9:00 AM - 6:00 PM EST</span>\n                              </div>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center space-x-3\">\n                            <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                            <div className=\"flex-1\">\n                              <div className=\"flex justify-between\">\n                                <span className=\"text-muted-foreground\">Weekend</span>\n                                <span className=\"text-primary font-medium\">10:00 AM - 4:00 PM EST</span>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"mt-8 p-4 bg-primary/5 rounded-lg border border-primary/20\">\n                        <h4 className=\"font-semibold text-foreground mb-2\">Community Support</h4>\n                        <p className=\"text-sm text-muted-foreground mb-3\">All users receive the same level of support and assistance for trading questions and platform issues.</p>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  {/* Contact Form */}\n                  <Card className=\"bg-card border-border\">\n                    <CardHeader>\n                      <CardTitle className=\"text-2xl\">Send us a Message</CardTitle>\n                      <p className=\"text-muted-foreground\">We'll get back to you as soon as possible</p>\n                    </CardHeader>\n                    <CardContent>\n                      <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        <div>\n                          <Label htmlFor=\"name\" className=\"text-foreground font-medium\">\n                            Name *\n                          </Label>\n                          <Input\n                            id=\"name\"\n                            type=\"text\"\n                            value={formData.name}\n                            onChange={(e) => handleChange(\"name\", e.target.value)}\n                            className=\"mt-1 bg-background border-border text-foreground\"\n                            placeholder=\"Your full name\"\n                            required\n                          />\n                          {errors.name && <p className=\"text-destructive text-sm mt-1\">{errors.name}</p>}\n                        </div>\n\n                        <div>\n                          <Label htmlFor=\"email\" className=\"text-foreground font-medium\">\n                            Email *\n                          </Label>\n                          <Input\n                            id=\"email\"\n                            type=\"email\"\n                            value={formData.email}\n                            onChange={(e) => handleChange(\"email\", e.target.value)}\n                            className=\"mt-1 bg-background border-border text-foreground\"\n                            placeholder=\"your@email.com\"\n                            required\n                          />\n                          {errors.email && <p className=\"text-destructive text-sm mt-1\">{errors.email}</p>}\n                        </div>\n\n                        <div>\n                          <Label htmlFor=\"subject\" className=\"text-foreground font-medium\">\n                            Subject *\n                          </Label>\n                          <Input\n                            id=\"subject\"\n                            type=\"text\"\n                            value={formData.subject}\n                            onChange={(e) => handleChange(\"subject\", e.target.value)}\n                            className=\"mt-1 bg-background border-border text-foreground\"\n                            placeholder=\"Account help, Tournament question, etc.\"\n                            required\n                          />\n                          {errors.subject && <p className=\"text-destructive text-sm mt-1\">{errors.subject}</p>}\n                        </div>\n\n                        <div>\n                          <Label htmlFor=\"message\" className=\"text-foreground font-medium\">\n                            Message *\n                          </Label>\n                          <Textarea\n                            id=\"message\"\n                            value={formData.message}\n                            onChange={(e) => handleChange(\"message\", e.target.value)}\n                            className=\"mt-1 min-h-[100px] bg-background border-border text-foreground\"\n                            placeholder=\"Describe your issue or question in detail...\"\n                            required\n                          />\n                          {errors.message && <p className=\"text-destructive text-sm mt-1\">{errors.message}</p>}\n                        </div>\n\n                        <Button\n                          type=\"submit\"\n                          disabled={contactMutation.isPending}\n                          className=\"w-full bg-primary text-primary-foreground hover:bg-primary/90 transition-colors\"\n                        >\n                          {contactMutation.isPending ? \"Sending...\" : \"Send Message\"}\n                        </Button>\n                      </form>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              </TabsContent>\n            </Tabs>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","size_bytes":29734},"client/src/pages/dashboard-backup.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { WatchlistItem, StockPurchase, Tournament } from \"@shared/schema\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  TrendingUp, \n  TrendingDown,\n  Plus, \n  X,\n  Star,\n  StarOff,\n  Eye,\n  BarChart3,\n  LineChart,\n  Activity,\n  DollarSign,\n  Calendar,\n  Clock,\n  AlertCircle,\n  CheckCircle,\n  Filter,\n  SortAsc,\n  SortDesc,\n  RefreshCw,\n  ExternalLink,\n  Bell,\n  Settings,\n  Download,\n  Building,\n  Trophy,\n  Lock,\n  Globe,\n  Users,\n  ChevronUp,\n  ChevronDown,\n  FileText,\n  ArrowUpDown,\n  Target,\n  ShoppingCart,\n  Coins\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { MarketStatusDisclaimer } from \"@/components/MarketStatusDisclaimer\";\nimport { PortfolioGrid } from \"@/components/portfolio/PortfolioGrid\";\n\n\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const { formatCurrency, t } = useUserPreferences();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // State management\n  const [activeTab, setActiveTab] = useState(\"personal\"); // personal or tournament\n  const [selectedTournament, setSelectedTournament] = useState<any>(null);\n  const [selectedStock, setSelectedStock] = useState<any>(null);\n  const [buyDialogOpen, setBuyDialogOpen] = useState(false);\n  const [sellDialogOpen, setSellDialogOpen] = useState(false);\n  const [buyAmount, setBuyAmount] = useState(\"\");\n  const [sellAmount, setSellAmount] = useState(\"\");\n  const [selectedSellStock, setSelectedSellStock] = useState<any>(null);\n  \n  // Watchlist specific state\n  const [selectedTimeframe, setSelectedTimeframe] = useState(\"1D\");\n  const [watchlistStockData, setWatchlistStockData] = useState<{[key: string]: any}>({});\n\n  // Portfolio queries\n  const { data: personalPortfolio = [], isLoading: personalLoading, refetch: refetchPersonal } = useQuery({\n    queryKey: [\"/api/portfolio/personal\"],\n    enabled: !!user && activeTab === \"personal\",\n  });\n\n  // Tournament queries\n  const { data: tournamentsResponse, isLoading: tournamentsLoading } = useQuery({\n    queryKey: [\"/api/tournaments\"],\n    enabled: !!user,\n  });\n\n  const userTournaments = (tournamentsResponse as any)?.data || [];\n  const activeTournaments = userTournaments.filter((t: any) => t.status === 'active');\n\n  // Tournament portfolio query\n  const { data: tournamentPortfolio = [], isLoading: tournamentLoading, refetch: refetchTournament } = useQuery({\n    queryKey: [\"/api/portfolio/tournament\", selectedTournament?.id],\n    enabled: !!user && !!selectedTournament?.id && activeTab === \"tournament\",\n  });\n\n  // Tournament balance query\n  const { data: tournamentBalance, isLoading: balanceLoading } = useQuery({\n    queryKey: [\"/api/tournaments\", selectedTournament?.id, \"balance\"],\n    enabled: !!selectedTournament?.id && activeTab === \"tournament\",\n  });\n\n  // Watchlist query\n  const { data: watchlist = [], isLoading: watchlistLoading, refetch: refetchWatchlist } = useQuery<WatchlistItem[]>({\n    queryKey: [\"/api/watchlist\"],\n    enabled: !!user,\n  });\n\n  // Popular stocks query\n  const { data: popularStocksData, isLoading: popularStocksLoading } = useQuery({\n    queryKey: [\"/api/popular\"],\n    enabled: !!user,\n  });\n\n  // Auto-select first tournament when switching to tournament tab\n  useEffect(() => {\n    if (activeTab === \"tournament\" && activeTournaments.length > 0 && !selectedTournament) {\n      setSelectedTournament(activeTournaments[0]);\n    }\n  }, [activeTab, activeTournaments, selectedTournament]);\n\n\n\n  // Buy stock mutation\n  const buyStockMutation = useMutation({\n    mutationFn: async (data: { symbol: string; amount: number; tournamentId?: number }) => {\n      const endpoint = data.tournamentId \n        ? \"/api/portfolio/tournament/buy\" \n        : \"/api/portfolio/personal/buy\";\n      return apiRequest(\"POST\", endpoint, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"Stock purchased successfully!\" });\n      setBuyDialogOpen(false);\n      setBuyAmount(\"\");\n      setSelectedStock(null);\n      if (activeTab === \"personal\") {\n        refetchPersonal();\n      } else if (selectedTournament) {\n        refetchTournament();\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", selectedTournament.id, \"balance\"] });\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Purchase failed\",\n        description: error.message || \"Unable to purchase stock\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Sell stock mutation\n  const sellStockMutation = useMutation({\n    mutationFn: async (data: { symbol: string; amount: number; tournamentId?: number }) => {\n      const endpoint = data.tournamentId \n        ? \"/api/portfolio/tournament/sell\" \n        : \"/api/portfolio/personal/sell\";\n      return apiRequest(\"POST\", endpoint, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"Stock sold successfully!\" });\n      setSellDialogOpen(false);\n      setSellAmount(\"\");\n      setSelectedSellStock(null);\n      if (activeTab === \"personal\") {\n        refetchPersonal();\n      } else if (selectedTournament) {\n        refetchTournament();\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", selectedTournament.id, \"balance\"] });\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Sale failed\",\n        description: error.message || \"Unable to sell stock\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Add to watchlist mutation\n  const addToWatchlistMutation = useMutation({\n    mutationFn: (stock: any) => \n      apiRequest(\"POST\", \"/api/watchlist\", {\n        symbol: stock.symbol,\n        companyName: stock.shortName || stock.longName || stock.symbol,\n      }),\n    onSuccess: () => {\n      toast({ title: \"Added to watchlist!\" });\n      refetchWatchlist();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to add to watchlist\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Remove from watchlist mutation\n  const removeFromWatchlistMutation = useMutation({\n    mutationFn: (id: number) => apiRequest(\"DELETE\", `/api/watchlist/${id}`),\n    onSuccess: () => {\n      toast({ title: \"Removed from watchlist!\" });\n      refetchWatchlist();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to remove from watchlist\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getCurrentBalance = (): number => {\n    if (activeTab === \"personal\") {\n      return Number(user?.balance) || 0;\n    } else if (selectedTournament && tournamentBalance) {\n      return (tournamentBalance as any)?.balance || 0;\n    }\n    return 0;\n  };\n\n  const getCurrentPortfolio = (): any[] => {\n    const personal = Array.isArray(personalPortfolio) ? personalPortfolio : [];\n    const tournament = Array.isArray(tournamentPortfolio) ? tournamentPortfolio : [];\n    return activeTab === \"personal\" ? personal : tournament;\n  };\n\n  const isPortfolioLoading = (): boolean => {\n    return activeTab === \"personal\" ? personalLoading : tournamentLoading;\n  };\n\n\n\n  // Fetch real-time data for watchlist stocks with timeframe support\n  useEffect(() => {\n    if (watchlist.length > 0) {\n      const fetchWatchlistData = async () => {\n        const stockData: {[key: string]: any} = {};\n        \n        for (const stock of watchlist) {\n          try {\n            // Fetch current quote data first\n            const quoteResponse = await apiRequest(\"GET\", `/api/quote/${stock.symbol}`);\n            const quoteData = await quoteResponse.json();\n            \n            const currentPrice = quoteData.data?.price || quoteData.data?.regularMarketPrice || 0;\n            const marketCap = quoteData.data?.marketCap || 0;\n            const volume = quoteData.data?.volume || quoteData.data?.regularMarketVolume || 0;\n            \n            // For 1D timeframe, use the daily change from quote data\n            if (selectedTimeframe === '1D') {\n              const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n              const previousClose = quoteData.data?.previousClose || (currentPrice - changeAmount);\n              // Calculate percentage change manually if not provided\n              let changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n              if (changePercent === 0 && previousClose > 0) {\n                changePercent = (changeAmount / previousClose) * 100;\n              }\n              \n\n              \n              stockData[stock.symbol] = {\n                ...quoteData.data,\n                price: currentPrice,\n                change: changeAmount,\n                changePercent: changePercent,\n                marketCap: marketCap,\n                volume: volume,\n                previousClose: previousClose // Use actual previous close from Yahoo Finance\n              };\n            } else {\n              // For other timeframes, fetch historical data with proper error handling\n              try {\n                const historicalResponse = await fetch(`/api/historical/${stock.symbol}/${selectedTimeframe}`);\n                \n                // Check if response is ok and content type is JSON\n                if (!historicalResponse.ok) {\n                  throw new Error(`HTTP ${historicalResponse.status}`);\n                }\n                \n                const contentType = historicalResponse.headers.get('content-type');\n                if (!contentType || !contentType.includes('application/json')) {\n                  throw new Error('Response is not JSON');\n                }\n                \n                const historicalData = await historicalResponse.json();\n                \n                let changeAmount = 0;\n                let changePercent = 0;\n                \n                if (historicalData.success && historicalData.data && historicalData.data.length > 0) {\n                  // Get the earliest price in the historical data (starting point for the timeframe)\n                  // Use the FIRST data point (oldest) instead of last (newest) for proper timeframe comparison\n                  const historicalPrice = historicalData.data[0].close;\n                  changeAmount = currentPrice - historicalPrice;\n                  changePercent = historicalPrice > 0 ? ((changeAmount / historicalPrice) * 100) : 0;\n                  \n\n                  \n                  stockData[stock.symbol] = {\n                    ...quoteData.data,\n                    price: currentPrice,\n                    change: changeAmount,\n                    changePercent: changePercent,\n                    marketCap: marketCap,\n                    volume: volume,\n                    previousClose: historicalPrice // This is the price at the timeframe start\n                  };\n                } else {\n                  // Fallback to daily change\n                  changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                  changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                  const fallbackPreviousClose = quoteData.data?.previousClose || (currentPrice - changeAmount);\n                  \n\n                  \n                  stockData[stock.symbol] = {\n                    ...quoteData.data,\n                    price: currentPrice,\n                    change: changeAmount,\n                    changePercent: changePercent,\n                    marketCap: marketCap,\n                    volume: volume,\n                    previousClose: fallbackPreviousClose // Use actual previous close or calculate\n                  };\n                }\n              } catch (histError) {\n                console.error(`Historical data error for ${stock.symbol}:`, histError);\n                // If historical data fails, use daily change as fallback\n                const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                const changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                \n                stockData[stock.symbol] = {\n                  ...quoteData.data,\n                  price: currentPrice,\n                  change: changeAmount,\n                  changePercent: changePercent,\n                  marketCap: marketCap,\n                  volume: volume,\n                  previousClose: currentPrice - changeAmount // Calculate from current price and change\n                };\n              }\n            }\n          } catch (error) {\n            console.error(`Error fetching data for ${stock.symbol}:`, error);\n            stockData[stock.symbol] = null;\n          }\n        }\n        \n        setWatchlistStockData(stockData);\n      };\n\n      fetchWatchlistData();\n      \n      // Refresh data every 30 seconds\n      const interval = setInterval(fetchWatchlistData, 30000);\n      return () => clearInterval(interval);\n    }\n  }, [watchlist, selectedTimeframe]);\n\n  if (!user) {\n    return (\n      <div className=\"h-[calc(100vh-4rem)] flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-foreground mb-2\">Please Log In</h2>\n          <p className=\"text-muted-foreground\">You need to be logged in to view your trading dashboard.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-[calc(100vh-4rem)] bg-background overflow-hidden\">\n      <MarketStatusDisclaimer />\n      \n      <div className=\"container mx-auto px-4 py-4 h-full\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"h-full flex flex-col\"\n        >\n          {/* Compact Header */}\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-foreground\">Trading Dashboard</h1>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <Badge variant=\"outline\" className=\"text-sm\">\n                <DollarSign className=\"w-4 h-4 mr-1\" />\n                {formatCurrency(getCurrentBalance())}\n              </Badge>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"flex-1 flex flex-col\">\n            <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n              <TabsTrigger value=\"personal\" className=\"flex items-center space-x-2\">\n                <Target className=\"w-4 h-4\" />\n                <span>Personal Portfolio</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"tournament\" className=\"flex items-center space-x-2\">\n                <Trophy className=\"w-4 h-4\" />\n                <span>Tournament Trading</span>\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Personal Portfolio Tab */}\n            <TabsContent value=\"personal\" className=\"flex-1 overflow-hidden\">\n              <div className=\"h-full grid grid-cols-1 lg:grid-cols-3 gap-4\">\n                {/* Main Trading Area - 2/3 width */}\n                <div className=\"lg:col-span-2 flex flex-col space-y-4 overflow-hidden\">\n                  {/* Portfolio Summary */}\n                  <Card className=\"flex-1\">\n                    <CardHeader className=\"pb-3\">\n                      <CardTitle className=\"text-lg\">Portfolio Overview</CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"flex-1 overflow-auto\">\n                      <PortfolioGrid />\n                    </CardContent>\n                  </Card>\n                </div>\n                \n                {/* Watchlist Sidebar - 1/3 width */}\n                <Card className=\"flex flex-col overflow-hidden\">\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <CardTitle className=\"flex items-center space-x-2 text-lg\">\n                        <Star className=\"w-4 h-4\" />\n                        <span>Watchlist</span>\n                      </CardTitle>\n                      <div className=\"flex items-center space-x-1\">\n                        <Select value={selectedTimeframe} onValueChange={setSelectedTimeframe}>\n                          <SelectTrigger className=\"w-20 h-8\">\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"1D\">1D</SelectItem>\n                            <SelectItem value=\"5D\">5D</SelectItem>\n                            <SelectItem value=\"1M\">1M</SelectItem>\n                            <SelectItem value=\"3M\">3M</SelectItem>\n                            <SelectItem value=\"6M\">6M</SelectItem>\n                            <SelectItem value=\"1Y\">1Y</SelectItem>\n                            <SelectItem value=\"YTD\">YTD</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          className=\"h-8 px-2\"\n                          onClick={() => {\n                            // Manual refresh function\n                            if (watchlist.length > 0) {\n                              const fetchWatchlistData = async () => {\n                                const stockData: {[key: string]: any} = {};\n                                \n                                for (const stock of watchlist) {\n                                  try {\n                                    // Fetch current quote data first\n                                    const quoteResponse = await apiRequest(\"GET\", `/api/quote/${stock.symbol}`);\n                                    const quoteData = await quoteResponse.json();\n                                    \n                                    const currentPrice = quoteData.data?.price || quoteData.data?.regularMarketPrice || 0;\n                                    const marketCap = quoteData.data?.marketCap || 0;\n                                    const volume = quoteData.data?.volume || quoteData.data?.regularMarketVolume || 0;\n                                    \n                                    // For 1D timeframe, use the daily change from quote data\n                                    if (selectedTimeframe === '1D') {\n                                      const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                                      const previousClose = quoteData.data?.previousClose || (currentPrice - changeAmount);\n                                      // Calculate percentage change manually if not provided\n                                      let changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                                      if (changePercent === 0 && previousClose > 0) {\n                                        changePercent = (changeAmount / previousClose) * 100;\n                                      }\n                                      \n                                      stockData[stock.symbol] = {\n                                        ...quoteData.data,\n                                        price: currentPrice,\n                                        change: changeAmount,\n                                        changePercent: changePercent,\n                                        marketCap: marketCap,\n                                        volume: volume,\n                                        previousClose: previousClose // Use actual previous close from Yahoo Finance\n                                      };\n                                    } else {\n                                      // For other timeframes, fetch historical data with proper error handling\n                                      try {\n                                        const historicalResponse = await fetch(`/api/historical/${stock.symbol}/${selectedTimeframe}`);\n                                        \n                                        // Check if response is ok and content type is JSON\n                                        if (!historicalResponse.ok) {\n                                          throw new Error(`HTTP ${historicalResponse.status}`);\n                                        }\n                                        \n                                        const contentType = historicalResponse.headers.get('content-type');\n                                        if (!contentType || !contentType.includes('application/json')) {\n                                          throw new Error('Response is not JSON');\n                                        }\n                                        \n                                        const historicalData = await historicalResponse.json();\n                                        \n                                        let changeAmount = 0;\n                                        let changePercent = 0;\n                                        \n                                        if (historicalData.success && historicalData.data && historicalData.data.length > 0) {\n                                          // Get the earliest price in the historical data (starting point for the timeframe)\n                                          // Use the FIRST data point (oldest) instead of last (newest) for proper timeframe comparison\n                                          const historicalPrice = historicalData.data[0].close;\n                                          changeAmount = currentPrice - historicalPrice;\n                                          changePercent = historicalPrice > 0 ? ((changeAmount / historicalPrice) * 100) : 0;\n                                          \n\n                                          \n                                          stockData[stock.symbol] = {\n                                            ...quoteData.data,\n                                            price: currentPrice,\n                                            change: changeAmount,\n                                            changePercent: changePercent,\n                                            marketCap: marketCap,\n                                            volume: volume,\n                                            previousClose: historicalPrice // This is the price at the timeframe start\n                                          };\n                                        } else {\n                                          changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                                          changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                                          \n                                          stockData[stock.symbol] = {\n                                            ...quoteData.data,\n                                            price: currentPrice,\n                                            change: changeAmount,\n                                            changePercent: changePercent,\n                                            marketCap: marketCap,\n                                            volume: volume,\n                                            previousClose: currentPrice - changeAmount // Calculate from current price and change\n                                          };\n                                        }\n                                      } catch (histError) {\n                                        console.error(`Manual refresh historical data error for ${stock.symbol}:`, histError);\n                                        // Fallback to daily change\n                                        const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                                        const changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                                        \n                                        stockData[stock.symbol] = {\n                                          ...quoteData.data,\n                                          price: currentPrice,\n                                          change: changeAmount,\n                                          changePercent: changePercent,\n                                          marketCap: marketCap,\n                                          volume: volume,\n                                          previousClose: currentPrice - changeAmount // Calculate from current price and change\n                                        };\n                                      }\n                                    }\n                                  } catch (error) {\n                                    console.error(`Error fetching data for ${stock.symbol}:`, error);\n                                    stockData[stock.symbol] = null;\n                                  }\n                                }\n                                \n                                setWatchlistStockData(stockData);\n                              };\n                              fetchWatchlistData();\n                            }\n                          }}\n                        >\n                          <RefreshCw className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"flex-1 overflow-auto\">\n                    {/* Watchlist Content */}\n                    {watchlistLoading ? (\n                      <div className=\"flex items-center justify-center py-8\">\n                        <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                        <span className=\"text-sm text-muted-foreground\">Loading...</span>\n                      </div>\n                    ) : watchlist.length === 0 ? (\n                      <div className=\"text-center py-8\">\n                        <Star className=\"w-8 h-8 mx-auto text-muted-foreground mb-3 opacity-50\" />\n                        <h3 className=\"font-semibold mb-2\">No watchlist items</h3>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Add stocks to monitor\n                        </p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-2\">\n                        {watchlist.map((stock) => {\n                          const stockData = watchlistStockData[stock.symbol];\n                          \n                          if (!stockData) {\n                            return (\n                              <div\n                                key={stock.id}\n                                className=\"p-3 border rounded hover:bg-muted/30 transition-colors\"\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <div className=\"font-semibold text-sm\">{stock.symbol}</div>\n                                    <div className=\"text-xs text-muted-foreground truncate\">\n                                      {stock.companyName}\n                                    </div>\n                                  </div>\n                                  <div className=\"text-xs text-muted-foreground\">\n                                    <RefreshCw className=\"w-3 h-3 animate-spin inline mr-1\" />\n                                    Loading...\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          }\n\n                          // Use real Yahoo Finance data with timeframe-aware changes\n                          const currentPrice = stockData.price || 0;\n                          const changeAmount = stockData.change || 0;\n                          const changePercent = stockData.changePercent || 0;\n                          const isPositive = changeAmount >= 0;\n                          \n                          return (\n                            <div\n                              key={stock.id}\n                              className=\"p-3 border rounded hover:bg-muted/30 transition-colors\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <div className=\"font-semibold text-sm\">{stock.symbol}</div>\n                                  <div className=\"text-xs text-muted-foreground truncate\">\n                                    {stock.companyName}\n                                  </div>\n                                </div>\n                                <div className=\"text-right\">\n                                  <div className=\"font-semibold text-sm\">\n                                    {formatCurrency(currentPrice)}\n                                  </div>\n                                  <div className={`text-xs ${isPositive ? 'text-green-600' : 'text-red-600'}`}>\n                                    {isPositive ? '+' : ''}{formatCurrency(changeAmount)} ({changePercent.toFixed(2)}%)\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"flex justify-between items-center mt-2\">\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  className=\"h-6 px-2 text-xs\"\n                                  onClick={() => {\n                                    setSelectedStock({ symbol: stock.symbol, shortName: stock.companyName });\n                                    setBuyDialogOpen(true);\n                                  }}\n                                >\n                                  <ShoppingCart className=\"w-3 h-3 mr-1\" />\n                                  Buy\n                                </Button>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-6 px-2\"\n                                  onClick={() => removeFromWatchlistMutation.mutate(stock.id)}\n                                >\n                                  <X className=\"w-3 h-3\" />\n                                </Button>\n                              </div>\n                            </div>\n                          );>\n                                  <RefreshCw className=\"w-4 h-4 animate-spin inline mr-2\" />\n                                  Loading...\n                                </div>\n                                <div className=\"flex items-center justify-center space-x-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => removeFromWatchlistMutation.mutate(stock.id)}\n                                  >\n                                    <X className=\"w-4 h-4\" />\n                                  </Button>\n                                </div>\n                              </div>\n                            );\n                          }\n\n                          // Use real Yahoo Finance data with timeframe-aware changes\n                          const currentPrice = stockData.price || 0;\n                          const changeAmount = stockData.change || 0;\n                          const changePercent = stockData.changePercent || 0;\n                          const marketCap = stockData.marketCap || 0;\n                          const volume = stockData.volume || 0;\n                          const previousClose = stockData.previousClose || 0;\n\n                          const isPositive = changeAmount >= 0;\n                          \n                          // Format market cap in billions/millions\n                          const formatMarketCap = (cap: number) => {\n                            if (cap >= 1e12) return `$${(cap / 1e12).toFixed(2)}T`;\n                            if (cap >= 1e9) return `$${(cap / 1e9).toFixed(2)}B`;\n                            if (cap >= 1e6) return `$${(cap / 1e6).toFixed(2)}M`;\n                            if (cap >= 1e3) return `$${(cap / 1e3).toFixed(2)}K`;\n                            return cap > 0 ? `$${cap.toFixed(0)}` : 'N/A';\n                          };\n                          \n                          return (\n                            <div\n                              key={stock.id}\n                              className=\"grid grid-cols-8 gap-4 p-3 border rounded-lg hover:bg-muted/30 transition-colors items-center\"\n                            >\n                              {/* Stock Info */}\n                              <div className=\"col-span-2\">\n                                <div className=\"font-semibold text-base\">{stock.symbol}</div>\n                                <div className=\"text-sm text-muted-foreground truncate\">\n                                  {stock.companyName}\n                                </div>\n                              </div>\n                              \n                              {/* Current Price */}\n                              <div className=\"text-right\">\n                                <div className=\"font-semibold\">\n                                  {formatCurrency(currentPrice)}\n                                </div>\n                              </div>\n                              \n                              {/* Previous Close */}\n                              <div className=\"text-right\">\n                                <div className=\"text-sm text-muted-foreground\">\n                                  {formatCurrency(previousClose)}\n                                </div>\n                              </div>\n                              \n                              {/* Change Amount & Percentage */}\n                              <div className=\"text-right\">\n                                <div className={`font-medium ${\n                                  isPositive ? 'text-green-600' : 'text-red-600'\n                                }`}>\n                                  <div className=\"flex items-center justify-end space-x-1\">\n                                    {isPositive ? (\n                                      <TrendingUp className=\"w-4 h-4\" />\n                                    ) : (\n                                      <TrendingDown className=\"w-4 h-4\" />\n                                    )}\n                                    <div>\n                                      <div>{isPositive ? '+' : ''}{formatCurrency(changeAmount)}</div>\n                                      <div className=\"text-xs\">\n                                        ({isPositive ? '+' : ''}{changePercent.toFixed(2)}%) {selectedTimeframe.toUpperCase()}\n                                      </div>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                              \n                              {/* Market Cap */}\n                              <div className=\"text-right\">\n                                <div className=\"text-sm font-medium\">\n                                  {formatMarketCap(marketCap)}\n                                </div>\n                              </div>\n                              \n                              {/* Volume */}\n                              <div className=\"text-right\">\n                                <div className=\"text-sm text-muted-foreground\">\n                                  {volume.toLocaleString()}\n                                </div>\n                              </div>\n                              \n                              {/* Actions */}\n                              <div className=\"flex items-center justify-center space-x-1\">\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => {\n                                    setSelectedStock({ symbol: stock.symbol, shortName: stock.companyName });\n                                    setBuyDialogOpen(true);\n                                  }}\n                                >\n                                  <ShoppingCart className=\"w-4 h-4\" />\n                                </Button>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  onClick={() => removeFromWatchlistMutation.mutate(stock.id)}\n                                >\n                                  <X className=\"w-4 h-4\" />\n                                </Button>\n                              </div>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </div>\n            </TabsContent>\n\n            {/* Tournament Trading Tab */}\n            <TabsContent value=\"tournament\" className=\"space-y-6\">\n              {activeTournaments.length === 0 ? (\n                <Card>\n                  <CardContent className=\"py-8\">\n                    <div className=\"text-center\">\n                      <Trophy className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                      <h3 className=\"text-lg font-semibold mb-2\">No Active Tournaments</h3>\n                      <p className=\"text-muted-foreground mb-4\">\n                        Join or create a tournament to start competitive trading\n                      </p>\n                      <Button asChild>\n                        <a href=\"/tournaments\">\n                          <Plus className=\"w-4 h-4 mr-2\" />\n                          Browse Tournaments\n                        </a>\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"space-y-6\">\n                  {/* Tournament Selector */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle>Select Tournament</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                        {activeTournaments.map((tournament: any) => (\n                          <div\n                            key={tournament.id}\n                            className={`p-4 border rounded-lg cursor-pointer transition-all ${\n                              selectedTournament?.id === tournament.id\n                                ? 'border-primary bg-primary/10'\n                                : 'border-border hover:bg-muted/50'\n                            }`}\n                            onClick={() => setSelectedTournament(tournament)}\n                          >\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <h4 className=\"font-semibold\">{tournament.name}</h4>\n                              <Badge variant={tournament.tournamentType === \"crypto\" ? \"secondary\" : \"default\"}>\n                                {tournament.tournamentType === \"crypto\" ? \"🪙 Crypto\" : \"📈 Stocks\"}\n                              </Badge>\n                            </div>\n                            <div className=\"text-sm text-muted-foreground\">\n                              <div className=\"flex items-center space-x-2\">\n                                <Users className=\"w-4 h-4\" />\n                                <span>{tournament.currentPlayers} players</span>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  {/* Tournament Trading Interface */}\n                  {selectedTournament && (\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                      {/* Portfolio */}\n                      <div className=\"lg:col-span-2\">\n                        <Card>\n                          <CardHeader>\n                            <CardTitle className=\"flex items-center justify-between\">\n                              <span>Tournament Portfolio - {selectedTournament.name}</span>\n                              <Badge variant=\"outline\">\n                                <DollarSign className=\"w-4 h-4 mr-1\" />\n                                {formatCurrency((tournamentBalance as any)?.balance || 0)}\n                              </Badge>\n                            </CardTitle>\n                          </CardHeader>\n                          <CardContent>\n                            {isPortfolioLoading() ? (\n                              <div className=\"flex items-center justify-center py-8\">\n                                <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                                <span className=\"text-sm text-muted-foreground\">Loading portfolio...</span>\n                              </div>\n                            ) : (getCurrentPortfolio() as any[]).length === 0 ? (\n                              <div className=\"text-center py-8\">\n                                <Coins className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                                <h3 className=\"text-lg font-semibold mb-2\">No Holdings</h3>\n                                <p className=\"text-muted-foreground\">\n                                  Start trading to build your tournament portfolio\n                                </p>\n                              </div>\n                            ) : (\n                              <div className=\"space-y-4\">\n                                {(getCurrentPortfolio() as any[]).map((holding: any, index: number) => (\n                                  <div key={index} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                                    <div>\n                                      <div className=\"font-semibold\">{holding.symbol}</div>\n                                      <div className=\"text-sm text-muted-foreground\">\n                                        {holding.shares} shares × {formatCurrency(holding.currentPrice || 0)}\n                                      </div>\n                                    </div>\n                                    <div className=\"text-right\">\n                                      <div className=\"font-medium\">\n                                        {formatCurrency((holding.shares || 0) * (holding.currentPrice || 0))}\n                                      </div>\n                                      <div className={`text-sm ${\n                                        ((holding.currentPrice || 0) - (holding.purchasePrice || 0)) >= 0 \n                                          ? 'text-green-600' \n                                          : 'text-red-600'\n                                      }`}>\n                                        {((holding.currentPrice || 0) - (holding.purchasePrice || 0)) >= 0 ? '+' : ''}\n                                        {formatCurrency((holding.currentPrice || 0) - (holding.purchasePrice || 0))}\n                                      </div>\n                                    </div>\n                                    <Button\n                                      size=\"sm\"\n                                      variant=\"outline\"\n                                      onClick={() => {\n                                        setSelectedSellStock(holding);\n                                        setSellDialogOpen(true);\n                                      }}\n                                    >\n                                      Sell\n                                    </Button>\n                                  </div>\n                                ))}\n                              </div>\n                            )}\n                          </CardContent>\n                        </Card>\n                      </div>\n\n\n                    </div>\n                  )}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </motion.div>\n      </div>\n\n      {/* Buy Stock Dialog */}\n      <Dialog open={buyDialogOpen} onOpenChange={setBuyDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Buy Stock - {selectedStock?.symbol}</DialogTitle>\n            <DialogDescription>\n              Enter the amount you want to invest in {selectedStock?.shortName || selectedStock?.longName}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"buyAmount\">Investment Amount ($)</Label>\n              <Input\n                id=\"buyAmount\"\n                type=\"number\"\n                min=\"0.01\"\n                step=\"0.01\"\n                value={buyAmount}\n                onChange={(e) => setBuyAmount(e.target.value)}\n                placeholder=\"Enter amount to invest...\"\n              />\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <Button variant=\"outline\" onClick={() => setBuyDialogOpen(false)}>\n                Cancel\n              </Button>\n              <Button\n                onClick={() => {\n                  const amount = parseFloat(buyAmount);\n                  if (amount && selectedStock) {\n                    buyStockMutation.mutate({\n                      symbol: selectedStock.symbol,\n                      amount,\n                      tournamentId: activeTab === \"tournament\" ? selectedTournament?.id : undefined,\n                    });\n                  }\n                }}\n                disabled={!buyAmount || parseFloat(buyAmount) <= 0 || buyStockMutation.isPending}\n              >\n                {buyStockMutation.isPending ? \"Purchasing...\" : \"Buy Stock\"}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Sell Stock Dialog */}\n      <Dialog open={sellDialogOpen} onOpenChange={setSellDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Sell Stock - {selectedSellStock?.symbol}</DialogTitle>\n            <DialogDescription>\n              Enter the amount you want to sell\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"sellAmount\">Sell Amount ($)</Label>\n              <Input\n                id=\"sellAmount\"\n                type=\"number\"\n                min=\"0.01\"\n                step=\"0.01\"\n                value={sellAmount}\n                onChange={(e) => setSellAmount(e.target.value)}\n                placeholder=\"Enter amount to sell...\"\n              />\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <Button variant=\"outline\" onClick={() => setSellDialogOpen(false)}>\n                Cancel\n              </Button>\n              <Button\n                onClick={() => {\n                  const amount = parseFloat(sellAmount);\n                  if (amount && selectedSellStock) {\n                    sellStockMutation.mutate({\n                      symbol: selectedSellStock.symbol,\n                      amount,\n                      tournamentId: activeTab === \"tournament\" ? selectedTournament?.id : undefined,\n                    });\n                  }\n                }}\n                disabled={!sellAmount || parseFloat(sellAmount) <= 0 || sellStockMutation.isPending}\n              >\n                {sellStockMutation.isPending ? \"Selling...\" : \"Sell Stock\"}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","size_bytes":49469},"client/src/pages/dashboard-simple.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { TrendingUp, TrendingDown, Star, StarOff } from \"lucide-react\";\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const [currentView, setCurrentView] = useState(\"dashboard\");\n\n  // Fetch popular stocks\n  const { data: popularStocksData, isLoading: popularStocksLoading } = useQuery({\n    queryKey: [\"/api/popular\"],\n    enabled: !!user,\n  });\n\n  // Fetch user's watchlist\n  const { data: watchlist = [], isLoading: watchlistLoading } = useQuery({\n    queryKey: [\"/api/watchlist\"],\n    enabled: !!user,\n  });\n\n  if (!user) {\n    return <div>Please log in to access the dashboard.</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <div className=\"bg-card border-b border-border\">\n        <div className=\"max-w-7xl mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <h1 className=\"text-2xl font-bold text-foreground\">Dashboard</h1>\n            <div className=\"flex space-x-2\">\n              <Button \n                variant={currentView === \"dashboard\" ? \"default\" : \"outline\"}\n                onClick={() => setCurrentView(\"dashboard\")}\n              >\n                Portfolio\n              </Button>\n              <Button \n                variant={currentView === \"watchlist\" ? \"default\" : \"outline\"}\n                onClick={() => setCurrentView(\"watchlist\")}\n              >\n                Watchlist\n              </Button>\n              <Button \n                variant={currentView === \"tournaments\" ? \"default\" : \"outline\"}\n                onClick={() => setCurrentView(\"tournaments\")}\n              >\n                Tournaments\n              </Button>\n              <Button \n                variant={currentView === \"leaderboard\" ? \"default\" : \"outline\"}\n                onClick={() => setCurrentView(\"leaderboard\")}\n              >\n                Leaderboard\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\n        {currentView === \"dashboard\" && (\n          <div className=\"space-y-6\">\n            <h2 className=\"text-xl font-semibold\">Portfolio Overview</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-sm font-medium\">Total Value</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">$10,000.00</div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    +$0.00 (+0.00%) today\n                  </p>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-sm font-medium\">Cash Balance</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">$10,000.00</div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Available to trade\n                  </p>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-sm font-medium\">Day's Change</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold text-muted-foreground\">$0.00</div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    0.00% change\n                  </p>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-sm font-medium\">Total Return</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold text-muted-foreground\">$0.00</div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    0.00% all time\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        )}\n\n        {currentView === \"watchlist\" && (\n          <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-semibold\">Watchlist</h2>\n              <Button>Add Stock</Button>\n            </div>\n            \n            {watchlistLoading ? (\n              <div>Loading watchlist...</div>\n            ) : watchlist.length === 0 ? (\n              <Card>\n                <CardContent className=\"py-8 text-center\">\n                  <Star className=\"w-8 h-8 mx-auto mb-4 text-muted-foreground\" />\n                  <p className=\"text-muted-foreground\">No stocks in your watchlist yet.</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-4\">\n                {watchlist.map((stock: any) => (\n                  <Card key={stock.id}>\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex justify-between items-center\">\n                        <div>\n                          <h3 className=\"font-semibold\">{stock.symbol}</h3>\n                          <p className=\"text-sm text-muted-foreground\">{stock.companyName}</p>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"font-semibold\">Loading...</div>\n                          <div className=\"text-sm text-muted-foreground\">--</div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {currentView === \"tournaments\" && (\n          <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-semibold\">Tournaments</h2>\n              <Button>Create Tournament</Button>\n            </div>\n            \n            <Card>\n              <CardContent className=\"py-8 text-center\">\n                <p className=\"text-muted-foreground\">Tournament functionality will be restored soon.</p>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {currentView === \"leaderboard\" && (\n          <div className=\"space-y-6\">\n            <h2 className=\"text-xl font-semibold\">Leaderboard</h2>\n            \n            <Card>\n              <CardContent className=\"py-8 text-center\">\n                <p className=\"text-muted-foreground\">Leaderboard functionality will be restored soon.</p>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":7052},"client/src/pages/dashboard.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { WatchlistItem, StockPurchase, Tournament } from \"@shared/schema\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  TrendingUp, \n  TrendingDown,\n  Plus, \n  X,\n  Star,\n  StarOff,\n  Eye,\n  BarChart3,\n  LineChart,\n  Activity,\n  DollarSign,\n  Calendar,\n  Clock,\n  AlertCircle,\n  CheckCircle,\n  Filter,\n  SortAsc,\n  SortDesc,\n  RefreshCw,\n  ExternalLink,\n  Bell,\n  Settings,\n  Download,\n  Building,\n  Trophy,\n  Lock,\n  Globe,\n  Users,\n  ChevronUp,\n  ChevronDown,\n  FileText,\n  ArrowUpDown,\n  Target,\n  ShoppingCart,\n  Coins\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { MarketStatusDisclaimer } from \"@/components/MarketStatusDisclaimer\";\nimport { PortfolioGrid } from \"@/components/portfolio/PortfolioGrid\";\nimport { PortfolioSummaryWidget } from \"@/components/portfolio/widgets/PortfolioSummaryWidget\";\nimport { StockSearchBar } from \"@/components/trading/StockSearchBar\";\nimport { TournamentPerformanceChart } from \"@/components/portfolio/widgets/TournamentPerformanceChart\";\nimport { TournamentLeaderboard } from \"@/components/tournaments/TournamentLeaderboard\";\nimport { TournamentLeaderboardDialog } from \"@/components/tournaments/TournamentLeaderboardDialog\";\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const { formatCurrency, t } = useUserPreferences();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // State management\n  const [activeTab, setActiveTab] = useState(\"personal\"); // personal or tournament\n  const [selectedTournament, setSelectedTournament] = useState<any>(null);\n  const [selectedStock, setSelectedStock] = useState<any>(null);\n  const [selectedChartStock, setSelectedChartStock] = useState<string | null>(null);\n  const [buyDialogOpen, setBuyDialogOpen] = useState(false);\n  const [sellDialogOpen, setSellDialogOpen] = useState(false);\n  const [buyShares, setBuyShares] = useState(\"\");\n  const [sellAmount, setSellAmount] = useState(\"\");\n  const [selectedSellStock, setSelectedSellStock] = useState<any>(null);\n  const [leaderboardDialogOpen, setLeaderboardDialogOpen] = useState(false);\n\n  // Watchlist specific state\n  const [selectedTimeframe, setSelectedTimeframe] = useState(\"1D\");\n  const [watchlistStockData, setWatchlistStockData] = useState<{[key: string]: any}>({});\n\n  // Portfolio queries\n  const { data: personalPortfolio = [], isLoading: personalLoading, refetch: refetchPersonal } = useQuery({\n    queryKey: [\"/api/portfolio/personal\"],\n    enabled: !!user && activeTab === \"personal\",\n  });\n\n  // Tournament queries\n  const { data: tournamentsResponse, isLoading: tournamentsLoading } = useQuery({\n    queryKey: [\"/api/tournaments\"],\n    enabled: !!user,\n  });\n\n  const userTournaments = (tournamentsResponse as any)?.data || [];\n  const activeTournaments = userTournaments.filter((t: any) => t.status === 'active');\n\n  // Tournament portfolio query\n  const { data: tournamentPortfolio = [], isLoading: tournamentLoading, refetch: refetchTournament } = useQuery({\n    queryKey: [\"/api/portfolio/tournament\", selectedTournament?.id],\n    enabled: !!user && !!selectedTournament?.id && activeTab === \"tournament\",\n  });\n\n  // Tournament balance query\n  const { data: tournamentBalance, isLoading: balanceLoading } = useQuery({\n    queryKey: [\"/api/tournaments\", selectedTournament?.id, \"balance\"],\n    enabled: !!selectedTournament?.id && activeTab === \"tournament\",\n  });\n\n  // Watchlist query\n  const { data: watchlist = [], isLoading: watchlistLoading, refetch: refetchWatchlist } = useQuery<WatchlistItem[]>({\n    queryKey: [\"/api/watchlist\"],\n    enabled: !!user,\n  });\n\n  // Popular stocks query\n  const { data: popularStocksData, isLoading: popularStocksLoading } = useQuery({\n    queryKey: [\"/api/popular\"],\n    enabled: !!user,\n  });\n\n  // Auto-select first tournament when switching to tournament tab\n  useEffect(() => {\n    if (activeTab === \"tournament\" && activeTournaments.length > 0 && !selectedTournament) {\n      setSelectedTournament(activeTournaments[0]);\n    }\n  }, [activeTab, activeTournaments, selectedTournament]);\n\n  // Buy stock mutation\n  const buyStockMutation = useMutation({\n    mutationFn: async (data: { symbol: string; companyName: string; shares: number; purchasePrice: number; tournamentId?: number }) => {\n      if (data.tournamentId) {\n        // Use the correct tournament endpoint\n        return apiRequest(\"POST\", `/api/tournaments/${data.tournamentId}/purchase`, {\n          symbol: data.symbol,\n          companyName: data.companyName,\n          shares: data.shares,\n          purchasePrice: data.purchasePrice\n        });\n      } else {\n        // Personal portfolio endpoint\n        return apiRequest(\"POST\", \"/api/personal-portfolio/purchase\", {\n          symbol: data.symbol,\n          companyName: data.companyName,\n          shares: data.shares,\n          purchasePrice: data.purchasePrice\n        });\n      }\n    },\n    onSuccess: () => {\n      toast({ title: \"Stock purchased successfully!\" });\n      setBuyDialogOpen(false);\n      setBuyShares(\"\");\n      setSelectedStock(null);\n      if (activeTab === \"personal\") {\n        refetchPersonal();\n      } else if (selectedTournament) {\n        refetchTournament();\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", selectedTournament.id, \"balance\"] });\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Purchase failed\",\n        description: error.message || \"Unable to purchase stock\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Sell stock mutation\n  const sellStockMutation = useMutation({\n    mutationFn: async (data: { symbol: string; sharesToSell: number; currentPrice: number; tournamentId?: number }) => {\n      const endpoint = data.tournamentId \n        ? `/api/tournaments/${data.tournamentId}/sell` \n        : \"/api/personal-portfolio/sell\";\n\n      const payload = data.tournamentId \n        ? { symbol: data.symbol, sharesToSell: data.sharesToSell, currentPrice: data.currentPrice }\n        : { symbol: data.symbol, sharesToSell: data.sharesToSell, currentPrice: data.currentPrice };\n\n      return apiRequest(\"POST\", endpoint, payload);\n    },\n    onSuccess: () => {\n      toast({ title: \"Stock sold successfully!\" });\n      setSellDialogOpen(false);\n      setSellAmount(\"\");\n      setSelectedSellStock(null);\n      if (activeTab === \"personal\") {\n        refetchPersonal();\n      } else if (selectedTournament) {\n        refetchTournament();\n        queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", selectedTournament.id, \"balance\"] });\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Sale failed\",\n        description: error.message || \"Unable to sell stock\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Add to watchlist mutation\n  const addToWatchlistMutation = useMutation({\n    mutationFn: (stock: any) => \n      apiRequest(\"POST\", \"/api/watchlist\", {\n        symbol: stock.symbol,\n        companyName: stock.shortName || stock.longName || stock.symbol,\n      }),\n    onSuccess: () => {\n      toast({ title: \"Added to watchlist!\" });\n      refetchWatchlist();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to add to watchlist\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Remove from watchlist mutation\n  const removeFromWatchlistMutation = useMutation({\n    mutationFn: (id: number) => apiRequest(\"DELETE\", `/api/watchlist/${id}`),\n    onSuccess: () => {\n      toast({ title: \"Removed from watchlist!\" });\n      refetchWatchlist();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to remove from watchlist\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getCurrentBalance = (): number => {\n    if (activeTab === \"personal\") {\n      return Number(user?.balance) || 0;\n    } else if (selectedTournament && tournamentBalance) {\n      return (tournamentBalance as any)?.balance || 0;\n    }\n    return 0;\n  };\n\n  const getCurrentPortfolio = (): any[] => {\n    const personal = Array.isArray(personalPortfolio) ? personalPortfolio : [];\n    // Handle API response structure for tournament portfolio\n    const tournamentData = (tournamentPortfolio as any)?.data || tournamentPortfolio;\n    const tournament = Array.isArray(tournamentData) ? tournamentData : [];\n    return activeTab === \"personal\" ? personal : tournament;\n  };\n\n  const isPortfolioLoading = (): boolean => {\n    return activeTab === \"personal\" ? personalLoading : tournamentLoading;\n  };\n\n  // Fetch real-time data for watchlist stocks with timeframe support\n  useEffect(() => {\n    if (watchlist.length > 0) {\n      const fetchWatchlistData = async () => {\n        const stockData: {[key: string]: any} = {};\n\n        for (const stock of watchlist) {\n          try {\n            // Fetch current quote data first\n            const quoteResponse = await apiRequest(\"GET\", `/api/quote/${stock.symbol}`);\n            const quoteData = await quoteResponse.json();\n\n            const currentPrice = quoteData.data?.price || quoteData.data?.regularMarketPrice || 0;\n            const marketCap = quoteData.data?.marketCap || 0;\n            const volume = quoteData.data?.volume || quoteData.data?.regularMarketVolume || 0;\n\n            // For 1D timeframe, use the daily change from quote data\n            if (selectedTimeframe === '1D') {\n              const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n              const previousClose = quoteData.data?.previousClose || (currentPrice - changeAmount);\n              // Calculate percentage change manually if not provided\n              let changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n              if (changePercent === 0 && previousClose > 0) {\n                changePercent = (changeAmount / previousClose) * 100;\n              }\n\n              stockData[stock.symbol] = {\n                ...quoteData.data,\n                price: currentPrice,\n                change: changeAmount,\n                changePercent: changePercent,\n                marketCap: marketCap,\n                volume: volume,\n                previousClose: previousClose // Use actual previous close from Yahoo Finance\n              };\n            } else {\n              // For other timeframes, fetch historical data with proper error handling\n              try {\n                const historicalResponse = await fetch(`/api/historical/${stock.symbol}/${selectedTimeframe}`);\n\n                // Check if response is ok and content type is JSON\n                if (!historicalResponse.ok) {\n                  throw new Error(`HTTP ${historicalResponse.status}`);\n                }\n\n                const contentType = historicalResponse.headers.get('content-type');\n                if (!contentType || !contentType.includes('application/json')) {\n                  throw new Error('Response is not JSON');\n                }\n\n                const historicalData = await historicalResponse.json();\n\n                let changeAmount = 0;\n                let changePercent = 0;\n\n                if (historicalData.success && historicalData.data && historicalData.data.length > 0) {\n                  // Get the earliest price in the historical data (starting point for the timeframe)\n                  // Use the FIRST data point (oldest) instead of last (newest) for proper timeframe comparison\n                  const historicalPrice = historicalData.data[0].close;\n                  changeAmount = currentPrice - historicalPrice;\n                  changePercent = historicalPrice > 0 ? ((changeAmount / historicalPrice) * 100) : 0;\n\n                  stockData[stock.symbol] = {\n                    ...quoteData.data,\n                    price: currentPrice,\n                    change: changeAmount,\n                    changePercent: changePercent,\n                    marketCap: marketCap,\n                    volume: volume,\n                    previousClose: historicalPrice // This is the price at the timeframe start\n                  };\n                } else {\n                  // Fallback to daily change\n                  changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                  changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                  const fallbackPreviousClose = quoteData.data?.previousClose || (currentPrice - changeAmount);\n\n                  stockData[stock.symbol] = {\n                    ...quoteData.data,\n                    price: currentPrice,\n                    change: changeAmount,\n                    changePercent: changePercent,\n                    marketCap: marketCap,\n                    volume: volume,\n                    previousClose: fallbackPreviousClose // Use actual previous close or calculate\n                  };\n                }\n              } catch (histError) {\n                console.error(`Historical data error for ${stock.symbol}:`, histError);\n                // If historical data fails, use daily change as fallback\n                const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                const changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n\n                stockData[stock.symbol] = {\n                  ...quoteData.data,\n                  price: currentPrice,\n                  change: changeAmount,\n                  changePercent: changePercent,\n                  marketCap: marketCap,\n                  volume: volume,\n                  previousClose: currentPrice - changeAmount // Calculate from current price and change\n                };\n              }\n            }\n          } catch (error) {\n            console.error(`Error fetching data for ${stock.symbol}:`, error);\n            stockData[stock.symbol] = null;\n          }\n        }\n\n        setWatchlistStockData(stockData);\n      };\n\n      fetchWatchlistData();\n\n      // Refresh data every 30 seconds\n      const interval = setInterval(fetchWatchlistData, 30000);\n      return () => clearInterval(interval);\n    }\n  }, [watchlist, selectedTimeframe]);\n\n  if (!user) {\n    return (\n      <div className=\"h-[calc(100vh-4rem)] flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-foreground mb-2\">Please Log In</h2>\n          <p className=\"text-muted-foreground\">You need to be logged in to view your trading dashboard.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-[calc(100vh-4rem)] bg-background\">\n      <MarketStatusDisclaimer />\n\n      <div className=\"container mx-auto px-4 py-4\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"flex flex-col\"\n        >\n          {/* Compact Header */}\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-foreground\">Trading Dashboard</h1>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <Badge variant=\"outline\" className=\"text-sm\">\n                <DollarSign className=\"w-4 h-4 mr-1\" />\n                {formatCurrency(getCurrentBalance())}\n              </Badge>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"flex flex-col\">\n            <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n              <TabsTrigger value=\"personal\" className=\"flex items-center space-x-2\">\n                <Target className=\"w-4 h-4\" />\n                <span>Personal Portfolio</span>\n              </TabsTrigger>\n              <TabsTrigger value=\"tournament\" className=\"flex items-center space-x-2\">\n                <Trophy className=\"w-4 h-4\" />\n                <span>Tournament Trading</span>\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Personal Portfolio Tab */}\n            <TabsContent value=\"personal\">\n              <div className=\"space-y-4\">\n                {/* Portfolio Overview Bar */}\n                <PortfolioSummaryWidget />\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n                  {/* Main Trading Area - 2/3 width */}\n                  <div className=\"lg:col-span-2 space-y-4\">\n                    {/* Portfolio Grid */}\n                    <Card>\n                      <CardHeader className=\"pb-3\">\n                        <CardTitle className=\"text-lg\">Your Holdings & Performance</CardTitle>\n                      </CardHeader>\n                      <CardContent>\n                        <PortfolioGrid selectedChartStock={selectedChartStock} onSelectStock={setSelectedChartStock} />\n                      </CardContent>\n                    </Card>\n                  </div>\n\n                  {/* Sidebar - 1/3 width */}\n                  <div className=\"space-y-4\">\n                  {/* Watchlist Search */}\n                  <Card>\n                    <CardHeader className=\"pb-3\">\n                      <CardTitle className=\"text-sm\">Add to Watchlist</CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <StockSearchBar type=\"watchlist\" placeholder=\"Search stocks to watch...\" />\n                    </CardContent>\n                  </Card>\n\n                  {/* Watchlist */}\n                  <Card className=\"flex flex-col overflow-hidden\">\n                    <CardHeader className=\"pb-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <CardTitle className=\"flex items-center space-x-2 text-lg\">\n                          <Star className=\"w-4 h-4\" />\n                          <span>Watchlist</span>\n                        </CardTitle>\n                      <div className=\"flex items-center space-x-1\">\n                        <Select value={selectedTimeframe} onValueChange={setSelectedTimeframe}>\n                          <SelectTrigger className=\"w-20 h-8\">\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"1D\">1D</SelectItem>\n                            <SelectItem value=\"5D\">5D</SelectItem>\n                            <SelectItem value=\"1M\">1M</SelectItem>\n                            <SelectItem value=\"3M\">3M</SelectItem>\n                            <SelectItem value=\"6M\">6M</SelectItem>\n                            <SelectItem value=\"1Y\">1Y</SelectItem>\n                            <SelectItem value=\"YTD\">YTD</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          className=\"h-8 px-2\"\n                          onClick={() => {\n                            // Manual refresh watchlist data\n                            if (watchlist.length > 0) {\n                              const fetchWatchlistData = async () => {\n                                const stockData: {[key: string]: any} = {};\n                                for (const stock of watchlist) {\n                                  try {\n                                    const quoteResponse = await apiRequest(\"GET\", `/api/quote/${stock.symbol}`);\n                                    const quoteData = await quoteResponse.json();\n                                    const currentPrice = quoteData.data?.price || quoteData.data?.regularMarketPrice || 0;\n                                    const changeAmount = quoteData.data?.change || quoteData.data?.regularMarketChange || 0;\n                                    const changePercent = quoteData.data?.changePercent || quoteData.data?.regularMarketChangePercent || 0;\n                                    stockData[stock.symbol] = {\n                                      ...quoteData.data,\n                                      price: currentPrice,\n                                      change: changeAmount,\n                                      changePercent: changePercent,\n                                    };\n                                  } catch (error) {\n                                    console.error(`Error refreshing ${stock.symbol}:`, error);\n                                    stockData[stock.symbol] = null;\n                                  }\n                                }\n                                setWatchlistStockData(stockData);\n                              };\n                              fetchWatchlistData();\n                            }\n                          }}\n                        >\n                          <RefreshCw className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"flex-1 overflow-auto\">\n                    {/* Watchlist Content */}\n                    {watchlistLoading ? (\n                      <div className=\"flex items-center justify-center py-8\">\n                        <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                        <span className=\"text-sm text-muted-foreground\">Loading...</span>\n                      </div>\n                    ) : watchlist.length === 0 ? (\n                      <div className=\"text-center py-8\">\n                        <Star className=\"w-8 h-8 mx-auto text-muted-foreground mb-3 opacity-50\" />\n                        <h3 className=\"font-semibold mb-2\">No watchlist items</h3>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Add stocks to monitor\n                        </p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-2\">\n                        {watchlist.map((stock) => {\n                          const stockData = watchlistStockData[stock.symbol];\n\n                          if (!stockData) {\n                            return (\n                              <div\n                                key={stock.id}\n                                className=\"p-3 border rounded hover:bg-muted/30 transition-colors\"\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <div className=\"font-semibold text-sm\">{stock.symbol}</div>\n                                    <div className=\"text-xs text-muted-foreground truncate\">\n                                      {stock.companyName}\n                                    </div>\n                                  </div>\n                                  <div className=\"text-xs text-muted-foreground\">\n                                    <RefreshCw className=\"w-3 h-3 animate-spin inline mr-1\" />\n                                    Loading...\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          }\n\n                          const currentPrice = stockData.price || 0;\n                          const changeAmount = stockData.change || 0;\n                          const changePercent = stockData.changePercent || 0;\n                          const isPositive = changeAmount >= 0;\n\n                          return (\n                            <div\n                              key={stock.id}\n                              className=\"p-3 border rounded hover:bg-muted/30 transition-colors\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <div className=\"font-semibold text-sm\">{stock.symbol}</div>\n                                  <div className=\"text-xs text-muted-foreground truncate\">\n                                    {stock.companyName}\n                                  </div>\n                                </div>\n                                <div className=\"text-right\">\n                                  <div className=\"font-semibold text-sm\">\n                                    {formatCurrency(currentPrice)}\n                                  </div>\n                                  <div className={`text-xs ${isPositive ? 'text-green-600' : 'text-red-600'}`}>\n                                    {isPositive ? '+' : ''}{formatCurrency(changeAmount)} ({changePercent.toFixed(2)}%)\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"flex justify-between items-center mt-2\">\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    className=\"h-6 px-2 text-xs\"\n                                    onClick={() => {\n                                      setSelectedStock({ symbol: stock.symbol, shortName: stock.companyName });\n                                      setBuyDialogOpen(true);\n                                    }}\n                                  >\n                                    <ShoppingCart className=\"w-3 h-3 mr-1\" />\n                                    {t('buy')}\n                                  </Button>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-6 px-2\"\n                                  onClick={() => removeFromWatchlistMutation.mutate(stock.id)}\n                                >\n                                  <X className=\"w-3 h-3\" />\n                                </Button>\n                              </div>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n\n            {/* Tournament Trading Tab */}\n            <TabsContent value=\"tournament\" className=\"flex-1 overflow-hidden\">\n              {activeTournaments.length === 0 ? (\n                <Card className=\"flex items-center justify-center h-full\">\n                  <CardContent className=\"py-8\">\n                    <div className=\"text-center\">\n                      <Trophy className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                      <h3 className=\"text-lg font-semibold mb-2\">No Active Tournaments</h3>\n                      <p className=\"text-muted-foreground mb-4\">\n                        Join or create a tournament to start competitive trading\n                      </p>\n                      <Button asChild>\n                        <a href=\"/tournaments\">\n                          <Plus className=\"w-4 h-4 mr-2\" />\n                          Browse Tournaments\n                        </a>\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"h-full flex flex-col\">\n                  {/* Tournament Selector */}\n                  <div className=\"flex items-center space-x-4 mb-4 p-3 bg-muted/60 rounded-lg\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Trophy className=\"w-4 h-4 text-primary\" />\n                      <span className=\"text-sm font-medium\">Tournament:</span>\n                    </div>\n                    <Select\n                      value={selectedTournament?.id?.toString() || \"\"}\n                      onValueChange={(value) => {\n                        const tournament = activeTournaments.find((t: any) => t.id.toString() === value);\n                        setSelectedTournament(tournament);\n                      }}\n                    >\n                      <SelectTrigger className=\"w-[300px]\">\n                        <SelectValue placeholder=\"Select tournament\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {activeTournaments.map((tournament: any) => (\n                          <SelectItem key={tournament.id} value={tournament.id.toString()}>\n                            <div className=\"flex items-center space-x-2\">\n                              <span>{tournament.name}</span>\n                              <Badge variant={tournament.tournamentType === \"crypto\" ? \"secondary\" : \"default\"} className=\"text-xs\">\n                                {tournament.tournamentType === \"crypto\" ? \"🪙\" : \"📈\"}\n                              </Badge>\n                            </div>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    {selectedTournament && (\n                      <Badge variant=\"outline\">\n                        <Users className=\"w-3 h-3 mr-1\" />\n                        {selectedTournament.currentPlayers} players\n                      </Badge>\n                    )}\n                  </div>\n\n                  {/* Tournament Content */}\n                  {selectedTournament ? (\n                    <div className=\"flex-1 flex flex-col space-y-4 overflow-hidden\">\n                      {/* Overview Bar */}\n                      <div className=\"grid grid-cols-2 lg:grid-cols-5 gap-4\">\n                        <Card>\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <DollarSign className=\"w-4 h-4 text-muted-foreground\" />\n                              <span className=\"text-sm font-medium text-muted-foreground\">Portfolio Value</span>\n                            </div>\n                            <div className=\"text-2xl font-bold\">\n                              {formatCurrency(\n                                (getCurrentPortfolio() as any[]).reduce((total, holding) => \n                                  total + (holding.shares || 0) * (holding.currentPrice || 0), 0\n                                ) + ((tournamentBalance as any)?.data?.balance || (tournamentBalance as any)?.balance || 0)\n                              )}\n                            </div>\n                          </CardContent>\n                        </Card>\n                        <Card>\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <Coins className=\"w-4 h-4 text-muted-foreground\" />\n                              <span className=\"text-sm font-medium text-muted-foreground\">Cash Balance</span>\n                            </div>\n                            <div className=\"text-2xl font-bold\">\n                              {formatCurrency((tournamentBalance as any)?.data?.balance || (tournamentBalance as any)?.balance || 0)}\n                            </div>\n                          </CardContent>\n                        </Card>\n                        <Card>\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <TrendingUp className=\"w-4 h-4 text-muted-foreground\" />\n                              <span className=\"text-sm font-medium text-muted-foreground\">Profit/Loss</span>\n                            </div>\n                            <div className={`text-2xl font-bold ${\n                              (getCurrentPortfolio() as any[]).reduce((total, holding) => \n                                total + (holding.shares || 0) * ((holding.currentPrice || 0) - (holding.purchasePrice || 0)), 0\n                              ) >= 0 ? 'text-green-600' : 'text-red-600'\n                            }`}>\n                              {((getCurrentPortfolio() as any[]).reduce((total, holding) => \n                                total + (holding.shares || 0) * ((holding.currentPrice || 0) - (holding.purchasePrice || 0)), 0\n                              ) >= 0 ? '+' : '')}\n                              {formatCurrency(\n                                (getCurrentPortfolio() as any[]).reduce((total, holding) => \n                                  total + (holding.shares || 0) * ((holding.currentPrice || 0) - (holding.purchasePrice || 0)), 0\n                                )\n                              )}\n                            </div>\n                          </CardContent>\n                        </Card>\n                        <Card>\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <BarChart3 className=\"w-4 h-4 text-muted-foreground\" />\n                              <span className=\"text-sm font-medium text-muted-foreground\">{t('holdings')}</span>\n                            </div>\n                            <div className=\"text-2xl font-bold\">\n                              {(getCurrentPortfolio() as any[]).length}\n                            </div>\n                          </CardContent>\n                        </Card>\n                        <Card>\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <Trophy className=\"w-4 h-4 text-muted-foreground\" />\n                              <span className=\"text-sm font-medium text-muted-foreground\">{t('buyIn')}</span>\n                            </div>\n                            <div className=\"text-2xl font-bold\">\n                              {formatCurrency(selectedTournament.buyInAmount || 0)}\n                            </div>\n                          </CardContent>\n                        </Card>\n                      </div>\n\n                      {/* Trading Interface */}\n                      <div className=\"flex-1 grid grid-cols-1 lg:grid-cols-3 gap-4 overflow-hidden\">\n                        <div className=\"lg:col-span-2 space-y-4\">\n                          <div className=\"h-[500px]\">\n                            <TournamentPerformanceChart \n                              tournamentId={selectedTournament.id} \n                              selectedStock={selectedChartStock} \n                            />\n                          </div>\n\n                          {/* Buy Stocks Search */}\n                          <Card>\n                            <CardHeader className=\"pb-3\">\n                              <CardTitle className=\"text-lg\">Buy Stocks</CardTitle>\n                            </CardHeader>\n                            <CardContent>\n                              <StockSearchBar \n                              type=\"purchase\" \n                              placeholder=\"Search stocks to buy...\" \n                              tournamentId={selectedTournament?.id}\n                              onStockSelect={(stock) => {\n                                setSelectedStock(stock);\n                                setBuyDialogOpen(true);\n                              }}\n                            />\n                            </CardContent>\n                          </Card>\n\n                          <Card>\n                            <CardHeader className=\"pb-3\">\n                              <CardTitle className=\"text-lg\">Tournament Portfolio</CardTitle>\n                            </CardHeader>\n                            <CardContent>\n                              {isPortfolioLoading() ? (\n                                <div className=\"flex items-center justify-center py-8\">\n                                  <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                                  <span className=\"text-sm text-muted-foreground\">Loading...</span>\n                                </div>\n                              ) : (getCurrentPortfolio() as any[]).length === 0 ? (\n                                <div className=\"text-center py-8\">\n                                  <Coins className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                                  <h3 className=\"text-lg font-semibold mb-2\">No Holdings</h3>\n                                  <p className=\"text-muted-foreground\">Start trading to build your portfolio</p>\n                                </div>\n                              ) : (\n                                <div className=\"space-y-2\">\n                                  {/* Table Header */}\n                                  <div className=\"grid grid-cols-7 gap-2 px-3 py-2 text-xs font-medium text-muted-foreground border-b\">\n                                    <div>Symbol</div>\n                                    <div>Shares</div>\n                                    <div>Purchase Price</div>\n                                    <div>Current Price</div>\n                                    <div>Change</div>\n                                    <div>Value</div>\n                                    <div>Actions</div>\n                                  </div>\n\n                                  {(getCurrentPortfolio() as any[]).map((holding: any, index: number) => {\n                                    const currentValue = (holding.shares || 0) * (holding.currentPrice || 0);\n                                    const purchasePrice = holding.averagePurchasePrice || holding.purchasePrice || 0;\n                                    const totalCost = holding.totalCost || ((holding.shares || 0) * purchasePrice);\n                                    const gainLoss = currentValue - totalCost;\n                                    const priceChange = (holding.currentPrice || 0) - purchasePrice;\n                                    const priceChangePercent = totalCost > 0 ? (priceChange / purchasePrice) * 100 : 0;\n                                    const isPositive = gainLoss >= 0;\n\n                                    return (\n                                      <div\n                                        key={index}\n                                        className=\"grid grid-cols-7 gap-2 px-3 py-2 rounded-lg border border-border/50 hover:bg-muted/30 transition-colors items-center\"\n                                      >\n                                        <div className=\"flex flex-col\">\n                                          <span className=\"font-medium text-sm text-foreground\">\n                                            {holding.symbol}\n                                          </span>\n                                          <span className=\"text-xs text-muted-foreground truncate\">\n                                            {holding.companyName || holding.symbol}\n                                          </span>\n                                        </div>\n\n                                        <div className=\"text-sm\">\n                                          {holding.shares}\n                                        </div>\n\n                                        <div className=\"text-sm\">\n                                          {formatCurrency(purchasePrice)}\n                                        </div>\n\n                                        <div className=\"text-sm font-medium\">\n                                          {formatCurrency(holding.currentPrice || 0)}\n                                        </div>\n\n                                        <div className={`text-sm flex items-center gap-1 ${\n                                          isPositive ? 'text-green-500' : 'text-red-500'\n                                        }`}>\n                                          {isPositive ? (\n                                            <TrendingUp className=\"h-3 w-3\" />\n                                          ) : (\n                                            <TrendingDown className=\"h-3 w-3\" />\n                                          )}\n                                          <div className=\"flex flex-col\">\n                                            <span>{isPositive ? '+' : ''}{formatCurrency(priceChange)}</span>\n                                            <span className=\"text-xs\">({isPositive ? '+' : ''}{priceChangePercent.toFixed(2)}%)</span>\n                                          </div>\n                                        </div>\n\n                                        <div className=\"text-sm font-medium\">\n                                          {formatCurrency(currentValue)}\n                                        </div>\n\n                                        <div className=\"flex gap-1\">\n                                          <Button\n                                            size=\"sm\"\n                                            variant=\"outline\"\n                                            onClick={() => setSelectedChartStock(holding.symbol)}\n                                            className=\"text-xs px-2 py-1 h-7\"\n                                            title=\"View chart\"\n                                          >\n                                            <BarChart3 className=\"h-3 w-3\" />\n                                          </Button>\n                                          <Button\n                                            size=\"sm\"\n                                            variant=\"outline\"\n                                            onClick={() => {\n                                              setSelectedSellStock(holding);\n                                              setSellDialogOpen(true);\n                                            }}\n                                            className=\"text-xs px-2 py-1 h-7\"\n                                          >\n                                            Sell\n                                          </Button>\n                                        </div>\n                                      </div>\n                                    );\n                                  })}\n                                </div>\n                              )}\n                            </CardContent>\n                          </Card>\n                        </div>\n                        <div className=\"space-y-4\">\n                          {/* Watchlist Search */}\n                          <Card>\n                            <CardHeader className=\"pb-3\">\n                              <CardTitle className=\"text-lg\">Add to Watchlist</CardTitle>\n                            </CardHeader>\n                            <CardContent>\n                              <StockSearchBar type=\"watchlist\" placeholder=\"Search stocks to watch...\" />\n                            </CardContent>\n                          </Card>\n\n                          <Card>\n                            <CardHeader className=\"pb-3\">\n                              <CardTitle className=\"text-lg\">Market Watch</CardTitle>\n                            </CardHeader>\n                            <CardContent>\n                              {watchlistLoading ? (\n                                <div className=\"flex items-center justify-center py-8\">\n                                  <RefreshCw className=\"w-4 h-4 animate-spin mr-2\" />\n                                  <span className=\"text-sm text-muted-foreground\">Loading watchlist...</span>\n                                </div>\n                              ) : watchlist.length === 0 ? (\n                                <div className=\"text-center py-8\">\n                                  <Star className=\"w-8 h-8 mx-auto text-muted-foreground mb-3 opacity-50\" />\n                                  <h3 className=\"font-semibold mb-2\">No watchlist items</h3>\n                                  <p className=\"text-xs text-muted-foreground\">\n                                    Add stocks to monitor\n                                  </p>\n                                </div>\n                              ) : (\n                                <div className=\"space-y-2\">\n                                  {watchlist.map((stock) => {\n                                    const stockData = watchlistStockData[stock.symbol];\n\n                                    if (!stockData) {\n                                      return (\n                                        <div\n                                          key={stock.id}\n                                          className=\"p-3 border rounded hover:bg-muted/30 transition-colors\"\n                                        >\n                                          <div className=\"flex justify-between items-center\">\n                                            <div>\n                                              <div className=\"font-semibold text-sm\">{stock.symbol}</div>\n                                              <div className=\"text-xs text-muted-foreground truncate\">\n                                                {stock.companyName}\n                                              </div>\n                                            </div>\n                                            <div className=\"text-xs text-muted-foreground\">\n                                              <RefreshCw className=\"w-3 h-3 animate-spin inline mr-1\" />\n                                              Loading...\n                                            </div>\n                                          </div>\n                                        </div>\n                                      );\n                                    }\n\n                                    const currentPrice = stockData.price || 0;\n                                    const changeAmount = stockData.change || 0;\n                                    const changePercent = stockData.changePercent || 0;\n                                    const isPositive = changeAmount >= 0;\n\n                                    return (\n                                      <div\n                                        key={stock.id}\n                                        className=\"p-3 border rounded hover:bg-muted/30 transition-colors\"\n                                      >\n                                        <div className=\"flex justify-between items-center\">\n                                          <div>\n                                            <div className=\"font-semibold text-sm\">{stock.symbol}</div>\n                                            <div className=\"text-xs text-muted-foreground truncate\">\n                                              {stock.companyName}\n                                            </div>\n                                          </div>\n                                          <div className=\"text-right\">\n                                            <div className=\"font-semibold text-sm\">\n                                              {formatCurrency(currentPrice)}\n                                            </div>\n                                            <div className={`text-xs ${isPositive ? 'text-green-600' : 'text-red-600'}`}>\n                                              {isPositive ? '+' : ''}{formatCurrency(changeAmount)} ({changePercent.toFixed(2)}%)\n                                            </div>\n                                          </div>\n                                        </div>\n                                        <div className=\"flex justify-between items-center mt-2\">\n                                          <Button\n                                            size=\"sm\"\n                                            variant=\"outline\"\n                                            className=\"h-6 px-2 text-xs\"\n                                            onClick={() => {\n                                              setSelectedStock({ \n                                                symbol: stock.symbol, \n                                                shortName: stock.companyName,\n                                                price: currentPrice\n                                              });\n                                              setBuyDialogOpen(true);\n                                            }}\n                                          >\n                                            <ShoppingCart className=\"w-3 h-3 mr-1\" />\n                                            {t('buy')}\n                                          </Button>\n                                          <Button\n                                            size=\"sm\"\n                                            variant=\"ghost\"\n                                            className=\"h-6 px-2\"\n                                            onClick={() => removeFromWatchlistMutation.mutate(stock.id)}\n                                          >\n                                            <X className=\"w-3 h-3\" />\n                                          </Button>\n                                        </div>\n                                      </div>\n                                    );\n                                  })}\n                                </div>\n                              )}\n                            </CardContent>\n                          </Card>\n\n                          {/* Tournament Leaderboard */}\n                          <TournamentLeaderboard \n                            tournamentId={selectedTournament.id}\n                            onViewFullLeaderboard={() => setLeaderboardDialogOpen(true)}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"flex-1 flex items-center justify-center\">\n                      <p className=\"text-muted-foreground\">Select a tournament to start trading</p>\n                    </div>\n                  )}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </motion.div>\n      </div>\n\n      {/* Tournament Leaderboard Dialog */}\n      <TournamentLeaderboardDialog\n        tournament={selectedTournament}\n        isOpen={leaderboardDialogOpen}\n        onClose={() => setLeaderboardDialogOpen(false)}\n      />\n\n      {/* Buy Stock Dialog */}\n      <Dialog open={buyDialogOpen} onOpenChange={setBuyDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Buy Stock - {selectedStock?.symbol}</DialogTitle>\n            <DialogDescription>\n              Enter the number of shares you want to buy of {selectedStock?.shortName || selectedStock?.longName} at {selectedStock?.price ? formatCurrency(selectedStock.price) : ''} per share\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"buyShares\">Number of Shares</Label>\n              <Input\n                id=\"buyShares\"\n                type=\"number\"\n                min=\"1\"\n                step=\"1\"\n                value={buyShares}\n                onChange={(e) => setBuyShares(e.target.value)}\n                placeholder=\"Enter number of shares...\"\n              />\n              {selectedStock?.price && buyShares && (\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  Total cost: {formatCurrency(parseInt(buyShares) * selectedStock.price)}\n                </p>\n              )}\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <Button variant=\"outline\" onClick={() => setBuyDialogOpen(false)}>\n                Cancel\n              </Button>\n              <Button\n                onClick={() => {\n                  const shares = parseInt(buyShares);\n                  if (shares && shares > 0 && selectedStock && selectedStock.price) {\n                    buyStockMutation.mutate({\n                      symbol: selectedStock.symbol,\n                      companyName: selectedStock.shortName || selectedStock.longName || selectedStock.companyName || selectedStock.symbol,\n                      shares,\n                      purchasePrice: selectedStock.price,\n                      tournamentId: activeTab === \"tournament\" ? selectedTournament?.id : undefined,\n                    });\n                  }\n                }}\n                disabled={!buyShares || parseInt(buyShares) <= 0 || buyStockMutation.isPending}\n              >\n                {buyStockMutation.isPending ? \"Purchasing...\" : \"Buy Stock\"}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Sell Stock Dialog */}\n      <Dialog open={sellDialogOpen} onOpenChange={setSellDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Sell Stock - {selectedSellStock?.symbol}</DialogTitle>\n            <DialogDescription>\n              Enter the number of shares you want to sell\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"sellAmount\">Shares to Sell</Label>\n              <Input\n                id=\"sellAmount\"\n                type=\"number\"\n                min=\"1\"\n                max={selectedSellStock?.shares || 0}\n                value={sellAmount}\n                onChange={(e) => setSellAmount(e.target.value)}\n                placeholder=\"Enter number of shares to sell...\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                You own {selectedSellStock?.shares || 0} shares\n              </p>\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <Button variant=\"outline\" onClick={() => setSellDialogOpen(false)}>\n                Cancel\n              </Button>\n              <Button\n                onClick={() => {\n                  const sharesToSell = parseInt(sellAmount);\n                  if (sharesToSell && selectedSellStock) {\n                    sellStockMutation.mutate({\n                      symbol: selectedSellStock.symbol,\n                      sharesToSell,\n                      currentPrice: selectedSellStock.currentPrice || selectedSellStock.purchasePrice || 0,\n                      tournamentId: activeTab === \"tournament\" ? selectedTournament?.id : undefined,\n                    });\n                  }\n                }}\n                disabled={!sellAmount || parseInt(sellAmount) <= 0 || sellStockMutation.isPending}\n              >\n                {sellStockMutation.isPending ? \"Selling...\" : \"Sell Stock\"}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","size_bytes":56033},"client/src/pages/events.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Calendar,\n  Trophy,\n  Clock,\n  Users,\n  Star,\n  Wrench,\n  ArrowLeft,\n  Sparkles,\n  Target,\n  Bell\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.5 }\n};\n\nexport default function Events() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-6 py-8\">\n        \n        {/* Header */}\n        <motion.div \n          className=\"mb-8\"\n          {...fadeInUp}\n        >\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-4\">\n              <Link href=\"/hub\">\n                <Button variant=\"ghost\" size=\"sm\">\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                  Back to Hub\n                </Button>\n              </Link>\n              <div>\n                <h1 className=\"text-3xl font-bold text-foreground flex items-center\">\n                  <Calendar className=\"w-8 h-8 mr-3 text-primary\" />\n                  Special Events\n                </h1>\n                <p className=\"text-muted-foreground mt-1\">\n                  Exclusive trading competitions and seasonal challenges\n                </p>\n              </div>\n            </div>\n            <Badge variant=\"secondary\" className=\"text-sm\">\n              <Wrench className=\"w-4 h-4 mr-1\" />\n              Work in Progress\n            </Badge>\n          </div>\n        </motion.div>\n\n        {/* Coming Soon Section */}\n        <motion.div \n          className=\"mb-12\"\n          initial={{ opacity: 0, y: 30 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, delay: 0.2 }}\n        >\n          <Card className=\"border-dashed border-2 border-primary/30 bg-primary/5\">\n            <CardContent className=\"p-12 text-center\">\n              <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-6\">\n                <Calendar className=\"w-10 h-10 text-primary\" />\n              </div>\n              <h2 className=\"text-2xl font-bold text-foreground mb-4\">\n                Special Events Coming Soon!\n              </h2>\n              <p className=\"text-muted-foreground text-lg mb-6 max-w-2xl mx-auto\">\n                Get ready for exclusive trading competitions, seasonal challenges, \n                and special tournaments with amazing prizes and unique trading scenarios.\n              </p>\n              <div className=\"flex items-center justify-center space-x-2 text-primary\">\n                <Clock className=\"w-5 h-5\" />\n                <span className=\"font-medium\">First Event: March 2025</span>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Upcoming Event Types */}\n        <motion.div \n          className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.8, delay: 0.4 }}\n        >\n          {[\n            {\n              title: \"Monthly Mega Tournament\",\n              description: \"Large-scale tournaments with massive prize pools\",\n              icon: Trophy,\n              color: \"text-yellow-500\",\n              participants: \"1000+ Traders\",\n              prize: \"$10,000 Pool\"\n            },\n            {\n              title: \"Weekend Blitz\",\n              description: \"Fast-paced 48-hour trading challenges\",\n              icon: Sparkles,\n              color: \"text-blue-500\",\n              participants: \"500+ Traders\",\n              prize: \"Premium Rewards\"\n            },\n            {\n              title: \"Seasonal Challenges\",\n              description: \"Special themed competitions throughout the year\",\n              icon: Target,\n              color: \"text-green-500\",\n              participants: \"Open to All\",\n              prize: \"Exclusive Badges\"\n            },\n            {\n              title: \"Celebrity Trader Events\",\n              description: \"Trade alongside famous investors and influencers\",\n              icon: Star,\n              color: \"text-purple-500\",\n              participants: \"Limited Spots\",\n              prize: \"Meet & Greet\"\n            },\n            {\n              title: \"Charity Tournaments\",\n              description: \"Trade for a cause with proceeds going to charity\",\n              icon: Users,\n              color: \"text-red-500\",\n              participants: \"Community Driven\",\n              prize: \"Good Karma\"\n            },\n            {\n              title: \"Learning Workshops\",\n              description: \"Educational events with expert traders and analysts\",\n              icon: Calendar,\n              color: \"text-orange-500\",\n              participants: \"All Levels\",\n              prize: \"Knowledge & Skills\"\n            }\n          ].map((event, index) => (\n            <Card key={index} className=\"bg-card/50 backdrop-blur-sm border-border/50 hover:bg-card/70 transition-all duration-300\">\n              <CardHeader className=\"pb-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div className=\"w-10 h-10 bg-muted/50 rounded-full flex items-center justify-center\">\n                    <event.icon className={`w-5 h-5 ${event.color}`} />\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    Coming Soon\n                  </Badge>\n                </div>\n                <CardTitle className=\"text-lg\">{event.title}</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-muted-foreground text-sm mb-4\">\n                  {event.description}\n                </p>\n                <div className=\"space-y-2 text-xs\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-muted-foreground\">Participants:</span>\n                    <span className=\"font-medium\">{event.participants}</span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-muted-foreground\">Rewards:</span>\n                    <span className=\"font-medium\">{event.prize}</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </motion.div>\n\n        {/* Notification Signup */}\n        <motion.div \n          className=\"text-center\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.8, delay: 0.6 }}\n        >\n          <Card className=\"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20 max-w-2xl mx-auto\">\n            <CardContent className=\"p-8\">\n              <h3 className=\"text-xl font-bold text-foreground mb-2\">\n                Don't Miss Out on Special Events\n              </h3>\n              <p className=\"text-muted-foreground mb-6\">\n                Be the first to know about upcoming events, early registration, and exclusive invites\n              </p>\n              <div className=\"flex items-center justify-center space-x-4\">\n                <Button className=\"bg-primary hover:bg-primary/90\">\n                  <Bell className=\"w-4 h-4 mr-2\" />\n                  Notify Me\n                </Button>\n                <Button variant=\"outline\">\n                  <Calendar className=\"w-4 h-4 mr-2\" />\n                  View Calendar\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n      </div>\n    </div>\n  );\n}","size_bytes":7859},"client/src/pages/home.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { ResearchInsight, Study, News } from \"@shared/schema\";\nimport { TrendingUp, AlertTriangle, Lightbulb, ArrowRight } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport default function Home() {\n  const { user } = useAuth();\n  \n  const { data: insights, isLoading: insightsLoading } = useQuery<ResearchInsight[]>({\n    queryKey: [\"/api/insights\"],\n  });\n\n  const { data: recentStudies, isLoading: studiesLoading } = useQuery<Study[]>({\n    queryKey: [\"/api/studies\"],\n  });\n\n  const { data: breakingNews, isLoading: newsLoading } = useQuery<News[]>({\n    queryKey: [\"/api/news/breaking\"],\n  });\n\n  const getInsightIcon = (type: string) => {\n    switch (type) {\n      case \"opportunity\":\n        return <Lightbulb className=\"w-5 h-5 text-green-600\" />;\n      case \"risk\":\n        return <AlertTriangle className=\"w-5 h-5 text-red-600\" />;\n      default:\n        return <TrendingUp className=\"w-5 h-5 text-blue-600\" />;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Welcome Section */}\n      <section className=\"py-12 bg-card\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <h1 className=\"text-4xl font-bold text-foreground mb-4\">\n                Welcome back, {user?.name || \"Researcher\"}!\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Here's your personalized research dashboard with the latest insights and opportunities.\n              </p>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Dashboard Content */}\n      <section className=\"py-12\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <div className=\"grid lg:grid-cols-3 gap-8\">\n              {/* Research Insights */}\n              <div className=\"lg:col-span-2\">\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h2 className=\"text-2xl font-bold text-foreground mb-6\">Research Insights</h2>\n                    {insightsLoading ? (\n                      <div className=\"space-y-4\">\n                        {Array.from({ length: 3 }).map((_, i) => (\n                          <div key={i} className=\"animate-pulse\">\n                            <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                            <div className=\"h-6 bg-muted rounded mb-3\"></div>\n                            <div className=\"h-16 bg-muted rounded\"></div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : insights && insights.length > 0 ? (\n                      <div className=\"space-y-4\">\n                        {insights.map((insight, index) => (\n                          <motion.div\n                            key={insight.id}\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            transition={{ duration: 0.6, delay: index * 0.1 }}\n                            className=\"p-4 bg-muted rounded-lg\"\n                          >\n                            <div className=\"flex items-center mb-2\">\n                              {getInsightIcon(insight.type)}\n                              <span className=\"font-semibold text-foreground ml-2\">{insight.title}</span>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground\">{insight.description}</p>\n                            {insight.symbol && (\n                              <span className=\"text-xs text-muted-foreground mt-1 block\">\n                                Symbol: {insight.symbol}\n                              </span>\n                            )}\n                          </motion.div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8\">\n                        <p className=\"text-muted-foreground\">No insights available at the moment.</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Recent Studies */}\n                <Card className=\"mt-8\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between mb-6\">\n                      <h2 className=\"text-2xl font-bold text-foreground\">Recent Studies</h2>\n                      <Button variant=\"outline\" size=\"sm\">\n                        View All\n                      </Button>\n                    </div>\n                    {studiesLoading ? (\n                      <div className=\"space-y-4\">\n                        {Array.from({ length: 3 }).map((_, i) => (\n                          <div key={i} className=\"animate-pulse\">\n                            <div className=\"h-6 bg-muted rounded mb-2\"></div>\n                            <div className=\"h-16 bg-muted rounded\"></div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : recentStudies && recentStudies.length > 0 ? (\n                      <div className=\"space-y-4\">\n                        {recentStudies.slice(0, 3).map((study, index) => (\n                          <motion.div\n                            key={study.id}\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            transition={{ duration: 0.6, delay: index * 0.1 }}\n                            className=\"flex items-center justify-between p-3 bg-muted rounded\"\n                          >\n                            <div>\n                              <h3 className=\"font-semibold text-foreground\">{study.title}</h3>\n                              <p className=\"text-sm text-muted-foreground\">{study.category}</p>\n                            </div>\n                            <Button variant=\"ghost\" size=\"sm\">\n                              <ArrowRight className=\"w-4 h-4\" />\n                            </Button>\n                          </motion.div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8\">\n                        <p className=\"text-muted-foreground\">No studies available at the moment.</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Sidebar */}\n              <div className=\"space-y-8\">\n                {/* Breaking News */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"text-lg font-bold text-foreground mb-4\">Breaking News</h3>\n                    {newsLoading ? (\n                      <div className=\"space-y-4\">\n                        {Array.from({ length: 2 }).map((_, i) => (\n                          <div key={i} className=\"animate-pulse\">\n                            <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                            <div className=\"h-16 bg-muted rounded\"></div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : breakingNews && breakingNews.length > 0 ? (\n                      <div className=\"space-y-4\">\n                        {breakingNews.slice(0, 2).map((news, index) => (\n                          <motion.div\n                            key={news.id}\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            transition={{ duration: 0.6, delay: index * 0.1 }}\n                            className=\"border-l-4 border-red-500 pl-4\"\n                          >\n                            <div className=\"flex items-center mb-1\">\n                              <span className=\"bg-red-500 text-white px-2 py-1 rounded text-xs font-semibold mr-2\">\n                                BREAKING\n                              </span>\n                              <span className=\"text-xs text-muted-foreground\">\n                                {new Date(news.publishedAt!).toLocaleTimeString()}\n                              </span>\n                            </div>\n                            <h4 className=\"font-semibold text-foreground text-sm\">{news.title}</h4>\n                            <p className=\"text-xs text-muted-foreground mt-1\">{news.description}</p>\n                          </motion.div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-4\">\n                        <p className=\"text-muted-foreground text-sm\">No breaking news at the moment.</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Market Sentiment */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"text-lg font-bold text-foreground mb-4\">Market Sentiment</h3>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-muted-foreground\">Overall Sentiment</span>\n                        <span className=\"text-sm font-semibold text-green-600\">Positive</span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-muted-foreground\">Weekend Impact</span>\n                        <span className=\"text-sm font-semibold text-foreground\">High</span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-muted-foreground\">Opportunities</span>\n                        <span className=\"text-sm font-semibold text-blue-600\">12 Active</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Quick Actions */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"text-lg font-bold text-foreground mb-4\">Quick Actions</h3>\n                    <div className=\"space-y-3\">\n                      <Button variant=\"outline\" className=\"w-full justify-start\">\n                        <TrendingUp className=\"w-4 h-4 mr-2\" />\n                        View Dashboard\n                      </Button>\n                      <Button variant=\"outline\" className=\"w-full justify-start\">\n                        <Lightbulb className=\"w-4 h-4 mr-2\" />\n                        New Research\n                      </Button>\n                      <Button variant=\"outline\" className=\"w-full justify-start\">\n                        <AlertTriangle className=\"w-4 h-4 mr-2\" />\n                        Risk Alerts\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}","size_bytes":11605},"client/src/pages/hub-backup.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Link } from \"wouter\";\nimport { \n  TrendingUp, \n  Trophy, \n  Users, \n  Target, \n  BarChart3,\n  Calendar,\n  ShoppingBag,\n  MessageCircle,\n  Award,\n  Clock,\n  ArrowRight,\n  Star,\n  Zap,\n  Globe,\n  PlayCircle,\n  Activity,\n  Settings,\n  ChevronRight,\n  Flame,\n  Sparkles\n} from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.4 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.05\n    }\n  }\n};\n\nexport default function Hub() {\n  const { user } = useAuth();\n\n  // Main feature cards (like the games in Stake)\n  const mainFeatures = [\n    {\n      title: \"DASHBOARD\",\n      subtitle: \"Trading Hub\",\n      description: \"Your personal trading command center\",\n      href: \"/dashboard\",\n      gradient: \"from-blue-500 to-purple-600\",\n      icon: BarChart3,\n      players: \"Active Now\"\n    },\n    {\n      title: \"TOURNAMENTS\",\n      subtitle: \"Compete & Win\", \n      description: \"Join competitive trading battles\",\n      href: \"/tournaments\",\n      gradient: \"from-yellow-500 to-orange-600\",\n      icon: Trophy,\n      players: \"12 Active\"\n    },\n    {\n      title: \"LEADERBOARD\",\n      subtitle: \"Global Rankings\",\n      description: \"See where you rank worldwide\",\n      href: \"/leaderboard\", \n      gradient: \"from-green-500 to-teal-600\",\n      icon: Award,\n      players: \"Updated Live\"\n    },\n    {\n      title: \"PEOPLE\",\n      subtitle: \"Community Hub\",\n      description: \"Connect with fellow traders\",\n      href: \"/people\",\n      gradient: \"from-pink-500 to-rose-600\", \n      icon: Users,\n      players: \"10K+ Traders\"\n    },\n    {\n      title: \"EVENTS\",\n      subtitle: \"Special Events\",\n      description: \"Exclusive trading competitions\",\n      href: \"/events\",\n      gradient: \"from-indigo-500 to-blue-600\",\n      icon: Calendar,\n      players: \"Coming Soon\"\n    },\n    {\n      title: \"SHOP\",\n      subtitle: \"Power-ups & More\",\n      description: \"Enhance your trading experience\", \n      href: \"/shop\",\n      gradient: \"from-purple-500 to-pink-600\",\n      icon: ShoppingBag,\n      players: \"New Items\"\n    }\n  ];\n\n  // Promotions section (like Stake's promotions)\n  const promotions = [\n    {\n      title: \"Weekly Tournament\",\n      description: \"Join this week's mega tournament with $1,000 prize pool\",\n      badge: \"HOT\",\n      badgeColor: \"bg-red-500\",\n      action: \"Join Now\",\n      href: \"/tournaments\",\n      gradient: \"from-red-500/20 to-orange-500/20\"\n    },\n    {\n      title: \"Trading Streak Bonus\",\n      description: \"Trade for 7 days straight and unlock exclusive badges\",\n      badge: \"NEW\",\n      badgeColor: \"bg-green-500\", \n      action: \"Start Streak\",\n      href: \"/dashboard\",\n      gradient: \"from-green-500/20 to-emerald-500/20\"\n    },\n    {\n      title: \"Refer Friends\",\n      description: \"Invite friends and both get bonus starting capital\",\n      badge: \"REWARD\",\n      badgeColor: \"bg-blue-500\",\n      action: \"Invite\",\n      href: \"/people\",\n      gradient: \"from-blue-500/20 to-cyan-500/20\"\n    }\n  ];\n\n  // Quick stats\n  const stats = [\n    { label: \"Your Rank\", value: \"#247\", change: \"+12\" },\n    { label: \"Win Rate\", value: \"73%\", change: \"+5%\" },\n    { label: \"Active Tournaments\", value: \"3\", change: \"\" },\n    { label: \"Total Trades\", value: \"156\", change: \"+8\" }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background p-6\">\n      {/* Welcome Header */}\n      <motion.div \n        className=\"mb-8\"\n        {...fadeInUp}\n      >\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground mb-2\">\n              Welcome back, {user?.firstName || user?.displayName || \"Trader\"}! \n            </h1>\n            <p className=\"text-muted-foreground\">\n              Ready to dominate the markets today?\n            </p>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Badge variant=\"secondary\" className=\"px-3 py-1\">\n              <Activity className=\"w-4 h-4 mr-1\" />\n              Online\n            </Badge>\n          </div>\n        </div>\n\n        {/* Quick Stats */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\n          {stats.map((stat, index) => (\n            <motion.div\n              key={index}\n              variants={fadeInUp}\n              initial=\"initial\"\n              animate=\"animate\"\n              transition={{ delay: index * 0.1 }}\n            >\n              <Card className=\"p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-foreground\">{stat.value}</div>\n                  <div className=\"text-sm text-muted-foreground\">{stat.label}</div>\n                  {stat.change && (\n                    <div className=\"text-xs text-green-500 mt-1\">{stat.change}</div>\n                  )}\n                </div>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n      </motion.div>\n\n      {/* Active Promotion Banner */}\n      <motion.div \n        className=\"mb-8\"\n        {...fadeInUp}\n      >\n        <Card className=\"relative overflow-hidden bg-gradient-to-r from-primary/10 via-secondary/10 to-primary/10 border-primary/20\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-4\">\n                <div className=\"p-3 rounded-full bg-primary/20\">\n                  <Zap className=\"w-6 h-6 text-primary\" />\n                </div>\n                <div>\n                  <div className=\"flex items-center space-x-2 mb-1\">\n                    <Badge className=\"bg-red-500 hover:bg-red-600\">\n                      <Sparkles className=\"w-3 h-3 mr-1\" />\n                      LIVE EVENT\n                    </Badge>\n                  </div>\n                  <h3 className=\"text-lg font-semibold text-foreground\">\n                    Mega Trading Championship - $5,000 Prize Pool\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Limited time event ending in 2 days. 500+ participants competing!\n                  </p>\n                </div>\n              </div>\n              <Link href=\"/tournaments\">\n                <Button size=\"lg\" className=\"bg-gradient-to-r from-primary to-secondary\">\n                  Join Battle\n                  <ArrowRight className=\"ml-2 w-4 h-4\" />\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </motion.div>\n\n      {/* Main Features Grid */}\n      <motion.div \n        className=\"mb-8\"\n        variants={staggerChildren}\n        initial=\"initial\"\n        animate=\"animate\"\n      >\n        <h2 className=\"text-xl font-semibold text-foreground mb-4 flex items-center\">\n          <PlayCircle className=\"w-5 h-5 mr-2\" />\n          Trading Hub\n        </h2>\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4\">\n          {mainFeatures.map((feature, index) => (\n            <motion.div\n              key={index}\n              variants={fadeInUp}\n              whileHover={{ scale: 1.02, y: -2 }}\n              whileTap={{ scale: 0.98 }}\n            >\n              <Link href={feature.href}>\n                <Card className=\"relative overflow-hidden group cursor-pointer transition-all duration-300 hover:shadow-lg\">\n                  <div className={`absolute inset-0 bg-gradient-to-br ${feature.gradient} opacity-20 group-hover:opacity-30 transition-opacity`} />\n                  <CardContent className=\"relative p-6 text-center\">\n                    <div className=\"flex justify-center mb-3\">\n                      <div className={`p-3 rounded-full bg-gradient-to-br ${feature.gradient}`}>\n                        <feature.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                    </div>\n                    <h3 className=\"text-lg font-bold text-foreground mb-1\">\n                      {feature.title}\n                    </h3>\n                    <p className=\"text-sm font-medium text-primary mb-2\">\n                      {feature.subtitle}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mb-3\">\n                      {feature.description}\n                    </p>\n                    <div className=\"flex items-center justify-center text-xs text-muted-foreground\">\n                      <Users className=\"w-3 h-3 mr-1\" />\n                      {feature.players}\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </motion.div>\n          ))}\n        </div>\n      </motion.div>\n\n      {/* Promotions Section */}\n      <motion.div \n        className=\"mb-8\"\n        {...fadeInUp}\n      >\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-foreground flex items-center\">\n            <Zap className=\"w-5 h-5 mr-2\" />\n            Promotions\n          </h2>\n          <Button variant=\"ghost\" size=\"sm\">\n            View All\n            <ChevronRight className=\"ml-1 w-4 h-4\" />\n          </Button>\n        </div>\n        <div className=\"grid md:grid-cols-3 gap-4\">\n          {promotions.map((promo, index) => (\n            <motion.div\n              key={index}\n              variants={fadeInUp}\n              initial=\"initial\"\n              animate=\"animate\"\n              transition={{ delay: index * 0.1 }}\n              whileHover={{ scale: 1.02 }}\n            >\n              <Card className=\"relative overflow-hidden group cursor-pointer transition-all duration-300 hover:shadow-lg\">\n                <div className={`absolute inset-0 bg-gradient-to-br ${promo.gradient}`} />\n                <CardContent className=\"relative p-6\">\n                  <div className=\"flex items-start justify-between mb-3\">\n                    <Badge className={`${promo.badgeColor} hover:${promo.badgeColor}`}>\n                      {promo.badge}\n                    </Badge>\n                  </div>\n                  <h3 className=\"text-lg font-semibold text-foreground mb-2\">\n                    {promo.title}\n                  </h3>\n                  <p className=\"text-sm text-muted-foreground mb-4\">\n                    {promo.description}\n                  </p>\n                  <Link href={promo.href}>\n                    <Button variant=\"secondary\" size=\"sm\" className=\"w-full\">\n                      {promo.action}\n                      <ArrowRight className=\"ml-2 w-3 h-3\" />\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n      </motion.div>\n\n      {/* Quick Actions */}\n      <motion.div \n        className=\"grid md:grid-cols-2 gap-6\"\n        {...fadeInUp}\n      >\n        <Card>\n          <CardContent className=\"p-6\">\n            <h3 className=\"text-lg font-semibold text-foreground mb-4 flex items-center\">\n              <Target className=\"w-5 h-5 mr-2\" />\n              Quick Actions\n            </h3>\n            <div className=\"space-y-3\">\n              <Link href=\"/dashboard\">\n                <Button variant=\"outline\" className=\"w-full justify-start\">\n                  <BarChart3 className=\"w-4 h-4 mr-3\" />\n                  View Trading Dashboard\n                  <ChevronRight className=\"ml-auto w-4 h-4\" />\n                </Button>\n              </Link>\n              <Link href=\"/tournaments\">\n                <Button variant=\"outline\" className=\"w-full justify-start\">\n                  <Trophy className=\"w-4 h-4 mr-3\" />\n                  Join Tournament\n                  <ChevronRight className=\"ml-auto w-4 h-4\" />\n                </Button>\n              </Link>\n              <Link href=\"/people\">\n                <Button variant=\"outline\" className=\"w-full justify-start\">\n                  <Users className=\"w-4 h-4 mr-3\" />\n                  Browse Community\n                  <ChevronRight className=\"ml-auto w-4 h-4\" />\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <h3 className=\"text-lg font-semibold text-foreground mb-4 flex items-center\">\n              <Clock className=\"w-5 h-5 mr-2\" />\n              Recent Activity\n            </h3>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between p-3 bg-muted rounded-lg\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                  <div>\n                    <p className=\"text-sm font-medium\">Joined \"Tech Stocks Battle\"</p>\n                    <p className=\"text-xs text-muted-foreground\">2 minutes ago</p>\n                  </div>\n                </div>\n              </div>\n              <div className=\"flex items-center justify-between p-3 bg-muted rounded-lg\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\n                  <div>\n                    <p className=\"text-sm font-medium\">Bought 50 shares of AAPL</p>\n                    <p className=\"text-xs text-muted-foreground\">1 hour ago</p>\n                  </div>\n                </div>\n              </div>\n              <div className=\"flex items-center justify-between p-3 bg-muted rounded-lg\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"w-2 h-2 bg-yellow-500 rounded-full\"></div>\n                  <div>\n                    <p className=\"text-sm font-medium\">Ranked up to #247</p>\n                    <p className=\"text-xs text-muted-foreground\">3 hours ago</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}","size_bytes":14258},"client/src/pages/hub.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Trophy, \n  TrendingUp, \n  Users, \n  Award,\n  Calendar,\n  BarChart3,\n  ChevronRight,\n  Zap,\n  Star,\n  Target,\n  DollarSign,\n  ArrowRight,\n  Activity,\n  Globe,\n  Sparkles,\n  Timer,\n  PlayCircle\n} from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Link } from \"wouter\";\nimport { MarketStatus } from \"@/components/market-status\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.5 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Hub() {\n  const { user } = useAuth();\n  const { t } = useUserPreferences();\n  const [currentTime, setCurrentTime] = useState(new Date());\n\n  // Update time every minute for greeting\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 60000);\n    return () => clearInterval(timer);\n  }, []);\n\n  // Dynamic greeting based on time\n  const getGreeting = () => {\n    const hour = currentTime.getHours();\n    if (hour < 12) return t('goodMorning') || \"Good Morning\";\n    if (hour < 17) return t('goodAfternoon') || \"Good Afternoon\"; \n    return t('goodEvening') || \"Good Evening\";\n  };\n\n  // Primary actions - streamlined and focused\n  const primaryActions = [\n    {\n      title: t('dashboard'),\n      description: t('dashboardDescription') || \"Jump into your personal trading dashboard\",\n      href: \"/dashboard\",\n      icon: BarChart3,\n      accent: \"from-blue-500 to-purple-600\",\n      feature: \"trending\"\n    },\n    {\n      title: t('joinTournament'),\n      description: t('joinTournamentDescription') || \"Compete against traders worldwide\",\n      href: \"/tournaments\", \n      icon: Trophy,\n      accent: \"from-orange-500 to-red-600\",\n      feature: \"hot\"\n    },\n    {\n      title: t('leaderboard'),\n      description: t('leaderboardDescription') || \"See where you stand globally\",\n      href: \"/leaderboard\",\n      icon: Award,\n      accent: \"from-green-500 to-emerald-600\",\n      feature: \"live\"\n    }\n  ];\n\n  // Secondary features - clean and minimal\n  const secondaryFeatures = [\n    { title: t('community'), href: \"/people\", icon: Users },\n    { title: t('events') || \"Events\", href: \"/events\", icon: Calendar },\n    { title: t('analytics'), href: \"/analytics\", icon: Activity }\n  ];\n\n  // Live stats - minimal and informative\n  const liveStats = [\n    { label: \"Active Traders\", value: \"2,847\", trend: \"+12%\" },\n    { label: \"Live Tournaments\", value: \"16\", trend: \"now\" },\n    { label: \"Daily Volume\", value: \"$1.2M\", trend: \"+8%\" }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-background to-muted/20\">\n      <div className=\"container mx-auto px-6 py-8\">\n        \n        {/* Personal Greeting Header */}\n        <motion.div \n          className=\"mb-12\"\n          {...fadeInUp}\n        >\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-4xl md:text-5xl font-bold text-foreground tracking-tight\">\n                {getGreeting()}, {user?.username || \"Trader\"}\n              </h1>\n              <p className=\"text-lg text-muted-foreground mt-2 flex items-center\">\n                <Sparkles className=\"w-5 h-5 mr-2 text-primary/60\" />\n                {t('hubWelcomeMessage') || \"Ready to make your mark on the markets?\"}\n              </p>\n            </div>\n            \n            {/* Live indicator */}\n            <div className=\"hidden md:flex items-center space-x-2 text-sm\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n              <span className=\"text-muted-foreground\">Markets Live</span>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Primary Action Cards - Hero Section */}\n        <motion.div \n          className=\"mb-12\"\n          variants={staggerChildren}\n          initial=\"initial\"\n          animate=\"animate\"\n        >\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 lg:gap-6\">\n            {primaryActions.map((action, index) => (\n              <motion.div key={index} variants={fadeInUp}>\n                <Link href={action.href}>\n                  <Card className=\"group relative overflow-hidden cursor-pointer border-0 bg-card/60 backdrop-blur-sm hover:bg-card/80 transition-all duration-300 hover:scale-[1.02] hover:shadow-xl\">\n                    <div className={`absolute inset-0 bg-gradient-to-br ${action.accent} opacity-5 group-hover:opacity-10 transition-opacity`} />\n                    \n                    {/* Feature badge */}\n                    <div className=\"absolute top-4 right-4\">\n                      {action.feature === \"trending\" && (\n                        <Badge variant=\"secondary\" className=\"text-xs bg-blue-500/20 text-blue-600 border-blue-500/30\">\n                          <TrendingUp className=\"w-3 h-3 mr-1\" />\n                          Trending\n                        </Badge>\n                      )}\n                      {action.feature === \"hot\" && (\n                        <Badge variant=\"secondary\" className=\"text-xs bg-red-500/20 text-red-600 border-red-500/30\">\n                          <Zap className=\"w-3 h-3 mr-1\" />\n                          Hot\n                        </Badge>\n                      )}\n                      {action.feature === \"live\" && (\n                        <Badge variant=\"secondary\" className=\"text-xs bg-green-500/20 text-green-600 border-green-500/30\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse mr-1\" />\n                          Live\n                        </Badge>\n                      )}\n                    </div>\n\n                    <CardContent className=\"p-6 lg:p-8\">\n                      <div className=\"flex items-start justify-between mb-4 lg:mb-6\">\n                        <div className={`p-3 lg:p-4 rounded-2xl bg-gradient-to-br ${action.accent} shadow-lg`}>\n                          <action.icon className=\"w-6 h-6 lg:w-8 lg:h-8 text-white\" />\n                        </div>\n                      </div>\n                      \n                      <h3 className=\"text-xl lg:text-2xl font-bold text-foreground mb-2 lg:mb-3 group-hover:text-primary transition-colors\">\n                        {action.title}\n                      </h3>\n                      <p className=\"text-muted-foreground mb-4 lg:mb-6 leading-relaxed text-sm lg:text-base\">\n                        {action.description}\n                      </p>\n                      \n                      <div className=\"flex items-center text-primary font-medium group-hover:translate-x-1 transition-transform text-sm lg:text-base\">\n                        <span>Get Started</span>\n                        <ArrowRight className=\"w-4 h-4 ml-2\" />\n                      </div>\n                    </CardContent>\n                  </Card>\n                </Link>\n              </motion.div>\n            ))}\n          </div>\n        </motion.div>\n\n        {/* Stats Bar - Minimal and Clean */}\n        <motion.div \n          className=\"mb-12\"\n          variants={fadeInUp}\n          initial=\"initial\"\n          animate=\"animate\"\n        >\n          <Card className=\"border-0 bg-card/40 backdrop-blur-sm\">\n            <CardContent className=\"p-6\">\n              <div className=\"grid grid-cols-3 divide-x divide-border/50\">\n                {liveStats.map((stat, index) => (\n                  <div key={index} className=\"text-center px-4\">\n                    <div className=\"text-2xl font-bold text-foreground mb-1\">{stat.value}</div>\n                    <div className=\"text-sm text-muted-foreground mb-1\">{stat.label}</div>\n                    <div className=\"text-xs text-primary font-medium\">{stat.trend}</div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Secondary Features - Horizontal Strip */}\n        <motion.div \n          className=\"mb-8\"\n          variants={staggerChildren}\n          initial=\"initial\"\n          animate=\"animate\"\n        >\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-xl font-semibold text-foreground\">Quick Access</h2>\n            <Button variant=\"ghost\" size=\"sm\" className=\"text-muted-foreground hover:text-foreground\">\n              View All\n              <ChevronRight className=\"w-4 h-4 ml-1\" />\n            </Button>\n          </div>\n          \n          <div className=\"grid grid-cols-3 gap-3 lg:gap-4\">\n            {secondaryFeatures.map((feature, index) => (\n              <motion.div key={index} variants={fadeInUp}>\n                <Link href={feature.href}>\n                  <Card className=\"group cursor-pointer border-0 bg-card/30 backdrop-blur-sm hover:bg-card/60 transition-all duration-200 hover:scale-105\">\n                    <CardContent className=\"p-4 lg:p-6 text-center\">\n                      <div className=\"flex justify-center mb-2 lg:mb-3\">\n                        <div className=\"p-2 lg:p-3 rounded-xl bg-muted/50 group-hover:bg-primary/10 transition-colors\">\n                          <feature.icon className=\"w-4 h-4 lg:w-5 lg:h-5 text-muted-foreground group-hover:text-primary transition-colors\" />\n                        </div>\n                      </div>\n                      <h3 className=\"text-xs lg:text-sm font-medium text-foreground group-hover:text-primary transition-colors\">\n                        {feature.title}\n                      </h3>\n                    </CardContent>\n                  </Card>\n                </Link>\n              </motion.div>\n            ))}\n          </div>\n        </motion.div>\n\n        {/* Market Status Footer */}\n        <motion.div \n          className=\"mt-12 text-center\"\n          variants={fadeInUp}\n          initial=\"initial\"\n          animate=\"animate\"\n        >\n          <MarketStatus variant=\"inline\" />\n        </motion.div>\n\n      </div>\n    </div>\n  );\n}","size_bytes":10300},"client/src/pages/landing.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Link } from \"wouter\";\nimport { \n  TrendingUp, \n  Trophy, \n  Users, \n  Target, \n  BarChart3,\n  Shield,\n  Zap,\n  Globe,\n  ArrowRight,\n  Play,\n  DollarSign,\n  Award,\n  Clock,\n  CheckCircle\n} from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 30 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Landing() {\n  const { user } = useAuth();\n\n  const features = [\n    {\n      icon: Trophy,\n      title: \"Competitive Trading\",\n      description: \"Join tournaments with traders worldwide. Compete for real prizes with virtual money.\",\n      color: \"text-yellow-500\"\n    },\n    {\n      icon: Target,\n      title: \"Risk-Free Trading\",\n      description: \"Practice trading strategies without financial risk. Perfect for beginners and experts alike.\",\n      color: \"text-blue-500\"\n    },\n    {\n      icon: BarChart3,\n      title: \"Real Market Data\",\n      description: \"Trade with authentic market prices and real-time data from major exchanges.\",\n      color: \"text-green-500\"\n    },\n    {\n      icon: Users,\n      title: \"Global Community\",\n      description: \"Connect with traders worldwide. Learn from the best and share your strategies.\",\n      color: \"text-purple-500\"\n    }\n  ];\n\n  const howItWorks = [\n    {\n      step: \"1\",\n      title: \"Sign Up & Get Started\",\n      description: \"Create your free account and receive $10,000 in virtual trading money\",\n      icon: CheckCircle\n    },\n    {\n      step: \"2\", \n      title: \"Join Tournaments\",\n      description: \"Browse public tournaments or create your own with custom rules and timeframes\",\n      icon: Target\n    },\n    {\n      step: \"3\",\n      title: \"Trade & Compete\",\n      description: \"Buy and sell stocks using real market data. Watch your portfolio grow in real-time\",\n      icon: TrendingUp\n    },\n    {\n      step: \"4\",\n      title: \"Win & Learn\",\n      description: \"Earn achievements, climb leaderboards, and improve your trading skills\",\n      icon: Award\n    }\n  ];\n\n  const stats = [\n    { label: \"Active Traders\", value: \"10,000+\", icon: Users },\n    { label: \"Tournaments Completed\", value: \"2,500+\", icon: Trophy },\n    { label: \"Virtual Money Traded\", value: \"$50M+\", icon: DollarSign },\n    { label: \"Countries\", value: \"85+\", icon: Globe }\n  ];\n\n  // Stock market graph SVG background\n  const stockGraphSVG = (\n    <svg viewBox=\"0 0 800 400\" className=\"absolute inset-0 w-full h-full opacity-20\">\n      <defs>\n        <linearGradient id=\"grad1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n          <stop offset=\"0%\" style={{ stopColor: '#3b82f6', stopOpacity: 0.8 }} />\n          <stop offset=\"50%\" style={{ stopColor: '#8b5cf6', stopOpacity: 0.6 }} />\n          <stop offset=\"100%\" style={{ stopColor: '#06b6d4', stopOpacity: 0.4 }} />\n        </linearGradient>\n        <filter id=\"glow\">\n          <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\"/>\n          <feMerge> \n            <feMergeNode in=\"coloredBlur\"/>\n            <feMergeNode in=\"SourceGraphic\"/>\n          </feMerge>\n        </filter>\n      </defs>\n      \n      {/* Grid lines */}\n      <defs>\n        <pattern id=\"grid\" width=\"50\" height=\"40\" patternUnits=\"userSpaceOnUse\">\n          <path d=\"M 50 0 L 0 0 0 40\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"0.5\" opacity=\"0.3\"/>\n        </pattern>\n      </defs>\n      <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\" />\n      \n      {/* Stock price lines */}\n      <path d=\"M50,300 Q150,250 250,280 T450,200 T650,160 T750,140\" \n            stroke=\"url(#grad1)\" \n            strokeWidth=\"3\" \n            fill=\"none\" \n            filter=\"url(#glow)\"/>\n      \n      <path d=\"M50,350 Q150,320 250,340 T450,280 T650,240 T750,220\" \n            stroke=\"url(#grad1)\" \n            strokeWidth=\"2\" \n            fill=\"none\" \n            opacity=\"0.6\"/>\n            \n      {/* Area fill */}\n      <path d=\"M50,300 Q150,250 250,280 T450,200 T650,160 T750,140 L750,400 L50,400 Z\" \n            fill=\"url(#grad1)\" \n            opacity=\"0.1\"/>\n            \n      {/* Data points */}\n      <circle cx=\"250\" cy=\"280\" r=\"4\" fill=\"#3b82f6\" filter=\"url(#glow)\"/>\n      <circle cx=\"450\" cy=\"200\" r=\"4\" fill=\"#8b5cf6\" filter=\"url(#glow)\"/>\n      <circle cx=\"650\" cy=\"160\" r=\"4\" fill=\"#06b6d4\" filter=\"url(#glow)\"/>\n    </svg>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section with Stock Graph Background */}\n      <section className=\"relative py-20 bg-gradient-to-br from-background via-primary/5 to-secondary/10 overflow-hidden\">\n        {/* Background Graph */}\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          {stockGraphSVG}\n        </div>\n        \n        {/* Content */}\n        <div className=\"container mx-auto px-4 relative z-10\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <motion.div\n              initial={{ opacity: 0, y: 30 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.8 }}\n            >\n              <Badge className=\"mb-6 bg-primary/10 text-primary border-primary/20\">\n                🚀 No Risk, All Reward\n              </Badge>\n              <h1 className=\"text-5xl md:text-6xl font-black text-foreground mb-6 leading-tight\">\n                Compete.{\" \"}\n                <span className=\"bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent\">\n                  Trade\n                </span>{\" \"}\n                Win.\n              </h1>\n              <p className=\"text-xl text-muted-foreground mb-8 max-w-2xl mx-auto leading-relaxed\">\n                Join the world's most exciting paper trading competitions. \n                Practice with real market data, compete globally, and become a trading champion.\n              </p>\n              <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n                {user ? (\n                  <Link href=\"/tournaments\">\n                    <Button size=\"lg\" className=\"text-lg px-8 py-4 shadow-2xl hover:shadow-primary/20\">\n                      <Trophy className=\"w-5 h-5 mr-2\" />\n                      Join Tournament\n                    </Button>\n                  </Link>\n                ) : (\n                  <Link href=\"/auth\">\n                    <Button size=\"lg\" className=\"text-lg px-8 py-4 shadow-2xl hover:shadow-primary/20\">\n                      <Play className=\"w-5 h-5 mr-2\" />\n                      Start Trading\n                    </Button>\n                  </Link>\n                )}\n                <Link href=\"#how-it-works\">\n                  <Button variant=\"outline\" size=\"lg\" className=\"text-lg px-8 py-4 backdrop-blur-sm\">\n                    <ArrowRight className=\"w-5 h-5 mr-2\" />\n                    Learn How\n                  </Button>\n                </Link>\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-16 bg-muted/30\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div \n            variants={staggerChildren}\n            initial=\"initial\"\n            whileInView=\"animate\"\n            viewport={{ once: true }}\n            className=\"grid grid-cols-2 md:grid-cols-4 gap-8 max-w-4xl mx-auto\"\n          >\n            {stats.map((stat, index) => (\n              <motion.div\n                key={index}\n                variants={fadeInUp}\n                className=\"text-center\"\n              >\n                <div className=\"inline-flex items-center justify-center w-12 h-12 bg-primary/10 rounded-lg mb-3\">\n                  <stat.icon className=\"w-6 h-6 text-primary\" />\n                </div>\n                <div className=\"text-2xl font-bold text-foreground\">{stat.value}</div>\n                <div className=\"text-sm text-muted-foreground\">{stat.label}</div>\n              </motion.div>\n            ))}\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section className=\"py-20\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <motion.div \n              initial={{ opacity: 0, y: 30 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={{ duration: 0.6 }}\n              className=\"text-center mb-16\"\n            >\n              <h2 className=\"text-4xl font-bold text-foreground mb-4\">\n                Why Choose ORSATH?\n              </h2>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                The ultimate platform for competitive paper trading with real market conditions\n              </p>\n            </motion.div>\n            \n            <motion.div \n              variants={staggerChildren}\n              initial=\"initial\"\n              whileInView=\"animate\"\n              viewport={{ once: true }}\n              className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\"\n            >\n              {features.map((feature, index) => (\n                <motion.div key={index} variants={fadeInUp}>\n                  <Card className=\"h-full hover:shadow-lg transition-all duration-300 border-2 hover:border-primary/20 group\">\n                    <CardContent className=\"p-6 text-center\">\n                      <div className={`inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted/50 mb-4 group-hover:scale-110 transition-transform`}>\n                        <feature.icon className={`w-8 h-8 ${feature.color}`} />\n                      </div>\n                      <h3 className=\"text-lg font-semibold text-foreground mb-2\">\n                        {feature.title}\n                      </h3>\n                      <p className=\"text-muted-foreground text-sm leading-relaxed\">\n                        {feature.description}\n                      </p>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* How It Works Section */}\n      <section id=\"how-it-works\" className=\"py-20 bg-muted/30\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <motion.div \n              initial={{ opacity: 0, y: 30 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={{ duration: 0.6 }}\n              className=\"text-center mb-16\"\n            >\n              <h2 className=\"text-4xl font-bold text-foreground mb-4\">\n                How It Works\n              </h2>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                Get started in minutes and join the global trading competition\n              </p>\n            </motion.div>\n            \n            <motion.div \n              variants={staggerChildren}\n              initial=\"initial\"\n              whileInView=\"animate\"\n              viewport={{ once: true }}\n              className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\"\n            >\n              {howItWorks.map((step, index) => (\n                <motion.div key={index} variants={fadeInUp}>\n                  <Card className=\"h-full hover:shadow-lg transition-all duration-300 relative overflow-hidden group\">\n                    <CardContent className=\"p-6 text-center relative z-10\">\n                      <div className=\"inline-flex items-center justify-center w-12 h-12 bg-primary text-primary-foreground rounded-full mb-4 text-lg font-bold\">\n                        {step.step}\n                      </div>\n                      <step.icon className=\"w-8 h-8 text-primary mx-auto mb-4\" />\n                      <h3 className=\"text-lg font-semibold text-foreground mb-2\">\n                        {step.title}\n                      </h3>\n                      <p className=\"text-muted-foreground text-sm leading-relaxed\">\n                        {step.description}\n                      </p>\n                    </CardContent>\n                    {/* Gradient background on hover */}\n                    <div className=\"absolute inset-0 bg-gradient-to-br from-primary/5 to-secondary/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                  </Card>\n                </motion.div>\n              ))}\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-20 bg-gradient-to-r from-primary/10 via-primary/5 to-secondary/10\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div \n            initial={{ opacity: 0, y: 30 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.6 }}\n            className=\"max-w-4xl mx-auto text-center\"\n          >\n            <h2 className=\"text-4xl font-bold text-foreground mb-4\">\n              Ready to Start Trading?\n            </h2>\n            <p className=\"text-xl text-muted-foreground mb-8\">\n              Join thousands of traders competing in risk-free tournaments worldwide\n            </p>\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n              {user ? (\n                <>\n                  <Link href=\"/tournaments\">\n                    <Button size=\"lg\" className=\"text-lg px-8 py-4\">\n                      <Trophy className=\"w-5 h-5 mr-2\" />\n                      Browse Tournaments\n                    </Button>\n                  </Link>\n                  <Link href=\"/dashboard\">\n                    <Button variant=\"outline\" size=\"lg\" className=\"text-lg px-8 py-4\">\n                      <BarChart3 className=\"w-5 h-5 mr-2\" />\n                      Go to Dashboard\n                    </Button>\n                  </Link>\n                </>\n              ) : (\n                <>\n                  <Link href=\"/auth\">\n                    <Button size=\"lg\" className=\"text-lg px-8 py-4\">\n                      <Play className=\"w-5 h-5 mr-2\" />\n                      Sign Up Free\n                    </Button>\n                  </Link>\n                  <Link href=\"/contact\">\n                    <Button variant=\"outline\" size=\"lg\" className=\"text-lg px-8 py-4\">\n                      <Users className=\"w-5 h-5 mr-2\" />\n                      Contact Support\n                    </Button>\n                  </Link>\n                </>\n              )}\n            </div>\n          </motion.div>\n        </div>\n      </section>\n    </div>\n  );\n}","size_bytes":14827},"client/src/pages/leaderboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Trophy, TrendingUp, Users, DollarSign, Activity } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\nconst fadeInUp = {\n  hidden: { opacity: 0, y: 20 },\n  visible: { opacity: 1, y: 0, transition: { duration: 0.5 } }\n};\n\nexport default function Leaderboard() {\n  const { user } = useAuth();\n  const { t, formatCurrency } = useUserPreferences();\n  const [activeTab, setActiveTab] = useState(\"tournaments\");\n\n  // Fetch tournaments leaderboard data with 5-minute refresh\n  const { data: tournamentLeaderboard, isLoading: tournamentsLoading } = useQuery({\n    queryKey: ['/api/tournaments/leaderboard'],\n    enabled: activeTab === \"tournaments\",\n    refetchInterval: 5 * 60 * 1000, // 5 minutes\n    refetchOnWindowFocus: true,\n    staleTime: 4 * 60 * 1000, // 4 minutes to allow fresh data\n  });\n\n  // Fetch personal leaderboard data with 5-minute refresh\n  const { data: personalLeaderboard, isLoading: personalLoading } = useQuery({\n    queryKey: ['/api/personal/leaderboard'],\n    enabled: activeTab === \"personal\",\n    refetchInterval: 5 * 60 * 1000, // 5 minutes\n    refetchOnWindowFocus: true,\n    staleTime: 4 * 60 * 1000, // 4 minutes to allow fresh data\n  });\n\n  // Fetch streak leaderboard data with 5-minute refresh\n  const { data: streakLeaderboard, isLoading: streakLoading } = useQuery({\n    queryKey: ['/api/streak/leaderboard'],\n    enabled: activeTab === \"streak\",\n    refetchInterval: 5 * 60 * 1000, // 5 minutes\n    refetchOnWindowFocus: true,\n    staleTime: 4 * 60 * 1000, // 4 minutes to allow fresh data\n  });\n\n  const getRankIcon = (rank: number) => {\n    switch (rank) {\n      case 1:\n        return <Trophy className=\"h-5 w-5 text-yellow-500\" />;\n      case 2:\n        return <Trophy className=\"h-5 w-5 text-gray-400\" />;\n      case 3:\n        return <Trophy className=\"h-5 w-5 text-amber-600\" />;\n      default:\n        return <span className=\"h-5 w-5 flex items-center justify-center text-sm font-bold\">{rank}</span>;\n    }\n  };\n\n\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <motion.div \n          initial=\"hidden\"\n          animate=\"visible\"\n          variants={fadeInUp}\n          className=\"text-center mb-8\"\n        >\n          <h1 className=\"text-4xl font-bold mb-4\">{t('leaderboard')}</h1>\n          <p className=\"text-muted-foreground text-lg\">\n            {t('leaderboardDescription')}\n          </p>\n        </motion.div>\n\n        <motion.div variants={fadeInUp} className=\"max-w-6xl mx-auto\">\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\n            <TabsList className=\"grid w-full grid-cols-3 mb-8\">\n              <TabsTrigger value=\"tournaments\" className=\"flex items-center gap-2\">\n                <Users className=\"h-4 w-4\" />\n{t('tournaments')}\n              </TabsTrigger>\n              <TabsTrigger value=\"personal\" className=\"flex items-center gap-2\">\n                <TrendingUp className=\"h-4 w-4\" />\n{t('personal')}\n              </TabsTrigger>\n              <TabsTrigger value=\"streak\" className=\"flex items-center gap-2\">\n                <Activity className=\"h-4 w-4\" />\n{t('streak')}\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"tournaments\" className=\"space-y-6\">\n              <div className=\"grid gap-4 md:grid-cols-3 mb-8\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Tournaments</CardTitle>\n                    <Users className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{(tournamentLeaderboard as any)?.data?.totalTournaments || 0}</div>\n                  </CardContent>\n                </Card>\n                \n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Total Participants</CardTitle>\n                    <Users className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{(tournamentLeaderboard as any)?.data?.totalParticipants || 0}</div>\n                  </CardContent>\n                </Card>\n                \n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Your Rank</CardTitle>\n                    <Trophy className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {(tournamentLeaderboard as any)?.data?.yourRank || \"N/A\"}\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Tournament Leaderboard</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {tournamentsLoading ? (\n                    <div className=\"flex justify-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {(tournamentLeaderboard as any)?.data?.rankings?.map((participant: any, index: number) => {\n                        const rank = index + 1;\n                        const percentageChange = participant.percentageChange || 0;\n                        \n                        return (\n                          <div\n                            key={participant.id}\n                            className={`flex items-center justify-between p-4 rounded-lg border ${\n                              participant.userId === user?.id ? 'border-primary bg-primary/10' : 'border-border'\n                            }`}\n                          >\n                            <div className=\"flex items-center gap-4\">\n                              {getRankIcon(rank)}\n                              <div>\n                                <div className=\"font-semibold\">{participant.username}</div>\n                                <div className=\"text-sm text-muted-foreground\">\n                                  {participant.tournamentName} (ID: {participant.tournamentId}) • Starting: {formatCurrency(participant.startingBalance)}\n                                </div>\n                              </div>\n                            </div>\n                            \n                            <div className=\"text-right\">\n                              <div className=\"font-bold text-lg\">{formatCurrency(participant.portfolioValue)}</div>\n                              <div className={`text-sm flex items-center gap-1 ${\n                                percentageChange >= 0 ? 'text-green-500' : 'text-red-500'\n                              }`}>\n                                <TrendingUp className=\"h-3 w-3\" />\n                                {percentageChange >= 0 ? '+' : ''}{percentageChange.toFixed(2)}%\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      }) || (\n                        <div className=\"text-center py-8 text-muted-foreground\">\n                          No tournament data available\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            <TabsContent value=\"personal\" className=\"space-y-6\">\n              <div className=\"grid gap-4 md:grid-cols-3 mb-8\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Total Traders</CardTitle>\n                    <Users className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{(personalLeaderboard as any)?.data?.totalTraders || 0}</div>\n                  </CardContent>\n                </Card>\n                \n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Your Rank</CardTitle>\n                    <Trophy className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {(personalLeaderboard as any)?.data?.yourRank || \"N/A\"}\n                    </div>\n                  </CardContent>\n                </Card>\n                \n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Users</CardTitle>\n                    <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{(personalLeaderboard as any)?.data?.totalUsers || 0}</div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Personal Portfolio Leaderboard</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {personalLoading ? (\n                    <div className=\"flex justify-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {(personalLeaderboard as any)?.data?.rankings?.map((trader: any, index: number) => {\n                        const rank = index + 1;\n                        const percentageChange = trader.percentageChange || 0;\n                        \n                        return (\n                          <div\n                            key={trader.id}\n                            className={`flex items-center justify-between p-4 rounded-lg border ${\n                              trader.id === user?.id ? 'border-primary bg-primary/10' : 'border-border'\n                            }`}\n                          >\n                            <div className=\"flex items-center gap-4\">\n                              {getRankIcon(rank)}\n                              <div>\n                                <div className=\"font-semibold flex items-center gap-2\">\n                                  {trader.username}\n                                  {trader.subscriptionTier === 'premium' && (\n                                    <Badge variant=\"outline\" className=\"text-xs\">Premium</Badge>\n                                  )}\n                                  {trader.subscriptionTier === 'administrator' && (\n                                    <Badge variant=\"outline\" className=\"text-xs text-blue-600\">Administrator</Badge>\n                                  )}\n                                </div>\n                                <div className=\"text-sm text-muted-foreground\">\n                                </div>\n                              </div>\n                            </div>\n                            \n                            <div className=\"text-right\">\n                              <div className=\"font-bold text-lg\">{formatCurrency(trader.portfolioValue)}</div>\n                              <div className={`text-sm flex items-center gap-1 ${\n                                percentageChange >= 0 ? 'text-green-500' : 'text-red-500'\n                              }`}>\n                                <TrendingUp className=\"h-3 w-3\" />\n                                {percentageChange >= 0 ? '+' : ''}{percentageChange.toFixed(2)}%\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      }) || (\n                        <div className=\"text-center py-8 text-muted-foreground\">\n                          No personal portfolio data available\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            <TabsContent value=\"streak\" className=\"space-y-6\">\n              <div className=\"grid gap-4 md:grid-cols-3 mb-8\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Streaks</CardTitle>\n                    <Activity className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{(streakLeaderboard as any)?.data?.totalTraders || 0}</div>\n                  </CardContent>\n                </Card>\n                \n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Active Users</CardTitle>\n                    <Users className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{(streakLeaderboard as any)?.data?.totalUsers || 0}</div>\n                  </CardContent>\n                </Card>\n                \n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Your Rank</CardTitle>\n                    <Trophy className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {(streakLeaderboard as any)?.data?.yourRank || \"N/A\"}\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Trading Streak Leaderboard</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {streakLoading ? (\n                    <div className=\"flex justify-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {(streakLeaderboard as any)?.data?.rankings?.map((trader: any, index: number) => {\n                        const rank = index + 1;\n                        const streak = trader.tradingStreak || 0;\n                        \n                        return (\n                          <div\n                            key={trader.id}\n                            className={`flex items-center justify-between p-4 rounded-lg border ${\n                              trader.id === user?.id ? 'border-primary bg-primary/10' : 'border-border'\n                            }`}\n                          >\n                            <div className=\"flex items-center gap-4\">\n                              {getRankIcon(rank)}\n                              <div>\n                                <div className=\"font-semibold flex items-center gap-2\">\n                                  {trader.username}\n                                  {trader.subscriptionTier === 'premium' && (\n                                    <Badge variant=\"outline\" className=\"text-xs\">Premium</Badge>\n                                  )}\n                                  {trader.subscriptionTier === 'administrator' && (\n                                    <Badge variant=\"outline\" className=\"text-xs text-blue-600\">Administrator</Badge>\n                                  )}\n                                </div>\n                                <div className=\"text-sm text-muted-foreground\">\n                                </div>\n                              </div>\n                            </div>\n                            \n                            <div className=\"text-right\">\n                              <div className=\"font-bold text-lg flex items-center gap-2\">\n                                <Activity className=\"h-4 w-4 text-primary\" />\n                                {streak} {streak === 1 ? 'Day' : 'Days'}\n                              </div>\n                              <div className=\"text-sm text-muted-foreground\">\n                                {streak === 0 ? 'No streak' : `${streak} consecutive trading days`}\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      }) || (\n                        <div className=\"text-center py-8 text-muted-foreground\">\n                          No trading streak data available\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","size_bytes":18158},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Link } from \"wouter\";\nimport { Loader2, Eye, EyeOff } from \"lucide-react\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\nexport default function Login() {\n  const [, navigate] = useLocation();\n  const { loginMutation, user } = useAuth();\n  const { t } = useUserPreferences();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n\n  // Redirect if already logged in\n  if (user) {\n    navigate(\"/dashboard\");\n    return null;\n  }\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    loginMutation.mutate({ username, password }, {\n      onSuccess: () => {\n        navigate(\"/dashboard\");\n      }\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center\">\n          <div className=\"flex justify-center\">\n            <div className=\"w-12 h-12 bg-primary rounded-lg flex items-center justify-center\">\n              <span className=\"text-primary-foreground font-bold text-xl\">O</span>\n            </div>\n          </div>\n          <h2 className=\"mt-6 text-3xl font-bold text-foreground\">\n            {t('signIn')} ORSATH\n          </h2>\n          <p className=\"mt-2 text-sm text-muted-foreground\">\n            {t('signInDescription')}\n          </p>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-center\">{t('welcomeBack')}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              <div>\n                <Label htmlFor=\"username\">{t('username')}</Label>\n                <Input\n                  id=\"username\"\n                  type=\"text\"\n                  required\n                  value={username}\n                  onChange={(e) => setUsername(e.target.value)}\n                  placeholder={t('enterUsername')}\n                  className=\"mt-1\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"password\">{t('password')}</Label>\n                <div className=\"relative mt-1\">\n                  <Input\n                    id=\"password\"\n                    type={showPassword ? \"text\" : \"password\"}\n                    required\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    placeholder={t('enterPassword')}\n                    className=\"pr-10\"\n                  />\n                  <button\n                    type=\"button\"\n                    className=\"absolute inset-y-0 right-0 flex items-center pr-3\"\n                    onClick={() => setShowPassword(!showPassword)}\n                  >\n                    {showPassword ? (\n                      <EyeOff className=\"h-4 w-4 text-muted-foreground\" />\n                    ) : (\n                      <Eye className=\"h-4 w-4 text-muted-foreground\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              <Button\n                type=\"submit\"\n                disabled={loginMutation.isPending}\n                className=\"w-full bg-black text-white hover:bg-neutral-800\"\n              >\n                {loginMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    {t('loggingIn')}\n                  </>\n                ) : (\n                  t('logIn')\n                )}\n              </Button>\n\n              <div className=\"text-center\">\n                <p className=\"text-sm text-muted-foreground\">\n                  {t('dontHaveAccount')}{\" \"}\n                  <Link href=\"/signup\" className=\"font-medium text-primary hover:underline\">\n                    {t('signUp')}\n                  </Link>\n                </p>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","size_bytes":4436},"client/src/pages/news.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { News } from \"@shared/schema\";\nimport { Clock, AlertTriangle, TrendingUp } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useState } from \"react\";\n\nexport default function NewsPage() {\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"all\");\n  \n  const { data: news, isLoading } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n  });\n\n  const { data: breakingNews, isLoading: breakingLoading } = useQuery<News[]>({\n    queryKey: [\"/api/news/breaking\"],\n  });\n\n  const categories = [\n    { id: \"all\", label: \"All News\" },\n    { id: \"breaking\", label: \"Breaking\" },\n    { id: \"research\", label: \"Research\" },\n    { id: \"analysis\", label: \"Analysis\" },\n    { id: \"market\", label: \"Market\" },\n  ];\n\n  const filteredNews = news?.filter(item => \n    selectedCategory === \"all\" || item.category === selectedCategory\n  );\n\n  const getPriorityBadge = (priority: string) => {\n    switch (priority) {\n      case \"breaking\":\n        return <span className=\"bg-red-500 text-white px-2 py-1 rounded text-xs font-semibold\">BREAKING</span>;\n      case \"research\":\n        return <span className=\"bg-blue-500 text-white px-2 py-1 rounded text-xs font-semibold\">RESEARCH</span>;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <section className=\"py-16 bg-white\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto text-center\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <h1 className=\"text-5xl font-bold text-black mb-6\">Market News & Analysis</h1>\n              <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n                Stay informed with our curated news and expert analysis. Real-time updates on market movements and research insights.\n              </p>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Breaking News Banner */}\n      {breakingNews && breakingNews.length > 0 && (\n        <section className=\"py-4 bg-red-50 border-l-4 border-red-500\">\n          <div className=\"container mx-auto px-4\">\n            <div className=\"max-w-6xl mx-auto\">\n              <div className=\"flex items-center space-x-4\">\n                <AlertTriangle className=\"w-6 h-6 text-red-500\" />\n                <div>\n                  <h3 className=\"font-bold text-red-900\">Breaking News</h3>\n                  <p className=\"text-red-700\">{breakingNews[0].title}</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      )}\n\n      {/* Categories */}\n      <section className=\"py-8 bg-white border-b\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <div className=\"flex flex-wrap gap-4 justify-center\">\n              {categories.map((category) => (\n                <Button\n                  key={category.id}\n                  variant={selectedCategory === category.id ? \"default\" : \"outline\"}\n                  onClick={() => setSelectedCategory(category.id)}\n                >\n                  {category.label}\n                </Button>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* News Content */}\n      <section className=\"py-16\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <div className=\"grid lg:grid-cols-3 gap-8\">\n              {/* Main News Feed */}\n              <div className=\"lg:col-span-2\">\n                {isLoading ? (\n                  <div className=\"space-y-6\">\n                    {Array.from({ length: 5 }).map((_, i) => (\n                      <Card key={i} className=\"animate-pulse\">\n                        <CardContent className=\"p-6\">\n                          <div className=\"h-4 bg-gray-200 rounded mb-4\"></div>\n                          <div className=\"h-6 bg-gray-200 rounded mb-3\"></div>\n                          <div className=\"h-20 bg-gray-200 rounded mb-4\"></div>\n                          <div className=\"h-4 bg-gray-200 rounded\"></div>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                ) : filteredNews && filteredNews.length > 0 ? (\n                  <div className=\"space-y-6\">\n                    {filteredNews.map((item, index) => (\n                      <motion.div\n                        key={item.id}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ duration: 0.6, delay: index * 0.1 }}\n                      >\n                        <Card className=\"hover:shadow-lg transition-all duration-300 hover:-translate-y-1\">\n                          <CardContent className=\"p-6\">\n                            <div className=\"flex items-center mb-3\">\n                              {getPriorityBadge(item.priority || \"normal\")}\n                              <span className=\"text-sm text-gray-500 ml-3\">\n                                <Clock className=\"w-4 h-4 inline mr-1\" />\n                                {new Date(item.publishedAt!).toLocaleString()}\n                              </span>\n                            </div>\n                            <h3 className=\"text-xl font-bold text-black mb-2\">{item.title}</h3>\n                            <p className=\"text-gray-600 mb-4\">{item.description}</p>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm text-gray-500 capitalize\">\n                                {item.category}\n                              </span>\n                              <Button variant=\"ghost\" size=\"sm\">\n                                Read Analysis\n                              </Button>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-16\">\n                    <div className=\"max-w-md mx-auto\">\n                      <AlertTriangle className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                      <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No News Available</h3>\n                      <p className=\"text-gray-600 mb-6\">\n                        {selectedCategory === \"all\" \n                          ? \"No news articles are available at the moment. Check back later for updates.\"\n                          : `No news found in the ${selectedCategory} category.`\n                        }\n                      </p>\n                      <Button \n                        variant=\"outline\" \n                        onClick={() => setSelectedCategory(\"all\")}\n                      >\n                        View All News\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Sidebar */}\n              <div className=\"space-y-8\">\n                {/* Market Sentiment Tracker */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"text-lg font-bold text-black mb-4\">Market Sentiment Tracker</h3>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-gray-600\">Overall Sentiment</span>\n                        <span className=\"text-sm font-semibold text-green-600\">Positive</span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-gray-600\">Weekend News Impact</span>\n                        <span className=\"text-sm font-semibold text-orange-600\">High</span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-gray-600\">Research Opportunities</span>\n                        <span className=\"text-sm font-semibold text-blue-600\">12 Active</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Research Calendar */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"text-lg font-bold text-black mb-4\">Research Calendar</h3>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center space-x-3\">\n                        <div className=\"w-2 h-2 bg-black rounded-full\"></div>\n                        <span className=\"text-sm text-gray-600\">Earnings Analysis - Tech Sector</span>\n                      </div>\n                      <div className=\"flex items-center space-x-3\">\n                        <div className=\"w-2 h-2 bg-gray-400 rounded-full\"></div>\n                        <span className=\"text-sm text-gray-600\">Weekend News Review</span>\n                      </div>\n                      <div className=\"flex items-center space-x-3\">\n                        <div className=\"w-2 h-2 bg-gray-400 rounded-full\"></div>\n                        <span className=\"text-sm text-gray-600\">Market Sentiment Update</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Trending Topics */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"text-lg font-bold text-black mb-4\">Trending Topics</h3>\n                    <div className=\"space-y-3\">\n                      {[\n                        \"Tech Sector Restructuring\",\n                        \"Energy Market Volatility\",\n                        \"Healthcare Regulations\",\n                        \"Financial Earnings\",\n                      ].map((topic, index) => (\n                        <div key={index} className=\"flex items-center space-x-3\">\n                          <TrendingUp className=\"w-4 h-4 text-gray-500\" />\n                          <span className=\"text-sm text-gray-600\">{topic}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","size_bytes":10810},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\n      <Card className=\"w-full max-w-md mx-4 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500 dark:text-red-400\" />\n            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600 dark:text-gray-300\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":844},"client/src/pages/partners.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { \n  Users, \n  UserPlus,\n  MessageSquare,\n  FileText,\n  Calendar,\n  CheckCircle,\n  Clock,\n  AlertCircle,\n  Plus,\n  Eye,\n  Edit,\n  Trash2,\n  BookOpen,\n  TrendingUp,\n  BarChart3,\n  FileDown,\n  Globe,\n  Settings,\n  Hash,\n  DollarSign,\n  Building,\n  TrendingUpDown\n} from \"lucide-react\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Partners() {\n  const { user, isLoading: authLoading } = useAuth();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [activeTab, setActiveTab] = useState(\"dashboard\");\n  const [newRequestOpen, setNewRequestOpen] = useState(false);\n  const [newPublicationOpen, setNewPublicationOpen] = useState(false);\n\n  \n  // Research request dialog state (same as dashboard)\n  const [researchStep, setResearchStep] = useState(1);\n  const [researchType, setResearchType] = useState(\"\");\n  const [researchTarget, setResearchTarget] = useState(\"\");\n  const [researchDescription, setResearchDescription] = useState(\"\");\n\n  // Check if user is a partner (userId 0, 1, or 2)\n  const isPartner = user?.userId === 0 || user?.userId === 1 || user?.userId === 2;\n\n  // Redirect if not authorized\n  useEffect(() => {\n    if (!authLoading && (!user || !isPartner)) {\n      toast({\n        title: \"Access Denied\",\n        description: \"You don't have permission to access the Partner Panel.\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/dashboard\");\n    }\n  }, [user, isPartner, authLoading, toast, setLocation]);\n\n  // Fetch research requests\n  const { data: researchRequests, isLoading: requestsLoading } = useQuery({\n    queryKey: [\"/api/research-requests\"],\n    enabled: isPartner,\n  });\n\n\n\n\n\n  // Fetch research publications\n  const { data: publications, isLoading: publicationsLoading } = useQuery({\n    queryKey: [\"/api/research-publications/drafts\"],\n    enabled: isPartner,\n  });\n\n\n\n  // Create research request mutation (same as dashboard)\n  const createRequestMutation = useMutation({\n    mutationFn: async (requestData: { type: string; target: string; description: string }) => {\n      await apiRequest(\"POST\", \"/api/research-requests\", requestData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/research-requests\"] });\n      resetResearchDialog();\n      toast({\n        title: \"Research Request Created\",\n        description: \"Your research request has been submitted successfully.\",\n        variant: \"default\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Reset research dialog (same as dashboard)\n  const resetResearchDialog = () => {\n    setNewRequestOpen(false);\n    setResearchStep(1);\n    setResearchType(\"\");\n    setResearchTarget(\"\");\n    setResearchDescription(\"\");\n  };\n\n  // Handle research request submit (same as dashboard)\n  const handleResearchRequestSubmit = () => {\n    if (!researchType || !researchTarget) {\n      toast({\n        title: \"Missing information\",\n        description: \"Please select a research type and specify the target.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createRequestMutation.mutate({\n      type: researchType,\n      target: researchTarget,\n      description: researchDescription || `${researchType} analysis for ${researchTarget}`,\n    });\n  };\n\n  // Create publication mutation\n  const createPublicationMutation = useMutation({\n    mutationFn: async (publicationData: any) => {\n      await apiRequest(\"POST\", \"/api/research-publications\", publicationData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/research-publications/drafts\"] });\n      setNewPublicationOpen(false);\n      toast({\n        title: \"Research Publication Created\",\n        description: \"Your research publication has been created successfully.\",\n        variant: \"default\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Update publication mutation\n  const updatePublicationMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: any }) => {\n      await apiRequest(\"PUT\", `/api/research-publications/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/research-publications/drafts\"] });\n      toast({\n        title: \"Publication Updated\",\n        description: \"Research publication has been updated successfully.\",\n        variant: \"default\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Show loading state\n  if (authLoading || requestsLoading || usersLoading || conversationsLoading || publicationsLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-black\"></div>\n      </div>\n    );\n  }\n\n  // Don't render anything if not authorized\n  if (!isPartner) {\n    return null;\n  }\n\n  const handleCreateRequest = (formData: FormData) => {\n    const requestData = {\n      target: formData.get(\"target\"),\n      description: formData.get(\"description\"),\n      category: formData.get(\"category\"),\n      priority: formData.get(\"priority\"),\n    };\n    createRequestMutation.mutate(requestData);\n  };\n\n  const handleCreatePublication = (formData: FormData) => {\n    const publicationData = {\n      title: formData.get(\"title\"),\n      content: formData.get(\"content\"),\n      summary: formData.get(\"summary\"),\n      category: formData.get(\"category\"),\n      tags: formData.get(\"tags\")?.toString().split(\",\").map(tag => tag.trim()).filter(Boolean) || [],\n      isPublished: formData.get(\"isPublished\") === \"on\",\n    };\n    createPublicationMutation.mutate(publicationData);\n  };\n\n\n\n  const handlePublishToggle = (publication: any) => {\n    updatePublicationMutation.mutate({\n      id: publication.id,\n      data: { isPublished: !publication.isPublished },\n    });\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"pending\": return \"bg-yellow-100 text-yellow-800\";\n      case \"assigned\": return \"bg-blue-100 text-blue-800\";\n      case \"in_progress\": return \"bg-purple-100 text-purple-800\";\n      case \"completed\": return \"bg-green-100 text-green-800\";\n      case \"cancelled\": return \"bg-red-100 text-red-800\";\n      default: return \"bg-gray-100 text-gray-800\";\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case \"urgent\": return \"bg-red-100 text-red-800\";\n      case \"high\": return \"bg-orange-100 text-orange-800\";\n      case \"medium\": return \"bg-yellow-100 text-yellow-800\";\n      case \"low\": return \"bg-green-100 text-green-800\";\n      default: return \"bg-gray-100 text-gray-800\";\n    }\n  };\n\n\n\n  return (\n    <div className=\"max-w-7xl mx-auto p-8\">\n      <motion.div\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n        className=\"space-y-8\"\n      >\n        {/* Header */}\n        <motion.div variants={fadeInUp} className=\"text-center\">\n          <h1 className=\"text-4xl font-bold mb-4\">Partner Panel</h1>\n          <p className=\"text-gray-600\">Research collaboration and client communication platform</p>\n        </motion.div>\n\n        {/* Partner Tabs */}\n        <motion.div variants={fadeInUp}>\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\n            <TabsList className=\"grid w-full grid-cols-3\">\n              <TabsTrigger value=\"dashboard\">Dashboard</TabsTrigger>\n              <TabsTrigger value=\"requests\">Research Requests</TabsTrigger>\n              <TabsTrigger value=\"insights\">Publish Research</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"dashboard\" className=\"space-y-6\">\n              {/* Dashboard Stats */}\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Total Requests</CardTitle>\n                    <FileText className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{researchRequests?.length || 0}</div>\n                    <p className=\"text-xs text-gray-500\">All research requests</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Publications</CardTitle>\n                    <BookOpen className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{publications?.length || 0}</div>\n                    <p className=\"text-xs text-gray-500\">Research publications</p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Published</CardTitle>\n                    <Globe className=\"h-4 w-4 text-gray-500\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {publications?.filter(p => p.isPublished).length || 0}\n                    </div>\n                    <p className=\"text-xs text-gray-500\">Live publications</p>\n                  </CardContent>\n                </Card>\n\n\n              </div>\n\n              {/* Recent Activity */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Calendar className=\"h-5 w-5\" />\n                    Recent Activity\n                  </CardTitle>\n                  <CardDescription>\n                    Latest research requests and updates\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {researchRequests?.slice(0, 5).map((request) => (\n                      <div key={request.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"flex-shrink-0\">\n                            <FileText className=\"h-5 w-5 text-gray-500\" />\n                          </div>\n                          <div>\n                            <p className=\"font-medium\">{request.target}</p>\n                            <p className=\"text-sm text-gray-500\">{request.category}</p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <Badge className={getPriorityColor(request.priority)}>\n                            {request.priority}\n                          </Badge>\n                          <Badge className={getStatusColor(request.status)}>\n                            {request.status}\n                          </Badge>\n                        </div>\n                      </div>\n                    )) || (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        No research requests yet\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n\n            <TabsContent value=\"requests\" className=\"space-y-6\">\n              {/* Research Requests */}\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <FileText className=\"h-5 w-5\" />\n                        Research Requests\n                      </CardTitle>\n                      <CardDescription>\n                        Manage and track all research requests\n                      </CardDescription>\n                    </div>\n                    <Dialog open={newRequestOpen} onOpenChange={setNewRequestOpen}>\n                      <DialogTrigger asChild>\n                        <Button>\n                          <Plus className=\"h-4 w-4 mr-2\" />\n                          New Request\n                        </Button>\n                      </DialogTrigger>\n                      <DialogContent className=\"sm:max-w-[425px]\">\n                        <DialogHeader>\n                          <DialogTitle>\n                            {researchStep === 1 ? 'Select Research Type' : 'Research Details'}\n                          </DialogTitle>\n                          <DialogDescription>\n                            {researchStep === 1 \n                              ? 'Choose the type of research you need'\n                              : 'Provide details for your research request'\n                            }\n                          </DialogDescription>\n                        </DialogHeader>\n                        \n                        {researchStep === 1 ? (\n                          <div className=\"space-y-4\">\n                            <RadioGroup value={researchType} onValueChange={setResearchType}>\n                              <div className=\"flex items-center space-x-2\">\n                                <RadioGroupItem value=\"company\" id=\"company\" />\n                                <Label htmlFor=\"company\" className=\"flex items-center\">\n                                  <Building className=\"w-4 h-4 mr-2\" />\n                                  Company Analysis\n                                </Label>\n                              </div>\n                              <div className=\"flex items-center space-x-2\">\n                                <RadioGroupItem value=\"sector\" id=\"sector\" />\n                                <Label htmlFor=\"sector\" className=\"flex items-center\">\n                                  <TrendingUpDown className=\"w-4 h-4 mr-2\" />\n                                  Sector Analysis\n                                </Label>\n                              </div>\n                            </RadioGroup>\n                            \n                            <div className=\"flex justify-end space-x-2\">\n                              <Button variant=\"outline\" onClick={resetResearchDialog}>\n                                Cancel\n                              </Button>\n                              <Button \n                                onClick={() => setResearchStep(2)}\n                                disabled={!researchType}\n                              >\n                                Next\n                              </Button>\n                            </div>\n                          </div>\n                        ) : (\n                          <div className=\"space-y-4\">\n                            <div>\n                              <Label htmlFor=\"target\">\n                                {researchType === 'company' ? 'Company Name/Symbol' : 'Sector Name'}\n                              </Label>\n                              <Input\n                                id=\"target\"\n                                value={researchTarget}\n                                onChange={(e) => setResearchTarget(e.target.value)}\n                                placeholder={researchType === 'company' ? 'e.g., Apple Inc. or AAPL' : 'e.g., Technology, Healthcare'}\n                              />\n                            </div>\n                            \n                            <div>\n                              <Label htmlFor=\"description\">Additional Details (Optional)</Label>\n                              <Textarea\n                                id=\"description\"\n                                value={researchDescription}\n                                onChange={(e) => setResearchDescription(e.target.value)}\n                                placeholder=\"Any specific areas of focus or questions you'd like addressed...\"\n                                rows={3}\n                              />\n                            </div>\n                            \n                            <div className=\"flex justify-end space-x-2\">\n                              <Button variant=\"outline\" onClick={() => setResearchStep(1)}>\n                                Back\n                              </Button>\n                              <Button \n                                onClick={handleResearchRequestSubmit}\n                                disabled={!researchTarget || createRequestMutation.isPending}\n                              >\n                                {createRequestMutation.isPending ? 'Submitting...' : 'Submit Request'}\n                              </Button>\n                            </div>\n                          </div>\n                        )}\n                      </DialogContent>\n                    </Dialog>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {researchRequests?.length ? (\n                      <div className=\"space-y-4\">\n                        {researchRequests.map((request) => (\n                          <div key={request.id} className=\"border rounded-lg p-4\">\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex-1\">\n                                <h3 className=\"font-medium\">{request.target}</h3>\n                                <p className=\"text-sm text-gray-600 mt-1\">{request.description}</p>\n                                <div className=\"flex items-center gap-2 mt-2\">\n                                  <Badge variant=\"outline\">{request.category}</Badge>\n                                  <Badge className={getPriorityColor(request.priority)}>\n                                    {request.priority}\n                                  </Badge>\n                                  <Badge className={getStatusColor(request.status)}>\n                                    {request.status}\n                                  </Badge>\n                                </div>\n                              </div>\n                              <div className=\"flex items-center gap-2\">\n                                <Button variant=\"ghost\" size=\"sm\">\n                                  <Eye className=\"h-4 w-4\" />\n                                </Button>\n                                <Button variant=\"ghost\" size=\"sm\">\n                                  <Edit className=\"h-4 w-4\" />\n                                </Button>\n                                <Button variant=\"ghost\" size=\"sm\">\n                                  <MessageSquare className=\"h-4 w-4\" />\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        No research requests found\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n            <TabsContent value=\"insights\" className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <FileText className=\"h-5 w-5\" />\n                        Research Publications\n                      </CardTitle>\n                      <CardDescription>\n                        Create and publish research insights for clients\n                      </CardDescription>\n                    </div>\n                    <Dialog open={newPublicationOpen} onOpenChange={setNewPublicationOpen}>\n                      <DialogTrigger asChild>\n                        <Button>\n                          <Plus className=\"h-4 w-4 mr-2\" />\n                          New Publication\n                        </Button>\n                      </DialogTrigger>\n                      <DialogContent className=\"max-w-2xl\">\n                        <DialogHeader>\n                          <DialogTitle>Create Research Publication</DialogTitle>\n                          <DialogDescription>\n                            Create a new research publication or insight\n                          </DialogDescription>\n                        </DialogHeader>\n                        <form action={handleCreatePublication} className=\"space-y-4\">\n                          <div>\n                            <Label htmlFor=\"title\">Title</Label>\n                            <Input \n                              id=\"title\" \n                              name=\"title\" \n                              placeholder=\"Publication title\"\n                              required \n                            />\n                          </div>\n                          <div>\n                            <Label htmlFor=\"summary\">Summary</Label>\n                            <Textarea \n                              id=\"summary\" \n                              name=\"summary\" \n                              placeholder=\"Brief summary of the publication\"\n                              required \n                            />\n                          </div>\n                          <div>\n                            <Label htmlFor=\"content\">Content</Label>\n                            <Textarea \n                              id=\"content\" \n                              name=\"content\" \n                              placeholder=\"Full publication content\"\n                              className=\"min-h-32\"\n                              required \n                            />\n                          </div>\n                          <div>\n                            <Label htmlFor=\"category\">Category</Label>\n                            <Select name=\"category\" required>\n                              <SelectTrigger>\n                                <SelectValue placeholder=\"Select category\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                <SelectItem value=\"equity_analysis\">Equity Analysis</SelectItem>\n                                <SelectItem value=\"market_research\">Market Research</SelectItem>\n                                <SelectItem value=\"sector_analysis\">Sector Analysis</SelectItem>\n                                <SelectItem value=\"economic_research\">Economic Research</SelectItem>\n                                <SelectItem value=\"technical_analysis\">Technical Analysis</SelectItem>\n                              </SelectContent>\n                            </Select>\n                          </div>\n                          <div>\n                            <Label htmlFor=\"tags\">Tags (comma-separated)</Label>\n                            <Input \n                              id=\"tags\" \n                              name=\"tags\" \n                              placeholder=\"stocks, analysis, research\"\n                            />\n                          </div>\n                          <div className=\"flex items-center space-x-2\">\n                            <input \n                              type=\"checkbox\" \n                              id=\"isPublished\" \n                              name=\"isPublished\" \n                              className=\"rounded\"\n                            />\n                            <Label htmlFor=\"isPublished\">Publish immediately</Label>\n                          </div>\n                          <div className=\"flex justify-end gap-2\">\n                            <Button type=\"button\" variant=\"outline\" onClick={() => setNewPublicationOpen(false)}>\n                              Cancel\n                            </Button>\n                            <Button type=\"submit\" disabled={createPublicationMutation.isPending}>\n                              {createPublicationMutation.isPending ? \"Creating...\" : \"Create Publication\"}\n                            </Button>\n                          </div>\n                        </form>\n                      </DialogContent>\n                    </Dialog>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {publications?.length ? (\n                      <div className=\"space-y-4\">\n                        {publications.map((publication) => (\n                          <div key={publication.id} className=\"border rounded-lg p-4\">\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex-1\">\n                                <h3 className=\"font-medium\">{publication.title}</h3>\n                                <p className=\"text-sm text-gray-600 mt-1\">{publication.summary}</p>\n                                <div className=\"flex items-center gap-2 mt-2\">\n                                  <Badge variant=\"outline\">{publication.category}</Badge>\n                                  <Badge className={publication.isPublished ? \"bg-green-100 text-green-800\" : \"bg-gray-100 text-gray-800\"}>\n                                    {publication.isPublished ? \"Published\" : \"Draft\"}\n                                  </Badge>\n                                  {publication.tags?.map((tag, index) => (\n                                    <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                                      <Hash className=\"h-3 w-3 mr-1\" />\n                                      {tag}\n                                    </Badge>\n                                  ))}\n                                </div>\n                              </div>\n                              <div className=\"flex items-center gap-2\">\n                                <Button \n                                  variant=\"ghost\" \n                                  size=\"sm\"\n                                  onClick={() => handlePublishToggle(publication)}\n                                >\n                                  {publication.isPublished ? <Eye className=\"h-4 w-4\" /> : <Globe className=\"h-4 w-4\" />}\n                                </Button>\n                                <Button variant=\"ghost\" size=\"sm\">\n                                  <Edit className=\"h-4 w-4\" />\n                                </Button>\n                                <Button variant=\"ghost\" size=\"sm\">\n                                  <Trash2 className=\"h-4 w-4\" />\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        No publications found\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </motion.div>\n      </motion.div>\n    </div>\n  );\n}","size_bytes":29031},"client/src/pages/people.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useParams } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { \n  User, \n  Users, \n  Trophy, \n  Crown, \n  Calendar, \n  TrendingUp, \n  Target,\n  Award,\n  Star,\n  Search,\n  ChevronRight,\n  MapPin,\n  Clock,\n  DollarSign,\n  Plus,\n  Activity,\n  Zap,\n  Flame\n} from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { PortfolioGraph } from \"@/components/ui/portfolio-graph\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\n// Achievement system with proper badge tiers and colors\nconst achievements = [\n  // Common (Gray)\n  { id: 1, name: \"Welcome\", description: \"Welcome to the platform\", icon: User, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n  { id: 2, name: \"First Trade\", description: \"Made your first trade\", icon: Target, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n  { id: 3, name: \"Tournament Participant\", description: \"Joined a tournament\", icon: Users, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n  // Uncommon (Green)\n  { id: 4, name: \"5 Day Streak\", description: \"Traded for 5 consecutive days\", icon: Activity, rarity: \"uncommon\", color: \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\" },\n  { id: 5, name: \"5% Portfolio Growth\", description: \"Made over 5% on portfolio\", icon: TrendingUp, rarity: \"uncommon\", color: \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\" },\n  // Rare (Bright Blue)\n  { id: 6, name: \"Tournament Creator\", description: \"Created a tournament\", icon: Plus, rarity: \"rare\", color: \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\" },\n  { id: 7, name: \"10% Portfolio Growth\", description: \"Made over 10% on portfolio\", icon: TrendingUp, rarity: \"rare\", color: \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\" },\n  { id: 8, name: \"15 Day Streak\", description: \"Traded for 15 consecutive days\", icon: Activity, rarity: \"rare\", color: \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\" },\n  { id: 8, name: \"25% Portfolio Growth\", description: \"Made over 25% on portfolio\", icon: TrendingUp, rarity: \"rare\", color: \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\" },\n  // Epic (Rich Purple)\n  { id: 9, name: \"50 Day Streak\", description: \"Traded for 50 consecutive days\", icon: Activity, rarity: \"epic\", color: \"bg-purple-200 text-purple-900 dark:bg-purple-700 dark:text-purple-100\" },\n  // Legendary (Bright Orange)\n  { id: 10, name: \"Tournament Champion\", description: \"Won a tournament\", icon: Trophy, rarity: \"legendary\", color: \"bg-orange-200 text-orange-900 dark:bg-orange-600 dark:text-orange-100\" },\n  { id: 11, name: \"100 Day Streak\", description: \"Traded for 100 consecutive days\", icon: Activity, rarity: \"legendary\", color: \"bg-orange-200 text-orange-900 dark:bg-orange-600 dark:text-orange-100\" },\n\n  // Mythic (Red)\n  { id: 13, name: \"365 Day Streak\", description: \"Traded every day for a full year\", icon: Activity, rarity: \"mythic\", color: \"bg-red-200 text-red-900 dark:bg-red-700 dark:text-red-100\" },\n  { id: 14, name: \"100% Portfolio Growth\", description: \"Doubled your portfolio value\", icon: TrendingUp, rarity: \"mythic\", color: \"bg-red-200 text-red-900 dark:bg-red-700 dark:text-red-100\" },\n  // Special (Unique gradient designs)\n  { id: 15, name: \"Tournament Overlord\", description: \"Ranked #1 on tournament leaderboard\", icon: Crown, rarity: \"special\", color: \"bg-gradient-to-r from-yellow-400 via-orange-500 to-red-600 text-white font-bold shadow-lg border-2 border-yellow-300\" },\n  { id: 16, name: \"Portfolio Emperor\", description: \"Ranked #1 on personal portfolio leaderboard\", icon: Trophy, rarity: \"special\", color: \"bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-white font-bold shadow-lg border-2 border-purple-300\" },\n  { id: 17, name: \"Streak Master\", description: \"Ranked #1 on trading streak leaderboard\", icon: Zap, rarity: \"special\", color: \"bg-gradient-to-r from-emerald-400 via-teal-500 to-cyan-600 text-white font-bold shadow-lg border-2 border-emerald-300\" },\n];\n\nexport default function People() {\n  const { userId: profileUserId } = useParams<{ userId: string }>();\n  const { user } = useAuth();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [activeTab, setActiveTab] = useState(\"browse\");\n  const [showAchievements, setShowAchievements] = useState(false);\n  const [sortBy, setSortBy] = useState(\"newest\");\n  const [filterBy, setFilterBy] = useState(\"all\");\n\n\n  // Fetch all users for browsing\n  const { data: allUsers, isLoading: isLoadingUsers } = useQuery({\n    queryKey: ['/api/users/public'],\n    enabled: !profileUserId,\n  });\n\n  // Fetch specific user profile\n  const { data: profileUser, isLoading: isLoadingProfile } = useQuery({\n    queryKey: ['/api/users/public', profileUserId],\n    enabled: !!profileUserId,\n  });\n\n  // Fetch user achievements when viewing profile\n  const { data: userAchievements, isLoading: isLoadingAchievements } = useQuery({\n    queryKey: ['/api/achievements', profileUserId],\n    enabled: !!profileUserId,\n  });\n\n  // Filter and sort users\n  const filteredAndSortedUsers = (() => {\n    let users = (allUsers as any)?.data || [];\n    \n    // Apply search filter\n    if (searchQuery) {\n      users = users.filter((u: any) => \n        u.username?.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n    }\n    \n    // Apply role filter\n    if (filterBy !== \"all\") {\n      users = users.filter((u: any) => u.subscriptionTier === filterBy);\n    }\n    \n    // Apply sorting\n    switch (sortBy) {\n      case \"newest\":\n        return users.sort((a: any, b: any) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n      case \"oldest\":\n        return users.sort((a: any, b: any) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime());\n      case \"trades\":\n        return users.sort((a: any, b: any) => (b.totalTrades || 0) - (a.totalTrades || 0));\n      case \"achievements\":\n        return users.sort((a: any, b: any) => (b.achievementCount || 0) - (a.achievementCount || 0));\n      case \"name\":\n        return users.sort((a: any, b: any) => (a.username || \"\").localeCompare(b.username || \"\"));\n      default:\n        return users;\n    }\n  })();\n\n  // Map achievement types to display data\n  const getAchievementDisplay = (achievement: any) => {\n    // The API returns camelCase field names\n    const displayData = achievements.find(a => a.name === achievement.achievementName);\n    return displayData || {\n      id: achievement.id,\n      name: achievement.achievementName,\n      description: achievement.achievementDescription,\n      icon: Trophy,\n      rarity: achievement.achievementTier,\n      color: getColorForTier(achievement.achievementTier)\n    };\n  };\n\n  // Get color for achievement tier\n  const getColorForTier = (tier: string) => {\n    switch(tier) {\n      case 'common': return \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\";\n      case 'uncommon': return \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\";\n      case 'rare': return \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\";\n      case 'epic': return \"bg-purple-200 text-purple-900 dark:bg-purple-700 dark:text-purple-100\";\n      case 'legendary': return \"bg-orange-200 text-orange-900 dark:bg-orange-600 dark:text-orange-100\";\n      case 'mythic': return \"bg-red-200 text-red-900 dark:bg-red-700 dark:text-red-100\";\n      default: return \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\";\n    }\n  };\n\n  // Get tier ranking for sorting (higher number = rarer)\n  const getTierRanking = (tier: string) => {\n    switch(tier) {\n      case 'mythic': return 6;\n      case 'legendary': return 5;\n      case 'epic': return 4;\n      case 'rare': return 3;\n      case 'uncommon': return 2;\n      case 'common': return 1;\n      default: return 0;\n    }\n  };\n\n  // Get user stats from API data\n  const getUserStats = (user: any) => ({\n    lastActive: new Date(Date.now() - Math.floor(Math.random() * 86400000 * 7)),\n    totalTrades: user?.totalTrades || 0,\n    achievements: user?.achievements || 0\n  });\n\n  // If viewing a specific user profile\n  if (profileUserId) {\n    if (isLoadingProfile || isLoadingAchievements) {\n      return (\n        <div className=\"min-h-screen bg-background flex items-center justify-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\n        </div>\n      );\n    }\n\n    const stats = getUserStats((profileUser as any)?.data);\n    const displayAchievements = ((userAchievements as any)?.data?.map((achievement: any) => getAchievementDisplay(achievement)) || [])\n      .sort((a: any, b: any) => getTierRanking(b.rarity) - getTierRanking(a.rarity));\n\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <div className=\"container mx-auto py-8 px-4\">\n          <motion.div\n            className=\"max-w-4xl mx-auto\"\n            initial=\"initial\"\n            animate=\"animate\"\n            variants={staggerChildren}\n          >\n            {/* Back Button */}\n            <motion.div className=\"mb-6\" variants={fadeInUp}>\n              <Button \n                variant=\"ghost\" \n                onClick={() => window.history.back()}\n                className=\"flex items-center\"\n              >\n                <ChevronRight className=\"w-4 h-4 mr-2 rotate-180\" />\n                Back to People\n              </Button>\n            </motion.div>\n\n            {/* Profile Header */}\n            <motion.div variants={fadeInUp}>\n              <Card className=\"mb-8 border-0 shadow-lg\">\n                <CardContent className=\"p-8\">\n                  <div className=\"flex items-center space-x-6\">\n                    <Avatar className=\"w-24 h-24\">\n                      <AvatarFallback className=\"text-2xl font-bold\">\n                        {(profileUser as any)?.data?.username?.[0]?.toUpperCase()}{(profileUser as any)?.data?.username?.[1]?.toUpperCase()}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1\">\n                      <h1 className=\"text-3xl font-bold text-foreground mb-2\">\n                        {(profileUser as any)?.data?.username}\n                      </h1>\n                      <div className=\"flex items-center space-x-4 mb-4\">\n                        {(profileUser as any)?.data?.subscriptionTier === 'administrator' && (\n                          <Badge className=\"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100\">\n                            <Crown className=\"w-3 h-3 mr-1\" />\n                            Administrator\n                          </Badge>\n                        )}\n                        <Badge className=\"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\">\n                          <Calendar className=\"w-3 h-3 mr-1\" />\n                          Since {(profileUser as any)?.data?.createdAt ? new Date((profileUser as any).data.createdAt).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : 'Unknown'}\n                        </Badge>\n                        <Badge className=\"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\">\n                          <Clock className=\"w-3 h-3 mr-1\" />\n                          Active {Math.floor((Date.now() - stats.lastActive.getTime()) / (1000 * 60 * 60 * 24))} days ago\n                        </Badge>\n                      </div>\n                      \n                      {/* Advanced Stats */}\n                      <div className=\"grid grid-cols-4 gap-4\">\n                        <div className=\"text-center\">\n                          <p className=\"text-xl font-bold text-foreground\">{(profileUser as any)?.data?.totalTrades || 0}</p>\n                          <p className=\"text-xs text-muted-foreground\">Total Trades</p>\n                        </div>\n                        <div className=\"text-center\">\n                          <p className=\"text-xl font-bold text-foreground\">{displayAchievements.length}</p>\n                          <p className=\"text-xs text-muted-foreground\">Achievements</p>\n                        </div>\n                        <div className=\"text-center\">\n                          <p className=\"text-xl font-bold text-green-600\">+{Math.floor(Math.random() * 50) + 5}%</p>\n                          <p className=\"text-xs text-muted-foreground\">Portfolio Growth</p>\n                        </div>\n                        <div className=\"text-center\">\n                          <p className=\"text-xl font-bold text-blue-600\">{Math.floor(Math.random() * 100) + 10}d</p>\n                          <p className=\"text-xs text-muted-foreground\">Trading Streak</p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            {/* Achievements */}\n            <motion.div variants={fadeInUp}>\n              <Card className=\"mb-8 border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center\">\n                    <Award className=\"w-5 h-5 mr-2\" />\n                    Achievements\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {displayAchievements.length > 0 ? displayAchievements.map((achievement: any) => (\n                      <div key={achievement.id} className=\"flex items-center space-x-3 p-3 rounded-lg bg-muted/50\">\n                        <div className={`w-10 h-10 rounded-full ${achievement.color} flex items-center justify-center`}>\n                          <achievement.icon className=\"w-5 h-5\" />\n                        </div>\n                        <div>\n                          <p className=\"font-medium text-foreground\">{achievement.name}</p>\n                          <p className=\"text-sm text-muted-foreground\">{achievement.description}</p>\n                        </div>\n                      </div>\n                    )) : (\n                      <div className=\"col-span-full text-center py-4\">\n                        <p className=\"text-muted-foreground\">No achievements yet</p>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            {/* Portfolio Performance */}\n            <motion.div variants={fadeInUp}>\n              <PortfolioGraph \n                userId={parseInt(profileUserId)}\n                portfolioType=\"personal\"\n                title=\"Portfolio Performance\"\n                height={250}\n                className=\"mb-8\"\n              />\n            </motion.div>\n\n          </motion.div>\n        </div>\n      </div>\n    );\n  }\n\n  // Main people browsing page\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto py-8 px-4\">\n        <motion.div\n          className=\"max-w-6xl mx-auto\"\n          initial=\"initial\"\n          animate=\"animate\"\n          variants={staggerChildren}\n        >\n          {/* Header */}\n          <motion.div className=\"mb-8\" variants={fadeInUp}>\n            <h1 className=\"text-3xl font-bold text-foreground mb-2\">People</h1>\n            <p className=\"text-muted-foreground\">Discover and connect with traders in our community</p>\n          </motion.div>\n\n          {/* Search and Filters */}\n          <motion.div className=\"mb-8\" variants={fadeInUp}>\n            <div className=\"flex flex-col sm:flex-row gap-4 mb-4\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search by name or username...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n              \n              {/* Sort By */}\n              <select\n                value={sortBy}\n                onChange={(e) => setSortBy(e.target.value)}\n                className=\"px-3 py-2 border border-input rounded-md bg-background text-foreground\"\n              >\n                <option value=\"newest\">Newest Members</option>\n                <option value=\"oldest\">Oldest Members</option>\n                <option value=\"trades\">Most Trades</option>\n                <option value=\"achievements\">Most Achievements</option>\n                <option value=\"name\">Alphabetical</option>\n              </select>\n              \n              {/* Filter By */}\n              <select\n                value={filterBy}\n                onChange={(e) => setFilterBy(e.target.value)}\n                className=\"px-3 py-2 border border-input rounded-md bg-background text-foreground\"\n              >\n                <option value=\"all\">All Members</option>\n                <option value=\"administrator\">Administrators</option>\n              </select>\n              \n              {/* Achievements Button */}\n              <Dialog open={showAchievements} onOpenChange={setShowAchievements}>\n                <DialogTrigger asChild>\n                  <Button variant=\"outline\" className=\"flex items-center space-x-2 whitespace-nowrap\">\n                    <Trophy className=\"w-4 h-4\" />\n                    <span>Achievements</span>\n                  </Button>\n                </DialogTrigger>\n                <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n                  <DialogHeader>\n                    <DialogTitle className=\"flex items-center space-x-2\">\n                      <Trophy className=\"w-5 h-5\" />\n                      <span>All Achievements</span>\n                    </DialogTitle>\n                  </DialogHeader>\n                  <div className=\"mt-6\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {achievements.map((achievement) => (\n                        <div key={achievement.id} className=\"flex items-center space-x-3 p-4 rounded-lg border bg-card\">\n                          <div className={`w-12 h-12 rounded-full ${achievement.color} flex items-center justify-center`}>\n                            <achievement.icon className=\"w-6 h-6\" />\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <p className=\"font-medium text-foreground\">{achievement.name}</p>\n                              <Badge variant=\"secondary\" className=\"text-xs\">\n                                {achievement.rarity}\n                              </Badge>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground\">{achievement.description}</p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </DialogContent>\n              </Dialog>\n            </div>\n            \n            {/* Results Count */}\n            <div className=\"text-sm text-muted-foreground\">\n              Showing {filteredAndSortedUsers.length} {filteredAndSortedUsers.length === 1 ? 'person' : 'people'}\n              {searchQuery && ` matching \"${searchQuery}\"`}\n              {filterBy !== \"all\" && ` (${filterBy} only)`}\n            </div>\n          </motion.div>\n\n          {/* People Grid */}\n          <motion.div variants={fadeInUp}>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {isLoadingUsers ? (\n                // Loading skeletons\n                Array.from({ length: 6 }).map((_, i) => (\n                  <Card key={i} className=\"border-0 shadow-lg\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"animate-pulse\">\n                        <div className=\"w-16 h-16 bg-muted rounded-full mb-4\"></div>\n                        <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                        <div className=\"h-3 bg-muted rounded w-3/4 mb-4\"></div>\n                        <div className=\"space-y-2\">\n                          <div className=\"h-3 bg-muted rounded\"></div>\n                          <div className=\"h-3 bg-muted rounded w-5/6\"></div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))\n              ) : filteredAndSortedUsers.length === 0 ? (\n                <div className=\"col-span-full text-center py-12\">\n                  <Users className=\"w-12 h-12 text-muted-foreground mx-auto mb-4\" />\n                  <p className=\"text-lg text-muted-foreground\">No people found</p>\n                </div>\n              ) : (\n                filteredAndSortedUsers.map((person: any) => {\n                  const stats = getUserStats(person);\n                  // For the people browsing list, show actual achievement count\n                  const achievementCount = person.achievementCount || 0;\n                  \n                  return (\n                    <Card key={person.id} className=\"border-0 shadow-lg hover:shadow-xl transition-shadow cursor-pointer\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-center space-x-4 mb-4\">\n                          <Avatar className=\"w-16 h-16\">\n                            <AvatarFallback className=\"text-lg font-bold\">\n                              {person.username?.[0]?.toUpperCase()}{person.username?.[1]?.toUpperCase()}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div className=\"flex-1\">\n                            <h3 className=\"text-lg font-semibold text-foreground\">\n                              {person.username}\n                            </h3>\n\n                            <p className=\"text-xs text-muted-foreground\">\n                              Member since {person.createdAt ? new Date(person.createdAt).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : 'Unknown'}\n                            </p>\n                          </div>\n                        </div>\n\n                        {/* Quick Stats */}\n                        <div className=\"grid grid-cols-3 gap-2 mb-4\">\n                          <div className=\"text-center\">\n                            <p className=\"text-sm font-bold text-foreground\">{person.totalTrades || 0}</p>\n                            <p className=\"text-xs text-muted-foreground\">Trades</p>\n                          </div>\n                          <div className=\"text-center\">\n                            <p className=\"text-sm font-bold text-foreground\">{achievementCount}</p>\n                            <p className=\"text-xs text-muted-foreground\">Badges</p>\n                          </div>\n                          <div className=\"text-center\">\n                            <p className=\"text-sm font-bold text-green-600\">\n                              {Math.floor(Math.random() * 30) + 1}%\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">Growth</p>\n                          </div>\n                        </div>\n\n                        {/* Activity Status */}\n                        <div className=\"flex items-center justify-between text-xs text-muted-foreground mb-4\">\n                          <div className=\"flex items-center space-x-1\">\n                            <div className={`w-2 h-2 rounded-full ${Math.random() > 0.5 ? 'bg-green-500' : 'bg-gray-400'}`}></div>\n                            <span>{Math.random() > 0.5 ? 'Active today' : 'Last seen 2d ago'}</span>\n                          </div>\n                          <div className=\"flex items-center space-x-1\">\n                            <Clock className=\"w-3 h-3\" />\n                            <span>{Math.floor(Math.random() * 20) + 1}d streak</span>\n                          </div>\n                        </div>\n\n                        {/* Achievement preview removed for performance - full achievements shown on profile page */}\n\n                        <Button \n                          className=\"w-full\" \n                          variant=\"outline\"\n                          onClick={() => window.location.href = `/people/${person.id}`}\n                        >\n                          View Profile\n                        </Button>\n                      </CardContent>\n                    </Card>\n                  );\n                })\n              )}\n            </div>\n          </motion.div>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","size_bytes":25650},"client/src/pages/portfolio.tsx":{"content":"import { useAuth } from \"@/hooks/use-auth\";\nimport { PortfolioGrid } from \"@/components/portfolio/PortfolioGrid\";\n\nexport default function Portfolio() {\n  const { user } = useAuth();\n\n  if (!user) {\n    return (\n      <div className=\"h-[calc(100vh-4rem)] flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-foreground mb-2\">Please Log In</h2>\n          <p className=\"text-muted-foreground\">You need to be logged in to view your portfolio.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-[calc(100vh-4rem)] overflow-hidden\">\n      <PortfolioGrid />\n    </div>\n  );\n}","size_bytes":667},"client/src/pages/pricing.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, Star, Crown, Zap, BookOpen } from \"lucide-react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\n\nconst tiers = [\n  {\n    name: \"Novice\",\n    price: \"Free\",\n    period: \"forever\",\n    description: \"Perfect for beginners getting started with investment research\",\n    icon: <BookOpen className=\"w-6 h-6\" />,\n    features: [\n      \"Limited watchlist (5 equities)\",\n      \"Limited news access\",\n      \"Email support\",\n      \"Basic market insights\"\n    ],\n    popular: false,\n    color: \"from-green-900 to-green-800\"\n  },\n  {\n    name: \"Explorer\",\n    price: \"$9.99\",\n    period: \"per month\",\n    description: \"Perfect for individual investors starting their qualitative research journey\",\n    icon: <Star className=\"w-6 h-6\" />,\n    features: [\n      \"Access to 50+ research studies monthly\",\n      \"Basic market news and insights\",\n      \"Email support\",\n      \"Basic portfolio tracking\",\n      \"Weekend market analysis\"\n    ],\n    popular: false,\n    color: \"from-gray-900 to-gray-800\"\n  },\n  {\n    name: \"Analyst\",\n    price: \"$19.99\",\n    period: \"per month\",\n    description: \"Ideal for active investors and financial professionals\",\n    icon: <Zap className=\"w-6 h-6\" />,\n    features: [\n      \"Everything in Explorer\",\n      \"Unlimited research studies access\",\n      \"Priority breaking news alerts\",\n      \"Advanced portfolio analytics\",\n      \"Instant email news alerts\",\n      \"Weekend support\"\n    ],\n    popular: true,\n    color: \"from-blue-900 to-blue-800\"\n  },\n  {\n    name: \"Professional\",\n    price: \"$49.99\",\n    period: \"per month\",\n    description: \"Comprehensive solution for investment firms and professionals\",\n    icon: <Crown className=\"w-6 h-6\" />,\n    features: [\n      \"Everything in Analyst\",\n      \"Custom case studies\",\n      \"Priority support\"\n    ],\n    popular: false,\n    color: \"from-purple-900 to-purple-800\"\n  }\n];\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Pricing() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, navigate] = useLocation();\n\n  const subscriptionMutation = useMutation({\n    mutationFn: async (tierName: string) => {\n      const tierMap: { [key: string]: string } = {\n        \"Novice\": \"novice\",\n        \"Explorer\": \"explorer\", \n        \"Analyst\": \"analyst\",\n        \"Professional\": \"professional\"\n      };\n      \n      const res = await apiRequest(\"PUT\", \"/api/user/subscription\", {\n        subscriptionTier: tierMap[tierName]\n      });\n      return await res.json();\n    },\n    onSuccess: (updatedUser, tierName) => {\n      console.log(\"Success callback triggered:\", updatedUser, tierName);\n      queryClient.setQueryData([\"/api/user\"], updatedUser);\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      toast({\n        title: \"Subscription Updated!\",\n        description: `You've successfully upgraded to the ${tierName} tier.`,\n      });\n      // Stay on pricing page to show the change\n      window.location.reload();\n    },\n    onError: (error) => {\n      console.log(\"Error callback triggered:\", error);\n      toast({\n        title: \"Update Failed\",\n        description: \"Failed to update subscription tier. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleTierSelection = (tierName: string) => {\n    console.log(\"Button clicked:\", tierName);\n    console.log(\"User:\", user);\n    console.log(\"User subscription tier:\", user?.subscriptionTier);\n    console.log(\"Is mutation pending?\", subscriptionMutation.isPending);\n    \n    if (!user) {\n      // Not logged in, redirect to auth\n      console.log(\"User not logged in, redirecting to auth\");\n      navigate(\"/auth\");\n      return;\n    }\n    \n    // User is logged in, update subscription\n    console.log(\"Calling mutation with:\", tierName);\n    subscriptionMutation.mutate(tierName);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      {/* Header */}\n      <motion.section \n        className=\"py-20 px-4\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-4xl mx-auto text-center\">\n          <motion.h1 \n            className=\"text-4xl md:text-5xl font-bold mb-6 text-black\"\n            variants={fadeInUp}\n          >\n            Choose Your Research Tier\n          </motion.h1>\n          <motion.p \n            className=\"text-xl text-gray-600 mb-8 max-w-2xl mx-auto\"\n            variants={fadeInUp}\n          >\n            Unlock the power of qualitative investment research with our comprehensive tier system designed for every level of investor.\n          </motion.p>\n        </div>\n      </motion.section>\n\n      {/* Pricing Cards */}\n      <motion.section \n        className=\"py-12 px-4\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"grid lg:grid-cols-4 gap-8 lg:gap-6\">\n            {tiers.map((tier, index) => (\n              <motion.div\n                key={tier.name}\n                variants={fadeInUp}\n                whileHover={{ scale: 1.02 }}\n                className={`relative ${tier.popular ? 'lg:scale-105' : ''}`}\n              >\n                {tier.popular && (\n                  <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2 z-10\">\n                    <Badge className=\"bg-blue-600 text-white px-4 py-1\">\n                      Most Popular\n                    </Badge>\n                  </div>\n                )}\n                \n                <Card className={`h-full border-2 ${tier.popular ? 'border-blue-600' : 'border-gray-200'} relative overflow-hidden`}>\n                  <div className={`absolute inset-0 bg-gradient-to-br ${tier.color} opacity-5 pointer-events-none`} />\n                  \n                  <CardHeader className=\"text-center pb-6\">\n                    <div className=\"flex justify-center mb-4\">\n                      <div className={`p-3 rounded-full bg-gradient-to-br ${tier.color} text-white`}>\n                        {tier.icon}\n                      </div>\n                    </div>\n                    <CardTitle className=\"text-2xl font-bold text-black\">\n                      {tier.name}\n                    </CardTitle>\n                    <CardDescription className=\"text-gray-600 mt-2\">\n                      {tier.description}\n                    </CardDescription>\n                    <div className=\"mt-4\">\n                      <span className=\"text-4xl font-bold text-black\">{tier.price}</span>\n                      <span className=\"text-gray-600 ml-2\">{tier.period}</span>\n                    </div>\n                  </CardHeader>\n                  \n                  <CardContent className=\"pt-0\">\n                    <ul className=\"space-y-3 mb-8\">\n                      {tier.features.map((feature, featureIndex) => (\n                        <li key={featureIndex} className=\"flex items-start\">\n                          <Check className=\"w-5 h-5 text-green-600 mr-3 mt-0.5 flex-shrink-0\" />\n                          <span className=\"text-gray-700\">{feature}</span>\n                        </li>\n                      ))}\n                    </ul>\n                    \n                    <Button \n                      className={`w-full py-6 text-lg font-semibold cursor-pointer ${\n                        tier.popular \n                          ? 'bg-blue-600 hover:bg-blue-700 text-white' \n                          : tier.name === 'Novice'\n                          ? 'bg-green-600 hover:bg-green-700 text-white'\n                          : 'bg-gray-900 hover:bg-gray-800 text-white'\n                      }`}\n                      onClick={(e) => {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        console.log(\"Button clicked for tier:\", tier.name);\n                        handleTierSelection(tier.name);\n                      }}\n                      disabled={subscriptionMutation.isPending || (user && user.subscriptionTier === tier.name.toLowerCase())}\n                      type=\"button\"\n                    >\n                      {subscriptionMutation.isPending ? 'Updating...' : \n                       (user && user.subscriptionTier === tier.name.toLowerCase()) ? 'Current Plan' :\n                       tier.name === 'Novice' ? 'Start Free' : 'Get Started'}\n                    </Button>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </motion.section>\n\n      {/* FAQ Section */}\n      <motion.section \n        className=\"py-20 px-4 bg-gray-50\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <div className=\"max-w-4xl mx-auto\">\n          <motion.h2 \n            className=\"text-3xl font-bold text-center mb-12 text-black\"\n            variants={fadeInUp}\n          >\n            Frequently Asked Questions\n          </motion.h2>\n          \n          <div className=\"grid md:grid-cols-2 gap-8\">\n            <motion.div variants={fadeInUp}>\n              <h3 className=\"text-xl font-semibold mb-3 text-black\">Can I switch tiers anytime?</h3>\n              <p className=\"text-gray-600\">\n                Yes, you can upgrade or downgrade your tier at any time. Changes take effect immediately and billing is prorated.\n              </p>\n            </motion.div>\n            \n            <motion.div variants={fadeInUp}>\n              <h3 className=\"text-xl font-semibold mb-3 text-black\">Is there a free plan?</h3>\n              <p className=\"text-gray-600\">\n                Yes! Our Novice plan is completely free and includes limited watchlist (5 equities), limited news access, and email support.\n              </p>\n            </motion.div>\n            \n            <motion.div variants={fadeInUp}>\n              <h3 className=\"text-xl font-semibold mb-3 text-black\">What payment methods do you accept?</h3>\n              <p className=\"text-gray-600\">\n                We accept all major credit cards, PayPal, and wire transfers for institutional accounts.\n              </p>\n            </motion.div>\n            \n            <motion.div variants={fadeInUp}>\n              <h3 className=\"text-xl font-semibold mb-3 text-black\">How do custom case studies work?</h3>\n              <p className=\"text-gray-600\">\n                Professional tier subscribers can request custom case studies on specific companies or sectors through our platform.\n              </p>\n            </motion.div>\n          </div>\n        </div>\n      </motion.section>\n    </div>\n  );\n}","size_bytes":11285},"client/src/pages/privacy.tsx":{"content":"import { motion } from \"framer-motion\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Privacy() {\n  return (\n    <div className=\"min-h-screen bg-white\">\n      <motion.div \n        className=\"max-w-4xl mx-auto py-20 px-4\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <motion.h1 \n          className=\"text-4xl md:text-5xl font-bold mb-8 text-black\"\n          variants={fadeInUp}\n        >\n          Privacy Policy\n        </motion.h1>\n        \n        <motion.div className=\"prose prose-lg max-w-none\" variants={fadeInUp}>\n          <p className=\"text-gray-600 mb-8\">\n            <strong>Last updated:</strong> {new Date().toLocaleDateString()}\n          </p>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Information We Collect</h2>\n            <p className=\"text-gray-700 mb-4\">\n              At ORSATH, we collect information that you provide directly to us, such as when you create an account, subscribe to our services, or contact us for support.\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Account information (name, email address, payment details)</li>\n              <li>Profile information and preferences</li>\n              <li>Communication records and support interactions</li>\n              <li>Usage data and analytics</li>\n              <li>Device and browser information</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">How We Use Your Information</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We use the information we collect to:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Provide and improve our investment research services</li>\n              <li>Process payments and manage subscriptions</li>\n              <li>Send important updates and communications</li>\n              <li>Personalize your experience and content recommendations</li>\n              <li>Analyze usage patterns to enhance our platform</li>\n              <li>Comply with legal obligations and prevent fraud</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Information Sharing</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We do not sell, rent, or share your personal information with third parties except in the following circumstances:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>With your explicit consent</li>\n              <li>To service providers who help us operate our platform</li>\n              <li>To comply with legal requirements or court orders</li>\n              <li>To protect our rights or prevent fraud</li>\n              <li>In connection with a business transaction (merger, acquisition, etc.)</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Data Security</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We implement appropriate technical and organizational measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction. This includes:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>SSL encryption for data transmission</li>\n              <li>Secure data storage with access controls</li>\n              <li>Regular security audits and updates</li>\n              <li>Employee training on data protection</li>\n              <li>Incident response procedures</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Your Rights</h2>\n            <p className=\"text-gray-700 mb-4\">\n              You have the right to:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Access, update, or delete your personal information</li>\n              <li>Opt out of marketing communications</li>\n              <li>Request a copy of your data</li>\n              <li>Restrict processing of your information</li>\n              <li>Data portability where applicable</li>\n              <li>Lodge a complaint with supervisory authorities</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Cookies and Tracking</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We use cookies and similar technologies to enhance your experience on our platform. You can control cookie preferences through your browser settings.\n            </p>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Changes to This Policy</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the \"Last updated\" date.\n            </p>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">Contact Us</h2>\n            <p className=\"text-gray-700\">\n              If you have any questions about this Privacy Policy, please contact us at:\n            </p>\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n              <p className=\"text-gray-700\">\n                <strong>Email:</strong> privacy@orsath.com<br />\n                <strong>Phone:</strong> +1 (555) 123-4567<br />\n                <strong>Address:</strong> 123 Finance Street, New York, NY 10001\n              </p>\n            </div>\n          </section>\n        </motion.div>\n      </motion.div>\n    </div>\n  );\n}","size_bytes":6257},"client/src/pages/profile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { \n  User, \n  Settings, \n  Bell, \n  CreditCard, \n  Shield, \n  Download,\n  Crown,\n  Mail,\n  Phone,\n  Calendar,\n  MapPin,\n  Trophy,\n  Target,\n  TrendingUp,\n  Award,\n  Star,\n  Users,\n  DollarSign,\n  Plus,\n  Globe,\n  Languages,\n  Upload,\n  Camera\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useTheme } from \"@/hooks/use-theme\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useMutation, useQueryClient, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { PortfolioGraph } from \"@/components/ui/portfolio-graph\";\nimport { ProfilePictureUpload } from \"@/components/profile/ProfilePictureUpload\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nconst profileSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n\n  username: z.string().min(3, \"Username must be at least 3 characters\").max(15, \"Username must be at most 15 characters\").regex(/^[a-zA-Z0-9_]+$/, \"Username can only contain letters, numbers, and underscores\").optional(),\n});\n\ntype ProfileFormData = z.infer<typeof profileSchema>;\n\nexport default function Profile() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const { theme, setTheme } = useTheme();\n  \n  // Balance management state\n  const [addAmount, setAddAmount] = useState(\"\");\n  const [withdrawAmount, setWithdrawAmount] = useState(\"\");\n  const { t, language, currency, updatePreferences, formatCurrency } = useUserPreferences();\n  const queryClient = useQueryClient();\n  const [profilePictureFile, setProfilePictureFile] = useState<File | null>(null);\n  const [profilePicturePreview, setProfilePicturePreview] = useState<string | null>(null);\n\n  \n  // Fetch user achievements for profile display\n  const { data: userAchievements, isLoading: isLoadingAchievements } = useQuery({\n    queryKey: ['/api/achievements', user?.id],\n    enabled: !!user?.id,\n  });\n\n  // Achievement system with proper badge tiers and colors (matching people.tsx)\n  const achievements = [\n    // Common (Gray)\n    { id: 1, name: \"Welcome\", description: \"Welcome to the platform\", icon: User, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n    { id: 2, name: \"First Trade\", description: \"Made your first trade\", icon: Target, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n    { id: 3, name: \"Tournament Participant\", description: \"Joined a tournament\", icon: Users, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n    { id: 4, name: \"Learning Experience\", description: \"Lost money on a trade\", icon: TrendingUp, rarity: \"common\", color: \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\" },\n    // Uncommon (Green)\n    { id: 5, name: \"Profit Maker\", description: \"Made money on trade (tournament)\", icon: DollarSign, rarity: \"uncommon\", color: \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\" },\n    { id: 7, name: \"5% Portfolio Growth\", description: \"Made over 5% on any portfolio\", icon: TrendingUp, rarity: \"uncommon\", color: \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\" },\n    // Rare (Bright Blue)\n    { id: 6, name: \"Tournament Creator\", description: \"Created a tournament\", icon: Plus, rarity: \"rare\", color: \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\" },\n    // Epic (Rich Purple)\n    { id: 8, name: \"Top 3 Finisher\", description: \"Finished in top 3 position in tournament\", icon: Award, rarity: \"epic\", color: \"bg-purple-200 text-purple-900 dark:bg-purple-700 dark:text-purple-100\" },\n    { id: 9, name: \"Tournament Leader\", description: \"Reached top 1 position in tournament\", icon: Crown, rarity: \"epic\", color: \"bg-purple-200 text-purple-900 dark:bg-purple-700 dark:text-purple-100\" },\n    { id: 10, name: \"10% Portfolio Growth\", description: \"Made over 10% on any portfolio\", icon: TrendingUp, rarity: \"rare\", color: \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\" },\n    // Legendary (Bright Orange)\n    { id: 11, name: \"Tournament Champion\", description: \"Won a tournament\", icon: Trophy, rarity: \"legendary\", color: \"bg-orange-200 text-orange-900 dark:bg-orange-600 dark:text-orange-100\" },\n    { id: 12, name: \"25% Portfolio Growth\", description: \"Made over 25% on any portfolio\", icon: TrendingUp, rarity: \"legendary\", color: \"bg-orange-200 text-orange-900 dark:bg-orange-600 dark:text-orange-100\" },\n\n    // Mythic (Red)\n    { id: 14, name: \"Tournament Legend\", description: \"Won 10 tournaments\", icon: Trophy, rarity: \"mythic\", color: \"bg-red-200 text-red-900 dark:bg-red-700 dark:text-red-100\" },\n    { id: 15, name: \"100% Portfolio Growth\", description: \"Made over 100% on any portfolio\", icon: TrendingUp, rarity: \"mythic\", color: \"bg-red-200 text-red-900 dark:bg-red-700 dark:text-red-100\" },\n  ];\n\n  // Map achievement types to display data\n  const getAchievementDisplay = (achievement: any) => {\n    // The API returns camelCase field names\n    const displayData = achievements.find(a => a.name === achievement.achievementName);\n    return displayData || {\n      id: achievement.id,\n      name: achievement.achievementName,\n      description: achievement.achievementDescription,\n      icon: Trophy,\n      rarity: achievement.achievementTier,\n      color: getColorForTier(achievement.achievementTier)\n    };\n  };\n\n  // Get color for achievement tier\n  const getColorForTier = (tier: string) => {\n    switch(tier) {\n      case 'common': return \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\";\n      case 'uncommon': return \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\";\n      case 'rare': return \"bg-blue-200 text-blue-900 dark:bg-blue-700 dark:text-blue-100\";\n      case 'epic': return \"bg-purple-200 text-purple-900 dark:bg-purple-700 dark:text-purple-100\";\n      case 'legendary': return \"bg-orange-200 text-orange-900 dark:bg-orange-600 dark:text-orange-100\";\n      case 'mythic': return \"bg-red-200 text-red-900 dark:bg-red-700 dark:text-red-100\";\n      default: return \"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100\";\n    }\n  };\n\n  // Get tier ranking for sorting (higher number = rarer)\n  const getTierRanking = (tier: string) => {\n    switch(tier) {\n      case 'mythic': return 6;\n      case 'legendary': return 5;\n      case 'epic': return 4;\n      case 'rare': return 3;\n      case 'uncommon': return 2;\n      case 'common': return 1;\n      default: return 0;\n    }\n  };\n\n  const displayAchievements = ((userAchievements as any)?.data?.map(getAchievementDisplay) || [])\n    .sort((a: any, b: any) => getTierRanking(b.rarity) - getTierRanking(a.rarity));\n  \n  const form = useForm<ProfileFormData>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      email: user?.email || \"\",\n\n      username: user?.username || \"\",\n    },\n  });\n\n  // Update form when user data changes\n  useEffect(() => {\n    if (user) {\n      form.reset({\n        email: user.email || \"\",\n\n        username: user.username || \"\",\n      });\n    }\n  }, [user, form]);\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: ProfileFormData) => {\n      console.log(\"Sending profile update data:\", data);\n      return await apiRequest('PUT', '/api/user/profile', data);\n    },\n    onSuccess: (result) => {\n      console.log(\"Profile update successful:\", result);\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users/public\"] });\n      toast({\n        title: \"Profile Updated\",\n        description: \"Your profile has been successfully updated.\",\n      });\n    },\n    onError: (error: any) => {\n      console.error(\"Profile update error:\", error);\n      let errorMessage = \"An error occurred while updating your profile\";\n      \n      // Handle specific error cases\n      if (error.message) {\n        if (error.message.includes(\"Username can only be changed once every two weeks\")) {\n          errorMessage = \"Username can only be changed once every two weeks. Please try again later.\";\n        } else if (error.message.includes(\"Username\")) {\n          errorMessage = error.message;\n        } else {\n          errorMessage = error.message;\n        }\n      }\n      \n      toast({\n        title: \"Update Failed\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n\n\n  const handleSaveProfile = (data: ProfileFormData) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  const handleProfilePictureChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      // Validate file size (max 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        toast({\n          title: \"File too large\",\n          description: \"Please select an image smaller than 5MB\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      // Validate file type\n      if (!file.type.startsWith('image/')) {\n        toast({\n          title: \"Invalid file type\",\n          description: \"Please select a valid image file\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      setProfilePictureFile(file);\n      \n      // Create preview\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const result = e.target?.result as string;\n        setProfilePicturePreview(result);\n        uploadProfilePicture(result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const uploadProfilePicture = async (base64Image: string) => {\n    try {\n      const result = await apiRequest(\"PATCH\", \"/api/profile/picture\", { profilePicture: base64Image });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users/public\"] });\n      toast({\n        title: \"Profile picture updated\",\n        description: \"Your profile picture has been successfully updated.\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Upload failed\",\n        description: error.message || \"Failed to update profile picture\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Balance management mutations\n  const addMoneyMutation = useMutation({\n    mutationFn: async (amount: number) => {\n      return await apiRequest('POST', '/api/balance/add', { amount });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      setAddAmount(\"\");\n      toast({\n        title: \"Money Added\",\n        description: \"The amount has been added to your account balance.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to Add Money\",\n        description: error.message || \"An error occurred while adding money to your account.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const withdrawMoneyMutation = useMutation({\n    mutationFn: async (amount: number) => {\n      return await apiRequest('POST', '/api/balance/withdraw', { amount });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      setWithdrawAmount(\"\");\n      toast({\n        title: \"Money Withdrawn\",\n        description: \"The amount has been withdrawn from your account balance.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to Withdraw Money\",\n        description: error.message || \"An error occurred while withdrawing money from your account.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Balance management handlers\n  const handleAddMoney = () => {\n    const amount = parseFloat(addAmount);\n    if (amount > 0) {\n      addMoneyMutation.mutate(amount);\n    }\n  };\n\n  const handleWithdrawMoney = () => {\n    const amount = parseFloat(withdrawAmount);\n    if (amount > 0) {\n      withdrawMoneyMutation.mutate(amount);\n    }\n  };\n\n  // Format join date\n  const joinDate = user?.createdAt \n    ? new Date(user.createdAt).toLocaleDateString('en-US', { \n        year: 'numeric', \n        month: 'long' \n      })\n    : \"Unknown\";\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card className=\"w-96\">\n          <CardContent className=\"p-6 text-center\">\n            <p className=\"text-muted-foreground\">Please log in to view your profile.</p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto py-8 px-4\">\n        <motion.div\n          className=\"max-w-4xl mx-auto\"\n          initial=\"initial\"\n          animate=\"animate\"\n          variants={staggerChildren}\n        >\n          {/* Header */}\n          <motion.div className=\"mb-8\" variants={fadeInUp}>\n            <h1 className=\"text-3xl font-bold text-foreground mb-2\">My Account</h1>\n            <p className=\"text-muted-foreground\">Manage your public profile and account settings</p>\n          </motion.div>\n\n          {/* User Overview Card */}\n          <motion.div variants={fadeInUp}>\n            <Card className=\"mb-8 border-0 shadow-lg\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-16 h-16 bg-muted rounded-full flex items-center justify-center overflow-hidden\">\n                    {user.profilePicture ? (\n                      <img \n                        src={user.profilePicture} \n                        alt=\"Profile\" \n                        className=\"w-full h-full object-cover\"\n                      />\n                    ) : (\n                      <User className=\"w-8 h-8 text-muted-foreground\" />\n                    )}\n                  </div>\n                  <div className=\"flex-1\">\n                    <h2 className=\"text-xl font-bold text-foreground\">{user.username}</h2>\n                    <p className=\"text-muted-foreground\">{user.email}</p>\n                    <div className=\"flex items-center space-x-4 mt-2\">\n                      <Badge className=\"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\">\n                        <Calendar className=\"w-3 h-3 mr-1\" />\n                        Member since {joinDate}\n                      </Badge>\n                    </div>\n                  </div>\n                  <Button variant=\"outline\" onClick={() => document.getElementById('profile-picture-input')?.click()}>\n                    <Camera className=\"w-4 h-4 mr-2\" />\n                    Change Photo\n                  </Button>\n                  <input\n                    id=\"profile-picture-input\"\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleProfilePictureChange}\n                    className=\"hidden\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Main Content */}\n          <motion.div variants={fadeInUp}>\n            <Tabs defaultValue=\"public\" className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"public\" className=\"flex items-center space-x-2\">\n                  <User className=\"w-4 h-4\" />\n                  <span>Public Profile</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"account\" className=\"flex items-center space-x-2\">\n                  <Settings className=\"w-4 h-4\" />\n                  <span>Account Settings</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"preferences\" className=\"flex items-center space-x-2\">\n                  <Languages className=\"w-4 h-4\" />\n                  <span>{t('preferences')}</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"security\" className=\"flex items-center space-x-2\">\n                  <Shield className=\"w-4 h-4\" />\n                  <span>Security</span>\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"public\">\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle>Public Profile</CardTitle>\n                    <CardDescription>\n                      This information is visible to other users on the platform\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    <div className=\"grid grid-cols-1 gap-6\">\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"username\">Username</Label>\n                        <Input \n                          id=\"username\"\n                          {...form.register(\"username\")}\n                          placeholder={user?.username}\n                        />\n                        <p className=\"text-xs text-muted-foreground\">\n                          Username can only be changed once every 2 weeks. Contains only letters, numbers, and underscores.\n                        </p>\n                        {form.formState.errors.username && (\n                          <p className=\"text-sm text-destructive\">\n                            {form.formState.errors.username.message}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n\n\n\n                    <Separator />\n\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-medium text-foreground\">Trading Achievements</h4>\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                        {isLoadingAchievements ? (\n                          <div className=\"col-span-full text-center py-4\">\n                            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n                            <p className=\"text-muted-foreground mt-2\">Loading achievements...</p>\n                          </div>\n                        ) : displayAchievements.length > 0 ? (\n                          displayAchievements.map((achievement: any) => (\n                            <div key={achievement.id} className=\"flex items-center space-x-3 p-3 rounded-lg bg-muted/50\">\n                              <div className={`w-10 h-10 rounded-full ${achievement.color} flex items-center justify-center`}>\n                                <achievement.icon className=\"w-5 h-5\" />\n                              </div>\n                              <div>\n                                <p className=\"font-medium text-foreground\">{achievement.name}</p>\n                                <p className=\"text-sm text-muted-foreground\">{achievement.description}</p>\n                              </div>\n                            </div>\n                          ))\n                        ) : (\n                          <div className=\"col-span-full text-center p-4 border-2 border-dashed border-muted rounded-lg\">\n                            <p className=\"text-sm text-muted-foreground\">No achievements yet</p>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    <Separator />\n\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-medium text-foreground\">Portfolio Performance</h4>\n                      <PortfolioGraph \n                        userId={user.id}\n                        portfolioType=\"personal\"\n                        title=\"Your Portfolio Since Account Creation\"\n                        height={250}\n                        showStats={true}\n                      />\n                    </div>\n\n                    <Button \n                      className=\"w-full\" \n                      onClick={(e) => {\n                        e.preventDefault();\n                        form.handleSubmit(handleSaveProfile)();\n                      }}\n                      disabled={updateProfileMutation.isPending}\n                    >\n                      {updateProfileMutation.isPending ? \"Updating...\" : \"Update Public Profile\"}\n                    </Button>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"account\" className=\"space-y-6\">\n                {/* Profile Picture Upload */}\n                <ProfilePictureUpload />\n                \n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle>Account Settings</CardTitle>\n                    <CardDescription>\n                      Manage your private account information and settings\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    <form onSubmit={form.handleSubmit(handleSaveProfile)} className=\"space-y-6\">\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"userId\">User ID</Label>\n                          <Input \n                            id=\"userId\" \n                            value={user.userId !== null ? user.userId : \"Not assigned\"} \n                            className=\"bg-muted cursor-not-allowed\" \n                            disabled \n                          />\n                          <p className=\"text-xs text-muted-foreground\">\n                            Your unique account identifier\n                          </p>\n                        </div>\n\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"email\">Email Address</Label>\n                          <div className=\"relative\">\n                            <Mail className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                            <Input \n                              id=\"email\" \n                              type=\"email\" \n                              {...form.register(\"email\")}\n                              className=\"pl-10\" \n                              placeholder=\"Enter your email\"\n                            />\n                          </div>\n                          {form.formState.errors.email && (\n                            <p className=\"text-sm text-destructive\">\n                              {form.formState.errors.email.message}\n                            </p>\n                          )}\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"joinDate\">Member Since</Label>\n                          <div className=\"relative\">\n                            <Calendar className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                            <Input \n                              id=\"joinDate\" \n                              value={joinDate} \n                              className=\"pl-10\" \n                              disabled \n                            />\n                          </div>\n                        </div>\n                      </div>\n                      <Button \n                        type=\"submit\" \n                        disabled={updateProfileMutation.isPending}\n                      >\n                        {updateProfileMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n                      </Button>\n                    </form>\n                  </CardContent>\n                </Card>\n\n                {/* Balance Management for Testing */}\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center space-x-2\">\n                      <DollarSign className=\"w-5 h-5\" />\n                      <span>Balance Management (Testing)</span>\n                    </CardTitle>\n                    <CardDescription>\n                      Add or withdraw money from your account balance for testing purposes. This represents real money that can be cashed out.\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    {/* Current Balance Display */}\n                    <div className=\"bg-muted/50 p-4 rounded-lg\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm text-muted-foreground\">Current Account Balance</p>\n                          <p className=\"text-2xl font-bold text-foreground\">{formatCurrency(Number(user?.balance || 0))}</p>\n                        </div>\n                        <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\n                          <DollarSign className=\"w-6 h-6 text-primary\" />\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Balance Actions */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {/* Add Money */}\n                      <Card className=\"border\">\n                        <CardHeader className=\"pb-3\">\n                          <CardTitle className=\"text-lg flex items-center space-x-2\">\n                            <Plus className=\"w-4 h-4 text-green-600\" />\n                            <span>Add Money</span>\n                          </CardTitle>\n                        </CardHeader>\n                        <CardContent className=\"space-y-3\">\n                          <div className=\"space-y-2\">\n                            <Label htmlFor=\"addAmount\">Amount to Add</Label>\n                            <Input\n                              id=\"addAmount\"\n                              type=\"number\"\n                              min=\"0.01\"\n                              step=\"0.01\"\n                              placeholder=\"Enter amount...\"\n                              value={addAmount}\n                              onChange={(e) => setAddAmount(e.target.value)}\n                            />\n                          </div>\n                          <Button \n                            className=\"w-full bg-green-600 hover:bg-green-700\"\n                            onClick={handleAddMoney}\n                            disabled={!addAmount || parseFloat(addAmount) <= 0 || addMoneyMutation.isPending}\n                          >\n                            {addMoneyMutation.isPending ? \"Adding...\" : \"Add Money\"}\n                          </Button>\n                        </CardContent>\n                      </Card>\n\n                      {/* Withdraw Money */}\n                      <Card className=\"border\">\n                        <CardHeader className=\"pb-3\">\n                          <CardTitle className=\"text-lg flex items-center space-x-2\">\n                            <DollarSign className=\"w-4 h-4 text-red-600\" />\n                            <span>Withdraw Money</span>\n                          </CardTitle>\n                        </CardHeader>\n                        <CardContent className=\"space-y-3\">\n                          <div className=\"space-y-2\">\n                            <Label htmlFor=\"withdrawAmount\">Amount to Withdraw</Label>\n                            <Input\n                              id=\"withdrawAmount\"\n                              type=\"number\"\n                              min=\"0.01\"\n                              step=\"0.01\"\n                              placeholder=\"Enter amount...\"\n                              value={withdrawAmount}\n                              onChange={(e) => setWithdrawAmount(e.target.value)}\n                            />\n                          </div>\n                          <Button \n                            className=\"w-full bg-red-600 hover:bg-red-700\"\n                            onClick={handleWithdrawMoney}\n                            disabled={!withdrawAmount || parseFloat(withdrawAmount) <= 0 || withdrawMoneyMutation.isPending}\n                          >\n                            {withdrawMoneyMutation.isPending ? \"Withdrawing...\" : \"Withdraw Money\"}\n                          </Button>\n                        </CardContent>\n                      </Card>\n                    </div>\n\n                    {/* Important Notice */}\n                    <div className=\"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-4\">\n                      <div className=\"flex items-start space-x-3\">\n                        <Shield className=\"w-5 h-5 text-amber-600 mt-0.5\" />\n                        <div>\n                          <h4 className=\"font-medium text-amber-800 dark:text-amber-200\">Testing Environment Notice</h4>\n                          <p className=\"text-sm text-amber-700 dark:text-amber-300 mt-1\">\n                            This balance management system is for testing purposes only. In production, money would be processed through secure payment gateways and banking systems.\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"preferences\">\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle>{t('preferences')}</CardTitle>\n                    <CardDescription>\n                      Manage your language, currency, and notification settings\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    {/* Language and Currency Settings */}\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-semibold text-foreground flex items-center\">\n                        <Languages className=\"w-4 h-4 mr-2\" />\n                        {t('language')} & {t('currency')}\n                      </h4>\n                      \n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"language\">{t('language')}</Label>\n                          <Select \n                            value={language} \n                            onValueChange={(value) => updatePreferences(value, undefined)}\n                          >\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select language\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"English\">English</SelectItem>\n                              <SelectItem value=\"Portuguese\">Português</SelectItem>\n                              <SelectItem value=\"Spanish\">Español</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        \n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"currency\">{t('currency')}</Label>\n                          <Select \n                            value={currency} \n                            onValueChange={(value) => updatePreferences(undefined, value)}\n                          >\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select currency\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"USD\">USD ($)</SelectItem>\n                              <SelectItem value=\"BRL\">BRL (R$)</SelectItem>\n                              <SelectItem value=\"ARS\">ARS ($)</SelectItem>\n                              <SelectItem value=\"MXN\">MXN ($)</SelectItem>\n                              <SelectItem value=\"CAD\">CAD (C$)</SelectItem>\n                              <SelectItem value=\"COP\">COP ($)</SelectItem>\n                              <SelectItem value=\"CLP\">CLP ($)</SelectItem>\n                              <SelectItem value=\"PEN\">PEN (S/)</SelectItem>\n                              <SelectItem value=\"UYU\">UYU ($U)</SelectItem>\n                              <SelectItem value=\"EUR\">EUR (€)</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </div>\n                    </div>\n\n                    <Separator />\n\n                    {/* Notification Settings */}\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-semibold text-foreground flex items-center\">\n                        <Bell className=\"w-4 h-4 mr-2\" />\n                        Notifications\n                      </h4>\n                      <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h4 className=\"font-medium text-foreground\">Tournament Updates</h4>\n                          <p className=\"text-sm text-muted-foreground\">Get notified about tournament results and new competitions</p>\n                        </div>\n                        <Switch defaultChecked />\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h4 className=\"font-medium text-foreground\">Market Alerts</h4>\n                          <p className=\"text-sm text-muted-foreground\">Important market movements and trading opportunities</p>\n                        </div>\n                        <Switch defaultChecked />\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h4 className=\"font-medium text-foreground\">Watchlist Updates</h4>\n                          <p className=\"text-sm text-muted-foreground\">Changes to companies in your watchlist</p>\n                        </div>\n                        <Switch defaultChecked />\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h4 className=\"font-medium text-foreground\">Marketing Emails</h4>\n                          <p className=\"text-sm text-muted-foreground\">Product updates and promotional content</p>\n                        </div>\n                        <Switch />\n                      </div>\n                      </div>\n                    </div>\n\n                    <Separator />\n\n                    <div className=\"space-y-4\">\n                      <h4 className=\"font-semibold text-foreground\">Display Settings</h4>\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h4 className=\"font-medium text-foreground\">Dark Mode</h4>\n                          <p className=\"text-sm text-muted-foreground\">Switch between light and dark themes</p>\n                        </div>\n                        <Switch \n                          checked={theme === \"dark\"}\n                          onCheckedChange={(checked) => setTheme(checked ? \"dark\" : \"light\")}\n                        />\n                      </div>\n                    </div>\n\n                    <Separator />\n\n\n\n                    <Button>Save Preferences</Button>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"security\">\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle>Security Settings</CardTitle>\n                    <CardDescription>\n                      Manage your account security and privacy\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <h4 className=\"font-medium text-foreground mb-2\">Change Password</h4>\n                        <div className=\"space-y-3\">\n                          <Input type=\"password\" placeholder=\"Current password\" />\n                          <Input type=\"password\" placeholder=\"New password\" />\n                          <Input type=\"password\" placeholder=\"Confirm new password\" />\n                          <Button variant=\"outline\">Update Password</Button>\n                        </div>\n                      </div>\n\n                      <Separator />\n\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h4 className=\"font-medium text-foreground\">Two-Factor Authentication</h4>\n                          <p className=\"text-sm text-muted-foreground\">Add an extra layer of security to your account</p>\n                        </div>\n                        <Button variant=\"outline\">Enable 2FA</Button>\n                      </div>\n\n                      <Separator />\n\n                      <div>\n                        <h4 className=\"font-medium text-foreground mb-2\">Active Sessions</h4>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between p-3 bg-muted rounded\">\n                            <div>\n                              <p className=\"text-sm font-medium text-foreground\">Current Session</p>\n                              <p className=\"text-xs text-muted-foreground\">Chrome on macOS • New York, NY</p>\n                            </div>\n                            <Badge variant=\"secondary\">Active</Badge>\n                          </div>\n                        </div>\n                        <Button variant=\"outline\" className=\"mt-3\">\n                          Sign Out All Other Sessions\n                        </Button>\n                      </div>\n\n                      <Separator />\n\n                      <div className=\"space-y-2\">\n                        <h4 className=\"font-medium text-foreground\">Account Actions</h4>\n                        <div className=\"space-y-2\">\n                          <Button variant=\"outline\" className=\"w-full justify-start\">\n                            <Download className=\"w-4 h-4 mr-2\" />\n                            Download Your Data\n                          </Button>\n                          <Button variant=\"destructive\" className=\"w-full justify-start\">\n                            Delete Account\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </motion.div>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","size_bytes":40159},"client/src/pages/shop.tsx":{"content":"import { useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { \n  ShoppingBag,\n  Zap,\n  Star,\n  Clock,\n  Wrench,\n  ArrowLeft,\n  DollarSign,\n  Plus\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.5 }\n};\n\nexport default function Shop() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n  const { toast } = useToast();\n  const [refillDialogOpen, setRefillDialogOpen] = useState(false);\n  const [selectedAmount, setSelectedAmount] = useState<number | null>(null);\n  const [customAmount, setCustomAmount] = useState(\"\");\n\n  // Mutation for adding site cash\n  const addSiteCashMutation = useMutation({\n    mutationFn: async (amount: number) => {\n      const response = await apiRequest(\"POST\", \"/api/admin/add-site-cash\", { amount });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      setRefillDialogOpen(false);\n      setSelectedAmount(null);\n      setCustomAmount(\"\");\n      toast({\n        title: \"Balance Added\",\n        description: `Successfully added ${formatCurrency(data.amount)} to your account.`,\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add balance\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleRefill = () => {\n    const amount = selectedAmount || parseFloat(customAmount);\n    if (amount && amount > 0) {\n      addSiteCashMutation.mutate(amount);\n    }\n  };\n\n  const presetAmounts = [10, 50, 100];\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-6 py-8\">\n        \n        {/* Header */}\n        <motion.div \n          className=\"mb-8\"\n          {...fadeInUp}\n        >\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-4\">\n              <Link href=\"/hub\">\n                <Button variant=\"ghost\" size=\"sm\">\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                  Back to Hub\n                </Button>\n              </Link>\n              <div>\n                <h1 className=\"text-3xl font-bold text-foreground flex items-center\">\n                  <ShoppingBag className=\"w-8 h-8 mr-3 text-primary\" />\n                  Trading Shop\n                </h1>\n                <p className=\"text-muted-foreground mt-1\">\n                  Power-ups and enhancements coming soon\n                </p>\n              </div>\n            </div>\n            <Badge variant=\"secondary\" className=\"text-sm\">\n              <Wrench className=\"w-4 h-4 mr-1\" />\n              Work in Progress\n            </Badge>\n          </div>\n        </motion.div>\n\n        {/* Refill Balance Section */}\n        <motion.div \n          className=\"mb-8\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.1 }}\n        >\n          <Card className=\"border-primary/20 bg-gradient-to-r from-primary/5 to-accent/5\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center text-xl\">\n                <DollarSign className=\"w-6 h-6 mr-2 text-primary\" />\n                Account Balance\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-2xl font-bold text-foreground\">\n                    {formatCurrency(Number(user?.siteCash) || 0)}\n                  </p>\n                  <p className=\"text-muted-foreground text-sm\">\n                    Current balance available for tournaments and features\n                  </p>\n                </div>\n                <Dialog open={refillDialogOpen} onOpenChange={setRefillDialogOpen}>\n                  <DialogTrigger asChild>\n                    <Button className=\"flex items-center space-x-2\">\n                      <Plus className=\"w-4 h-4\" />\n                      <span>Refill Balance</span>\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent className=\"sm:max-w-md\">\n                    <DialogHeader>\n                      <DialogTitle>Refill Your Balance</DialogTitle>\n                      <DialogDescription>\n                        Add funds to your account to participate in tournaments and purchase features.\n                      </DialogDescription>\n                    </DialogHeader>\n                    <div className=\"space-y-4\">\n                      {/* Preset Amount Options */}\n                      <div>\n                        <Label className=\"text-sm font-medium\">Quick Select</Label>\n                        <div className=\"grid grid-cols-3 gap-2 mt-2\">\n                          {presetAmounts.map((amount) => (\n                            <Button\n                              key={amount}\n                              variant={selectedAmount === amount ? \"default\" : \"outline\"}\n                              onClick={() => {\n                                setSelectedAmount(amount);\n                                setCustomAmount(\"\");\n                              }}\n                              className=\"h-12\"\n                            >\n                              {formatCurrency(amount)}\n                            </Button>\n                          ))}\n                        </div>\n                      </div>\n                      \n                      {/* Custom Amount */}\n                      <div>\n                        <Label htmlFor=\"custom-amount\" className=\"text-sm font-medium\">\n                          Custom Amount\n                        </Label>\n                        <div className=\"relative mt-2\">\n                          <DollarSign className=\"w-4 h-4 text-muted-foreground absolute left-3 top-1/2 transform -translate-y-1/2\" />\n                          <Input\n                            id=\"custom-amount\"\n                            type=\"number\"\n                            placeholder=\"0.00\"\n                            value={customAmount}\n                            onChange={(e) => {\n                              setCustomAmount(e.target.value);\n                              setSelectedAmount(null);\n                            }}\n                            className=\"pl-10\"\n                            min=\"0\"\n                            step=\"0.01\"\n                          />\n                        </div>\n                      </div>\n                    </div>\n                    <DialogFooter>\n                      <Button \n                        variant=\"outline\" \n                        onClick={() => setRefillDialogOpen(false)}\n                      >\n                        Cancel\n                      </Button>\n                      <Button \n                        onClick={handleRefill}\n                        disabled={\n                          addSiteCashMutation.isPending || \n                          (!selectedAmount && !customAmount) ||\n                          (customAmount && parseFloat(customAmount) <= 0)\n                        }\n                      >\n                        {addSiteCashMutation.isPending ? \"Processing...\" : \"Add Funds\"}\n                      </Button>\n                    </DialogFooter>\n                  </DialogContent>\n                </Dialog>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Coming Soon Section */}\n        <motion.div \n          className=\"mb-12\"\n          initial={{ opacity: 0, y: 30 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, delay: 0.2 }}\n        >\n          <Card className=\"border-dashed border-2 border-primary/30 bg-primary/5\">\n            <CardContent className=\"p-12 text-center\">\n              <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-6\">\n                <ShoppingBag className=\"w-10 h-10 text-primary\" />\n              </div>\n              <h2 className=\"text-2xl font-bold text-foreground mb-4\">\n                Shop Coming Soon!\n              </h2>\n              <p className=\"text-muted-foreground text-lg mb-6 max-w-2xl mx-auto\">\n                We're building an amazing shop where you can purchase power-ups, \n                trading tools, and exclusive features to enhance your trading experience.\n              </p>\n              <div className=\"flex items-center justify-center space-x-2 text-primary\">\n                <Clock className=\"w-5 h-5\" />\n                <span className=\"font-medium\">Expected Launch: Q2 2025</span>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Preview Features */}\n        <motion.div \n          className=\"grid grid-cols-1 md:grid-cols-3 gap-6\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.8, delay: 0.4 }}\n        >\n          {[\n            {\n              title: \"Trading Boosters\",\n              description: \"Temporary multipliers for tournament performance\",\n              icon: Zap,\n              color: \"text-yellow-500\"\n            },\n            {\n              title: \"Premium Analytics\",\n              description: \"Advanced charts and market analysis tools\",\n              icon: Star,\n              color: \"text-blue-500\"\n            },\n            {\n              title: \"Custom Themes\",\n              description: \"Personalize your trading dashboard appearance\",\n              icon: ShoppingBag,\n              color: \"text-purple-500\"\n            }\n          ].map((feature, index) => (\n            <Card key={index} className=\"bg-card/50 backdrop-blur-sm border-border/50\">\n              <CardHeader className=\"text-center pb-4\">\n                <div className=\"w-12 h-12 bg-muted/50 rounded-full flex items-center justify-center mx-auto mb-3\">\n                  <feature.icon className={`w-6 h-6 ${feature.color}`} />\n                </div>\n                <CardTitle className=\"text-lg\">{feature.title}</CardTitle>\n              </CardHeader>\n              <CardContent className=\"text-center\">\n                <p className=\"text-muted-foreground text-sm mb-4\">\n                  {feature.description}\n                </p>\n                <Button variant=\"outline\" size=\"sm\" disabled>\n                  Coming Soon\n                </Button>\n              </CardContent>\n            </Card>\n          ))}\n        </motion.div>\n\n        {/* Stay Updated */}\n        <motion.div \n          className=\"mt-12 text-center\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.8, delay: 0.6 }}\n        >\n          <Card className=\"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20\">\n            <CardContent className=\"p-8\">\n              <h3 className=\"text-xl font-bold text-foreground mb-2\">\n                Be the First to Know\n              </h3>\n              <p className=\"text-muted-foreground mb-4\">\n                Get notified when the shop launches with exclusive early access\n              </p>\n              <Button className=\"bg-primary hover:bg-primary/90\">\n                Notify Me\n              </Button>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n      </div>\n    </div>\n  );\n}","size_bytes":12225},"client/src/pages/signup.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Link } from \"wouter\";\nimport { Loader2, Eye, EyeOff, ArrowRight, ArrowLeft, Globe, Crown, Check } from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\n// Country and language mappings\nconst countries = {\n  // North America\n  \"United States\": { language: \"English\", currency: \"USD\", code: \"US\" },\n  \"Canada\": { language: \"English\", currency: \"CAD\", code: \"CA\" },\n  \"Mexico\": { language: \"Spanish\", currency: \"MXN\", code: \"MX\" },\n  \n  // Central America\n  \"Guatemala\": { language: \"Spanish\", currency: \"GTQ\", code: \"GT\" },\n  \"Belize\": { language: \"English\", currency: \"BZD\", code: \"BZ\" },\n  \"El Salvador\": { language: \"Spanish\", currency: \"USD\", code: \"SV\" },\n  \"Honduras\": { language: \"Spanish\", currency: \"HNL\", code: \"HN\" },\n  \"Nicaragua\": { language: \"Spanish\", currency: \"NIO\", code: \"NI\" },\n  \"Costa Rica\": { language: \"Spanish\", currency: \"CRC\", code: \"CR\" },\n  \"Panama\": { language: \"Spanish\", currency: \"PAB\", code: \"PA\" },\n  \n  // South America\n  \"Colombia\": { language: \"Spanish\", currency: \"COP\", code: \"CO\" },\n  \"Venezuela\": { language: \"Spanish\", currency: \"VES\", code: \"VE\" },\n  \"Guyana\": { language: \"English\", currency: \"GYD\", code: \"GY\" },\n  \"Suriname\": { language: \"Dutch\", currency: \"SRD\", code: \"SR\" },\n  \"French Guiana\": { language: \"French\", currency: \"EUR\", code: \"GF\" },\n  \"Brazil\": { language: \"Portuguese\", currency: \"BRL\", code: \"BR\" },\n  \"Ecuador\": { language: \"Spanish\", currency: \"USD\", code: \"EC\" },\n  \"Peru\": { language: \"Spanish\", currency: \"PEN\", code: \"PE\" },\n  \"Bolivia\": { language: \"Spanish\", currency: \"BOB\", code: \"BO\" },\n  \"Paraguay\": { language: \"Spanish\", currency: \"PYG\", code: \"PY\" },\n  \"Chile\": { language: \"Spanish\", currency: \"CLP\", code: \"CL\" },\n  \"Argentina\": { language: \"Spanish\", currency: \"ARS\", code: \"AR\" },\n  \"Uruguay\": { language: \"Spanish\", currency: \"UYU\", code: \"UY\" },\n};\n\nconst languages = [\"English\", \"Spanish\", \"Portuguese\", \"French\", \"Dutch\"];\nconst currencies = [\"USD\", \"CAD\", \"MXN\", \"GTQ\", \"BZD\", \"HNL\", \"NIO\", \"CRC\", \"PAB\", \"COP\", \"VES\", \"GYD\", \"SRD\", \"EUR\", \"BRL\", \"PEN\", \"BOB\", \"PYG\", \"CLP\", \"ARS\", \"UYU\"];\n\n// Translations\nconst translations = {\n  English: {\n    welcome: \"Welcome!\",\n    country: \"What country are you located in?\",\n    language: \"Language\",\n    currency: \"Currency\",\n    next: \"Next\",\n    back: \"Back\",\n    username: \"Choose a username\",\n    usernameDescription: \"3-15 characters, letters, numbers, and underscores only\",\n    usernamePlaceholder: \"Enter your username\",\n    email: \"What's your email address?\",\n    emailPlaceholder: \"Enter your email\",\n    password: \"Create a password\",\n    passwordPlaceholder: \"Enter a secure password\",\n    upgrade: \"Upgrade to Premium?\",\n    upgradeDescription: \"Get premium features for a better trading experience\",\n    upgradeLater: \"Maybe Later\",\n    upgradeNow: \"Upgrade Now\",\n    signUp: \"Create Account\",\n    subtitle: \"Start your paper trading competition journey\"\n  },\n  Spanish: {\n    welcome: \"¡Bienvenido!\",\n    country: \"¿En qué país te encuentras?\",\n    language: \"Idioma\",\n    currency: \"Moneda\",\n    next: \"Siguiente\",\n    back: \"Atrás\",\n    username: \"Elige un nombre de usuario\",\n    usernameDescription: \"3-15 caracteres, letras, números y guiones bajos solamente\",\n    usernamePlaceholder: \"Ingresa tu nombre de usuario\",\n    email: \"¿Cuál es tu dirección de correo?\",\n    emailPlaceholder: \"Ingresa tu correo\",\n    password: \"Crea una contraseña\",\n    passwordPlaceholder: \"Ingresa una contraseña segura\",\n    upgrade: \"¿Actualizar a Premium?\",\n    upgradeDescription: \"Obtén funciones premium para una mejor experiencia\",\n    upgradeLater: \"Tal vez después\",\n    upgradeNow: \"Actualizar ahora\",\n    signUp: \"Crear cuenta\",\n    subtitle: \"Comienza tu viaje de competencias de trading\"\n  },\n  Portuguese: {\n    welcome: \"Bem-vindo!\",\n    country: \"Em que país você está localizado?\",\n    language: \"Idioma\",\n    currency: \"Moeda\",\n    next: \"Próximo\",\n    back: \"Voltar\",\n    username: \"Escolha um nome de usuário\",\n    usernameDescription: \"3-15 caracteres, letras, números e sublinhados apenas\",\n    usernamePlaceholder: \"Digite seu nome de usuário\",\n    email: \"Qual é o seu endereço de email?\",\n    emailPlaceholder: \"Digite seu email\",\n    password: \"Crie uma senha\",\n    passwordPlaceholder: \"Digite uma senha segura\",\n    upgrade: \"Atualizar para Premium?\",\n    upgradeDescription: \"Obtenha recursos premium para uma melhor experiência\",\n    upgradeLater: \"Talvez depois\",\n    upgradeNow: \"Atualizar agora\",\n    signUp: \"Criar conta\",\n    subtitle: \"Comece sua jornada de competições de trading\"\n  }\n};\n\nexport default function Signup() {\n  const [, navigate] = useLocation();\n  const { registerMutation, user } = useAuth();\n  const [step, setStep] = useState(1);\n  const [selectedCountry, setSelectedCountry] = useState(\"\");\n  const [selectedLanguage, setSelectedLanguage] = useState(\"English\");\n  const [selectedCurrency, setSelectedCurrency] = useState(\"USD\");\n  const [username, setUsername] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [wantsPremium, setWantsPremium] = useState(false);\n\n  // Redirect if already logged in\n  if (user) {\n    navigate(\"/dashboard\");\n    return null;\n  }\n\n  // Update language and currency when country changes\n  useEffect(() => {\n    if (selectedCountry && countries[selectedCountry as keyof typeof countries]) {\n      const countryData = countries[selectedCountry as keyof typeof countries];\n      setSelectedLanguage(countryData.language);\n      setSelectedCurrency(countryData.currency);\n    }\n  }, [selectedCountry]);\n\n  const t = translations[selectedLanguage as keyof typeof translations] || translations.English;\n\n  const handleNext = () => {\n    if (step < 6) setStep(step + 1);\n  };\n\n  const handleBack = () => {\n    if (step > 1) setStep(step - 1);\n  };\n\n  const handleSubmit = () => {\n    registerMutation.mutate({ \n      email, \n      password, \n      username,\n      country: selectedCountry,\n      language: selectedLanguage,\n      currency: selectedCurrency,\n      wantsPremium \n    }, {\n      onSuccess: () => {\n        navigate(\"/dashboard\");\n      }\n    });\n  };\n\n  const renderStep = () => {\n    switch (step) {\n      case 1:\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center space-y-2\">\n              <h1 className=\"text-4xl font-bold\">\n                <span className=\"text-blue-500\">Welcome!</span>{\" \"}\n                <span className=\"text-green-500\">Bem-vindo!</span>{\" \"}\n                <span className=\"text-red-500\">¡Bienvenido!</span>\n              </h1>\n              <div className=\"w-16 h-1 bg-gradient-to-r from-blue-500 via-green-500 to-red-500 mx-auto rounded-full\"></div>\n            </div>\n\n            <div className=\"space-y-4\">\n              <Label className=\"text-lg font-medium\">{t.country}</Label>\n              <Select value={selectedCountry} onValueChange={setSelectedCountry}>\n                <SelectTrigger className=\"w-full h-12\">\n                  <SelectValue placeholder=\"Select your country\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">North America</div>\n                  {Object.keys(countries).slice(0, 3).map((country) => (\n                    <SelectItem key={country} value={country}>{country}</SelectItem>\n                  ))}\n                  <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">Central America</div>\n                  {Object.keys(countries).slice(3, 10).map((country) => (\n                    <SelectItem key={country} value={country}>{country}</SelectItem>\n                  ))}\n                  <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">South America</div>\n                  {Object.keys(countries).slice(10).map((country) => (\n                    <SelectItem key={country} value={country}>{country}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-sm font-medium\">{t.language}</Label>\n                  <Select value={selectedLanguage} onValueChange={setSelectedLanguage}>\n                    <SelectTrigger className=\"h-12\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {languages.map((lang) => (\n                        <SelectItem key={lang} value={lang}>{lang}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium\">{t.currency}</Label>\n                  <Select value={selectedCurrency} onValueChange={setSelectedCurrency}>\n                    <SelectTrigger className=\"h-12\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {currencies.map((curr) => (\n                        <SelectItem key={curr} value={curr}>{curr}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </div>\n          </div>\n        );\n\n      case 2:\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h2 className=\"text-2xl font-bold\">{t.username}</h2>\n              <p className=\"text-sm text-muted-foreground mt-2\">{t.usernameDescription}</p>\n            </div>\n            <div>\n              <Input\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                placeholder={t.usernamePlaceholder}\n                className=\"h-12 text-center\"\n                pattern=\"[a-zA-Z0-9_]{3,15}\"\n                maxLength={15}\n              />\n            </div>\n          </div>\n        );\n\n      case 3:\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h2 className=\"text-2xl font-bold\">{t.email}</h2>\n            </div>\n            <div>\n              <Input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                placeholder={t.emailPlaceholder}\n                className=\"h-12 text-center\"\n              />\n            </div>\n          </div>\n        );\n\n      case 4:\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <h2 className=\"text-2xl font-bold\">{t.password}</h2>\n            </div>\n            <div className=\"relative\">\n              <Input\n                type={showPassword ? \"text\" : \"password\"}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder={t.passwordPlaceholder}\n                className=\"h-12 text-center pr-12\"\n              />\n              <button\n                type=\"button\"\n                className=\"absolute inset-y-0 right-0 pr-3 flex items-center\"\n                onClick={() => setShowPassword(!showPassword)}\n              >\n                {showPassword ? (\n                  <EyeOff className=\"h-5 w-5 text-muted-foreground\" />\n                ) : (\n                  <Eye className=\"h-5 w-5 text-muted-foreground\" />\n                )}\n              </button>\n            </div>\n          </div>\n        );\n\n      case 5:\n        return (\n          <div className=\"space-y-6\">\n            <div className=\"text-center\">\n              <Crown className=\"w-16 h-16 mx-auto text-yellow-500 mb-4\" />\n              <h2 className=\"text-2xl font-bold\">{t.upgrade}</h2>\n              <p className=\"text-muted-foreground mt-2\">{t.upgradeDescription}</p>\n            </div>\n            \n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setWantsPremium(false);\n                    handleSubmit();\n                  }}\n                  className=\"h-12\"\n                  disabled={registerMutation.isPending}\n                >\n                  {t.upgradeLater}\n                </Button>\n                <Button\n                  onClick={() => {\n                    setWantsPremium(true);\n                    handleSubmit();\n                  }}\n                  className=\"h-12 bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600\"\n                  disabled={registerMutation.isPending}\n                >\n                  <Crown className=\"w-4 h-4 mr-2\" />\n                  {registerMutation.isPending ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    t.upgradeNow\n                  )}\n                </Button>\n              </div>\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  const canProceed = () => {\n    switch (step) {\n      case 1: return selectedCountry !== \"\";\n      case 2: return username !== \"\" && username.length >= 3 && username.length <= 15 && /^[a-zA-Z0-9_]+$/.test(username);\n      case 3: return email !== \"\";\n      case 4: return password !== \"\";\n      default: return true;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background py-12 px-4\">\n      <div className=\"max-w-lg w-full\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"w-12 h-12 bg-primary rounded-lg flex items-center justify-center\">\n              <span className=\"text-primary-foreground font-bold text-xl\">O</span>\n            </div>\n          </div>\n          <h1 className=\"text-2xl font-bold text-foreground\">Join ORSATH</h1>\n          <p className=\"text-muted-foreground mt-1\">{t.subtitle}</p>\n        </div>\n\n        {/* Progress Bar */}\n        <div className=\"mb-8\">\n          <div className=\"flex justify-between items-center mb-2\">\n            <span className=\"text-sm text-muted-foreground\">Step {step} of 5</span>\n            <span className=\"text-sm text-muted-foreground\">{Math.round((step / 5) * 100)}%</span>\n          </div>\n          <div className=\"w-full bg-muted rounded-full h-2\">\n            <motion.div\n              className=\"bg-primary h-2 rounded-full\"\n              initial={{ width: \"20%\" }}\n              animate={{ width: `${(step / 5) * 100}%` }}\n              transition={{ duration: 0.3 }}\n            />\n          </div>\n        </div>\n\n        {/* Main Card */}\n        <Card className=\"border-2 shadow-lg\">\n          <CardContent className=\"p-8\">\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={step}\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                transition={{ duration: 0.3 }}\n              >\n                {renderStep()}\n              </motion.div>\n            </AnimatePresence>\n\n            {/* Navigation Buttons */}\n            <div className=\"flex justify-between mt-8\">\n              <Button\n                variant=\"outline\"\n                onClick={handleBack}\n                disabled={step === 1}\n                className=\"flex items-center\"\n              >\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                {t.back}\n              </Button>\n\n              {step < 5 && (\n                <Button\n                  onClick={handleNext}\n                  disabled={!canProceed()}\n                  className=\"flex items-center\"\n                >\n                  {t.next}\n                  <ArrowRight className=\"w-4 h-4 ml-2\" />\n                </Button>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Sign In Link */}\n        <div className=\"text-center mt-6\">\n          <p className=\"text-sm text-muted-foreground\">\n            Already have an account?{\" \"}\n            <Link href=\"/login\" className=\"text-primary hover:underline\">\n              Sign in\n            </Link>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":16958},"client/src/pages/studies.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Study } from \"@shared/schema\";\nimport { TrendingUp, Search, Newspaper, ArrowRight } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useState } from \"react\";\n\nexport default function Studies() {\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"all\");\n  \n  const { data: studies, isLoading } = useQuery<Study[]>({\n    queryKey: [\"/api/studies\"],\n  });\n\n  const categories = [\n    { id: \"all\", label: \"All Studies\", icon: TrendingUp },\n    { id: \"Case Study\", label: \"Case Studies\", icon: Search },\n    { id: \"Analysis\", label: \"Analysis\", icon: Newspaper },\n    { id: \"Research\", label: \"Research\", icon: Search },\n  ];\n\n  const filteredStudies = studies?.filter(study => \n    selectedCategory === \"all\" || study.category === selectedCategory\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <section className=\"py-16 bg-white\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto text-center\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <h1 className=\"text-5xl font-bold text-black mb-6\">Research Studies</h1>\n              <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n                In-depth analysis and case studies from our research team. Discover the qualitative insights that drive investment decisions.\n              </p>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Categories */}\n      <section className=\"py-8 bg-white border-b\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <div className=\"flex flex-wrap gap-4 justify-center\">\n              {categories.map((category) => (\n                <Button\n                  key={category.id}\n                  variant={selectedCategory === category.id ? \"default\" : \"outline\"}\n                  onClick={() => setSelectedCategory(category.id)}\n                  className=\"flex items-center space-x-2\"\n                >\n                  <category.icon className=\"w-4 h-4\" />\n                  <span>{category.label}</span>\n                </Button>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Studies Grid */}\n      <section className=\"py-16\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            {isLoading ? (\n              <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n                {Array.from({ length: 6 }).map((_, i) => (\n                  <Card key={i} className=\"animate-pulse\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"h-4 bg-gray-200 rounded mb-4\"></div>\n                      <div className=\"h-6 bg-gray-200 rounded mb-3\"></div>\n                      <div className=\"h-20 bg-gray-200 rounded mb-4\"></div>\n                      <div className=\"h-4 bg-gray-200 rounded\"></div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : filteredStudies && filteredStudies.length > 0 ? (\n              <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n                {filteredStudies.map((study, index) => (\n                  <motion.div\n                    key={study.id}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ duration: 0.6, delay: index * 0.1 }}\n                  >\n                    <Card className=\"h-full hover:shadow-lg transition-all duration-300 hover:-translate-y-2\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-center mb-4\">\n                          <TrendingUp className=\"text-black mr-3 w-5 h-5\" />\n                          <span className=\"text-sm text-gray-500\">{study.category}</span>\n                        </div>\n                        <h3 className=\"text-xl font-bold text-black mb-3\">{study.title}</h3>\n                        <p className=\"text-gray-600 mb-4 flex-1\">{study.description}</p>\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"text-sm text-gray-500\">\n                            {new Date(study.publishedAt!).toLocaleDateString()}\n                          </span>\n                          <Button variant=\"ghost\" size=\"sm\" className=\"hover:text-black\">\n                            <ArrowRight className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-16\">\n                <div className=\"max-w-md mx-auto\">\n                  <Search className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                  <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No Studies Found</h3>\n                  <p className=\"text-gray-600 mb-6\">\n                    {selectedCategory === \"all\" \n                      ? \"No studies are available at the moment. Check back later for new research.\"\n                      : `No studies found in the ${selectedCategory} category.`\n                    }\n                  </p>\n                  <Button \n                    variant=\"outline\" \n                    onClick={() => setSelectedCategory(\"all\")}\n                    className=\"mx-auto\"\n                  >\n                    View All Studies\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-16 bg-white\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n              viewport={{ once: true }}\n            >\n              <h2 className=\"text-3xl font-bold text-black mb-4\">\n                Want to Access Premium Research?\n              </h2>\n              <p className=\"text-xl text-gray-600 mb-8\">\n                Join our platform to get access to exclusive research studies and detailed analysis reports.\n              </p>\n              <Button \n                size=\"lg\" \n                className=\"bg-black text-white hover:bg-gray-800\"\n                onClick={() => window.location.href = \"/api/login\"}\n              >\n                Get Access Now\n              </Button>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","size_bytes":7085},"client/src/pages/terms.tsx":{"content":"import { motion } from \"framer-motion\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\nexport default function Terms() {\n  return (\n    <div className=\"min-h-screen bg-white\">\n      <motion.div \n        className=\"max-w-4xl mx-auto py-20 px-4\"\n        initial=\"initial\"\n        animate=\"animate\"\n        variants={staggerChildren}\n      >\n        <motion.h1 \n          className=\"text-4xl md:text-5xl font-bold mb-8 text-black\"\n          variants={fadeInUp}\n        >\n          Terms of Service\n        </motion.h1>\n        \n        <motion.div className=\"prose prose-lg max-w-none\" variants={fadeInUp}>\n          <p className=\"text-gray-600 mb-8\">\n            <strong>Last updated:</strong> {new Date().toLocaleDateString()}\n          </p>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">1. Agreement to Terms</h2>\n            <p className=\"text-gray-700 mb-4\">\n              By accessing and using ORSATH services, you agree to be bound by these Terms of Service and all applicable laws and regulations. If you do not agree with any of these terms, you are prohibited from using our services.\n            </p>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">2. Service Description</h2>\n            <p className=\"text-gray-700 mb-4\">\n              ORSATH provides qualitative investment research services including but not limited to:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Investment analysis and research reports</li>\n              <li>Market news and insights</li>\n              <li>Portfolio tracking and analytics</li>\n              <li>Custom research services</li>\n              <li>Educational content and resources</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">3. User Accounts</h2>\n            <p className=\"text-gray-700 mb-4\">\n              To access certain features of our service, you must create an account. You are responsible for:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Maintaining the confidentiality of your account credentials</li>\n              <li>All activities that occur under your account</li>\n              <li>Notifying us immediately of any unauthorized use</li>\n              <li>Providing accurate and complete information</li>\n              <li>Updating your information as necessary</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">4. Subscription and Payment</h2>\n            <p className=\"text-gray-700 mb-4\">\n              Our services are offered on a subscription basis. By subscribing, you agree to:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Pay all charges and fees associated with your subscription</li>\n              <li>Automatic renewal unless cancelled before the renewal date</li>\n              <li>Current pricing and billing terms as displayed on our website</li>\n              <li>No refunds for partial months or unused portions of your subscription</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">5. Investment Disclaimer</h2>\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4\">\n              <p className=\"text-gray-700 font-semibold\">\n                IMPORTANT: Our research and analysis are for informational purposes only and should not be considered as investment advice.\n              </p>\n            </div>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Past performance does not guarantee future results</li>\n              <li>All investments carry inherent risks</li>\n              <li>You should consult with a qualified financial advisor before making investment decisions</li>\n              <li>We are not responsible for any investment losses</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">6. Intellectual Property</h2>\n            <p className=\"text-gray-700 mb-4\">\n              All content, research, and materials provided through our service are protected by intellectual property laws. You may not:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Reproduce, distribute, or display our content without permission</li>\n              <li>Use our research for commercial purposes beyond your subscription</li>\n              <li>Reverse engineer or attempt to extract data from our platform</li>\n              <li>Share your account credentials with others</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">7. Prohibited Uses</h2>\n            <p className=\"text-gray-700 mb-4\">\n              You agree not to use our service for any unlawful purpose or in any way that could harm our business or other users:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Violating any applicable laws or regulations</li>\n              <li>Transmitting harmful or malicious code</li>\n              <li>Attempting to gain unauthorized access to our systems</li>\n              <li>Harassing or threatening other users</li>\n              <li>Interfering with the proper functioning of our service</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">8. Limitation of Liability</h2>\n            <p className=\"text-gray-700 mb-4\">\n              To the maximum extent permitted by law, ORSATH shall not be liable for any indirect, incidental, special, consequential, or punitive damages, including but not limited to:\n            </p>\n            <ul className=\"list-disc list-inside space-y-2 text-gray-700\">\n              <li>Investment losses or missed opportunities</li>\n              <li>Loss of profits or business interruption</li>\n              <li>Data loss or corruption</li>\n              <li>Service downtime or technical issues</li>\n            </ul>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">9. Termination</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We may terminate or suspend your account immediately, without prior notice, for any reason including but not limited to breach of these Terms of Service.\n            </p>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">10. Changes to Terms</h2>\n            <p className=\"text-gray-700 mb-4\">\n              We reserve the right to modify these terms at any time. We will notify users of any material changes via email or through our platform. Continued use of our service after changes constitutes acceptance of the new terms.\n            </p>\n          </section>\n\n          <section className=\"mb-8\">\n            <h2 className=\"text-2xl font-bold mb-4 text-black\">11. Contact Information</h2>\n            <p className=\"text-gray-700\">\n              For questions about these Terms of Service, please contact us at:\n            </p>\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n              <p className=\"text-gray-700\">\n                <strong>Email:</strong> legal@orsath.com<br />\n                <strong>Phone:</strong> +1 (555) 123-4567<br />\n                <strong>Address:</strong> 123 Finance Street, New York, NY 10001\n              </p>\n            </div>\n          </section>\n        </motion.div>\n      </motion.div>\n    </div>\n  );\n}","size_bytes":8246},"client/src/pages/tournaments.tsx":{"content":"import React, { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { \n  Trophy, \n  Users, \n  Clock, \n  DollarSign, \n  Plus, \n  Search,\n  Eye,\n  EyeOff,\n  Calendar,\n  TrendingUp,\n  Bitcoin,\n  Building,\n  Filter,\n  SortAsc,\n  SortDesc,\n  Timer,\n  Target,\n  Shield,\n  Lock,\n  Globe,\n  Crown,\n  MessageSquare\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { TournamentManagementDialog } from \"@/components/tournaments/TournamentManagementDialog\";\nimport { BuyInIncentiveBox } from \"@/components/ui/buy-in-incentive-box\";\nimport { MarketStatus } from \"@/components/market-status\";\nimport { TournamentCreationDialog } from \"@/components/tournaments/TournamentCreationDialog\";\nimport { TournamentLeaderboardDialog } from \"@/components/tournaments/TournamentLeaderboardDialog\";\nimport { MarketStatusDisclaimer } from \"@/components/MarketStatusDisclaimer\";\nimport { ChatSystem } from \"@/components/chat/ChatSystem\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.3 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\n\n\n// Duration options for tournament creation\nconst DURATION_OPTIONS = [\n  { value: \"1 minute\", label: \"1 Minute\", ms: 60 * 1000 },\n  { value: \"5 minutes\", label: \"5 Minutes\", ms: 5 * 60 * 1000 },\n  { value: \"15 minutes\", label: \"15 Minutes\", ms: 15 * 60 * 1000 },\n  { value: \"30 minutes\", label: \"30 Minutes\", ms: 30 * 60 * 1000 },\n  { value: \"1 hour\", label: \"1 Hour\", ms: 60 * 60 * 1000 },\n  { value: \"2 hours\", label: \"2 Hours\", ms: 2 * 60 * 60 * 1000 },\n  { value: \"6 hours\", label: \"6 Hours\", ms: 6 * 60 * 60 * 1000 },\n  { value: \"12 hours\", label: \"12 Hours\", ms: 12 * 60 * 60 * 1000 },\n  { value: \"1 day\", label: \"1 Day\", ms: 24 * 60 * 60 * 1000 },\n  { value: \"3 days\", label: \"3 Days\", ms: 3 * 24 * 60 * 60 * 1000 },\n  { value: \"1 week\", label: \"1 Week\", ms: 7 * 24 * 60 * 60 * 1000 },\n  { value: \"2 weeks\", label: \"2 Weeks\", ms: 14 * 24 * 60 * 60 * 1000 },\n  { value: \"4 weeks\", label: \"4 Weeks\", ms: 28 * 24 * 60 * 60 * 1000 }\n];\n\n// Start delay options (minimum 5 minutes)\nconst START_DELAY_OPTIONS = [\n  { value: \"5 minutes\", label: \"5 Minutes\", ms: 5 * 60 * 1000 },\n  { value: \"15 minutes\", label: \"15 Minutes\", ms: 15 * 60 * 1000 },\n  { value: \"30 minutes\", label: \"30 Minutes\", ms: 30 * 60 * 1000 },\n  { value: \"1 hour\", label: \"1 Hour\", ms: 60 * 60 * 1000 },\n  { value: \"2 hours\", label: \"2 Hours\", ms: 2 * 60 * 60 * 1000 },\n  { value: \"6 hours\", label: \"6 Hours\", ms: 6 * 60 * 60 * 1000 },\n  { value: \"12 hours\", label: \"12 Hours\", ms: 12 * 60 * 60 * 1000 },\n  { value: \"1 day\", label: \"1 Day\", ms: 24 * 60 * 60 * 1000 },\n  { value: \"3 days\", label: \"3 Days\", ms: 3 * 24 * 60 * 60 * 1000 },\n  { value: \"1 week\", label: \"1 Week\", ms: 7 * 24 * 60 * 60 * 1000 }\n];\n\nexport default function TournamentsPage() {\n  const { user } = useAuth();\n  const { formatCurrency, t } = useUserPreferences();\n  const { toast } = useToast();\n\n  // State management\n  const [activeTab, setActiveTab] = useState(\"upcoming\");\n  const [createDialogOpen, setCreateDialogOpen] = useState(false);\n  const [joinCodeDialogOpen, setJoinCodeDialogOpen] = useState(false);\n  const [managementDialogOpen, setManagementDialogOpen] = useState(false);\n  const [selectedTournament, setSelectedTournament] = useState<any>(null);\n  const [joinCode, setJoinCode] = useState(\"\");\n  const [sortBy, setSortBy] = useState(\"starting-soon\");\n  const [filterType, setFilterType] = useState(\"all\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [tournamentChatOpen, setTournamentChatOpen] = useState<number | null>(null);\n\n  // State for join confirmation dialog\n  const [joinConfirmationOpen, setJoinConfirmationOpen] = useState(false);\n  const [tournamentToJoin, setTournamentToJoin] = useState<any>(null);\n  const [agreementChecked, setAgreementChecked] = useState(false);\n\n  // State for leaderboard dialog\n  const [leaderboardDialogOpen, setLeaderboardDialogOpen] = useState(false);\n  const [selectedLeaderboardTournament, setSelectedLeaderboardTournament] = useState<any>(null);\n\n  // Tournament creation is now handled by TournamentCreationDialog component\n\n  // Fetch public tournaments\n  const { data: publicTournaments, isLoading: publicLoading } = useQuery<{data: any[]}>({\n    queryKey: ['/api/tournaments/public'],\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  // Fetch user's tournaments (includes private tournaments they created/joined)\n  const { data: userTournaments, isLoading: userLoading } = useQuery<{data: any[]}>({\n    queryKey: ['/api/tournaments'],\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  const tournamentsLoading = publicLoading || userLoading;\n\n  // Join tournament by code mutation\n  const joinByCodeMutation = useMutation({\n    mutationFn: async (code: string) => {\n      const res = await apiRequest(\"POST\", `/api/tournaments/code/${code}/join`, {});\n      return res.json();\n    },\n    onSuccess: () => {\n      setJoinCodeDialogOpen(false);\n      setJoinCode(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments/public\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      toast({\n        title: \"Success\",\n        description: \"Successfully joined tournament!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Join tournament by ID mutation\n  const joinTournamentMutation = useMutation({\n    mutationFn: async (tournamentId: number) => {\n      const res = await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/join`, {});\n      return res.json();\n    },\n    onSuccess: () => {\n      setJoinConfirmationOpen(false);\n      setTournamentToJoin(null);\n      setAgreementChecked(false);\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments/public\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      toast({\n        title: \"Success\",\n        description: \"Successfully joined tournament!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Function to handle join tournament button click\n  const handleJoinTournament = (tournament: any) => {\n    setTournamentToJoin(tournament);\n    setJoinConfirmationOpen(true);\n    setAgreementChecked(false);\n  };\n\n  // Function to confirm join tournament\n  const confirmJoinTournament = () => {\n    if (tournamentToJoin && agreementChecked) {\n      joinTournamentMutation.mutate(tournamentToJoin.id);\n    }\n  };\n\n  // Tournament creation is now handled by TournamentCreationDialog component\n\n  // Combine public tournaments and user's tournaments, removing duplicates\n  const allTournaments = React.useMemo(() => {\n    const publicList = publicTournaments?.data || [];\n    const userList = userTournaments?.data || [];\n    \n    // Create a Map to avoid duplicates (user tournaments take priority)\n    const tournamentMap = new Map();\n    \n    // Add public tournaments first\n    publicList.forEach(tournament => {\n      tournamentMap.set(tournament.id, tournament);\n    });\n    \n    // Add user tournaments ONLY if they are:\n    // 1. Public tournaments (to update with participation info), OR\n    // 2. Private tournaments where user is participating (creator or participant)\n    userList.forEach(tournament => {\n      const isUserParticipating = tournament.creatorId === user?.id || tournament.isParticipating;\n      \n      if (tournament.isPublic || isUserParticipating) {\n        tournamentMap.set(tournament.id, tournament);\n      }\n    });\n    \n    return Array.from(tournamentMap.values());\n  }, [publicTournaments, userTournaments, user?.id]);\n\n  // Filter and sort tournaments\n  const processedTournaments = {\n    upcoming: allTournaments.filter((t: any) => \n      t.status === \"waiting\" && \n      (filterType === \"all\" || t.tournamentType === filterType) &&\n      (searchQuery === \"\" || t.name.toLowerCase().includes(searchQuery.toLowerCase()))\n    ),\n    ongoing: allTournaments.filter((t: any) => \n      t.status === \"active\" && \n      (filterType === \"all\" || t.tournamentType === filterType) &&\n      (searchQuery === \"\" || t.name.toLowerCase().includes(searchQuery.toLowerCase()))\n    )\n  };\n\n  // Sort tournaments (prioritize participated tournaments first)\n  const sortTournaments = (tournaments: any[]) => {\n    return [...tournaments].sort((a, b) => {\n      // Check if user is participating in each tournament\n      const aIsParticipating = a.creatorId === user?.id || a.isParticipating;\n      const bIsParticipating = b.creatorId === user?.id || b.isParticipating;\n      \n      // Prioritize tournaments user is participating in\n      if (aIsParticipating && !bIsParticipating) return -1;\n      if (!aIsParticipating && bIsParticipating) return 1;\n      \n      // Within participated tournaments, prioritize owned tournaments\n      if (aIsParticipating && bIsParticipating) {\n        const aIsOwner = a.creatorId === user?.id;\n        const bIsOwner = b.creatorId === user?.id;\n        \n        if (aIsOwner && !bIsOwner) return -1;\n        if (!aIsOwner && bIsOwner) return 1;\n      }\n      \n      // Then sort by the selected criteria\n      switch (sortBy) {\n        case \"starting-soon\":\n          return new Date(a.scheduledStartTime || a.createdAt).getTime() - new Date(b.scheduledStartTime || b.createdAt).getTime();\n        case \"pot-high-low\":\n          return (b.currentPlayers * b.buyInAmount) - (a.currentPlayers * a.buyInAmount);\n        case \"pot-low-high\":\n          return (a.currentPlayers * a.buyInAmount) - (b.currentPlayers * b.buyInAmount);\n        case \"most-recent\":\n          return new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime();\n        default:\n          return 0;\n      }\n    });\n  };\n\n  const sortedUpcoming = sortTournaments(processedTournaments.upcoming);\n  const sortedOngoing = sortTournaments(processedTournaments.ongoing);\n\n  if (!user) {\n    return (\n      <div className=\"h-[calc(100vh-4rem)] flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-foreground mb-2\">Please Log In</h2>\n          <p className=\"text-muted-foreground\">You need to be logged in to view tournaments.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-[calc(100vh-4rem)] overflow-auto\">\n      <div className=\"container mx-auto p-6 max-w-7xl\">\n        <motion.div\n          initial=\"initial\"\n          animate=\"animate\"\n          variants={staggerChildren}\n          className=\"space-y-6\"\n        >\n          {/* Market Status Disclaimer */}\n          <MarketStatusDisclaimer />\n\n          {/* Header */}\n          <motion.div variants={fadeInUp} className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-foreground mb-2\">Tournaments</h1>\n              <p className=\"text-muted-foreground\">Join competitions and test your trading skills</p>\n            </div>\n            <div className=\"flex items-center space-x-3\">\n              <Dialog open={joinCodeDialogOpen} onOpenChange={setJoinCodeDialogOpen}>\n                <DialogTrigger asChild>\n                  <Button variant=\"outline\">\n                    <Lock className=\"w-4 h-4 mr-2\" />\n                    Join Private\n                  </Button>\n                </DialogTrigger>\n                <DialogContent>\n                  <DialogHeader>\n                    <DialogTitle>Join Private Tournament</DialogTitle>\n                  </DialogHeader>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <Label htmlFor=\"join-code\">Tournament Code</Label>\n                      <Input\n                        id=\"join-code\"\n                        value={joinCode}\n                        onChange={(e) => setJoinCode(e.target.value.toUpperCase())}\n                        placeholder=\"Enter 8-character code\"\n                        maxLength={8}\n                      />\n                    </div>\n                    <Button \n                      onClick={() => joinByCodeMutation.mutate(joinCode)}\n                      disabled={joinCode.length !== 8 || joinByCodeMutation.isPending}\n                      className=\"w-full\"\n                    >\n                      {joinByCodeMutation.isPending ? \"Joining...\" : \"Join Tournament\"}\n                    </Button>\n                  </div>\n                </DialogContent>\n              </Dialog>\n\n              <TournamentCreationDialog \n                isOpen={createDialogOpen} \n                onClose={() => setCreateDialogOpen(false)} \n              />\n              <Button onClick={() => setCreateDialogOpen(true)}>\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Create Tournament\n              </Button>\n            </div>\n          </motion.div>\n\n          {/* Search and Filter Controls */}\n          <motion.div variants={fadeInUp} className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"relative\">\n                <Search className=\"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground\" />\n                <Input\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  placeholder=\"Search tournaments...\"\n                  className=\"pl-9 w-64\"\n                />\n              </div>\n              <Select value={filterType} onValueChange={setFilterType}>\n                <SelectTrigger className=\"w-40\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Types</SelectItem>\n                  <SelectItem value=\"stocks\">Stocks Only</SelectItem>\n                  <SelectItem value=\"crypto\">Crypto Only</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <Select value={sortBy} onValueChange={setSortBy}>\n              <SelectTrigger className=\"w-48\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"starting-soon\">Starting Soonest</SelectItem>\n                <SelectItem value=\"pot-high-low\">Highest Pot</SelectItem>\n                <SelectItem value=\"pot-low-high\">Lowest Pot</SelectItem>\n                <SelectItem value=\"most-recent\">Most Recent</SelectItem>\n              </SelectContent>\n            </Select>\n          </motion.div>\n\n          {/* Tournament Tabs */}\n          <motion.div variants={fadeInUp}>\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"upcoming\" className=\"flex items-center space-x-2\">\n                  <Timer className=\"w-4 h-4\" />\n                  <span>Upcoming Tournaments ({sortedUpcoming.length})</span>\n                </TabsTrigger>\n                <TabsTrigger value=\"ongoing\" className=\"flex items-center space-x-2\">\n                  <Trophy className=\"w-4 h-4\" />\n                  <span>Ongoing Tournaments ({sortedOngoing.length})</span>\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"upcoming\" className=\"mt-6\">\n                <TournamentGrid \n                  tournaments={sortedUpcoming} \n                  type=\"upcoming\" \n                  onManage={(tournament) => {\n                    setSelectedTournament(tournament);\n                    setManagementDialogOpen(true);\n                  }}\n                  onOpenChat={(tournamentId) => setTournamentChatOpen(tournamentId)}\n                  onJoinTournament={handleJoinTournament}\n                  isJoining={joinTournamentMutation.isPending}\n                />\n              </TabsContent>\n\n              <TabsContent value=\"ongoing\" className=\"mt-6\">\n                <TournamentGrid \n                  tournaments={sortedOngoing} \n                  type=\"ongoing\" \n                  onManage={(tournament) => {\n                    setSelectedTournament(tournament);\n                    setManagementDialogOpen(true);\n                  }}\n                  onOpenChat={(tournamentId) => setTournamentChatOpen(tournamentId)}\n                  onJoinTournament={handleJoinTournament}\n                  onViewLeaderboard={(tournament) => {\n                    setSelectedLeaderboardTournament(tournament);\n                    setLeaderboardDialogOpen(true);\n                  }}\n                  isJoining={joinTournamentMutation.isPending}\n                />\n              </TabsContent>\n            </Tabs>\n          </motion.div>\n        </motion.div>\n      </div>\n\n      {/* Tournament Management Dialog */}\n      {selectedTournament && (\n        <TournamentManagementDialog\n          tournament={selectedTournament}\n          isOpen={managementDialogOpen}\n          onClose={() => {\n            setManagementDialogOpen(false);\n            setSelectedTournament(null);\n          }}\n        />\n      )}\n\n      {/* Tournament-specific Chat System */}\n      {tournamentChatOpen && (\n        <ChatSystem\n          tournamentId={tournamentChatOpen}\n          isOpen={true}\n          onToggle={() => setTournamentChatOpen(null)}\n        />\n      )}\n\n      {/* Tournament Leaderboard Dialog */}\n      {selectedLeaderboardTournament && (\n        <TournamentLeaderboardDialog\n          tournament={selectedLeaderboardTournament}\n          isOpen={leaderboardDialogOpen}\n          onClose={() => {\n            setLeaderboardDialogOpen(false);\n            setSelectedLeaderboardTournament(null);\n          }}\n        />\n      )}\n\n      {/* Join Tournament Confirmation Dialog */}\n      <Dialog open={joinConfirmationOpen} onOpenChange={setJoinConfirmationOpen}>\n        <DialogContent className=\"sm:max-w-[500px]\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center space-x-2\">\n              <Trophy className=\"w-5 h-5\" />\n              <span>Join Tournament</span>\n            </DialogTitle>\n          </DialogHeader>\n          \n          {tournamentToJoin && (\n            <div className=\"space-y-6\">\n              {/* Tournament Basic Info */}\n              <div className=\"space-y-4\">\n                <div className=\"text-center p-4 bg-muted/30 rounded-lg\">\n                  <h3 className=\"text-lg font-bold\">{tournamentToJoin.name}</h3>\n                  <p className=\"text-muted-foreground text-sm\">\n                    {tournamentToJoin.tournamentType === \"crypto\" ? \"Cryptocurrency\" : \"Stock Market\"} Tournament\n                  </p>\n                </div>\n\n                {/* Tournament Details */}\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Players:</span>\n                      <span>{tournamentToJoin.currentPlayers}/{tournamentToJoin.maxPlayers}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Duration:</span>\n                      <span>{tournamentToJoin.timeframe}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Starting Balance:</span>\n                      <span>{formatCurrency(tournamentToJoin.startingBalance)}</span>\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Status:</span>\n                      <Badge variant={tournamentToJoin.isPublic ? \"secondary\" : \"outline\"}>\n                        {tournamentToJoin.isPublic ? \"Public\" : \"Private\"}\n                      </Badge>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Buy-in:</span>\n                      <span className=\"font-medium\">\n                        {tournamentToJoin.buyInAmount > 0 ? formatCurrency(tournamentToJoin.buyInAmount) : \"Free\"}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Prize Pool:</span>\n                      <span className=\"font-bold text-green-600\">\n                        {formatCurrency(tournamentToJoin.currentPot || (tournamentToJoin.buyInAmount * tournamentToJoin.currentPlayers))}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Tournament Type Specific Information */}\n              <div className=\"p-4 bg-blue-50 dark:bg-blue-950/30 rounded-lg\">\n                <h4 className=\"font-medium mb-2 text-blue-800 dark:text-blue-200\">Tournament Rules</h4>\n                <ul className=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\n                  {tournamentToJoin.isPublic ? (\n                    <>\n                      <li>• Public tournaments cannot be cancelled early</li>\n                      <li>• Tournament will run for the full duration</li>\n                      <li>• All participants compete fairly until the end</li>\n                    </>\n                  ) : (\n                    <>\n                      <li>• Private tournaments can be cancelled by the creator</li>\n                      <li>• Creator has full control over tournament settings</li>\n                      <li>• Participants may be removed at creator's discretion</li>\n                    </>\n                  )}\n                  <li>• Virtual trading only - no real money at risk</li>\n                  <li>• Rankings based on portfolio performance</li>\n                </ul>\n              </div>\n\n              {/* Buy-in Confirmation */}\n              {tournamentToJoin.buyInAmount > 0 && (\n                <div className=\"p-4 bg-yellow-50 dark:bg-yellow-950/30 rounded-lg\">\n                  <h4 className=\"font-medium mb-2 text-yellow-800 dark:text-yellow-200\">Entry Fee Required</h4>\n                  <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                    This tournament requires a buy-in of <strong>{formatCurrency(tournamentToJoin.buyInAmount)}</strong>.\n                    This fee contributes to the tournament prize pool.\n                  </p>\n                </div>\n              )}\n\n              {/* Agreement Checkbox */}\n              <div className=\"flex items-start space-x-3 p-4 border rounded-lg\">\n                <Checkbox \n                  id=\"tournament-agreement\" \n                  checked={agreementChecked}\n                  onCheckedChange={(checked) => setAgreementChecked(checked === true)}\n                />\n                <div>\n                  <label htmlFor=\"tournament-agreement\" className=\"text-sm font-medium cursor-pointer\">\n                    I agree to the tournament terms and conditions\n                  </label>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    By joining, you agree to participate fairly and follow tournament rules.\n                    {tournamentToJoin.buyInAmount > 0 && \" Entry fee will be charged upon confirmation.\"}\n                  </p>\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex space-x-3\">\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setJoinConfirmationOpen(false);\n                    setTournamentToJoin(null);\n                    setAgreementChecked(false);\n                  }}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  className=\"flex-1\"\n                  onClick={confirmJoinTournament}\n                  disabled={!agreementChecked || joinTournamentMutation.isPending}\n                >\n                  {joinTournamentMutation.isPending ? \"Joining...\" : \n                   tournamentToJoin.buyInAmount > 0 ? `Join - ${formatCurrency(tournamentToJoin.buyInAmount)}` : \"Join Free\"\n                  }\n                </Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n\n// Tournament Grid Component\nfunction TournamentGrid({ \n  tournaments, \n  type, \n  onManage,\n  onOpenChat,\n  onJoinTournament,\n  onViewLeaderboard,\n  isJoining\n}: { \n  tournaments: any[], \n  type: \"upcoming\" | \"ongoing\",\n  onManage: (tournament: any) => void,\n  onOpenChat: (tournamentId: number) => void,\n  onJoinTournament: (tournament: any) => void,\n  onViewLeaderboard?: (tournament: any) => void,\n  isJoining: boolean\n}) {\n\n  if (tournaments.length === 0) {\n    return (\n      <div className=\"text-center py-12\">\n        <Trophy className=\"w-16 h-16 mx-auto mb-4 text-muted-foreground/50\" />\n        <h3 className=\"text-lg font-semibold mb-2\">No {type} tournaments</h3>\n        <p className=\"text-muted-foreground\">\n          {type === \"upcoming\" \n            ? \"No upcoming tournaments available. Create your own!\" \n            : \"No tournaments are currently running.\"\n          }\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n      <AnimatePresence>\n        {tournaments.map((tournament) => (\n          <TournamentCard \n            key={tournament.id} \n            tournament={tournament} \n            type={type}\n            onJoin={() => onJoinTournament(tournament)}\n            isJoining={isJoining}\n            onManage={() => onManage(tournament)}\n            onOpenChat={() => onOpenChat(tournament.id)}\n            onViewLeaderboard={onViewLeaderboard ? () => onViewLeaderboard(tournament) : undefined}\n          />\n        ))}\n      </AnimatePresence>\n    </div>\n  );\n}\n\n// Tournament Card Component\nfunction TournamentCard({ \n  tournament, \n  type, \n  onJoin, \n  isJoining,\n  onManage,\n  onOpenChat,\n  onViewLeaderboard\n}: { \n  tournament: any, \n  type: \"upcoming\" | \"ongoing\", \n  onJoin: () => void,\n  isJoining: boolean,\n  onManage: () => void,\n  onOpenChat: () => void,\n  onViewLeaderboard?: () => void\n}) {\n  const { formatCurrency } = useUserPreferences();\n  const { user } = useAuth();\n  \n  const currentPot = tournament.currentPlayers * tournament.buyInAmount;\n  const isCreator = tournament.creatorId === user?.id;\n  const isParticipant = tournament.participants?.some((p: any) => p.userId === user?.id) || isCreator;\n  \n  const getTournamentTypeIcon = (tournamentType: string) => {\n    return tournamentType === \"crypto\" ? Bitcoin : TrendingUp;\n  };\n\n  const TournamentTypeIcon = getTournamentTypeIcon(tournament.tournamentType);\n\n  const getTimeRemaining = () => {\n    if (type === \"upcoming\" && tournament.scheduledStartTime) {\n      const timeLeft = new Date(tournament.scheduledStartTime).getTime() - Date.now();\n      if (timeLeft > 0) {\n        const hours = Math.floor(timeLeft / (1000 * 60 * 60));\n        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));\n        return `Starts in ${hours}h ${minutes}m`;\n      }\n      return \"Starting soon\";\n    }\n    return null;\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.9 }}\n      animate={{ opacity: 1, scale: 1 }}\n      exit={{ opacity: 0, scale: 0.9 }}\n      whileHover={{ scale: 1.01 }}\n      transition={{ duration: 0.2 }}\n    >\n      <Card className=\"h-full hover:shadow-lg transition-all duration-300 border border-border/50 hover:border-border bg-background\">\n        <CardHeader className=\"pb-4\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex-1\">\n              <CardTitle className=\"text-xl font-bold text-foreground mb-2 truncate\">\n                {tournament.name}\n              </CardTitle>\n              <div className=\"flex items-center space-x-2\">\n                <span className=\"text-sm text-muted-foreground\">\n                  {tournament.tournamentType === \"crypto\" ? \"Crypto\" : \"Stocks\"}\n                </span>\n                <span className=\"text-sm text-muted-foreground\">•</span>\n                <Badge variant={type === \"upcoming\" ? \"secondary\" : \"default\"} className=\"text-xs\">\n                  {type === \"upcoming\" ? \"Upcoming\" : \"Live\"}\n                </Badge>\n              </div>\n            </div>\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"space-y-4\">\n          {/* Current Pot - Clean */}\n          <div className=\"text-center py-3 bg-muted/30 rounded-lg\">\n            <div className=\"text-sm text-muted-foreground\">Current Pot</div>\n            <div className=\"text-2xl font-bold text-foreground\">\n              {formatCurrency(currentPot)}\n            </div>\n            <div className=\"text-xs text-muted-foreground mt-1\">\n              {tournament.currentPlayers} player{tournament.currentPlayers !== 1 ? 's' : ''} joined\n            </div>\n          </div>\n\n          {/* Tournament Stats - Simplified */}\n          <div className=\"space-y-2 text-sm\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Players</span>\n              <span className=\"font-medium\">{tournament.currentPlayers}/{tournament.maxPlayers}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Duration</span>\n              <span className=\"font-medium\">{tournament.timeframe}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-muted-foreground\">Starting Balance</span>\n              <span className=\"font-medium\">{formatCurrency(tournament.startingBalance)}</span>\n            </div>\n          </div>\n\n          {/* Time Information */}\n          {type === \"upcoming\" && (\n            <div className=\"text-center p-2 bg-orange-50 dark:bg-orange-950/30 rounded-lg\">\n              <p className=\"text-sm font-medium text-orange-600 dark:text-orange-400\">\n                {getTimeRemaining()}\n              </p>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"space-y-2\">\n            <Button\n              onClick={onOpenChat}\n              className=\"w-full\"\n              variant=\"outline\"\n              size=\"sm\"\n            >\n              Chat\n            </Button>\n            \n            {type === \"ongoing\" && tournament.isPublic && !isParticipant ? (\n              // Show \"View\" button for ongoing public tournaments where user is not a participant\n              <Button\n                onClick={onViewLeaderboard}\n                className=\"w-full\"\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                <Trophy className=\"w-4 h-4 mr-2\" />\n                View Leaderboard\n              </Button>\n            ) : isCreator ? (\n              <Button\n                onClick={onManage}\n                className=\"w-full\"\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                Manage\n              </Button>\n            ) : type === \"upcoming\" ? (\n              <Button\n                onClick={onJoin}\n                disabled={isJoining || tournament.currentPlayers >= tournament.maxPlayers}\n                className=\"w-full\"\n                size=\"sm\"\n              >\n                {isJoining ? \"Joining...\" : \n                 tournament.currentPlayers >= tournament.maxPlayers ? \"Full\" :\n                 tournament.buyInAmount > 0 ? `Join - ${formatCurrency(tournament.buyInAmount)}` : \"Join Free\"\n                }\n              </Button>\n            ) : null}\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}\n\n// Add ChatSystem to the main TournamentsPage\nexport { ChatSystem } from \"@/components/chat/ChatSystem\";","size_bytes":33491},"client/src/pages/unauthenticated-home.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Link } from \"wouter\";\nimport { \n  TrendingUp, \n  Trophy, \n  Users, \n  Target, \n  BarChart3,\n  Shield,\n  Zap,\n  Globe,\n  ArrowRight,\n  Play,\n  DollarSign,\n  Award,\n  Clock,\n  CheckCircle,\n  Star,\n  TrendingDown,\n  LineChart\n} from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 30 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.6 }\n};\n\nconst staggerChildren = {\n  animate: {\n    transition: {\n      staggerChildren: 0.1\n    }\n  }\n};\n\n// Stock chart background SVG component\nconst StockChartBackground = () => (\n  <div className=\"absolute inset-0 overflow-hidden\">\n    <svg\n      className=\"absolute inset-0 w-full h-full opacity-10\"\n      viewBox=\"0 0 800 400\"\n      preserveAspectRatio=\"none\"\n    >\n      <defs>\n        <linearGradient id=\"stockGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n          <stop offset=\"0%\" stopColor=\"#3b82f6\" stopOpacity=\"0.3\" />\n          <stop offset=\"100%\" stopColor=\"#3b82f6\" stopOpacity=\"0.05\" />\n        </linearGradient>\n        <filter id=\"glow\">\n          <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\"/>\n          <feMerge> \n            <feMergeNode in=\"coloredBlur\"/>\n            <feMergeNode in=\"SourceGraphic\"/>\n          </feMerge>\n        </filter>\n      </defs>\n      \n      {/* Grid lines */}\n      <g stroke=\"#3b82f6\" strokeWidth=\"0.5\" opacity=\"0.2\">\n        {Array.from({ length: 10 }).map((_, i) => (\n          <line key={`h-${i}`} x1=\"0\" y1={i * 40} x2=\"800\" y2={i * 40} />\n        ))}\n        {Array.from({ length: 20 }).map((_, i) => (\n          <line key={`v-${i}`} x1={i * 40} y1=\"0\" x2={i * 40} y2=\"400\" />\n        ))}\n      </g>\n      \n      {/* Stock price line */}\n      <path\n        d=\"M 0 300 Q 100 250 200 280 T 400 200 T 600 160 T 800 120\"\n        fill=\"none\"\n        stroke=\"#3b82f6\"\n        strokeWidth=\"2\"\n        filter=\"url(#glow)\"\n        opacity=\"0.8\"\n      />\n      \n      {/* Area under the curve */}\n      <path\n        d=\"M 0 300 Q 100 250 200 280 T 400 200 T 600 160 T 800 120 L 800 400 L 0 400 Z\"\n        fill=\"url(#stockGradient)\"\n      />\n      \n      {/* Data points */}\n      {[\n        { x: 0, y: 300 },\n        { x: 200, y: 280 },\n        { x: 400, y: 200 },\n        { x: 600, y: 160 },\n        { x: 800, y: 120 }\n      ].map((point, i) => (\n        <circle\n          key={i}\n          cx={point.x}\n          cy={point.y}\n          r=\"3\"\n          fill=\"#3b82f6\"\n          filter=\"url(#glow)\"\n          opacity=\"0.6\"\n        />\n      ))}\n    </svg>\n  </div>\n);\n\nexport default function UnauthenticatedHome() {\n  const features = [\n    {\n      icon: Trophy,\n      title: \"Competitive Trading\",\n      description: \"Join tournaments with traders worldwide. Compete for real prizes with virtual money.\",\n      color: \"text-yellow-500\"\n    },\n    {\n      icon: Target,\n      title: \"Risk-Free Trading\",\n      description: \"Practice trading strategies without financial risk. Perfect for beginners and experts alike.\",\n      color: \"text-blue-500\"\n    },\n    {\n      icon: BarChart3,\n      title: \"Real Market Data\",\n      description: \"Trade with authentic market prices and real-time data from major exchanges.\",\n      color: \"text-green-500\"\n    },\n    {\n      icon: Users,\n      title: \"Global Community\",\n      description: \"Connect with traders worldwide. Learn from the best and share your strategies.\",\n      color: \"text-purple-500\"\n    }\n  ];\n\n  const howItWorks = [\n    {\n      step: \"1\",\n      title: \"Sign Up & Get Started\",\n      description: \"Create your free account and receive $10,000 in virtual trading money\",\n      icon: CheckCircle\n    },\n    {\n      step: \"2\", \n      title: \"Join Tournaments\",\n      description: \"Enter trading competitions with different themes, durations, and prize pools\",\n      icon: Trophy\n    },\n    {\n      step: \"3\",\n      title: \"Trade & Compete\",\n      description: \"Buy and sell stocks with real market data, compete against other traders\",\n      icon: TrendingUp\n    },\n    {\n      step: \"4\",\n      title: \"Win & Earn\",\n      description: \"Top performers win prizes and climb the global leaderboards\",\n      icon: Award\n    }\n  ];\n\n  const stats = [\n    { label: \"Active Traders\", value: \"10,000+\", icon: Users },\n    { label: \"Tournaments Daily\", value: \"50+\", icon: Trophy },\n    { label: \"Total Prizes\", value: \"$100K+\", icon: DollarSign },\n    { label: \"Countries\", value: \"80+\", icon: Globe }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section with Stock Chart Background */}\n      <section className=\"relative py-20 overflow-hidden\">\n        <StockChartBackground />\n        <div className=\"relative z-10 container mx-auto px-4\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <motion.div {...fadeInUp}>\n              <Badge variant=\"secondary\" className=\"mb-6 text-sm px-4 py-2\">\n                <Star className=\"w-4 h-4 mr-2\" />\n                The Future of Paper Trading\n              </Badge>\n              <h1 className=\"text-5xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-foreground to-muted-foreground bg-clip-text text-transparent\">\n                Compete. Trade. Win.\n              </h1>\n              <p className=\"text-xl md:text-2xl text-muted-foreground mb-4\">\n                No risk, all reward.\n              </p>\n              <p className=\"text-lg text-muted-foreground mb-8 max-w-2xl mx-auto\">\n                Join the world's most exciting paper trading competition platform. \n                Practice with real market data, compete in tournaments, and climb the global leaderboards.\n              </p>\n              <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n                <Link href=\"/signup\">\n                  <Button size=\"lg\" className=\"text-lg px-8 py-6\">\n                    Start Trading Free\n                    <ArrowRight className=\"ml-2 w-5 h-5\" />\n                  </Button>\n                </Link>\n                <Link href=\"/login\">\n                  <Button variant=\"outline\" size=\"lg\" className=\"text-lg px-8 py-6\">\n                    <Play className=\"mr-2 w-5 h-5\" />\n                    Watch Demo\n                  </Button>\n                </Link>\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-16 bg-card/50\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div \n            className=\"grid grid-cols-2 md:grid-cols-4 gap-8 max-w-4xl mx-auto\"\n            variants={staggerChildren}\n            initial=\"initial\"\n            whileInView=\"animate\"\n            viewport={{ once: true }}\n          >\n            {stats.map((stat, index) => (\n              <motion.div\n                key={index}\n                variants={fadeInUp}\n                className=\"text-center\"\n              >\n                <div className=\"flex justify-center mb-3\">\n                  <stat.icon className=\"w-8 h-8 text-primary\" />\n                </div>\n                <div className=\"text-3xl font-bold text-foreground mb-1\">\n                  {stat.value}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  {stat.label}\n                </div>\n              </motion.div>\n            ))}\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section className=\"py-20\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <motion.div className=\"text-center mb-16\" {...fadeInUp}>\n              <h2 className=\"text-3xl md:text-4xl font-bold mb-4\">\n                Why Choose Our Platform?\n              </h2>\n              <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n                Experience the thrill of trading without the risk. Our platform combines \n                real market data with competitive gaming elements.\n              </p>\n            </motion.div>\n\n            <motion.div \n              className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\"\n              variants={staggerChildren}\n              initial=\"initial\"\n              whileInView=\"animate\"\n              viewport={{ once: true }}\n            >\n              {features.map((feature, index) => (\n                <motion.div\n                  key={index}\n                  variants={fadeInUp}\n                  className=\"group\"\n                >\n                  <Card className=\"h-full transition-all duration-300 hover:shadow-lg hover:-translate-y-1\">\n                    <CardContent className=\"p-6 text-center\">\n                      <div className=\"flex justify-center mb-4\">\n                        <div className=\"p-3 rounded-full bg-background\">\n                          <feature.icon className={`w-8 h-8 ${feature.color}`} />\n                        </div>\n                      </div>\n                      <h3 className=\"text-xl font-semibold mb-3\">{feature.title}</h3>\n                      <p className=\"text-muted-foreground text-sm leading-relaxed\">\n                        {feature.description}\n                      </p>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* How It Works Section */}\n      <section className=\"py-20 bg-card/30\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-6xl mx-auto\">\n            <motion.div className=\"text-center mb-16\" {...fadeInUp}>\n              <h2 className=\"text-3xl md:text-4xl font-bold mb-4\">\n                How It Works\n              </h2>\n              <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n                Get started in minutes and begin your journey to becoming a better trader\n              </p>\n            </motion.div>\n\n            <motion.div \n              className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\"\n              variants={staggerChildren}\n              initial=\"initial\"\n              whileInView=\"animate\"\n              viewport={{ once: true }}\n            >\n              {howItWorks.map((step, index) => (\n                <motion.div\n                  key={index}\n                  variants={fadeInUp}\n                  className=\"text-center relative\"\n                >\n                  <div className=\"flex justify-center mb-4\">\n                    <div className=\"relative\">\n                      <div className=\"w-16 h-16 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-xl font-bold\">\n                        {step.step}\n                      </div>\n                      {index < howItWorks.length - 1 && (\n                        <div className=\"hidden lg:block absolute top-8 left-16 w-20 h-0.5 bg-border\"></div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex justify-center mb-3\">\n                    <step.icon className=\"w-6 h-6 text-primary\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold mb-2\">{step.title}</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {step.description}\n                  </p>\n                </motion.div>\n              ))}\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-20\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div \n            className=\"max-w-4xl mx-auto text-center\"\n            {...fadeInUp}\n          >\n            <Card className=\"p-12 bg-gradient-to-r from-primary/10 to-secondary/10 border-primary/20\">\n              <CardContent className=\"p-0\">\n                <h2 className=\"text-3xl md:text-4xl font-bold mb-4\">\n                  Ready to Start Trading?\n                </h2>\n                <p className=\"text-lg text-muted-foreground mb-8 max-w-2xl mx-auto\">\n                  Join thousands of traders who are already competing and improving their skills. \n                  Start your trading journey today with $10,000 in virtual money.\n                </p>\n                <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n                  <Link href=\"/signup\">\n                    <Button size=\"lg\" className=\"text-lg px-8 py-6\">\n                      Create Free Account\n                      <ArrowRight className=\"ml-2 w-5 h-5\" />\n                    </Button>\n                  </Link>\n                  <Link href=\"/about\">\n                    <Button variant=\"outline\" size=\"lg\" className=\"text-lg px-8 py-6\">\n                      Learn More\n                    </Button>\n                  </Link>\n                </div>\n                <p className=\"text-sm text-muted-foreground mt-6\">\n                  <Shield className=\"inline w-4 h-4 mr-1\" />\n                  100% Free • No Credit Card Required • Real Market Data\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n      </section>\n    </div>\n  );\n}","size_bytes":13311},"client/src/pages/withdraw.tsx":{"content":"import { useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { \n  ArrowLeft,\n  DollarSign,\n  Minus,\n  AlertTriangle\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\nconst fadeInUp = {\n  initial: { opacity: 0, y: 20 },\n  animate: { opacity: 1, y: 0 },\n  transition: { duration: 0.5 }\n};\n\nexport default function Withdraw() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n  const { toast } = useToast();\n  const [amount, setAmount] = useState(\"\");\n  const [selectedAmount, setSelectedAmount] = useState<number | null>(null);\n\n  const currentBalance = Number(user?.siteCash) || 0;\n  const presetAmounts = [10, 25, 50, 100].filter(amt => amt <= currentBalance);\n\n  // Fee calculation\n  const SITE_FEE_PERCENTAGE = 25; // 25% site fee\n  const TRANSACTION_FEE_PERCENTAGE = 3; // 3% transaction fee\n\n  const getWithdrawalBreakdown = (withdrawAmount: number) => {\n    const siteFee = withdrawAmount * (SITE_FEE_PERCENTAGE / 100);\n    const transactionFee = withdrawAmount * (TRANSACTION_FEE_PERCENTAGE / 100);\n    const totalFees = siteFee + transactionFee;\n    const subtotal = withdrawAmount - totalFees;\n\n    return {\n      originalAmount: withdrawAmount,\n      siteFee,\n      transactionFee,\n      totalFees,\n      subtotal: Math.max(0, subtotal) // Ensure subtotal is never negative\n    };\n  };\n\n  const currentWithdrawAmount = selectedAmount || parseFloat(amount) || 0;\n  const breakdown = getWithdrawalBreakdown(currentWithdrawAmount);\n\n  // Mutation for withdrawing site cash\n  const withdrawMutation = useMutation({\n    mutationFn: async (withdrawAmount: number) => {\n      const response = await apiRequest(\"POST\", \"/api/balance/withdraw\", { amount: withdrawAmount });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      setAmount(\"\");\n      setSelectedAmount(null);\n      toast({\n        title: \"Withdrawal Successful\",\n        description: `Successfully withdrew ${formatCurrency(data.amount || 0)} from your account.`,\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Withdrawal Failed\",\n        description: error.message || \"Failed to process withdrawal\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleWithdraw = () => {\n    const withdrawAmount = selectedAmount || parseFloat(amount);\n    const breakdown = getWithdrawalBreakdown(withdrawAmount);\n    \n    if (withdrawAmount && withdrawAmount > 0 && withdrawAmount <= currentBalance && breakdown.subtotal >= 1) {\n      // Deduct the full withdrawal amount from balance (not just the subtotal)\n      withdrawMutation.mutate(withdrawAmount);\n    }\n  };\n\n  const isValidAmount = () => {\n    const withdrawAmount = selectedAmount || parseFloat(amount);\n    const breakdown = getWithdrawalBreakdown(withdrawAmount);\n    return withdrawAmount > 0 && withdrawAmount <= currentBalance && breakdown.subtotal >= 1;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-6 py-8\">\n        \n        {/* Header */}\n        <motion.div \n          className=\"mb-8\"\n          {...fadeInUp}\n        >\n          <div className=\"flex items-center space-x-4\">\n            <Link href=\"/hub\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                Back to Hub\n              </Button>\n            </Link>\n            <div>\n              <h1 className=\"text-3xl font-bold text-foreground flex items-center\">\n                <Minus className=\"w-8 h-8 mr-3 text-red-500\" />\n                Withdraw Funds\n              </h1>\n              <p className=\"text-muted-foreground mt-1\">\n                Withdraw funds from your account balance\n              </p>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Current Balance Display */}\n        <motion.div \n          className=\"mb-6\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.1 }}\n        >\n          <Card className=\"border-primary/20\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Available Balance</p>\n                  <p className=\"text-3xl font-bold text-foreground\">\n                    {formatCurrency(currentBalance)}\n                  </p>\n                </div>\n                <DollarSign className=\"w-12 h-12 text-primary/30\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Withdrawal Form */}\n        <motion.div \n          className=\"mb-6\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.2 }}\n        >\n          <Card>\n            <CardHeader>\n              <CardTitle>Withdrawal Amount</CardTitle>\n              <CardDescription>\n                Choose a preset amount or enter a custom withdrawal amount\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              {/* Preset Amounts */}\n              {presetAmounts.length > 0 && (\n                <div>\n                  <Label className=\"text-sm font-medium\">Quick Select</Label>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2\">\n                    {presetAmounts.map((presetAmount) => (\n                      <Button\n                        key={presetAmount}\n                        variant={selectedAmount === presetAmount ? \"default\" : \"outline\"}\n                        onClick={() => {\n                          setSelectedAmount(presetAmount);\n                          setAmount(\"\");\n                        }}\n                        className=\"h-12\"\n                      >\n                        {formatCurrency(presetAmount)}\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n              )}\n              \n              {/* Custom Amount */}\n              <div>\n                <Label htmlFor=\"custom-amount\" className=\"text-sm font-medium\">\n                  Custom Amount\n                </Label>\n                <div className=\"relative mt-2\">\n                  <DollarSign className=\"w-4 h-4 text-muted-foreground absolute left-3 top-1/2 transform -translate-y-1/2\" />\n                  <Input\n                    id=\"custom-amount\"\n                    type=\"number\"\n                    placeholder=\"0.00\"\n                    value={amount}\n                    onChange={(e) => {\n                      setAmount(e.target.value);\n                      setSelectedAmount(null);\n                    }}\n                    className=\"pl-10\"\n                    min=\"0\"\n                    step=\"0.01\"\n                    max={currentBalance}\n                  />\n                </div>\n              </div>\n\n              {/* Fee Breakdown - Show when amount is entered */}\n              {currentWithdrawAmount > 0 && (\n                <div className=\"bg-muted/30 p-4 rounded-lg space-y-2\">\n                  <h4 className=\"font-medium text-sm text-foreground\">Withdrawal Breakdown</h4>\n                  <div className=\"space-y-1 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Withdrawal Amount:</span>\n                      <span className=\"font-medium\">{formatCurrency(breakdown.originalAmount)}</span>\n                    </div>\n                    <div className=\"flex justify-between text-red-600 dark:text-red-400\">\n                      <span>Site Fee (-{SITE_FEE_PERCENTAGE}%):</span>\n                      <span>-{formatCurrency(breakdown.siteFee)}</span>\n                    </div>\n                    <div className=\"flex justify-between text-red-600 dark:text-red-400\">\n                      <span>Transaction Fee (-{TRANSACTION_FEE_PERCENTAGE}%):</span>\n                      <span>-{formatCurrency(breakdown.transactionFee)}</span>\n                    </div>\n                    <div className=\"border-t border-border pt-1 mt-2\">\n                      <div className=\"flex justify-between font-medium\">\n                        <span>You will receive:</span>\n                        <span className=\"text-green-600 dark:text-green-400\">\n                          {formatCurrency(breakdown.subtotal)}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Warning for insufficient funds */}\n              {(selectedAmount || parseFloat(amount)) > currentBalance && (\n                <Alert variant=\"destructive\">\n                  <AlertTriangle className=\"h-4 w-4\" />\n                  <AlertDescription>\n                    Withdrawal amount cannot exceed your current balance of {formatCurrency(currentBalance)}.\n                  </AlertDescription>\n                </Alert>\n              )}\n\n              {/* Warning for low payout */}\n              {currentWithdrawAmount > 0 && breakdown.subtotal < 1 && (\n                <Alert variant=\"destructive\">\n                  <AlertTriangle className=\"h-4 w-4\" />\n                  <AlertDescription>\n                    After fees, you would receive less than $1.00. Consider withdrawing a larger amount.\n                  </AlertDescription>\n                </Alert>\n              )}\n\n              {/* Withdraw Button */}\n              <Button \n                onClick={handleWithdraw}\n                disabled={\n                  withdrawMutation.isPending || \n                  !isValidAmount() ||\n                  currentBalance <= 0\n                }\n                className=\"w-full\"\n                variant=\"destructive\"\n              >\n                {withdrawMutation.isPending ? \"Processing...\" : \"Withdraw Funds\"}\n              </Button>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Important Notice */}\n        <motion.div \n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.3 }}\n        >\n          <Alert>\n            <AlertTriangle className=\"h-4 w-4\" />\n            <AlertDescription>\n              <strong>Important:</strong> Withdrawals are processed immediately and cannot be undone. \n              Make sure you enter the correct amount before proceeding.\n            </AlertDescription>\n          </Alert>\n        </motion.div>\n\n      </div>\n    </div>\n  );\n}","size_bytes":11273},"client/src/components/admin/UserManagementDialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  Edit, \n  DollarSign, \n  Plus, \n  Minus, \n  FileText, \n  Ban, \n  Crown,\n  User\n} from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface UserManagementDialogProps {\n  user: any;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport function UserManagementDialog({ user, open, onOpenChange }: UserManagementDialogProps) {\n  const [newUsername, setNewUsername] = useState(user?.username || \"\");\n  const [balanceAmount, setBalanceAmount] = useState(\"\");\n  const [adminNote, setAdminNote] = useState(user?.adminNote || \"\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const updateUsernameMutation = useMutation({\n    mutationFn: async (data: { userId: number; username: string }) => {\n      return await apiRequest(\"PATCH\", `/api/admin/users/${data.userId}/username`, { username: data.username });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Username updated successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update username\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateBalanceMutation = useMutation({\n    mutationFn: async (data: { userId: number; amount: number; operation: \"add\" | \"remove\" }) => {\n      return await apiRequest(\"PATCH\", `/api/admin/users/${data.userId}/balance`, { \n        amount: data.amount,\n        operation: data.operation \n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Balance updated successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      setBalanceAmount(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update balance\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateNoteMutation = useMutation({\n    mutationFn: async (data: { userId: number; note: string }) => {\n      return await apiRequest(\"PATCH\", `/api/admin/users/${data.userId}/note`, { note: data.note });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Admin note updated successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update note\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const banUserMutation = useMutation({\n    mutationFn: async (userId: number) => {\n      return await apiRequest(\"PATCH\", `/api/admin/users/${userId}/ban`, {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"User banned successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to ban user\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleUsernameUpdate = () => {\n    if (!newUsername.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Username cannot be empty\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    updateUsernameMutation.mutate({ userId: user.id, username: newUsername.trim() });\n  };\n\n  const handleBalanceUpdate = (operation: \"add\" | \"remove\") => {\n    const amount = parseFloat(balanceAmount);\n    if (isNaN(amount) || amount <= 0) {\n      toast({\n        title: \"Error\",\n        description: \"Please enter a valid amount\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    updateBalanceMutation.mutate({ userId: user.id, amount, operation });\n  };\n\n  const handleNoteUpdate = () => {\n    updateNoteMutation.mutate({ userId: user.id, note: adminNote });\n  };\n\n  const handleBanUser = () => {\n    if (confirm(\"Are you sure you want to ban this user? This action cannot be undone.\")) {\n      banUserMutation.mutate(user.id);\n    }\n  };\n\n  if (!user) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            {user.subscriptionTier === 'administrator' ? (\n              <Crown className=\"h-5 w-5 text-yellow-500\" />\n            ) : (\n              <User className=\"h-5 w-5\" />\n            )}\n            Manage User: {user.username}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {/* User Info */}\n          <div className=\"bg-muted/50 p-4 rounded-lg\">\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div>\n                <span className=\"text-muted-foreground\">User ID:</span>\n                <div className=\"flex items-center gap-2\">\n                  {user.id}\n                  {user.subscriptionTier === 'administrator' && (\n                    <Crown className=\"h-4 w-4 text-yellow-500\" />\n                  )}\n                </div>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Email:</span>\n                <div>{user.email}</div>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Site Cash:</span>\n                <div className=\"font-mono\">${parseFloat(user.siteCash || \"0\").toLocaleString()}</div>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Member Since:</span>\n                <div>{new Date(user.createdAt).toLocaleDateString()}</div>\n              </div>\n            </div>\n          </div>\n\n          <Tabs defaultValue=\"username\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-4\">\n              <TabsTrigger value=\"username\">Username</TabsTrigger>\n              <TabsTrigger value=\"balance\">Site Cash</TabsTrigger>\n              <TabsTrigger value=\"notes\">Notes</TabsTrigger>\n              <TabsTrigger value=\"actions\">Actions</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"username\" className=\"space-y-4\">\n              <div className=\"space-y-3\">\n                <Label htmlFor=\"new-username\">Change Username</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"new-username\"\n                    value={newUsername}\n                    onChange={(e) => setNewUsername(e.target.value)}\n                    placeholder=\"Enter new username\"\n                  />\n                  <Button \n                    onClick={handleUsernameUpdate}\n                    disabled={updateUsernameMutation.isPending}\n                  >\n                    <Edit className=\"h-4 w-4 mr-2\" />\n                    Update\n                  </Button>\n                </div>\n                <p className=\"text-xs text-muted-foreground\">\n                  Username must be 3-15 characters and contain only letters, numbers, and underscores.\n                </p>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"balance\" className=\"space-y-4\">\n              <div className=\"space-y-3\">\n                <Label htmlFor=\"balance-amount\">Adjust Site Cash</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"balance-amount\"\n                    type=\"number\"\n                    value={balanceAmount}\n                    onChange={(e) => setBalanceAmount(e.target.value)}\n                    placeholder=\"Enter amount\"\n                    min=\"0\"\n                    step=\"0.01\"\n                  />\n                  <Button \n                    onClick={() => handleBalanceUpdate(\"add\")}\n                    disabled={updateBalanceMutation.isPending}\n                    variant=\"default\"\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add\n                  </Button>\n                  <Button \n                    onClick={() => handleBalanceUpdate(\"remove\")}\n                    disabled={updateBalanceMutation.isPending}\n                    variant=\"destructive\"\n                  >\n                    <Minus className=\"h-4 w-4 mr-2\" />\n                    Remove\n                  </Button>\n                </div>\n                <p className=\"text-xs text-muted-foreground\">\n                  Current site cash: ${parseFloat(user.siteCash || \"0\").toLocaleString()}\n                </p>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"notes\" className=\"space-y-4\">\n              <div className=\"space-y-3\">\n                <Label htmlFor=\"admin-note\">Admin Notes</Label>\n                <Textarea\n                  id=\"admin-note\"\n                  value={adminNote}\n                  onChange={(e) => setAdminNote(e.target.value)}\n                  placeholder=\"Add notes about this user (visible only to admins)\"\n                  rows={4}\n                />\n                <Button \n                  onClick={handleNoteUpdate}\n                  disabled={updateNoteMutation.isPending}\n                >\n                  <FileText className=\"h-4 w-4 mr-2\" />\n                  Save Note\n                </Button>\n                <p className=\"text-xs text-muted-foreground\">\n                  These notes are only visible to administrators and help track user interactions.\n                </p>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"actions\" className=\"space-y-4\">\n              <div className=\"space-y-3\">\n                <div className=\"bg-destructive/10 border border-destructive/20 p-4 rounded-lg\">\n                  <h4 className=\"font-medium text-destructive mb-2\">Dangerous Actions</h4>\n                  <p className=\"text-sm text-muted-foreground mb-3\">\n                    These actions are permanent and cannot be undone.\n                  </p>\n                  <Button \n                    onClick={handleBanUser}\n                    disabled={banUserMutation.isPending}\n                    variant=\"destructive\"\n                  >\n                    <Ban className=\"h-4 w-4 mr-2\" />\n                    Ban User\n                  </Button>\n                </div>\n              </div>\n            </TabsContent>\n          </Tabs>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":11201},"client/src/components/chat/ChatSidebar.tsx":{"content":"import React, { useState, useEffect, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Send, MessageSquare, X, User, Globe, Trophy, Users } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface ChatMessage {\n  id: number;\n  userId: number;\n  username: string;\n  message: string;\n  createdAt: string;\n}\n\ninterface Tournament {\n  id: number;\n  name: string;\n  status: string;\n  isParticipating?: boolean;\n}\n\ninterface ChatSidebarProps {\n  isOpen: boolean;\n  onToggle: () => void;\n}\n\nexport function ChatSidebar({ isOpen, onToggle }: ChatSidebarProps) {\n  const { user } = useAuth();\n  const { t } = useUserPreferences();\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [selectedChat, setSelectedChat] = useState<string>(\"global\");\n  const scrollAreaRef = useRef<HTMLDivElement>(null);\n  const queryClient = useQueryClient();\n\n  // Fetch user's tournaments for chat selection\n  const { data: userTournamentsResponse } = useQuery<{data: Tournament[]}>({\n    queryKey: ['/api/tournaments'],\n    enabled: !!user && isOpen,\n  });\n\n  const userTournaments = userTournamentsResponse?.data?.filter(t => \n    t.status === \"active\" || t.status === \"waiting\"\n  ) || [];\n\n  // Determine current chat endpoint\n  const isGlobalChat = selectedChat === \"global\";\n  const tournamentId = isGlobalChat ? undefined : parseInt(selectedChat);\n\n  // Fetch chat messages with optimized polling\n  const { data: chatResponse, isLoading } = useQuery({\n    queryKey: ['/api/chat', selectedChat],\n    queryFn: async () => {\n      const endpoint = isGlobalChat \n        ? '/api/chat/global' \n        : `/api/chat/tournament/${tournamentId}`;\n      const response = await apiRequest(\"GET\", endpoint);\n      return response.json();\n    },\n    refetchInterval: 1500, // Faster refresh - every 1.5 seconds\n    enabled: isOpen && !!user,\n    staleTime: 500, // Consider data stale after 0.5 seconds\n    gcTime: 2000, // Garbage collect after 2 seconds\n  });\n\n  const messages: ChatMessage[] = chatResponse?.data || [];\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (messageData: { message: string; tournamentId?: number }) => {\n      const endpoint = isGlobalChat \n        ? '/api/chat/global' \n        : `/api/chat/tournament/${tournamentId}`;\n      const response = await apiRequest(\"POST\", endpoint, messageData);\n      return response.json();\n    },\n    onSuccess: () => {\n      setNewMessage(\"\");\n      queryClient.invalidateQueries({ queryKey: ['/api/chat', selectedChat] });\n    }\n  });\n\n  const handleSendMessage = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !user) return;\n\n    sendMessageMutation.mutate({\n      message: newMessage.trim(),\n      tournamentId: isGlobalChat ? undefined : tournamentId\n    });\n  };\n\n  // Auto-scroll to bottom when new messages arrive\n  useEffect(() => {\n    if (scrollAreaRef.current) {\n      const scrollContainer = scrollAreaRef.current.querySelector('[data-radix-scroll-area-viewport]');\n      if (scrollContainer) {\n        scrollContainer.scrollTop = scrollContainer.scrollHeight;\n      }\n    }\n  }, [messages]);\n\n  const formatTimestamp = (timestamp: string) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diffInHours = (now.getTime() - date.getTime()) / (1000 * 60 * 60);\n\n    if (diffInHours < 24) {\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    } else {\n      return date.toLocaleDateString([], { month: 'short', day: 'numeric' });\n    }\n  };\n\n  const getCurrentChatInfo = () => {\n    if (isGlobalChat) {\n      return {\n        name: \"Global Chat\",\n        description: \"Chat with all platform users\",\n        icon: <Globe className=\"w-4 h-4\" />,\n        color: \"bg-blue-500\"\n      };\n    }\n\n    const tournament = userTournaments.find(t => t.id === tournamentId);\n    if (tournament) {\n      return {\n        name: tournament.name,\n        description: \"Tournament chat\",\n        icon: <Trophy className=\"w-4 h-4\" />,\n        color: \"bg-orange-500\"\n      };\n    }\n\n    return {\n      name: \"Tournament Chat\",\n      description: \"Tournament discussion\",\n      icon: <Trophy className=\"w-4 h-4\" />,\n      color: \"bg-orange-500\"\n    };\n  };\n\n  const chatInfo = getCurrentChatInfo();\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <>\n          {/* Backdrop */}\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            onClick={onToggle}\n            className=\"fixed top-16 left-0 right-0 bottom-0 bg-black/20 backdrop-blur-sm z-40 lg:hidden\"\n          />\n\n          {/* Chat Sidebar - Semi-transparent */}\n          <motion.div\n            initial={{ x: \"100%\" }}\n            animate={{ x: 0 }}\n            exit={{ x: \"100%\" }}\n            transition={{ type: \"spring\", damping: 30, stiffness: 300 }}\n            className=\"fixed top-16 right-0 h-[calc(100vh-4rem)] w-80 bg-background/80 backdrop-blur-md border-l border-border/50 shadow-xl z-50 flex flex-col\"\n          >\n            {/* Compact Header with Chat Selector */}\n            <div className=\"flex items-center justify-between p-3 border-b border-border/30 bg-background/40\">\n              <div className=\"flex items-center space-x-3 flex-1\">\n                <div className={`w-6 h-6 ${chatInfo.color} rounded flex items-center justify-center`}>\n                  {chatInfo.icon}\n                </div>\n                {/* Compact Chat Selector */}\n                <Select value={selectedChat} onValueChange={setSelectedChat}>\n                  <SelectTrigger className=\"w-full h-8 text-sm bg-background/60 border-border/50\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent className=\"bg-background/95 backdrop-blur-md border-border/50\">\n                    <SelectItem value=\"global\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Globe className=\"w-3 h-3\" />\n                        <span>Global Chat</span>\n                      </div>\n                    </SelectItem>\n                    {userTournaments.map((tournament) => (\n                      <SelectItem key={tournament.id} value={tournament.id.toString()}>\n                        <div className=\"flex items-center space-x-2\">\n                          <Trophy className=\"w-3 h-3\" />\n                          <span className=\"truncate max-w-[180px]\">{tournament.name}</span>\n                          <Badge variant=\"secondary\" className=\"text-xs shrink-0\">\n                            {tournament.status}\n                          </Badge>\n                        </div>\n                      </SelectItem>\n                    ))}\n                    {userTournaments.length === 0 && (\n                      <SelectItem value=\"no-tournaments\" disabled>\n                        <div className=\"flex items-center space-x-2\">\n                          <Trophy className=\"w-3 h-3 text-muted-foreground\" />\n                          <span className=\"text-muted-foreground\">No tournaments</span>\n                        </div>\n                      </SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n              <Button\n                onClick={onToggle}\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"h-8 w-8 p-0 ml-2 hover:bg-background/60\"\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n\n            {/* Messages Area - Semi-transparent */}\n            <ScrollArea ref={scrollAreaRef} className=\"flex-1 p-3 bg-background/20\">\n              <div className=\"space-y-3\">\n                {isLoading ? (\n                  <div className=\"text-center py-4\">\n                    <div className=\"inline-block w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\n                  </div>\n                ) : messages.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <MessageSquare className=\"w-10 h-10 mx-auto mb-3 text-muted-foreground/50\" />\n                    <p className=\"text-sm text-muted-foreground\">\n                      {isGlobalChat ? \"No messages yet. Start the conversation!\" : \"No tournament messages yet.\"}\n                    </p>\n                  </div>\n                ) : (\n                  messages.map((message) => (\n                    <div key={message.id} className=\"flex space-x-2\">\n                      <div className=\"w-7 h-7 bg-muted/60 backdrop-blur-sm rounded-full flex items-center justify-center flex-shrink-0\">\n                        <User className=\"w-3 h-3\" />\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center space-x-2 mb-1\">\n                          <span className=\"text-sm font-medium\">\n                            {message.username}\n                          </span>\n                          {message.userId === user?.id && (\n                            <Badge variant=\"secondary\" className=\"text-xs\">You</Badge>\n                          )}\n                          <span className=\"text-xs text-muted-foreground/70\">\n                            {formatTimestamp(message.createdAt)}\n                          </span>\n                        </div>\n                        <div className=\"bg-muted/40 backdrop-blur-sm rounded-lg px-3 py-2 border border-border/30\">\n                          <p className=\"text-sm break-words leading-tight\">{message.message}</p>\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                )}\n              </div>\n            </ScrollArea>\n\n            {/* Message Input - Semi-transparent */}\n            <div className=\"p-3 border-t border-border/30 bg-background/40\">\n              <form onSubmit={handleSendMessage} className=\"flex space-x-2\">\n                <Input\n                  value={newMessage}\n                  onChange={(e) => setNewMessage(e.target.value)}\n                  placeholder={`Message ${isGlobalChat ? 'everyone' : 'tournament'}...`}\n                  className=\"flex-1 bg-background/60 border-border/50 text-sm h-9\"\n                  maxLength={500}\n                />\n                <Button\n                  type=\"submit\"\n                  size=\"sm\"\n                  disabled={!newMessage.trim() || sendMessageMutation.isPending}\n                  className=\"px-3 h-9\"\n                >\n                  <Send className=\"w-4 h-4\" />\n                </Button>\n              </form>\n              <div className=\"flex items-center justify-between mt-2 text-xs text-muted-foreground/70\">\n                <span>{messages.length} messages</span>\n                <span>{newMessage.length}/500</span>\n              </div>\n            </div>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n}","size_bytes":11658},"client/src/components/chat/ChatSystem.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n// Remove Avatar import as it doesn't exist in our components\nimport { Send, MessageSquare, X, User } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface ChatMessage {\n  id: number;\n  userId: number;\n  username: string;\n  profilePicture?: string;\n  message: string;\n  createdAt: string;\n}\n\ninterface ChatSystemProps {\n  tournamentId?: number;\n  isOpen: boolean;\n  onToggle: () => void;\n}\n\nexport function ChatSystem({ tournamentId, isOpen, onToggle }: ChatSystemProps) {\n  const { user } = useAuth();\n  const [newMessage, setNewMessage] = useState(\"\");\n  const scrollAreaRef = useRef<HTMLDivElement>(null);\n  const queryClient = useQueryClient();\n\n  // Fetch chat messages with optimized polling\n  const { data: chatResponse, isLoading } = useQuery({\n    queryKey: ['/api/chat', tournamentId],\n    queryFn: async () => {\n      const endpoint = tournamentId ? `/api/chat/tournament/${tournamentId}` : '/api/chat/global';\n      const response = await apiRequest(\"GET\", endpoint);\n      return response.json();\n    },\n    refetchInterval: 1500, // Faster refresh - every 1.5 seconds\n    enabled: isOpen,\n    staleTime: 500, // Consider data stale after 0.5 seconds\n    gcTime: 2000, // Garbage collect after 2 seconds\n  });\n\n  const messages = chatResponse?.data || [];\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (messageData: { message: string; tournamentId?: number }) => {\n      const endpoint = tournamentId ? `/api/chat/tournament/${tournamentId}` : '/api/chat/global';\n      const response = await apiRequest(\"POST\", endpoint, messageData);\n      return response.json();\n    },\n    onSuccess: () => {\n      setNewMessage(\"\");\n      queryClient.invalidateQueries({ queryKey: ['/api/chat', tournamentId] });\n    }\n  });\n\n  const handleSendMessage = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !user) return;\n\n    sendMessageMutation.mutate({\n      message: newMessage.trim(),\n      tournamentId\n    });\n  };\n\n  // Auto-scroll to bottom when new messages arrive\n  useEffect(() => {\n    if (scrollAreaRef.current) {\n      const scrollContainer = scrollAreaRef.current.querySelector('[data-radix-scroll-area-viewport]');\n      if (scrollContainer) {\n        scrollContainer.scrollTop = scrollContainer.scrollHeight;\n      }\n    }\n  }, [messages]);\n\n  if (!isOpen) {\n    return (\n      <Button\n        onClick={onToggle}\n        className=\"fixed bottom-4 right-4 rounded-full w-12 h-12 shadow-lg z-50\"\n        size=\"sm\"\n      >\n        <MessageSquare className=\"w-5 h-5\" />\n      </Button>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20, scale: 0.95 }}\n      animate={{ opacity: 1, y: 0, scale: 1 }}\n      exit={{ opacity: 0, y: 20, scale: 0.95 }}\n      className=\"fixed bottom-4 right-4 w-80 h-96 z-50\"\n    >\n      <Card className=\"h-full border-0 shadow-2xl bg-background\">\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"text-sm font-medium\">\n              {tournamentId ? 'Tournament Chat' : 'Global Chat'}\n            </CardTitle>\n            <Button variant=\"ghost\" size=\"sm\" onClick={onToggle} className=\"h-6 w-6 p-0\">\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"p-0 h-full flex flex-col\">\n          <ScrollArea ref={scrollAreaRef} className=\"flex-1 px-4\">\n            <div className=\"space-y-3 pb-4\">\n              <AnimatePresence>\n                {isLoading ? (\n                  <div className=\"text-center text-muted-foreground text-sm py-4\">\n                    Loading messages...\n                  </div>\n                ) : messages.length === 0 ? (\n                  <div className=\"text-center text-muted-foreground text-sm py-4\">\n                    No messages yet. Start the conversation!\n                  </div>\n                ) : (\n                  messages.map((message: ChatMessage) => (\n                    <motion.div\n                      key={message.id}\n                      initial={{ opacity: 0, y: 10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      className={`flex items-start space-x-2 ${\n                        message.userId === user?.id ? 'flex-row-reverse space-x-reverse' : ''\n                      }`}\n                    >\n                      <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center overflow-hidden\">\n                        {message.profilePicture ? (\n                          <img \n                            src={message.profilePicture} \n                            alt={message.username}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        ) : (\n                          <User className=\"w-4 h-4 text-muted-foreground\" />\n                        )}\n                      </div>\n                      \n                      <div className={`flex-1 max-w-[80%] ${\n                        message.userId === user?.id ? 'text-right' : ''\n                      }`}>\n                        <div className=\"flex items-center space-x-2 mb-1\">\n                          <span className=\"text-xs font-medium text-foreground\">\n                            {message.username}\n                          </span>\n                          <span className=\"text-xs text-muted-foreground\">\n                            {new Date(message.createdAt).toLocaleTimeString([], { \n                              hour: '2-digit', \n                              minute: '2-digit' \n                            })}\n                          </span>\n                        </div>\n                        <div className={`px-3 py-2 rounded-lg text-sm ${\n                          message.userId === user?.id \n                            ? 'bg-primary text-primary-foreground ml-auto' \n                            : 'bg-muted text-foreground'\n                        }`}>\n                          {message.message}\n                        </div>\n                      </div>\n                    </motion.div>\n                  ))\n                )}\n              </AnimatePresence>\n            </div>\n          </ScrollArea>\n\n          {/* Message input */}\n          <div className=\"p-4 border-t border-border/50\">\n            <form onSubmit={handleSendMessage} className=\"flex space-x-2\">\n              <Input\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                placeholder=\"Type a message...\"\n                className=\"flex-1 h-9\"\n                maxLength={500}\n              />\n              <Button \n                type=\"submit\" \n                size=\"sm\" \n                disabled={!newMessage.trim() || sendMessageMutation.isPending}\n                className=\"h-9 w-9 p-0\"\n              >\n                <Send className=\"w-4 h-4\" />\n              </Button>\n            </form>\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","size_bytes":7583},"client/src/components/layout/footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { FaInstagram, FaFacebook, FaTwitter, FaTiktok } from \"react-icons/fa\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\nexport default function Footer() {\n  const { t } = useUserPreferences();\n  return (\n    <footer className=\"bg-card border-t border-border py-12\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"grid md:grid-cols-4 gap-8\">\n            <div>\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <div className=\"w-8 h-8 bg-primary rounded-sm flex items-center justify-center\">\n                  <span className=\"text-primary-foreground font-bold text-sm\">O</span>\n                </div>\n                <span className=\"text-xl font-bold text-foreground\">{t('brandName')}</span>\n              </div>\n              <p className=\"text-muted-foreground text-sm\">\n                {t('tagline')}\n              </p>\n            </div>\n\n            <div>\n              <h4 className=\"text-lg font-semibold mb-4 text-foreground\">Platform</h4>\n              <ul className=\"space-y-2 text-muted-foreground\">\n                <li>\n                  <Link href=\"/hub\" className=\"hover:text-foreground transition-colors\">\n                    {t('hub')}\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/dashboard\" className=\"hover:text-foreground transition-colors\">\n                    {t('dashboard')}\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/tournaments\" className=\"hover:text-foreground transition-colors\">\n                    {t('tournaments')}\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/leaderboard\" className=\"hover:text-foreground transition-colors\">\n                    {t('leaderboard')}\n                  </Link>\n                </li>\n              </ul>\n            </div>\n\n            <div>\n              <h4 className=\"text-lg font-semibold mb-4 text-foreground\">{t('community')}</h4>\n              <ul className=\"space-y-2 text-muted-foreground\">\n                <li>\n                  <Link href=\"/people\" className=\"hover:text-foreground transition-colors\">\n                    {t('people')}\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/events\" className=\"hover:text-foreground transition-colors\">\n                    Events\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/shop\" className=\"hover:text-foreground transition-colors\">\n                    Shop\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/analytics\" className=\"hover:text-foreground transition-colors\">\n                    {t('analytics')}\n                  </Link>\n                </li>\n              </ul>\n            </div>\n\n            <div>\n              <h4 className=\"text-lg font-semibold mb-4 text-foreground\">{t('support')}</h4>\n              <ul className=\"space-y-2 text-muted-foreground\">\n                <li>\n                  <Link href=\"/support\" className=\"hover:text-foreground transition-colors\">\n                    Help Center\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/archive\" className=\"hover:text-foreground transition-colors\">\n                    Transaction Archive\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/pricing\" className=\"hover:text-white transition-colors\">\n                    Pricing\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/withdraw\" className=\"hover:text-foreground transition-colors\">\n                    Withdraw Funds\n                  </Link>\n                </li>\n              </ul>\n            </div>\n          </div>\n\n          <div className=\"border-t border-gray-800 mt-8 pt-8\">\n            <div className=\"flex flex-col md:flex-row items-center justify-between\">\n              <p className=\"text-gray-400 text-sm\">\n                © 2024 Orellana, Santos & Thompson. All rights reserved.\n              </p>\n              <div className=\"flex items-center space-x-6 mt-4 md:mt-0\">\n                <div className=\"flex items-center space-x-4 mr-6\">\n                  <a\n                    href=\"https://instagram.com\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-gray-400 hover:text-white transition-colors\"\n                    aria-label=\"Instagram\"\n                  >\n                    <FaInstagram className=\"w-5 h-5\" />\n                  </a>\n                  <a\n                    href=\"https://facebook.com\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-gray-400 hover:text-white transition-colors\"\n                    aria-label=\"Facebook\"\n                  >\n                    <FaFacebook className=\"w-5 h-5\" />\n                  </a>\n                  <a\n                    href=\"https://twitter.com\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-gray-400 hover:text-white transition-colors\"\n                    aria-label=\"Twitter\"\n                  >\n                    <FaTwitter className=\"w-5 h-5\" />\n                  </a>\n                  <a\n                    href=\"https://tiktok.com\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-gray-400 hover:text-white transition-colors\"\n                    aria-label=\"TikTok\"\n                  >\n                    <FaTiktok className=\"w-5 h-5\" />\n                  </a>\n                </div>\n                <Link href=\"/privacy\" className=\"text-gray-400 hover:text-white transition-colors\">\n                  Privacy Policy\n                </Link>\n                <Link href=\"/terms\" className=\"text-gray-400 hover:text-white transition-colors\">\n                  Terms of Service\n                </Link>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","size_bytes":6367},"client/src/components/layout/header.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Button } from \"@/components/ui/button\";\nimport { useState } from \"react\";\nimport { BalanceDialog } from \"@/components/balance-dialog\";\nimport { ChatSidebar } from \"@/components/chat/ChatSidebar\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { User, ChevronDown, LogOut, UserPlus, LogIn, DollarSign, Shield, MessageSquare, Plus, Minus } from \"lucide-react\";\nexport default function Header() {\n  const { user, logoutMutation } = useAuth();\n  const { t, formatCurrency } = useUserPreferences();\n  const [balanceDialogOpen, setBalanceDialogOpen] = useState(false);\n  const [chatOpen, setChatOpen] = useState(false);\n  const [, navigate] = useLocation();\n\n  return (\n    <header className=\"fixed top-0 left-0 right-0 z-50 bg-background/98 backdrop-blur-md border-b border-border/50\">\n      <div className=\"container mx-auto px-4\">\n        <nav className=\"flex items-center justify-between h-16\">\n          {/* Left side - Logo - clicks to hub if authenticated, home if not */}\n          <div className=\"flex items-center space-x-4\">\n            <Link href={user ? \"/hub\" : \"/\"} className=\"flex items-center space-x-2 transition-all duration-200 hover:opacity-80\">\n              <div className=\"w-8 h-8 bg-primary rounded-lg flex items-center justify-center\">\n                <span className=\"text-primary-foreground font-bold text-sm\">O</span>\n              </div>\n              <span className=\"text-xl font-bold text-foreground\">ORSATH</span>\n            </Link>\n          </div>\n\n          {/* Right side - Clean user info and actions */}\n          <div className=\"flex items-center space-x-3\">\n            {user ? (\n              <>\n                {/* Balance Display - Clickable for balance management */}\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button variant=\"ghost\" className=\"flex items-center space-x-2 px-3 py-2 bg-muted/30 backdrop-blur-sm border border-border/50 rounded-md hover:bg-muted/50\">\n                      <DollarSign className=\"w-4 h-4 text-primary\" />\n                      <span className=\"text-sm font-semibold\">\n                        {formatCurrency(Number(user.siteCash) || 0)}\n                      </span>\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\" className=\"w-48\">\n                    <DropdownMenuItem onClick={() => navigate(\"/shop\")}>\n                      <Plus className=\"w-4 h-4 mr-2\" />\n                      {t('deposit')}\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onClick={() => navigate(\"/withdraw\")}>\n                      <Minus className=\"w-4 h-4 mr-2\" />\n                      {t('withdraw')}\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n\n                {/* Chat Button - only show for authenticated users */}\n                <Button\n                  onClick={() => setChatOpen(!chatOpen)}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"flex items-center space-x-2 px-3 py-2 hover:bg-muted/50 border border-border rounded-md\"\n                >\n                  <MessageSquare className=\"w-4 h-4\" />\n                  <span className=\"text-sm font-medium\">{t('chat')}</span>\n                </Button>\n\n                {/* User Menu with integrated balance */}\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button variant=\"ghost\" className=\"flex items-center space-x-2 px-3 py-2 hover:bg-muted/50 border border-border rounded-md\">\n                      <User className=\"w-4 h-4\" />\n                      <span className=\"text-sm font-medium\">\n                        {user?.username || \"User\"}\n                      </span>\n                      <ChevronDown className=\"w-4 h-4\" />\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\" className=\"w-48\">\n                    {(user?.subscriptionTier === 'administrator') && (\n                      <>\n                        <DropdownMenuSeparator />\n                        <Link href=\"/admin\">\n                          <DropdownMenuItem>\n                            <Shield className=\"w-4 h-4 mr-2\" />\n                            Admin Panel\n                          </DropdownMenuItem>\n                        </Link>\n                        <DropdownMenuSeparator />\n                      </>\n                    )}\n                    <DropdownMenuItem onClick={() => {\n                      logoutMutation.mutate();\n                    }}>\n                      <LogOut className=\"w-4 h-4 mr-2\" />\n                      {t('logout')}\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              </>\n            ) : (\n              <>\n                <Link href=\"/login\">\n                  <Button variant=\"ghost\" className=\"px-4 py-2 hover:bg-muted/50\">\n                    <LogIn className=\"w-4 h-4 mr-2\" />\n                    Log In\n                  </Button>\n                </Link>\n                <Link href=\"/signup\">\n                  <Button className=\"bg-primary hover:bg-primary/90 px-4 py-2\">\n                    <UserPlus className=\"w-4 h-4 mr-2\" />\n                    Sign Up\n                  </Button>\n                </Link>\n              </>\n            )}\n          </div>\n        </nav>\n      </div>\n      \n      {/* Balance Dialog */}\n      <BalanceDialog \n        open={balanceDialogOpen}\n        onOpenChange={setBalanceDialogOpen}\n        currentBalance={Number(user?.balance) || 0}\n      />\n\n      {/* Global Chat Sidebar */}\n      <ChatSidebar\n        isOpen={chatOpen}\n        onToggle={() => setChatOpen(!chatOpen)}\n      />\n    </header>\n  );\n}\n","size_bytes":6141},"client/src/components/layout/layout.tsx":{"content":"\nimport { useAuth } from \"@/hooks/use-auth\";\nimport Header from \"./header\";\nimport { SimplifiedSidebar } from \"./simplified-sidebar\";\n\n\ninterface LayoutProps {\n  children: React.ReactNode;\n}\n\nexport default function Layout({ children }: LayoutProps) {\n  const { user } = useAuth();\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <Header />\n\n      {/* Simplified Sidebar - Only for authenticated users */}\n      {user && <SimplifiedSidebar />}\n\n      {/* Main Content */}\n      <div className={`transition-all duration-300 ${\n        user ? 'ml-16' : ''\n      }`}>        \n        <main className=\"relative pt-16\">\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n}","size_bytes":722},"client/src/components/layout/sidebar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { \n  Home, \n  BarChart3, \n  Briefcase, \n  Trophy, \n  Users, \n  Crown, \n  Phone, \n  Menu,\n  X,\n  ShoppingBag,\n  Gift,\n  Target,\n  Swords\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { CodeRedemptionDialog } from \"@/components/code-redemption-dialog\";\n\ninterface SidebarProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function Sidebar({ isOpen, onClose }: SidebarProps) {\n  const { user } = useAuth();\n  const { t } = useUserPreferences();\n  const [location] = useLocation();\n  const [codeDialogOpen, setCodeDialogOpen] = useState(false);\n\n  const navItems = [\n    ...(user ? [\n      { href: \"/dashboard\", label: t('dashboard'), icon: BarChart3 },\n      { href: \"/tournaments\", label: t('tournaments'), icon: Swords },\n      { href: \"/leaderboard\", label: t('leaderboard'), icon: Trophy },\n      { href: \"/people\", label: t('people'), icon: Users },\n      { href: \"/shop\", label: \"Shop\", icon: ShoppingBag },\n      { href: \"/contact\", label: \"Support\", icon: Phone },\n    ] : [\n      { href: \"/contact\", label: \"Support\", icon: Phone },\n    ]),\n  ];\n\n  const isActive = (href: string) => {\n    if (href === \"/\" && location === \"/\") return true;\n    if (href !== \"/\" && location.startsWith(href)) return true;\n    return false;\n  };\n\n  return (\n    <div className={`fixed left-0 top-0 h-full z-40 transition-transform duration-300 ${\n      isOpen ? 'translate-x-0' : '-translate-x-full'\n    }`}>\n      <div className=\"w-64 h-full backdrop-blur-xl bg-background/80 border-r border-border/50 flex flex-col shadow-2xl\">\n        {/* Sidebar Header */}\n        <div className=\"flex items-center justify-between p-4 border-b border-border/50 backdrop-blur-sm\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-8 h-8 gradient-primary rounded-lg flex items-center justify-center neon-glow\">\n              <span className=\"text-primary-foreground font-bold text-sm\">O</span>\n            </div>\n            <span className=\"text-lg font-bold gradient-text\">ORSATH</span>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={onClose}\n            className=\"hover-lift\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Navigation Items */}\n        <nav className=\"p-4 space-y-2 flex-1 backdrop-blur-sm\">\n          {navItems.map((item) => (\n            <Link\n              key={item.href}\n              href={item.href}\n              onClick={onClose}\n              className={`sidebar-nav-item flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-300 hover-lift backdrop-blur-sm ${\n                isActive(item.href)\n                  ? \"bg-primary/20 text-primary border border-primary/30 font-semibold shadow-lg\"\n                  : \"text-muted-foreground hover:text-foreground hover:bg-muted/20 hover:backdrop-blur-md\"\n              }`}\n            >\n              <item.icon className=\"w-5 h-5\" />\n              <span>{item.label}</span>\n            </Link>\n          ))}\n        </nav>\n\n        {/* Code Redemption Button - Only for authenticated users */}\n        {user && (\n          <div className=\"p-4 border-t border-border/50 backdrop-blur-sm\">\n            <Button\n              onClick={() => setCodeDialogOpen(true)}\n              className=\"w-full bg-gradient-to-r from-purple-500/80 to-pink-500/80 hover:from-purple-600/90 hover:to-pink-600/90 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 hover-lift backdrop-blur-md border border-purple-300/20 shadow-lg\"\n              size=\"lg\"\n            >\n              <div className=\"flex items-center justify-center space-x-2\">\n                <Gift className=\"w-5 h-5\" />\n                <span>Redeem Code</span>\n              </div>\n            </Button>\n          </div>\n        )}\n\n        {/* Code Redemption Dialog */}\n        <CodeRedemptionDialog \n          open={codeDialogOpen}\n          onOpenChange={setCodeDialogOpen}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport function SidebarTrigger({ onOpen }: { onOpen: () => void }) {\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={onOpen}\n      className=\"hover-lift neon-glow\"\n    >\n      <Menu className=\"w-5 h-5\" />\n    </Button>\n  );\n}","size_bytes":4583},"client/src/components/layout/simplified-sidebar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Button } from \"@/components/ui/button\";\nimport { \n  Home, \n  BarChart3, \n  Briefcase, \n  Trophy, \n  Users, \n  Phone,\n  ShoppingBag,\n  Gift,\n  Settings,\n  Archive,\n  Shield,\n  Calendar,\n  Target,\n  Swords\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { CodeRedemptionDialog } from \"@/components/code-redemption-dialog\";\n\nexport function SimplifiedSidebar() {\n  const { user } = useAuth();\n  const { t } = useUserPreferences();\n  const [location] = useLocation();\n  const [expanded, setExpanded] = useState(false);\n  const [codeDialogOpen, setCodeDialogOpen] = useState(false);\n\n  const navItems = [\n    ...(user ? [\n      { href: \"/dashboard\", label: t('dashboard'), icon: BarChart3 },\n      { href: \"/tournaments\", label: t('tournaments'), icon: Swords },\n      { href: \"/leaderboard\", label: t('leaderboard'), icon: Trophy },\n      { href: \"/people\", label: t('people'), icon: Users },\n      { href: \"/events\", label: t('events'), icon: Calendar },\n      { href: \"/shop\", label: t('shop'), icon: ShoppingBag },\n      { href: \"/contact\", label: t('support'), icon: Phone },\n    ] : [\n      { href: \"/contact\", label: t('support'), icon: Phone },\n    ]),\n  ];\n\n  const userItems = user ? [\n    { href: \"/profile\", label: t('settings'), icon: Settings },\n    { href: \"/archive\", label: t('archive'), icon: Archive },\n    ...(user.subscriptionTier === 'administrator' ? [\n      { href: \"/admin\", label: t('admin'), icon: Shield }\n    ] : [])\n  ] : [];\n\n  const isActive = (href: string) => {\n    if (href === \"/\" && location === \"/\") return true;\n    if (href !== \"/\" && location.startsWith(href)) return true;\n    return false;\n  };\n\n  return (\n    <>\n      {/* Simplified Always-Visible Sidebar */}\n      <div \n        className={`fixed left-0 top-16 h-[calc(100vh-4rem)] bg-background/90 backdrop-blur-md border-r border-border/50 z-30 transition-all duration-300 ease-in-out ${\n          expanded ? 'w-64' : 'w-16'\n        }`}\n        onMouseEnter={() => setExpanded(true)}\n        onMouseLeave={() => setExpanded(false)}\n      >\n        {/* Navigation Items */}\n        <nav className=\"p-3 space-y-2\">\n          {navItems.map((item) => (\n            <Link\n              key={item.href}\n              href={item.href}\n              className={`group flex items-center px-3 py-3 rounded-lg transition-all duration-200 ${\n                isActive(item.href)\n                  ? \"bg-primary/10 text-primary border border-primary/20\"\n                  : \"text-muted-foreground hover:text-foreground hover:bg-muted/50\"\n              }`}\n            >\n              <item.icon className={`w-5 h-5 ${expanded ? 'mr-3' : ''}`} />\n              {expanded && (\n                <span className=\"text-sm font-medium whitespace-nowrap\">\n                  {item.label}\n                </span>\n              )}\n            </Link>\n          ))}\n        </nav>\n\n        {/* Separator */}\n        {user && (\n          <div className=\"mx-3 my-3 h-px bg-border\" />\n        )}\n\n        {/* User Actions */}\n        {user && (\n          <nav className=\"p-3 space-y-2\">\n            {userItems.map((item) => (\n              <Link\n                key={item.href}\n                href={item.href}\n                className={`group flex items-center px-3 py-3 rounded-lg transition-all duration-200 ${\n                  isActive(item.href)\n                    ? \"bg-primary/10 text-primary border border-primary/20\"\n                    : \"text-muted-foreground hover:text-foreground hover:bg-muted/50\"\n                }`}\n              >\n                <item.icon className={`w-5 h-5 ${expanded ? 'mr-3' : ''}`} />\n                {expanded && (\n                  <span className=\"text-sm font-medium whitespace-nowrap\">\n                    {item.label}\n                  </span>\n                )}\n              </Link>\n            ))}\n          </nav>\n        )}\n\n        {/* Code Redemption - Bottom */}\n        {user && (\n          <div className=\"absolute bottom-4 left-3 right-3\">\n            <Button\n              onClick={() => setCodeDialogOpen(true)}\n              className={`w-full transition-all duration-200 ${\n                expanded \n                  ? 'bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-4 py-2'\n                  : 'bg-gradient-to-br from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white p-3 aspect-square'\n              }`}\n              size={expanded ? \"default\" : \"icon\"}\n            >\n              {expanded ? (\n                <div className=\"flex items-center justify-center space-x-2\">\n                  <Gift className=\"w-4 h-4\" />\n                  <span className=\"text-sm font-medium\">Redeem Code</span>\n                </div>\n              ) : (\n                <Gift className=\"w-4 h-4\" />\n              )}\n            </Button>\n          </div>\n        )}\n\n        {/* Code Redemption Dialog */}\n        <CodeRedemptionDialog \n          open={codeDialogOpen}\n          onOpenChange={setCodeDialogOpen}\n        />\n      </div>\n\n      {/* Main Content Spacing */}\n      <div className={`transition-all duration-300 ${expanded ? 'ml-64' : 'ml-16'}`} />\n    </>\n  );\n}","size_bytes":5352},"client/src/components/portfolio/PortfolioGrid.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\n// Import widget components\nimport { PerformanceChart } from \"./widgets/PerformanceChart\";\nimport { PortfolioHoldingsWidget } from \"./widgets/PortfolioHoldingsWidget\";\nimport { StockSearchBar } from \"../trading/StockSearchBar\";\nimport { ShoppingCart } from \"lucide-react\";\n\ninterface PortfolioGridProps {\n  selectedChartStock?: string | null;\n  onSelectStock?: (symbol: string) => void;\n}\n\nexport function PortfolioGrid({ selectedChartStock, onSelectStock }: PortfolioGridProps = {}) {\n  return (\n    <div className=\"w-full space-y-6\">\n      {/* Portfolio Performance Chart with Summary in Header - Full Width */}\n      <Card className=\"w-full min-h-[500px]\">\n        <PerformanceChart selectedStock={selectedChartStock} />\n      </Card>\n\n      {/* Stock Purchase Search */}\n      <Card className=\"w-full\">\n        <CardHeader className=\"pb-3\">\n          <CardTitle className=\"text-sm flex items-center space-x-2\">\n            <ShoppingCart className=\"w-4 h-4\" />\n            <span>Buy Stocks</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <StockSearchBar type=\"purchase\" placeholder=\"Search stocks to buy...\" />\n        </CardContent>\n      </Card>\n\n      {/* Current Holdings */}\n      <Card className=\"w-full min-h-[400px]\">\n        <PortfolioHoldingsWidget onSelectStock={onSelectStock} />\n      </Card>\n    </div>\n  );\n}","size_bytes":1444},"client/src/components/profile/ProfilePictureUpload.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Label } from \"@/components/ui/label\";\nimport { User, Upload, X } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport function ProfilePictureUpload() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(user?.profilePicture || null);\n\n  // Update profile picture mutation\n  const updateProfilePictureMutation = useMutation({\n    mutationFn: async (profilePicture: string) => {\n      return await apiRequest(\"PATCH\", \"/api/profile/picture\", { profilePicture });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      toast({\n        title: \"Success\",\n        description: \"Profile picture updated successfully!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"Error\",\n        description: \"Please select a valid image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Validate file size (5MB limit)\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"Error\",\n        description: \"Image file must be smaller than 5MB\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const base64 = e.target?.result as string;\n      setPreviewUrl(base64);\n      updateProfilePictureMutation.mutate(base64);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleRemovePhoto = () => {\n    setPreviewUrl(null);\n    updateProfilePictureMutation.mutate(\"\");\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Profile Picture</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"flex items-center space-x-4\">\n          {/* Profile Picture Preview */}\n          <div className=\"w-20 h-20 rounded-full bg-muted flex items-center justify-center overflow-hidden border-2 border-border\">\n            {previewUrl ? (\n              <img \n                src={previewUrl} \n                alt=\"Profile\" \n                className=\"w-full h-full object-cover\"\n              />\n            ) : (\n              <User className=\"w-8 h-8 text-muted-foreground\" />\n            )}\n          </div>\n\n          {/* Upload Controls */}\n          <div className=\"flex-1 space-y-2\">\n            <Label className=\"text-sm font-medium\">Upload a new profile picture</Label>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                onChange={handleFileSelect}\n                className=\"hidden\"\n              />\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => fileInputRef.current?.click()}\n                disabled={updateProfilePictureMutation.isPending}\n              >\n                <Upload className=\"w-4 h-4 mr-2\" />\n                {updateProfilePictureMutation.isPending ? \"Uploading...\" : \"Choose File\"}\n              </Button>\n              \n              {previewUrl && (\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleRemovePhoto}\n                  disabled={updateProfilePictureMutation.isPending}\n                >\n                  <X className=\"w-4 h-4 mr-2\" />\n                  Remove\n                </Button>\n              )}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Recommended: Square image, max 5MB. Supports JPG, PNG, GIF.\n            </p>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":4601},"client/src/components/sections/about.tsx":{"content":"import { CheckCircle } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport default function About() {\n  const features = [\n    \"Zero financial risk - trade with virtual money\",\n    \"Real market data and live stock prices\",\n    \"Achievement system with unlockable badges\",\n    \"Competitive leaderboards and rankings\",\n    \"Personal portfolio tracking and analytics\",\n    \"Tournament system with automated expiration\",\n  ];\n\n  return (\n    <section className=\"py-20 bg-background\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"grid md:grid-cols-2 gap-12 items-center\">\n            <motion.div\n              initial={{ opacity: 0, x: -50 }}\n              whileInView={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.6 }}\n              viewport={{ once: true }}\n            >\n              <h2 className=\"text-4xl font-bold text-foreground mb-6\">Why Choose Our Platform</h2>\n              <p className=\"text-muted-foreground mb-6\">\n                Master the art of trading without risking real money. Join competitive tournaments, \n                track your progress through achievements, and climb the leaderboards while learning \n                from experienced traders in a completely safe environment.\n              </p>\n              <div className=\"space-y-4\">\n                {features.map((feature, index) => (\n                  <div key={index} className=\"flex items-center space-x-3\">\n                    <CheckCircle className=\"text-primary w-5 h-5 flex-shrink-0\" />\n                    <span className=\"text-foreground\">{feature}</span>\n                  </div>\n                ))}\n              </div>\n            </motion.div>\n            \n            <motion.div\n              initial={{ opacity: 0, x: 50 }}\n              whileInView={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.6 }}\n              viewport={{ once: true }}\n            >\n              <div className=\"bg-card rounded-lg p-6 h-[480px]\">\n                <h3 className=\"text-lg font-semibold mb-4 text-foreground\">Platform Stats</h3>\n                <div className=\"space-y-5\">\n                  <div className=\"text-center\">\n                    <div className=\"text-3xl font-bold text-primary mb-2\">8,000+</div>\n                    <div className=\"text-sm text-muted-foreground\">Tracked Equities</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-3xl font-bold text-primary mb-2\">3</div>\n                    <div className=\"text-sm text-muted-foreground\">Real-time Leaderboards</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-3xl font-bold text-primary mb-2\">24/7</div>\n                    <div className=\"text-sm text-muted-foreground\">Platform Availability</div>\n                  </div>\n                  <div className=\"text-center border-t pt-4\">\n                    <div className=\"text-lg font-semibold text-foreground mb-2\">Market Data Updates</div>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-center text-sm\">\n                        <span className=\"text-primary font-medium\">Real-time updates for all users</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","size_bytes":3540},"client/src/components/sections/hero.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Play } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport default function Hero() {\n  // Generate realistic stock chart with candlestick-like movement\n  const generateStockChart = () => {\n    const points = [];\n    const candlesticks = [];\n    const width = 1200;\n    const height = 600;\n    const segments = 80;\n    \n    let basePrice = height * 0.6; // Start at 60% from top\n    let currentPrice = basePrice;\n    \n    for (let i = 0; i <= segments; i++) {\n      const x = (i / segments) * width;\n      \n      // Generate more realistic stock movement\n      const volatility = 25;\n      const trend = Math.sin(i * 0.1) * 10; // Gentle wave trend\n      const randomChange = (Math.random() - 0.5) * volatility;\n      \n      currentPrice += randomChange + trend * 0.3;\n      currentPrice = Math.max(height * 0.15, Math.min(height * 0.85, currentPrice));\n      \n      points.push(`${x},${currentPrice}`);\n      \n      // Add candlestick data for volume bars\n      if (i % 4 === 0) {\n        candlesticks.push({\n          x: x,\n          height: Math.random() * 40 + 10,\n          y: height - 80\n        });\n      }\n    }\n    \n    return { \n      path: `M ${points.join(' L ')}`,\n      candlesticks: candlesticks\n    };\n  };\n\n  const { path: chartPath, candlesticks } = generateStockChart();\n\n  return (\n    <section className=\"relative py-20 bg-background overflow-hidden\">\n      {/* Large Background Stock Chart */}\n      <div className=\"absolute inset-0 opacity-40\">\n        <svg\n          className=\"w-full h-full scale-110 transform rotate-1\"\n          viewBox=\"0 0 1200 600\"\n          preserveAspectRatio=\"xMidYMid slice\"\n        >\n          <defs>\n            <linearGradient id=\"chartGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stopColor=\"hsl(142, 76%, 36%)\" stopOpacity=\"0.6\" />\n              <stop offset=\"30%\" stopColor=\"hsl(142, 76%, 46%)\" stopOpacity=\"0.8\" />\n              <stop offset=\"70%\" stopColor=\"hsl(51, 100%, 50%)\" stopOpacity=\"0.7\" />\n              <stop offset=\"100%\" stopColor=\"hsl(200, 100%, 50%)\" stopOpacity=\"0.5\" />\n            </linearGradient>\n            <linearGradient id=\"fillGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n              <stop offset=\"0%\" stopColor=\"hsl(142, 76%, 36%)\" stopOpacity=\"0.3\" />\n              <stop offset=\"100%\" stopColor=\"hsl(240, 10%, 8%)\" stopOpacity=\"0.1\" />\n            </linearGradient>\n            <linearGradient id=\"volumeGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n              <stop offset=\"0%\" stopColor=\"hsl(51, 100%, 50%)\" stopOpacity=\"0.4\" />\n              <stop offset=\"100%\" stopColor=\"hsl(142, 76%, 36%)\" stopOpacity=\"0.2\" />\n            </linearGradient>\n          </defs>\n          \n          {/* Grid system */}\n          <g opacity=\"0.15\">\n            {Array.from({ length: 8 }, (_, i) => (\n              <line\n                key={`h-${i}`}\n                x1=\"0\"\n                y1={i * 75}\n                x2=\"1200\"\n                y2={i * 75}\n                stroke=\"#3b82f6\"\n                strokeWidth=\"1\"\n                strokeDasharray=\"5,5\"\n              />\n            ))}\n            {Array.from({ length: 13 }, (_, i) => (\n              <line\n                key={`v-${i}`}\n                x1={i * 100}\n                y1=\"0\"\n                x2={i * 100}\n                y2=\"600\"\n                stroke=\"#3b82f6\"\n                strokeWidth=\"1\"\n                strokeDasharray=\"5,5\"\n              />\n            ))}\n          </g>\n          \n          {/* Volume bars */}\n          <g opacity=\"0.3\">\n            {candlesticks.map((bar, i) => (\n              <rect\n                key={`vol-${i}`}\n                x={bar.x - 8}\n                y={bar.y}\n                width=\"16\"\n                height={bar.height}\n                fill=\"url(#volumeGradient)\"\n                rx=\"2\"\n              />\n            ))}\n          </g>\n          \n          {/* Chart area fill */}\n          <path\n            d={`${chartPath} L 1200,600 L 0,600 Z`}\n            fill=\"url(#fillGradient)\"\n          />\n          \n          {/* Main chart line with glow */}\n          <path\n            d={chartPath}\n            fill=\"none\"\n            stroke=\"url(#chartGradient)\"\n            strokeWidth=\"4\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            filter=\"drop-shadow(0 0 8px rgba(34, 197, 94, 0.5))\"\n          />\n          \n          {/* Price points */}\n          <g opacity=\"0.6\">\n            {chartPath.split(' L ').slice(0, -1).map((point, i) => {\n              if (i % 8 === 0) {\n                const [x, y] = point.replace('M ', '').split(',').map(Number);\n                return (\n                  <circle\n                    key={`point-${i}`}\n                    cx={x}\n                    cy={y}\n                    r=\"3\"\n                    fill=\"hsl(142, 76%, 36%)\"\n                    stroke=\"hsl(51, 100%, 50%)\"\n                    strokeWidth=\"1\"\n                  />\n                );\n              }\n              return null;\n            })}\n          </g>\n        </svg>\n      </div>\n\n      <div className=\"container mx-auto px-4 relative z-10\">\n        <div className=\"max-w-4xl mx-auto text-center\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n          >\n            <div className=\"mb-6\">\n              <h1 className=\"text-5xl md:text-6xl font-bold text-foreground mb-4\">\n                Compete. Trade. Win.\n              </h1>\n              <p className=\"text-2xl md:text-3xl text-muted-foreground\">\n                No risk, all reward.\n              </p>\n            </div>\n            <p className=\"text-xl text-muted-foreground mb-8 max-w-2xl mx-auto\">\n              Compete with traders worldwide using virtual portfolios and real market data.\n              Test your skills, climb the leaderboards, and win prizes.\n            </p>\n            <div className=\"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4 animate-slide-up\">\n              <Button\n                size=\"lg\"\n                className=\"btn-primary hover-lift neon-glow animate-pulse-slow\"\n                onClick={() => window.location.href = \"/signup\"}\n              >\n                🚀 Start Trading\n              </Button>\n              <Button variant=\"ghost\" size=\"lg\" className=\"btn-secondary hover-lift\">\n                <Play className=\"w-5 h-5 mr-2\" />\n                Watch Demo\n              </Button>\n            </div>\n          </motion.div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","size_bytes":6680},"client/src/components/tournaments/TournamentCreationDialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { \n  Trophy,\n  Users,\n  DollarSign,\n  Clock,\n  Shield,\n  Globe,\n  TrendingUp,\n  Bitcoin,\n  Timer,\n  Crown,\n  Info,\n  Gift\n} from \"lucide-react\";\nimport { \n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\n\ninterface TournamentCreationDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst DURATION_OPTIONS = [\n  { value: \"1 day\", label: \"1 Day\" },\n  { value: \"3 days\", label: \"3 Days\" },\n  { value: \"1 week\", label: \"1 Week\" },\n  { value: \"2 weeks\", label: \"2 Weeks\" },\n  { value: \"1 month\", label: \"1 Month\" },\n];\n\nconst START_DELAY_OPTIONS = [\n  { value: \"10 minutes\", label: \"10 Minutes\" },\n  { value: \"30 minutes\", label: \"30 Minutes\" },\n  { value: \"1 hour\", label: \"1 Hour\" },\n  { value: \"2 hours\", label: \"2 Hours\" },\n  { value: \"6 hours\", label: \"6 Hours\" },\n  { value: \"12 hours\", label: \"12 Hours\" },\n  { value: \"1 day\", label: \"1 Day\" },\n  { value: \"3 days\", label: \"3 Days\" },\n  { value: \"1 week\", label: \"1 Week\" },\n];\n\n// Info tooltip component\nconst InfoTooltip = ({ content }: { content: string }) => (\n  <TooltipProvider>\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <Info className=\"w-4 h-4 text-muted-foreground hover:text-foreground cursor-help\" />\n      </TooltipTrigger>\n      <TooltipContent side=\"top\" className=\"max-w-xs\">\n        <p className=\"text-sm\">{content}</p>\n      </TooltipContent>\n    </Tooltip>\n  </TooltipProvider>\n);\n\nexport function TournamentCreationDialog({ isOpen, onClose }: TournamentCreationDialogProps) {\n  const { user } = useAuth();\n  const { formatCurrency, t } = useUserPreferences();\n  const { toast } = useToast();\n\n  // Tournament form state - exactly 7 options as specified\n  const [formData, setFormData] = useState({\n    name: \"\", // 1. Tournament title\n    maxPlayers: 10, // 2. Max amount of players\n    tournamentType: \"stocks\", // 3. Stock or Crypto tournament\n    startingBalance: 10000, // 4. Starting Fake Cash amount\n    duration: \"1 week\", // 5. Duration of the tournament\n    startDelay: \"10 minutes\", // 6. In how many minutes, hours, or days the tournament will start (min 10 minutes)\n    isPublic: true, // 7. Private or Public\n    buyInAmount: 0, // Buy-in amount\n    agreeToTerms: false // Terms of service agreement\n  });\n\n  const [errors, setErrors] = useState<{[key: string]: string}>({});\n\n  // Create tournament mutation\n  const createTournamentMutation = useMutation({\n    mutationFn: async (data: typeof formData) => {\n      const res = await apiRequest(\"POST\", \"/api/tournaments\", {\n        name: data.name,\n        maxPlayers: data.maxPlayers,\n        tournamentType: data.tournamentType,\n        startingBalance: data.startingBalance,\n        duration: data.duration,\n        scheduledStartTime: new Date(Date.now() + (\n          data.startDelay === '10 minutes' ? 10 * 60 * 1000 :\n          data.startDelay === '30 minutes' ? 30 * 60 * 1000 : \n          data.startDelay === '1 hour' ? 60 * 60 * 1000 :\n          data.startDelay === '2 hours' ? 2 * 60 * 60 * 1000 :\n          data.startDelay === '6 hours' ? 6 * 60 * 60 * 1000 :\n          data.startDelay === '12 hours' ? 12 * 60 * 60 * 1000 :\n          data.startDelay === '1 day' ? 24 * 60 * 60 * 1000 :\n          data.startDelay === '3 days' ? 3 * 24 * 60 * 60 * 1000 :\n          7 * 24 * 60 * 60 * 1000 // 1 week default\n        )).toISOString(),\n        buyInAmount: data.buyInAmount,\n        isPublic: data.isPublic\n      });\n      return res.json();\n    },\n    onSuccess: () => {\n      onClose();\n      setFormData({\n        name: \"\",\n        maxPlayers: 10,\n        tournamentType: \"stocks\",\n        startingBalance: 10000,\n        duration: \"1 week\",\n        startDelay: \"10 minutes\",\n        isPublic: true,\n        buyInAmount: 0,\n        agreeToTerms: false\n      });\n      setErrors({});\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments/public\"] });\n      toast({\n        title: \"Success\",\n        description: \"Tournament created successfully!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const validateForm = () => {\n    const newErrors: {[key: string]: string} = {};\n\n    if (!formData.name.trim()) {\n      newErrors.name = \"Tournament title is required\";\n    }\n\n    if (formData.maxPlayers < 2) {\n      newErrors.maxPlayers = \"Minimum 2 players required\";\n    }\n\n    if (formData.maxPlayers > 50) {\n      newErrors.maxPlayers = \"Maximum 50 players allowed\";\n    }\n\n    if (formData.startingBalance < 1000) {\n      newErrors.startingBalance = \"Minimum starting balance is $1,000\";\n    }\n\n    if (formData.startingBalance > 1000000) {\n      newErrors.startingBalance = \"Maximum starting balance is $1,000,000\";\n    }\n\n    // Buy-in validation\n    if (formData.buyInAmount > 0) {\n      const userBalance = parseFloat(user?.siteCash?.toString() || '0');\n      if (formData.buyInAmount > userBalance) {\n        newErrors.buyInAmount = `Insufficient funds. You need $${formData.buyInAmount.toFixed(2)} but only have $${userBalance.toFixed(2)} in your account.`;\n      }\n    }\n\n    if (!formData.agreeToTerms) {\n      newErrors.agreeToTerms = \"You must agree to the terms of service\";\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = () => {\n    if (validateForm()) {\n      createTournamentMutation.mutate(formData);\n    }\n  };\n\n  const updateField = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: \"\" }));\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center space-x-2\">\n            <Trophy className=\"w-5 h-5 text-yellow-500\" />\n            <span>Create New Tournament</span>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n\n\n          {/* 1. Tournament Title */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Label htmlFor=\"tournament-name\" className=\"text-sm font-medium\">\n                Tournament Title\n              </Label>\n              <InfoTooltip content=\"Choose a unique and descriptive name for your tournament that participants will see when browsing.\" />\n            </div>\n            <Input\n              id=\"tournament-name\"\n              placeholder=\"Enter tournament name...\"\n              value={formData.name}\n              onChange={(e) => updateField(\"name\", e.target.value)}\n              className={errors.name ? \"border-red-500\" : \"\"}\n            />\n            {errors.name && <p className=\"text-sm text-red-500\">{errors.name}</p>}\n          </div>\n\n          {/* 2. Max Players */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Label htmlFor=\"max-players\" className=\"text-sm font-medium\">\n                Maximum Players\n              </Label>\n              <InfoTooltip content=\"Set the maximum number of participants (2-50). Tournament starts when this limit is reached or manually started.\" />\n            </div>\n            <Input\n              id=\"max-players\"\n              type=\"number\"\n              min=\"2\"\n              max=\"50\"\n              value={formData.maxPlayers}\n              onChange={(e) => updateField(\"maxPlayers\", parseInt(e.target.value) || 2)}\n              className={errors.maxPlayers ? \"border-red-500\" : \"\"}\n            />\n            {errors.maxPlayers && <p className=\"text-sm text-red-500\">{errors.maxPlayers}</p>}\n          </div>\n\n          {/* 3. Tournament Type */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Label className=\"text-sm font-medium\">Tournament Type</Label>\n              <InfoTooltip content=\"Stocks: Trade traditional stock markets during market hours. Crypto: Trade cryptocurrencies 24/7.\" />\n            </div>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Card \n                className={`cursor-pointer transition-all ${\n                  formData.tournamentType === \"stocks\" \n                    ? \"ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-950/20\" \n                    : \"hover:bg-muted/50\"\n                }`}\n                onClick={() => updateField(\"tournamentType\", \"stocks\")}\n              >\n                <CardContent className=\"flex items-center space-x-3 p-4\">\n                  <TrendingUp className=\"w-5 h-5 text-blue-600\" />\n                  <div>\n                    <p className=\"font-medium\">Stocks</p>\n                    <p className=\"text-sm text-muted-foreground\">Trade stock markets</p>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card \n                className={`cursor-pointer transition-all ${\n                  formData.tournamentType === \"crypto\" \n                    ? \"ring-2 ring-orange-500 bg-orange-50 dark:bg-orange-950/20\" \n                    : \"hover:bg-muted/50\"\n                }`}\n                onClick={() => updateField(\"tournamentType\", \"crypto\")}\n              >\n                <CardContent className=\"flex items-center space-x-3 p-4\">\n                  <Bitcoin className=\"w-5 h-5 text-orange-600\" />\n                  <div>\n                    <p className=\"font-medium\">Crypto</p>\n                    <p className=\"text-sm text-muted-foreground\">Trade cryptocurrencies</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* 4. Starting Cash */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Label htmlFor=\"starting-balance\" className=\"text-sm font-medium\">\n                Starting Fake Money\n              </Label>\n              <InfoTooltip content=\"Virtual currency amount each participant starts with. This is paper money for practice trading - no real money involved.\" />\n            </div>\n            <Input\n              id=\"starting-balance\"\n              type=\"number\"\n              min=\"1000\"\n              max=\"1000000\"\n              step=\"1000\"\n              value={formData.startingBalance}\n              onChange={(e) => updateField(\"startingBalance\", parseInt(e.target.value) || 10000)}\n              className={errors.startingBalance ? \"border-red-500\" : \"\"}\n            />\n            <p className=\"text-sm text-muted-foreground\">\n              Amount: {formatCurrency(formData.startingBalance)}\n            </p>\n            {errors.startingBalance && <p className=\"text-sm text-red-500\">{errors.startingBalance}</p>}\n          </div>\n\n          {/* 5. Duration */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Label className=\"text-sm font-medium\">Tournament Duration</Label>\n              <InfoTooltip content=\"How long the tournament will run. Participants can trade within this timeframe to compete.\" />\n            </div>\n            <Select value={formData.duration} onValueChange={(value) => updateField(\"duration\", value)}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {DURATION_OPTIONS.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 6. Start Delay */}\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Label className=\"text-sm font-medium\">Tournament Start Time</Label>\n              <InfoTooltip content=\"When the tournament will begin. Minimum delay is 10 minutes to allow for proper setup and participant registration.\" />\n            </div>\n            <Select value={formData.startDelay} onValueChange={(value) => updateField(\"startDelay\", value)}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {START_DELAY_OPTIONS.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 7. Privacy Setting */}\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center space-x-2\">\n              <Label className=\"text-sm font-medium\">Tournament Visibility</Label>\n              <InfoTooltip content=\"Public: Anyone can find and join. Private: Only people with the join code can participate. Private tournaments give you more control.\" />\n            </div>\n            <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n              <div className=\"flex items-center space-x-3\">\n                {formData.isPublic ? (\n                  <Globe className=\"w-5 h-5 text-green-600\" />\n                ) : (\n                  <Shield className=\"w-5 h-5 text-blue-600\" />\n                )}\n                <div>\n                  <p className=\"font-medium\">\n                    {formData.isPublic ? \"Public Tournament\" : \"Private Tournament\"}\n                  </p>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {formData.isPublic \n                      ? \"Anyone can join this tournament\" \n                      : \"Only users with invite code can join\"\n                    }\n                  </p>\n                </div>\n              </div>\n              <Switch\n                checked={formData.isPublic}\n                onCheckedChange={(checked) => updateField(\"isPublic\", checked)}\n              />\n            </div>\n\n            {/* Creator Powers Notice */}\n            {!formData.isPublic && (\n              <div className=\"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg\">\n                <p className=\"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1\">\n                  Private Tournament Creator Powers:\n                </p>\n                <ul className=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\n                  <li>• Kick participants before tournament starts</li>\n                  <li>• Start tournament early</li>\n                  <li>• Cancel tournament (only before it starts)</li>\n                </ul>\n              </div>\n            )}\n          </div>\n\n          {/* Buy-in Amount Section */}\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center space-x-2\">\n              <Label htmlFor=\"buy-in-amount\" className=\"text-sm font-medium\">\n                Buy-in Amount (Optional)\n              </Label>\n              <InfoTooltip content=\"Optional entry fee that creates a prize pool. Participants pay this amount to join, and the platform takes a 5% commission.\" />\n            </div>\n            <Input\n              id=\"buy-in-amount\"\n              type=\"number\"\n              min=\"0\"\n              step=\"0.01\"\n              value={formData.buyInAmount}\n              onChange={(e) => updateField(\"buyInAmount\", parseFloat(e.target.value) || 0)}\n              placeholder=\"0.00\"\n              className={errors.buyInAmount ? \"border-red-500\" : \"\"}\n            />\n            {errors.buyInAmount && (\n              <p className=\"text-sm text-red-500\">{errors.buyInAmount}</p>\n            )}\n            <p className=\"text-sm text-muted-foreground\">\n              Entry Fee: {formatCurrency(formData.buyInAmount)} {formData.buyInAmount > 0 && `(Prize Pool: ${formatCurrency(formData.buyInAmount * formData.maxPlayers * 0.95)})`}\n            </p>\n\n            {/* Buy-in Incentive Box */}\n            {formData.buyInAmount > 0 && (\n              <div className=\"p-4 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                <div className=\"flex items-center space-x-2 mb-2\">\n                  <Gift className=\"w-5 h-5 text-green-600\" />\n                  <p className=\"text-sm font-medium text-green-800 dark:text-green-200\">\n                    Buy-in Tournament Benefits\n                  </p>\n                </div>\n                <ul className=\"text-sm text-green-700 dark:text-green-300 space-y-1\">\n                  <li>• Creates competitive prize pool for winners</li>\n                  <li>• Attracts more serious traders</li>\n                  <li>• Platform takes only 5% commission</li>\n                  <li>• Winner takes 95% of total prize pool</li>\n                </ul>\n                <div className=\"mt-3 p-2 bg-green-100 dark:bg-green-900/30 rounded text-xs text-green-800 dark:text-green-200\">\n                  <strong>Prize Breakdown:</strong> Total pot: {formatCurrency(formData.buyInAmount * formData.maxPlayers)} → Winner gets: {formatCurrency(formData.buyInAmount * formData.maxPlayers * 0.95)} (Platform fee: {formatCurrency(formData.buyInAmount * formData.maxPlayers * 0.05)})\n                </div>\n              </div>\n            )}\n          </div>\n\n          <Separator />\n\n          {/* Terms of Service Agreement */}\n          <div className=\"space-y-3\">\n            <div className=\"flex items-start space-x-3 p-4 border rounded-lg\">\n              <Checkbox\n                id=\"agree-terms\"\n                checked={formData.agreeToTerms}\n                onCheckedChange={(checked) => updateField(\"agreeToTerms\", checked)}\n                className=\"mt-0.5\"\n              />\n              <div className=\"flex-1\">\n                <Label \n                  htmlFor=\"agree-terms\" \n                  className=\"text-sm font-medium cursor-pointer\"\n                >\n                  I agree to the Terms of Service\n                </Label>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  By creating this tournament, you agree to our platform rules, fair play policies, and understand that this is virtual trading with no real money risk.\n                </p>\n              </div>\n            </div>\n            {errors.agreeToTerms && <p className=\"text-sm text-red-500\">{errors.agreeToTerms}</p>}\n          </div>\n\n          {/* Submit Button */}\n          <div className=\"flex justify-end space-x-3\">\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              disabled={createTournamentMutation.isPending}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={createTournamentMutation.isPending || !formData.agreeToTerms}\n              className=\"bg-blue-600 hover:bg-blue-700 disabled:opacity-50\"\n            >\n              {createTournamentMutation.isPending ? \"Creating...\" : \"Create Tournament\"}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":20164},"client/src/components/tournaments/TournamentLeaderboard.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trophy, Crown, Medal, Award, User, Eye, TrendingUp, TrendingDown } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { motion } from \"framer-motion\";\n\ninterface TournamentLeaderboardProps {\n  tournamentId: number;\n  onViewFullLeaderboard?: () => void;\n}\n\nexport function TournamentLeaderboard({ tournamentId, onViewFullLeaderboard }: TournamentLeaderboardProps) {\n  const { formatCurrency, t } = useUserPreferences();\n\n  // Fetch tournament leaderboard data\n  const { data: leaderboardData, isLoading } = useQuery<{success: boolean; participants: any[]}>({\n    queryKey: ['/api/tournaments', tournamentId, 'leaderboard'],\n    enabled: !!tournamentId,\n    refetchInterval: 10000, // Refresh every 10 seconds for real-time updates\n  });\n\n  const participants = leaderboardData?.participants || [];\n  const topParticipants = participants.slice(0, 5); // Show top 5 participants\n\n  const getRankIcon = (position: number) => {\n    switch (position) {\n      case 1:\n        return <Crown className=\"w-4 h-4 text-yellow-500\" />;\n      case 2:\n        return <Medal className=\"w-4 h-4 text-gray-400\" />;\n      case 3:\n        return <Award className=\"w-4 h-4 text-amber-600\" />;\n      default:\n        return <span className=\"w-4 h-4 flex items-center justify-center text-xs font-bold text-muted-foreground\">#{position}</span>;\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardHeader className=\"pb-3\">\n          <CardTitle className=\"flex items-center space-x-2 text-lg\">\n            <Trophy className=\"w-4 h-4\" />\n            <span>{t('leaderboard')}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {[...Array(3)].map((_, i) => (\n              <div key={i} className=\"animate-pulse bg-muted/50 rounded-lg h-12\" />\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (participants.length === 0) {\n    return (\n      <Card>\n        <CardHeader className=\"pb-3\">\n          <CardTitle className=\"flex items-center space-x-2 text-lg\">\n            <Trophy className=\"w-4 h-4\" />\n            <span>{t('leaderboard')}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-6\">\n            <User className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground/50\" />\n            <p className=\"text-sm text-muted-foreground\">{t('noData')}</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center space-x-2 text-lg\">\n            <Trophy className=\"w-4 h-4\" />\n            <span>{t('leaderboard')}</span>\n          </CardTitle>\n          {participants.length > 5 && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"h-8 px-2 text-xs\"\n              onClick={onViewFullLeaderboard}\n            >\n              <Eye className=\"w-3 h-3 mr-1\" />\n              {t('all')}\n            </Button>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-2\">\n          {topParticipants.map((participant, index) => {\n            const position = index + 1;\n            const totalValue = participant.portfolioValue || participant.totalValue || 0;\n            const startingBalance = 10000; // Tournament starting balance, should come from tournament data\n            const profitLoss = totalValue - startingBalance;\n            const isPositive = profitLoss >= 0;\n\n            return (\n              <motion.div\n                key={participant.userId}\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: index * 0.1 }}\n                className={`flex items-center justify-between p-3 rounded-lg border transition-colors hover:bg-muted/30 ${\n                  position <= 3 ? 'bg-gradient-to-r from-primary/5 to-transparent' : 'bg-muted/20'\n                }`}\n              >\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"flex-shrink-0\">\n                    {getRankIcon(position)}\n                  </div>\n                  <div className=\"flex flex-col min-w-0\">\n                    <span className=\"font-medium text-sm truncate\">\n                      {participant.firstName || participant.displayName || participant.username || `Player ${participant.userId}`}\n                    </span>\n                    <div className=\"flex items-center space-x-2 text-xs text-muted-foreground\">\n                      <span>{formatCurrency(totalValue)}</span>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"flex flex-col items-end text-right\">\n                  <div className={`text-sm font-medium ${\n                    isPositive ? 'text-green-600' : 'text-red-600'\n                  }`}>\n                    {isPositive ? '+' : ''}{formatCurrency(profitLoss)}\n                  </div>\n                  <div className={`flex items-center text-xs ${\n                    isPositive ? 'text-green-600' : 'text-red-600'\n                  }`}>\n                    {isPositive ? (\n                      <TrendingUp className=\"w-3 h-3 mr-1\" />\n                    ) : (\n                      <TrendingDown className=\"w-3 h-3 mr-1\" />\n                    )}\n                    {((profitLoss / startingBalance) * 100).toFixed(1)}%\n                  </div>\n                </div>\n              </motion.div>\n            );\n          })}\n        </div>\n        \n        {participants.length > 5 && (\n          <div className=\"mt-3 pt-3 border-t text-center\">\n            <p className=\"text-xs text-muted-foreground\">\n              Showing top 5 of {participants.length} participants\n            </p>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":6295},"client/src/components/tournaments/TournamentLeaderboardDialog.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Trophy, Medal, Award, Crown, TrendingUp, User } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { motion } from \"framer-motion\";\n\ninterface TournamentLeaderboardDialogProps {\n  tournament: any;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function TournamentLeaderboardDialog({ \n  tournament, \n  isOpen, \n  onClose \n}: TournamentLeaderboardDialogProps) {\n  const { formatCurrency } = useUserPreferences();\n\n  // Fetch tournament leaderboard data\n  const { data: leaderboardData, isLoading } = useQuery<{participants: any[]}>({\n    queryKey: ['/api/tournaments', tournament?.id, 'leaderboard'],\n    enabled: isOpen && !!tournament?.id,\n    refetchInterval: 5000, // Refresh every 5 seconds for real-time updates\n  });\n\n  const participants = leaderboardData?.participants || [];\n\n  const getRankIcon = (position: number) => {\n    switch (position) {\n      case 1:\n        return <Crown className=\"w-5 h-5 text-yellow-500\" />;\n      case 2:\n        return <Medal className=\"w-5 h-5 text-gray-400\" />;\n      case 3:\n        return <Award className=\"w-5 h-5 text-amber-600\" />;\n      default:\n        return <span className=\"w-5 h-5 flex items-center justify-center text-sm font-bold text-muted-foreground\">#{position}</span>;\n    }\n  };\n\n  const getTimeRemaining = () => {\n    if (!tournament?.endTime) return \"N/A\";\n    \n    const timeLeft = new Date(tournament.endTime).getTime() - Date.now();\n    if (timeLeft <= 0) return \"Ended\";\n    \n    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));\n    \n    if (days > 0) return `${days}d ${hours}h remaining`;\n    if (hours > 0) return `${hours}h ${minutes}m remaining`;\n    return `${minutes}m remaining`;\n  };\n\n  if (!tournament) return null;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center space-x-2\">\n            <Trophy className=\"w-5 h-5\" />\n            <span>{tournament.name} - Leaderboard</span>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Tournament Overview */}\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-sm font-medium\">Prize Pool</CardTitle>\n              </CardHeader>\n              <CardContent className=\"pt-0\">\n                <p className=\"text-2xl font-bold text-green-600\">\n                  {formatCurrency(tournament.currentPlayers * tournament.buyInAmount)}\n                </p>\n              </CardContent>\n            </Card>\n            \n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-sm font-medium\">Participants</CardTitle>\n              </CardHeader>\n              <CardContent className=\"pt-0\">\n                <p className=\"text-2xl font-bold\">{tournament.currentPlayers}</p>\n              </CardContent>\n            </Card>\n            \n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-sm font-medium\">Time Remaining</CardTitle>\n              </CardHeader>\n              <CardContent className=\"pt-0\">\n                <p className=\"text-2xl font-bold\">{getTimeRemaining()}</p>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Leaderboard */}\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-semibold flex items-center space-x-2\">\n              <TrendingUp className=\"w-5 h-5\" />\n              <span>Current Rankings</span>\n            </h3>\n\n            {isLoading ? (\n              <div className=\"space-y-3\">\n                {[...Array(5)].map((_, i) => (\n                  <div key={i} className=\"animate-pulse bg-muted/50 rounded-lg h-16\" />\n                ))}\n              </div>\n            ) : participants.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <User className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground/50\" />\n                <p className=\"text-muted-foreground\">No participants data available</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {participants.map((participant, index) => {\n                  const position = index + 1;\n                  const portfolioValue = participant.portfolioValue || tournament.startingBalance;\n                  const gainLoss = portfolioValue - tournament.startingBalance;\n                  const gainLossPercent = ((gainLoss / tournament.startingBalance) * 100);\n                  \n                  return (\n                    <motion.div\n                      key={participant.userId}\n                      initial={{ opacity: 0, y: 10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: index * 0.05 }}\n                    >\n                      <Card className={`transition-all duration-200 hover:shadow-md ${\n                        position <= 3 ? 'border-primary/20 bg-primary/5' : ''\n                      }`}>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex items-center space-x-4\">\n                              {getRankIcon(position)}\n                              <div>\n                                <p className=\"font-medium\">{participant.displayName || participant.firstName || `User ${participant.userId}`}</p>\n                                <p className=\"text-sm text-muted-foreground\">\n                                  Portfolio: {formatCurrency(portfolioValue)}\n                                </p>\n                              </div>\n                            </div>\n                            \n                            <div className=\"text-right\">\n                              <div className={`text-lg font-bold ${\n                                gainLoss >= 0 ? 'text-green-600' : 'text-red-600'\n                              }`}>\n                                {gainLoss >= 0 ? '+' : ''}{formatCurrency(gainLoss)}\n                              </div>\n                              <div className={`text-sm ${\n                                gainLoss >= 0 ? 'text-green-600' : 'text-red-600'\n                              }`}>\n                                {gainLoss >= 0 ? '+' : ''}{gainLossPercent.toFixed(2)}%\n                              </div>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n\n          {/* Tournament Info */}\n          <div className=\"p-4 bg-muted/30 rounded-lg\">\n            <h4 className=\"font-medium mb-2\">Tournament Details</h4>\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div className=\"space-y-1\">\n                <p><span className=\"text-muted-foreground\">Type:</span> {tournament.tournamentType === \"crypto\" ? \"Cryptocurrency\" : \"Stock Market\"}</p>\n                <p><span className=\"text-muted-foreground\">Starting Balance:</span> {formatCurrency(tournament.startingBalance)}</p>\n              </div>\n              <div className=\"space-y-1\">\n                <p><span className=\"text-muted-foreground\">Buy-in:</span> {tournament.buyInAmount > 0 ? formatCurrency(tournament.buyInAmount) : \"Free\"}</p>\n                <p><span className=\"text-muted-foreground\">Status:</span> <Badge variant={tournament.isPublic ? \"secondary\" : \"outline\"}>{tournament.isPublic ? \"Public\" : \"Private\"}</Badge></p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":8418},"client/src/components/tournaments/TournamentManagementDialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  Users, \n  Clock, \n  DollarSign, \n  Target,\n  Shield,\n  Play,\n  X,\n  UserX,\n  AlertTriangle,\n  Crown,\n  MessageSquare\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { ChatSystem } from \"@/components/chat/ChatSystem\";\nimport { \n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface TournamentManagementDialogProps {\n  tournament: any;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function TournamentManagementDialog({ \n  tournament, \n  isOpen, \n  onClose \n}: TournamentManagementDialogProps) {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n  const { toast } = useToast();\n  \n  const [kickDialogOpen, setKickDialogOpen] = useState(false);\n  const [cancelDialogOpen, setCancelDialogOpen] = useState(false);\n  const [selectedParticipant, setSelectedParticipant] = useState<any>(null);\n  const [chatOpen, setChatOpen] = useState(false);\n\n  const isCreator = user?.id === tournament?.creatorId;\n  const isPrivate = !tournament?.isPublic;\n  const hasStarted = tournament?.status === 'active';\n  const isWaiting = tournament?.status === 'waiting';\n\n  // Debug logging\n  console.log('Tournament Management Dialog - Tournament data:', {\n    id: tournament?.id,\n    name: tournament?.name,\n    code: tournament?.code,\n    isPublic: tournament?.isPublic,\n    isPrivate,\n    isCreator\n  });\n\n  // Kick participant mutation\n  const kickParticipantMutation = useMutation({\n    mutationFn: async (participantId: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/tournaments/${tournament.id}/participants/${participantId}`, {});\n      return res.json();\n    },\n    onSuccess: () => {\n      setKickDialogOpen(false);\n      setSelectedParticipant(null);\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments/public\"] });\n      queryClient.invalidateQueries({ queryKey: [`/api/tournaments/${tournament.id}/participants`] });\n      toast({\n        title: \"Success\",\n        description: \"Participant removed from tournament\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Start tournament early mutation\n  const startEarlyMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", `/api/tournaments/${tournament.id}/start-early`, {});\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments/public\"] });\n      toast({\n        title: \"Success\",\n        description: \"Tournament started successfully!\",\n      });\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Cancel tournament mutation\n  const cancelTournamentMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"DELETE\", `/api/tournaments/${tournament.id}/cancel`, {});\n      return res.json();\n    },\n    onSuccess: () => {\n      setCancelDialogOpen(false);\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments/public\"] });\n      toast({\n        title: \"Success\",\n        description: \"Tournament cancelled successfully\",\n      });\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (!isCreator) {\n    return null;\n  }\n\n  const getStartTime = () => {\n    if (tournament.scheduledStartTime) {\n      const startTime = new Date(tournament.scheduledStartTime);\n      const now = new Date();\n      const timeDiff = startTime.getTime() - now.getTime();\n      \n      if (timeDiff > 0) {\n        const hours = Math.floor(timeDiff / (1000 * 60 * 60));\n        const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));\n        return `Starts in ${hours}h ${minutes}m`;\n      }\n      return \"Ready to start\";\n    }\n    return \"Immediate start\";\n  };\n\n  return (\n    <>\n      <Dialog open={isOpen} onOpenChange={onClose}>\n        <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center space-x-2\">\n              <Crown className=\"w-5 h-5 text-yellow-500\" />\n              <span>Manage Tournament: {tournament.name}</span>\n            </DialogTitle>\n          </DialogHeader>\n\n          <div className=\"space-y-6\">\n            {/* Tournament Status */}\n            <div className=\"flex items-center justify-between p-4 bg-muted/50 rounded-lg\">\n              <div className=\"flex items-center space-x-4\">\n                <Badge variant={hasStarted ? \"default\" : isWaiting ? \"secondary\" : \"outline\"}>\n                  {tournament.status}\n                </Badge>\n                <span className=\"text-sm text-muted-foreground\">\n                  {getStartTime()}\n                </span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                {isPrivate && <Shield className=\"w-4 h-4 text-blue-500\" />}\n                <span className=\"text-sm font-medium\">\n                  {isPrivate ? \"Private\" : \"Public\"} Tournament\n                </span>\n              </div>\n            </div>\n\n            {/* Tournament Info */}\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div className=\"flex items-center space-x-2\">\n                <Users className=\"w-4 h-4 text-muted-foreground\" />\n                <span>{tournament.currentPlayers}/{tournament.maxPlayers} players</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                <span>{tournament.timeframe}</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <DollarSign className=\"w-4 h-4 text-muted-foreground\" />\n                <span>{formatCurrency(tournament.startingBalance)} starting</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Target className=\"w-4 h-4 text-muted-foreground\" />\n                <span>{formatCurrency(tournament.currentPlayers * tournament.buyInAmount)} pot</span>\n              </div>\n              {/* Show tournament code for private tournaments */}\n              {isPrivate && (\n                <>\n                  <div className=\"flex items-center space-x-2 col-span-2 p-3 bg-blue-50 dark:bg-blue-950/30 rounded-lg border border-blue-200 dark:border-blue-800\">\n                    <Shield className=\"w-4 h-4 text-blue-600\" />\n                    <div className=\"flex-1\">\n                      <span className=\"font-medium text-blue-800 dark:text-blue-200\">Join Code: </span>\n                      <code className=\"bg-blue-100 dark:bg-blue-900 px-2 py-1 rounded text-blue-900 dark:text-blue-100 font-mono text-sm\">\n                        {tournament.code || 'CODE_NOT_FOUND'}\n                      </code>\n                      {!tournament.code && (\n                        <div className=\"text-xs text-red-600 mt-1\">\n                          Debug: Tournament data missing code field\n                        </div>\n                      )}\n                    </div>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"text-blue-600 border-blue-300 hover:bg-blue-100 dark:text-blue-400 dark:border-blue-700 dark:hover:bg-blue-900\"\n                      onClick={() => {\n                        if (tournament.code) {\n                          navigator.clipboard.writeText(tournament.code);\n                          toast({\n                            title: \"Copied!\",\n                            description: \"Tournament code copied to clipboard\",\n                          });\n                        } else {\n                          toast({\n                            title: \"Error\",\n                            description: \"No tournament code available to copy\",\n                            variant: \"destructive\",\n                          });\n                        }\n                      }}\n                    >\n                      Copy\n                    </Button>\n                  </div>\n                </>\n              )}\n            </div>\n\n            <Separator />\n\n            {/* Creator Powers */}\n            <div className=\"space-y-4\">\n              <h3 className=\"font-semibold\">Creator Actions</h3>\n              \n              {/* Tournament Chat */}\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"font-medium\">Tournament Chat</p>\n                  <p className=\"text-sm text-muted-foreground\">Chat with tournament participants</p>\n                </div>\n                <Button\n                  onClick={() => setChatOpen(true)}\n                  variant=\"outline\"\n                >\n                  <MessageSquare className=\"w-4 h-4 mr-2\" />\n                  Open Chat\n                </Button>\n              </div>\n              \n              {/* Private Tournament Powers */}\n              {isPrivate && isWaiting && (\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"font-medium\">Start Tournament Early</p>\n                      <p className=\"text-sm text-muted-foreground\">Begin the tournament immediately</p>\n                    </div>\n                    <Button\n                      onClick={() => startEarlyMutation.mutate()}\n                      disabled={startEarlyMutation.isPending || tournament.currentPlayers < 2}\n                      className=\"bg-green-600 hover:bg-green-700\"\n                    >\n                      <Play className=\"w-4 h-4 mr-2\" />\n                      {startEarlyMutation.isPending ? \"Starting...\" : \"Start Now\"}\n                    </Button>\n                  </div>\n\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"font-medium\">Cancel Tournament</p>\n                      <p className=\"text-sm text-muted-foreground\">Delete the tournament before it starts</p>\n                    </div>\n                    <Button\n                      onClick={() => setCancelDialogOpen(true)}\n                      disabled={hasStarted}\n                      variant=\"destructive\"\n                    >\n                      <X className=\"w-4 h-4 mr-2\" />\n                      Cancel Tournament\n                    </Button>\n                  </div>\n                </div>\n              )}\n\n              {/* Participant Management (Private only) */}\n              {isPrivate && isWaiting && (\n                <div>\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <p className=\"font-medium\">Manage Participants</p>\n                    <Badge variant=\"outline\">{tournament.currentPlayers} participants</Badge>\n                  </div>\n                  \n                  <div className=\"space-y-2 max-h-40 overflow-auto\">\n                    {tournament.participants?.map((participant: any) => (\n                      <div key={participant.id} className=\"flex items-center justify-between p-2 border rounded\">\n                        <div className=\"flex items-center space-x-2\">\n                          <span className=\"font-medium\">{participant.displayName || participant.username}</span>\n                          {participant.id === tournament.creatorId && (\n                            <Crown className=\"w-4 h-4 text-yellow-500\" />\n                          )}\n                        </div>\n                        {participant.id !== tournament.creatorId && (\n                          <Button\n                            onClick={() => {\n                              setSelectedParticipant(participant);\n                              setKickDialogOpen(true);\n                            }}\n                            size=\"sm\"\n                            variant=\"outline\"\n                            className=\"text-red-600 hover:text-red-700\"\n                          >\n                            <UserX className=\"w-3 h-3 mr-1\" />\n                            Kick\n                          </Button>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Tournament Started Notice */}\n              {hasStarted && (\n                <div className=\"flex items-center space-x-2 p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg\">\n                  <AlertTriangle className=\"w-5 h-5 text-blue-600\" />\n                  <div>\n                    <p className=\"font-medium text-blue-800 dark:text-blue-200\">Tournament in Progress</p>\n                    <p className=\"text-sm text-blue-600 dark:text-blue-300\">\n                      Management options are limited once a tournament has started\n                    </p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Kick Participant Confirmation */}\n      <AlertDialog open={kickDialogOpen} onOpenChange={setKickDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Remove Participant</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to remove \"{selectedParticipant?.displayName || selectedParticipant?.username}\" from this tournament? \n              They will need to rejoin using the tournament code.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => kickParticipantMutation.mutate(selectedParticipant?.id)}\n              disabled={kickParticipantMutation.isPending}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              {kickParticipantMutation.isPending ? \"Removing...\" : \"Remove Participant\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Cancel Tournament Confirmation */}\n      <AlertDialog open={cancelDialogOpen} onOpenChange={setCancelDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Cancel Tournament</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to cancel \"{tournament.name}\"? This action cannot be undone and all participants will be notified.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Keep Tournament</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => cancelTournamentMutation.mutate()}\n              disabled={cancelTournamentMutation.isPending}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              {cancelTournamentMutation.isPending ? \"Cancelling...\" : \"Cancel Tournament\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Tournament-specific Chat System */}\n      <ChatSystem\n        tournamentId={tournament.id}\n        isOpen={chatOpen}\n        onToggle={() => setChatOpen(!chatOpen)}\n      />\n    </>\n  );\n}","size_bytes":16331},"client/src/components/trading/BuyStockDialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { TrendingUp, Calculator } from \"lucide-react\";\n\ninterface BuyStockDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  stock: {\n    symbol: string;\n    name?: string;\n    shortName?: string;\n    companyName?: string;\n    price: number;\n    exchange?: string;\n  } | null;\n}\n\nexport function BuyStockDialog({ open, onOpenChange, stock }: BuyStockDialogProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const { formatCurrency, t } = useUserPreferences();\n  const queryClient = useQueryClient();\n  const [shares, setShares] = useState<string>(\"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const sharesNumber = parseFloat(shares) || 0;\n  const totalCost = sharesNumber * (stock?.price || 0);\n\n  const buyStockMutation = useMutation({\n    mutationFn: async (purchaseData: any) => {\n      return apiRequest(\"POST\", \"/api/personal-portfolio/purchase\", purchaseData);\n    },\n    onSuccess: () => {\n      toast({ \n        title: t('success'),\n        description: `${t('buyStock')}: ${shares} ${t('shares')} ${stock?.symbol}`\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-portfolio\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/portfolio/personal\"] });\n      onOpenChange(false);\n      setShares(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: t('error'),\n        description: error.message || t('errorOccurred'),\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!stock || !shares || sharesNumber <= 0) {\n      toast({\n        title: t('error'),\n        description: t('invalidShares'),\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    const purchaseData = {\n      symbol: stock.symbol,\n      companyName: stock.name || stock.shortName || stock.companyName || stock.symbol,\n      shares: sharesNumber,\n      purchasePrice: stock.price,\n      totalCost: totalCost\n    };\n\n    setIsSubmitting(true);\n    try {\n      await buyStockMutation.mutateAsync(purchaseData);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (!stock) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[425px]\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center space-x-2\">\n            <TrendingUp className=\"h-5 w-5\" />\n            <span>Buy {stock.symbol}</span>\n          </DialogTitle>\n          <DialogDescription>\n            {stock.name || stock.shortName || stock.companyName}\n            {stock.exchange && (\n              <span className=\"text-xs ml-2 text-muted-foreground\">({stock.exchange})</span>\n            )}\n          </DialogDescription>\n        </DialogHeader>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"current-price\">Current Price</Label>\n            <div className=\"text-2xl font-bold text-green-600\">\n              {formatCurrency(stock.price)}\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"shares\">Number of Shares</Label>\n            <Input\n              id=\"shares\"\n              type=\"number\"\n              placeholder=\"Enter number of shares\"\n              value={shares}\n              onChange={(e) => setShares(e.target.value)}\n              min=\"0.01\"\n              step=\"0.01\"\n              required\n              className=\"text-lg\"\n            />\n          </div>\n\n          {sharesNumber > 0 && (\n            <div className=\"p-4 bg-muted/30 rounded-lg border\">\n              <div className=\"flex items-center space-x-2 mb-2\">\n                <Calculator className=\"h-4 w-4\" />\n                <span className=\"font-medium\">Order Summary</span>\n              </div>\n              <div className=\"space-y-1 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span>Shares:</span>\n                  <span>{sharesNumber}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span>Price per share:</span>\n                  <span>{formatCurrency(stock.price)}</span>\n                </div>\n                <div className=\"border-t pt-1 mt-2\">\n                  <div className=\"flex justify-between font-bold\">\n                    <span>Total Cost:</span>\n                    <span>{formatCurrency(totalCost)}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <DialogFooter>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              disabled={isSubmitting}\n            >\n              Cancel\n            </Button>\n            <Button\n              type=\"submit\"\n              disabled={!shares || sharesNumber <= 0 || isSubmitting}\n              className=\"bg-green-600 hover:bg-green-700\"\n            >\n              {isSubmitting ? \"Processing...\" : `Buy ${formatCurrency(totalCost)}`}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":5804},"client/src/components/trading/SellStockDialog.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\ninterface SellStockDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  stock: any;\n}\n\nexport function SellStockDialog({ open, onOpenChange, stock }: SellStockDialogProps) {\n  const [shares, setShares] = useState(\"\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { formatCurrency, t } = useUserPreferences();\n\n  const sellMutation = useMutation({\n    mutationFn: async (data: { shares: number }) => {\n      return apiRequest(\"POST\", \"/api/personal-portfolio/sell\", {\n        symbol: stock.symbol,\n        sharesToSell: data.shares,\n        currentPrice: stock.currentPrice\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: t('success'),\n        description: `${t('sellStock')}: ${shares} ${t('shares')} ${stock?.symbol}`,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-purchases\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-portfolio\"] });\n      onOpenChange(false);\n      setShares(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: t('error'),\n        description: error.message || t('errorOccurred'),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSell = () => {\n    const sharesToSell = parseInt(shares);\n    if (sharesToSell > 0 && sharesToSell <= (stock?.shares || 0)) {\n      sellMutation.mutate({ shares: sharesToSell });\n    }\n  };\n\n  if (!stock) return null;\n\n  const maxShares = stock.shares || 0;\n  const estimatedValue = parseInt(shares) * (stock.currentPrice || stock.purchasePrice || 0);\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>{t('sellStock')} {stock.symbol}</DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n            <div>\n              <span className=\"text-muted-foreground\">{t('shares')}:</span>\n              <p className=\"font-medium\">{maxShares}</p>\n            </div>\n            <div>\n              <span className=\"text-muted-foreground\">Current price:</span>\n              <p className=\"font-medium\">{formatCurrency(stock.currentPrice || stock.purchasePrice || 0)}</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"shares\">Shares to sell</Label>\n            <Input\n              id=\"shares\"\n              type=\"number\"\n              min=\"1\"\n              max={maxShares}\n              value={shares}\n              onChange={(e) => setShares(e.target.value)}\n              placeholder=\"Enter number of shares\"\n            />\n          </div>\n\n          {shares && parseInt(shares) > 0 && (\n            <div className=\"p-3 bg-muted/50 rounded-lg\">\n              <div className=\"text-sm text-muted-foreground\">Estimated proceeds:</div>\n              <div className=\"text-lg font-semibold text-foreground\">\n                {formatCurrency(estimatedValue)}\n              </div>\n            </div>\n          )}\n\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => onOpenChange(false)}\n              className=\"flex-1\"\n            >\n              Cancel\n            </Button>\n            <Button \n              onClick={handleSell}\n              disabled={!shares || parseInt(shares) <= 0 || parseInt(shares) > maxShares || sellMutation.isPending}\n              className=\"flex-1\"\n            >\n              {sellMutation.isPending ? \"Selling...\" : \"Sell Stock\"}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":4195},"client/src/components/trading/StockSearchBar.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Search, Plus, ShoppingCart, TrendingUp, TrendingDown } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { BuyStockDialog } from \"./BuyStockDialog\";\n\ninterface StockSearchBarProps {\n  type: \"purchase\" | \"watchlist\";\n  placeholder?: string;\n  tournamentId?: number;\n  onStockSelect?: (stock: any) => void;\n}\n\nexport function StockSearchBar({ type, placeholder, tournamentId, onStockSelect }: StockSearchBarProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const { formatCurrency, t } = useUserPreferences();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedStock, setSelectedStock] = useState<any>(null);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\n  const [showBuyDialog, setShowBuyDialog] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  // Search for stocks with debouncing\n  const { data: searchResults, isLoading: searchLoading } = useQuery({\n    queryKey: [\"/api/search\", searchQuery],\n    enabled: searchQuery.length > 1,\n    staleTime: 5000, // Cache for 5 seconds\n  });\n\n  const suggestions = (searchResults as any)?.data || [];\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n        setHighlightedIndex(-1);\n      }\n    }\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Show dropdown when we have results\n  useEffect(() => {\n    if (suggestions.length > 0 && searchQuery.length > 1) {\n      setShowDropdown(true);\n    } else {\n      setShowDropdown(false);\n    }\n  }, [suggestions, searchQuery]);\n\n  // Add to watchlist mutation\n  const addToWatchlistMutation = useMutation({\n    mutationFn: async (watchlistData: any) => {\n      return apiRequest(\"POST\", `/api/watchlist`, watchlistData);\n    },\n    onSuccess: () => {\n      toast({ title: t('addToWatchlist') });\n      queryClient.invalidateQueries({ queryKey: [\"/api/watchlist\"] });\n      setSearchQuery(\"\");\n      setSelectedStock(null);\n    },\n    onError: (error: any) => {\n      toast({ \n        title: t('error'), \n        description: error.message || \"Failed to add to watchlist\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const handleSelectStock = async (stock: any) => {\n    try {\n      const response = await fetch(`/api/quote/${stock.symbol}`);\n      const data = await response.json();\n      \n      if (data.success) {\n        setSelectedStock({ ...stock, price: data.data.price });\n        setShowDropdown(false);\n        setSearchQuery(stock.symbol);\n        \n        // For watchlist type, automatically add to watchlist when stock is selected\n        if (type === \"watchlist\") {\n          const watchlistData = {\n            symbol: stock.symbol,\n            companyName: stock.name || stock.shortName || stock.companyName || stock.symbol,\n            notes: \"\"\n          };\n          addToWatchlistMutation.mutate(watchlistData);\n        } else if (type === \"purchase\") {\n          if (onStockSelect) {\n            // Use parent callback for purchase (dashboard handles this)\n            onStockSelect({ ...stock, price: data.data.price });\n            setSearchQuery(\"\");\n            setSelectedStock(null);\n          } else {\n            // Fallback to internal dialog\n            setShowBuyDialog(true);\n          }\n        }\n      } else {\n        toast({\n          title: \"Stock not found\",\n          description: \"Please check the symbol and try again\",\n          variant: \"destructive\"\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to get stock price\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleAddToWatchlist = () => {\n    if (selectedStock) {\n      const watchlistData = {\n        symbol: selectedStock.symbol,\n        companyName: selectedStock.name || selectedStock.shortName || selectedStock.companyName || selectedStock.symbol,\n        notes: \"\"\n      };\n      addToWatchlistMutation.mutate(watchlistData);\n      setSearchQuery(\"\");\n      setSelectedStock(null);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (!showDropdown || suggestions.length === 0) return;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setHighlightedIndex(prev => \n          prev < suggestions.length - 1 ? prev + 1 : prev\n        );\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        setHighlightedIndex(prev => prev > 0 ? prev - 1 : prev);\n        break;\n      case 'Enter':\n        e.preventDefault();\n        if (highlightedIndex >= 0 && highlightedIndex < suggestions.length) {\n          handleSelectStock(suggestions[highlightedIndex]);\n        }\n        break;\n      case 'Escape':\n        setShowDropdown(false);\n        setHighlightedIndex(-1);\n        break;\n    }\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setSearchQuery(value);\n    setHighlightedIndex(-1);\n    if (value.length === 0) {\n      setSelectedStock(null);\n    }\n  };\n\n  return (\n    <div className=\"relative\" ref={dropdownRef}>\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n        <Input\n          ref={inputRef}\n          placeholder={placeholder || `Search stocks to ${type === 'purchase' ? 'buy' : 'watch'}...`}\n          value={searchQuery}\n          onChange={handleInputChange}\n          onKeyDown={handleKeyPress}\n          onFocus={() => {\n            if (suggestions.length > 0 && searchQuery.length > 1) {\n              setShowDropdown(true);\n            }\n          }}\n          className=\"pl-10\"\n        />\n        {searchLoading && (\n          <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2\">\n            <div className=\"animate-spin h-4 w-4 border-2 border-primary border-t-transparent rounded-full\"></div>\n          </div>\n        )}\n      </div>\n\n      {/* Dropdown with suggestions */}\n      {showDropdown && suggestions.length > 0 && (\n        <div className=\"absolute z-50 w-full mt-1 bg-background border border-border rounded-lg shadow-lg max-h-60 overflow-y-auto\">\n          {suggestions.slice(0, 8).map((stock: any, index: number) => (\n            <div\n              key={stock.symbol || index}\n              className={`px-4 py-3 cursor-pointer border-b border-border/50 last:border-b-0 hover:bg-muted/50 transition-colors ${\n                index === highlightedIndex ? 'bg-muted' : ''\n              }`}\n              onClick={() => handleSelectStock(stock)}\n            >\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"font-medium text-sm\">{stock.symbol}</span>\n                    <span className=\"text-xs text-muted-foreground truncate\">\n                      {stock.name || stock.shortName || stock.companyName}\n                    </span>\n                  </div>\n                  {stock.exchange && (\n                    <div className=\"text-xs text-muted-foreground mt-1\">\n                      {stock.exchange}\n                    </div>\n                  )}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">\n                  {type === 'purchase' ? 'Buy' : 'Watch'}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Selected stock actions */}\n      {selectedStock && (\n        <div className=\"mt-3 p-3 border rounded-lg bg-muted/30\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h4 className=\"font-medium\">{selectedStock.symbol}</h4>\n              <p className=\"text-sm text-muted-foreground\">{selectedStock.name || selectedStock.shortName || selectedStock.companyName}</p>\n              {selectedStock.price && (\n                <p className=\"text-sm font-medium\">{formatCurrency(selectedStock.price)}</p>\n              )}\n            </div>\n            <div className=\"flex space-x-2\">\n              {type === \"watchlist\" && (\n                <Button\n                  size=\"sm\"\n                  onClick={handleAddToWatchlist}\n                  disabled={addToWatchlistMutation.isPending}\n                >\n                  <Plus className=\"h-4 w-4 mr-1\" />\n                  Add to Watchlist\n                </Button>\n              )}\n              {type === \"purchase\" && (\n                <Button\n                  size=\"sm\"\n                  onClick={() => setShowBuyDialog(true)}\n                >\n                  <ShoppingCart className=\"h-4 w-4 mr-1\" />\n                  Buy Stock\n                </Button>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Buy Stock Dialog */}\n      <BuyStockDialog\n        open={showBuyDialog}\n        onOpenChange={setShowBuyDialog}\n        stock={selectedStock}\n      />\n    </div>\n  );\n}","size_bytes":9817},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/buy-in-incentive-box.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Gift, Trophy, DollarSign, Users } from \"lucide-react\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\ninterface BuyInIncentiveBoxProps {\n  buyInAmount: number;\n  maxPlayers: number;\n  currentPlayers?: number;\n  variant?: \"tournament\" | \"creation\" | \"join\";\n}\n\nexport function BuyInIncentiveBox({ \n  buyInAmount, \n  maxPlayers, \n  currentPlayers = 0,\n  variant = \"tournament\" \n}: BuyInIncentiveBoxProps) {\n  const { formatCurrency } = useUserPreferences();\n  \n  if (buyInAmount <= 0) return null;\n\n  const totalPot = buyInAmount * maxPlayers;\n  const currentPot = buyInAmount * currentPlayers;\n  const winnerAmount = totalPot * 0.95;\n  const platformFee = totalPot * 0.05;\n\n  const getVariantStyles = () => {\n    switch (variant) {\n      case \"creation\":\n        return \"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-800\";\n      case \"join\":\n        return \"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800\";\n      default:\n        return \"bg-yellow-50 dark:bg-yellow-950/20 border-yellow-200 dark:border-yellow-800\";\n    }\n  };\n\n  const getIconColor = () => {\n    switch (variant) {\n      case \"creation\":\n        return \"text-green-600\";\n      case \"join\":\n        return \"text-blue-600\";\n      default:\n        return \"text-yellow-600\";\n    }\n  };\n\n  const getTextColor = () => {\n    switch (variant) {\n      case \"creation\":\n        return \"text-green-800 dark:text-green-200\";\n      case \"join\":\n        return \"text-blue-800 dark:text-blue-200\";\n      default:\n        return \"text-yellow-800 dark:text-yellow-200\";\n    }\n  };\n\n  const getSecondaryTextColor = () => {\n    switch (variant) {\n      case \"creation\":\n        return \"text-green-700 dark:text-green-300\";\n      case \"join\":\n        return \"text-blue-700 dark:text-blue-300\";\n      default:\n        return \"text-yellow-700 dark:text-yellow-300\";\n    }\n  };\n\n  return (\n    <Card className={`border ${getVariantStyles()}`}>\n      <CardContent className=\"p-4\">\n        <div className=\"flex items-center space-x-2 mb-3\">\n          <Gift className={`w-5 h-5 ${getIconColor()}`} />\n          <p className={`text-sm font-medium ${getTextColor()}`}>\n            {variant === \"creation\" \n              ? \"Buy-in Tournament Benefits\"\n              : variant === \"join\"\n              ? \"Tournament Prize Pool\"\n              : \"Prize Pool Active\"\n            }\n          </p>\n          <Badge variant=\"secondary\" className=\"text-xs\">\n            <Trophy className=\"w-3 h-3 mr-1\" />\n            {formatCurrency(buyInAmount)} entry\n          </Badge>\n        </div>\n\n        {/* Prize breakdown */}\n        <div className=\"grid grid-cols-2 gap-4 mb-3\">\n          <div className=\"text-center\">\n            <div className={`text-lg font-bold ${getTextColor()}`}>\n              {formatCurrency(currentPlayers > 0 ? currentPot : totalPot)}\n            </div>\n            <div className={`text-xs ${getSecondaryTextColor()}`}>\n              {currentPlayers > 0 ? \"Current\" : \"Max\"} Prize Pool\n            </div>\n          </div>\n          <div className=\"text-center\">\n            <div className={`text-lg font-bold ${getTextColor()}`}>\n              {formatCurrency(winnerAmount)}\n            </div>\n            <div className={`text-xs ${getSecondaryTextColor()}`}>\n              Winner Takes (95%)\n            </div>\n          </div>\n        </div>\n\n        {/* Features list */}\n        <div className={`text-xs ${getSecondaryTextColor()} space-y-1`}>\n          {variant === \"creation\" ? (\n            <>\n              <div className=\"flex items-center space-x-2\">\n                <Trophy className=\"w-3 h-3\" />\n                <span>Creates competitive prize pool for winners</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Users className=\"w-3 h-3\" />\n                <span>Attracts more serious and skilled traders</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <DollarSign className=\"w-3 h-3\" />\n                <span>Platform takes only 5% commission</span>\n              </div>\n            </>\n          ) : (\n            <>\n              <div className=\"flex items-center justify-between\">\n                <span>Entry Fee:</span>\n                <span className=\"font-medium\">{formatCurrency(buyInAmount)}</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span>Platform Fee:</span>\n                <span className=\"font-medium\">{formatCurrency(platformFee)}</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span>Players:</span>\n                <span className=\"font-medium\">{currentPlayers}/{maxPlayers}</span>\n              </div>\n            </>\n          )}\n        </div>\n\n        {/* Progress bar for current vs max pot */}\n        {currentPlayers > 0 && currentPlayers < maxPlayers && (\n          <div className=\"mt-3\">\n            <div className=\"flex justify-between text-xs mb-1\">\n              <span className={getSecondaryTextColor()}>Prize Pool Progress</span>\n              <span className={getSecondaryTextColor()}>{Math.round((currentPlayers / maxPlayers) * 100)}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                className={`h-2 rounded-full ${\n                  variant === \"creation\" ? \"bg-green-500\" :\n                  variant === \"join\" ? \"bg-blue-500\" : \"bg-yellow-500\"\n                }`}\n                style={{ width: `${(currentPlayers / maxPlayers) * 100}%` }}\n              ></div>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":5853},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex flex-col space-y-1.5 p-6\", className)} {...props} />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center p-6 pt-0\", className)} {...props} />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }","size_bytes":1848},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }","size_bytes":823},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }","size_bytes":709},"client/src/components/ui/loading-spinner.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface LoadingSpinnerProps {\n  className?: string;\n  size?: \"sm\" | \"md\" | \"lg\";\n}\n\nexport default function LoadingSpinner({ className, size = \"md\" }: LoadingSpinnerProps) {\n  const sizeClasses = {\n    sm: \"h-4 w-4\",\n    md: \"h-8 w-8\",\n    lg: \"h-12 w-12\",\n  };\n\n  return (\n    <div className={cn(\"animate-spin rounded-full border-2 border-gray-300 border-t-black\", sizeClasses[size], className)} />\n  );\n}\n","size_bytes":444},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/portfolio-graph.tsx":{"content":"import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\nimport { Card, CardContent, CardHeader, CardTitle } from './card';\nimport { TrendingUp, TrendingDown, DollarSign } from 'lucide-react';\nimport { useQuery } from '@tanstack/react-query';\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\ninterface PortfolioGraphProps {\n  userId: number;\n  portfolioType?: 'personal' | 'tournament';\n  tournamentId?: number;\n  title?: string;\n  height?: number;\n  showStats?: boolean;\n  className?: string;\n}\n\ninterface PortfolioDataPoint {\n  date: string;\n  value: number;\n  cashBalance: number;\n  stockValue: number;\n}\n\nexport function PortfolioGraph({ \n  userId, \n  portfolioType = 'personal', \n  tournamentId, \n  title = 'Portfolio Performance',\n  height = 300,\n  showStats = true,\n  className = ''\n}: PortfolioGraphProps) {\n  const { formatCurrency } = useUserPreferences();\n  const { data: portfolioHistory, isLoading } = useQuery({\n    queryKey: [`/api/portfolio-history/${userId}`, portfolioType, tournamentId],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        type: portfolioType\n      });\n      if (tournamentId) {\n        params.append('tournamentId', tournamentId.toString());\n      }\n      \n      const response = await fetch(`/api/portfolio-history/${userId}?${params}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch portfolio history');\n      }\n      return response.json();\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // Generate mock data if no history exists yet\n  const generateMockData = (): PortfolioDataPoint[] => {\n    const now = new Date();\n    const data: PortfolioDataPoint[] = [];\n    const startValue = 10000;\n    \n    for (let i = 29; i >= 0; i--) {\n      const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);\n      // Simple random walk with slight upward trend\n      const variation = (Math.random() - 0.45) * 200; // Slight positive bias\n      const dayValue = Math.max(8000, startValue + variation * Math.sqrt(30 - i));\n      \n      data.push({\n        date: date.toISOString().split('T')[0],\n        value: Math.round(dayValue),\n        cashBalance: Math.round(dayValue * 0.3), // 30% cash\n        stockValue: Math.round(dayValue * 0.7) // 70% stocks\n      });\n    }\n    \n    return data;\n  };\n\n  const data: PortfolioDataPoint[] = portfolioHistory?.data?.length > 0 \n    ? portfolioHistory.data.map((item: any) => ({\n        date: new Date(item.recordedAt).toISOString().split('T')[0],\n        value: parseFloat(item.totalValue),\n        cashBalance: parseFloat(item.cashBalance),\n        stockValue: parseFloat(item.stockValue)\n      }))\n    : generateMockData();\n\n  if (isLoading) {\n    return (\n      <Card className={className}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center\">\n            <TrendingUp className=\"w-5 h-5 mr-2\" />\n            {title}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-center\" style={{ height }}>\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const currentValue = data[data.length - 1]?.value || 10000;\n  const initialValue = data[0]?.value || 10000;\n  const totalChange = currentValue - initialValue;\n  const percentChange = ((totalChange / initialValue) * 100);\n  const isPositive = totalChange >= 0;\n\n  return (\n    <Card className={`${className} gradient-card border-0 shadow-lg`}>\n      <CardHeader>\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center\">\n            <div className=\"w-8 h-8 gradient-primary rounded-lg flex items-center justify-center neon-glow mr-3\">\n              <TrendingUp className=\"w-4 h-4 text-primary-foreground\" />\n            </div>\n            <span className=\"gradient-text\">{title}</span>\n          </div>\n          {showStats && (\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"text-right\">\n                <p className=\"text-2xl font-bold text-foreground\">\n                  {formatCurrency(currentValue)}\n                </p>\n                <div className={`flex items-center text-sm ${isPositive ? 'text-green-600' : 'text-red-600'}`}>\n                  {isPositive ? <TrendingUp className=\"w-4 h-4 mr-1\" /> : <TrendingDown className=\"w-4 h-4 mr-1\" />}\n                  {formatCurrency(Math.abs(totalChange))} ({isPositive ? '+' : ''}{percentChange.toFixed(2)}%)\n                </div>\n              </div>\n            </div>\n          )}\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"relative\">\n        <div className=\"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent rounded-lg pointer-events-none\"></div>\n        <ResponsiveContainer width=\"100%\" height={height}>\n          <LineChart \n            data={data} \n            margin={{ top: 20, right: 30, left: 65, bottom: 35 }}\n          >\n            <defs>\n              <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                <stop offset=\"0%\" stopColor=\"hsl(var(--neon-blue))\" />\n                <stop offset=\"50%\" stopColor=\"hsl(var(--primary))\" />\n                <stop offset=\"100%\" stopColor=\"hsl(var(--neon-purple))\" />\n              </linearGradient>\n            </defs>\n            <CartesianGrid \n              strokeDasharray=\"2 2\" \n              stroke=\"hsl(var(--muted-foreground))\" \n              opacity={0.2}\n              horizontal={true}\n              vertical={false}\n            />\n            <XAxis \n              dataKey=\"date\" \n              tick={{ \n                fontSize: 11, \n                fill: 'hsl(var(--muted-foreground))',\n                fontWeight: 500\n              }}\n              tickLine={{ stroke: 'hsl(var(--muted-foreground))', strokeWidth: 1 }}\n              axisLine={{ stroke: 'hsl(var(--border))', strokeWidth: 1 }}\n              tickMargin={8}\n              interval=\"preserveStartEnd\"\n              tickFormatter={(value) => {\n                const date = new Date(value);\n                return `${date.getMonth() + 1}/${date.getDate()}`;\n              }}\n            />\n            <YAxis \n              tick={{ \n                fontSize: 11, \n                fill: 'hsl(var(--muted-foreground))',\n                fontWeight: 500\n              }}\n              tickLine={{ stroke: 'hsl(var(--muted-foreground))', strokeWidth: 1 }}\n              axisLine={{ stroke: 'hsl(var(--border))', strokeWidth: 1 }}\n              tickMargin={8}\n              width={55}\n              tickCount={6}\n              domain={['dataMin - 200', 'dataMax + 200']}\n              tickFormatter={(value) => {\n                if (value >= 1000) {\n                  return formatCurrency(value / 1000) + 'k';\n                } else {\n                  return formatCurrency(value);\n                }\n              }}\n            />\n            <Tooltip \n              labelFormatter={(value) => {\n                const date = new Date(value);\n                return date.toLocaleDateString('en-US', { \n                  month: 'short', \n                  day: 'numeric',\n                  year: 'numeric'\n                });\n              }}\n              formatter={(value: number, name: string) => [\n                formatCurrency(value),\n                name === 'value' ? 'Total Value' : \n                name === 'stockValue' ? 'Stock Value' : 'Cash Balance'\n              ]}\n              contentStyle={{\n                backgroundColor: 'hsl(var(--background))',\n                border: '1px solid hsl(var(--border))',\n                borderRadius: '8px',\n                boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',\n                fontSize: '12px',\n                fontWeight: 500\n              }}\n              labelStyle={{\n                color: 'hsl(var(--foreground))',\n                fontWeight: 600,\n                marginBottom: '4px'\n              }}\n            />\n            <Line \n              type=\"monotone\" \n              dataKey=\"value\" \n              stroke=\"url(#gradient)\" \n              strokeWidth={3}\n              dot={false}\n              activeDot={{ \n                r: 6, \n                fill: 'hsl(var(--neon-blue))',\n                stroke: 'hsl(var(--background))',\n                strokeWidth: 3,\n                style: {\n                  filter: 'drop-shadow(0 0 8px hsl(var(--neon-blue)))'\n                }\n              }}\n              style={{\n                filter: 'drop-shadow(0 0 4px hsl(var(--primary)))'\n              }}\n            />\n          </LineChart>\n        </ResponsiveContainer>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":8797},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/stock-ticker.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { TrendingUp, TrendingDown } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\n\ninterface StockData {\n  symbol: string;\n  price: number;\n  change: number;\n  percentChange: number;\n  volume: number;\n}\n\ninterface PerformanceData {\n  symbol: string;\n  percentChange: number;\n  timeFrame: string;\n}\n\nexport default function StockTicker() {\n  const [tickerData, setTickerData] = useState<StockData[]>([]);\n\n  const { data: popularStocks, isLoading } = useQuery<{ success: boolean; data: StockData[] }>({\n    queryKey: ['/api/popular'],\n    refetchInterval: 60000, // Refresh every minute\n  });\n\n  useEffect(() => {\n    if (popularStocks?.success && popularStocks.data) {\n      // Sort by highest absolute percent change to show most active stocks\n      const sortedStocks = [...popularStocks.data]\n        .sort((a, b) => Math.abs(b.percentChange) - Math.abs(a.percentChange))\n        .slice(0, 10); // Show top 10 most active stocks\n      setTickerData(sortedStocks);\n    }\n  }, [popularStocks]);\n\n  if (isLoading || !tickerData.length) {\n    return (\n      <div className=\"bg-card border-b border-muted py-3 overflow-hidden\">\n        <div className=\"flex items-center space-x-8\">\n          {Array.from({ length: 8 }).map((_, i) => (\n            <div key={i} className=\"flex items-center space-x-2 animate-pulse\">\n              <div className=\"w-10 h-4 bg-muted rounded\"></div>\n              <div className=\"w-16 h-4 bg-muted rounded\"></div>\n              <div className=\"w-12 h-4 bg-muted rounded\"></div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const StockItem = ({ stock }: { stock: StockData }) => (\n    <div className=\"flex items-center space-x-2 whitespace-nowrap px-4\">\n      <span className=\"font-semibold text-foreground text-sm\">{stock.symbol}</span>\n      <span className=\"text-foreground text-sm\">${stock.price.toFixed(2)}</span>\n      <div className=\"flex items-center space-x-1\">\n        {stock.percentChange >= 0 ? (\n          <TrendingUp className=\"w-3 h-3 text-green-500\" />\n        ) : (\n          <TrendingDown className=\"w-3 h-3 text-red-500\" />\n        )}\n        <span\n          className={`text-xs font-medium ${\n            stock.percentChange >= 0 ? \"text-green-600\" : \"text-red-600\"\n          }`}\n        >\n          {stock.percentChange >= 0 ? '+' : ''}{stock.percentChange.toFixed(2)}%\n        </span>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"bg-card border-b border-muted py-3 overflow-hidden\">\n      <div className=\"flex animate-scroll\">\n        {/* First set */}\n        {tickerData.map((stock) => (\n          <StockItem key={`first-${stock.symbol}`} stock={stock} />\n        ))}\n        {/* Second set for seamless loop */}\n        {tickerData.map((stock) => (\n          <StockItem key={`second-${stock.symbol}`} stock={stock} />\n        ))}\n      </div>\n    </div>\n  );\n}","size_bytes":2967},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }","size_bytes":1882},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}","size_bytes":4838},"client/src/components/ui/toaster.tsx":{"content":"import {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\nimport { useToast } from \"@/hooks/use-toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}","size_bytes":771},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/visually-hidden.tsx":{"content":"import * as React from \"react\";\n\ninterface VisuallyHiddenProps extends React.HTMLAttributes<HTMLSpanElement> {\n  children: React.ReactNode;\n}\n\nexport const VisuallyHidden = React.forwardRef<HTMLSpanElement, VisuallyHiddenProps>(\n  ({ children, ...props }, ref) => {\n    return (\n      <span\n        ref={ref}\n        {...props}\n        style={{\n          position: 'absolute',\n          width: '1px',\n          height: '1px',\n          padding: 0,\n          margin: '-1px',\n          overflow: 'hidden',\n          clip: 'rect(0, 0, 0, 0)',\n          whiteSpace: 'nowrap',\n          border: 0,\n          ...props.style,\n        }}\n      >\n        {children}\n      </span>\n    );\n  }\n);\n\nVisuallyHidden.displayName = \"VisuallyHidden\";","size_bytes":732},"client/src/components/widgets/PortfolioGraphWidget.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from \"recharts\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { TrendingUp, TrendingDown } from \"lucide-react\";\n\ninterface PortfolioGraphWidgetProps {\n  height?: number;\n}\n\nexport function PortfolioGraphWidget({ height = 300 }: PortfolioGraphWidgetProps) {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  // Fetch portfolio history\n  const { data: portfolioHistory, isLoading } = useQuery({\n    queryKey: [\"/api/portfolio-history\", user?.userId],\n    enabled: !!user,\n    refetchInterval: 60000, // Refresh every minute\n  });\n\n  // Generate sample data if no history exists\n  const generateSampleData = () => {\n    const data = [];\n    const startValue = 10000;\n    const days = 30;\n    \n    for (let i = 0; i < days; i++) {\n      const date = new Date();\n      date.setDate(date.getDate() - (days - i));\n      const randomChange = (Math.random() - 0.5) * 200;\n      const value = i === 0 ? startValue : data[i-1].value + randomChange;\n      \n      data.push({\n        date: date.toISOString().split('T')[0],\n        value: Math.max(value, 0),\n        displayDate: date.toLocaleDateString()\n      });\n    }\n    return data;\n  };\n\n  const chartData = portfolioHistory?.data?.length > 0 ? portfolioHistory.data : generateSampleData();\n  const currentValue = chartData[chartData.length - 1]?.value || 10000;\n  const previousValue = chartData[chartData.length - 2]?.value || 10000;\n  const change = currentValue - previousValue;\n  const changePercent = ((change / previousValue) * 100);\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-sm\">Portfolio Performance</CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex items-center justify-center\" style={{ height: height - 80 }}>\n          <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-sm\">Portfolio Performance</CardTitle>\n          <div className=\"flex items-center gap-2\">\n            {change >= 0 ? (\n              <TrendingUp className=\"w-4 h-4 text-green-500\" />\n            ) : (\n              <TrendingDown className=\"w-4 h-4 text-red-500\" />\n            )}\n            <span className={`text-sm font-medium ${change >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n              {change >= 0 ? '+' : ''}{changePercent.toFixed(2)}%\n            </span>\n          </div>\n        </div>\n        <div className=\"text-lg font-bold\">\n          {formatCurrency(currentValue)}\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-2\">\n        <ResponsiveContainer width=\"100%\" height={height - 100}>\n          <LineChart data={chartData}>\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" />\n            <XAxis \n              dataKey=\"displayDate\" \n              stroke=\"hsl(var(--muted-foreground))\"\n              fontSize={10}\n              tick={{ fontSize: 10 }}\n            />\n            <YAxis \n              stroke=\"hsl(var(--muted-foreground))\"\n              fontSize={10}\n              tick={{ fontSize: 10 }}\n              tickFormatter={(value) => `$${(value / 1000).toFixed(0)}k`}\n            />\n            <Tooltip \n              labelFormatter={(label) => `Date: ${label}`}\n              formatter={(value: number) => [formatCurrency(value), 'Portfolio Value']}\n              contentStyle={{\n                backgroundColor: 'hsl(var(--card))',\n                border: '1px solid hsl(var(--border))',\n                borderRadius: '6px'\n              }}\n            />\n            <Line \n              type=\"monotone\" \n              dataKey=\"value\" \n              stroke={change >= 0 ? '#10b981' : '#ef4444'}\n              strokeWidth={2}\n              dot={false}\n              activeDot={{ r: 4, stroke: change >= 0 ? '#10b981' : '#ef4444', strokeWidth: 2 }}\n            />\n          </LineChart>\n        </ResponsiveContainer>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":4525},"client/src/components/widgets/PositionsWidget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Briefcase, TrendingUp, TrendingDown } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\ninterface PositionsWidgetProps {\n  height?: number;\n}\n\nexport function PositionsWidget({ height = 300 }: PositionsWidgetProps) {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  // Fetch personal portfolio positions\n  const { data: purchases, isLoading } = useQuery({\n    queryKey: [\"/api/personal-purchases\"],\n    enabled: !!user,\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-sm flex items-center gap-2\">\n            <Briefcase className=\"w-4 h-4\" />\n            Positions\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex items-center justify-center\" style={{ height: height - 80 }}>\n          <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const positions = purchases?.data || [];\n\n  // Group positions by symbol\n  const groupedPositions = positions.reduce((acc: any, purchase: any) => {\n    const symbol = purchase.symbol;\n    if (!acc[symbol]) {\n      acc[symbol] = {\n        symbol,\n        totalShares: 0,\n        totalCost: 0,\n        currentPrice: purchase.currentPrice || 0,\n        purchases: []\n      };\n    }\n    acc[symbol].totalShares += purchase.shares;\n    acc[symbol].totalCost += purchase.totalCost;\n    acc[symbol].purchases.push(purchase);\n    return acc;\n  }, {});\n\n  const positionsList = Object.values(groupedPositions);\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-sm flex items-center gap-2\">\n            <Briefcase className=\"w-4 h-4\" />\n            Positions\n          </CardTitle>\n          <Link href=\"/portfolio\">\n            <Button variant=\"ghost\" size=\"sm\" className=\"h-6 text-xs\">\n              View All\n            </Button>\n          </Link>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-2\">\n        <div className=\"space-y-1\" style={{ height: height - 80, overflowY: 'auto' }}>\n          {positionsList.length === 0 ? (\n            <div className=\"text-center text-muted-foreground text-xs py-4\">\n              No positions held\n            </div>\n          ) : (\n            positionsList.slice(0, 8).map((position: any) => {\n              const currentValue = position.totalShares * position.currentPrice;\n              const totalReturn = currentValue - position.totalCost;\n              const returnPercent = ((totalReturn / position.totalCost) * 100);\n              \n              return (\n                <div \n                  key={position.symbol}\n                  className=\"flex items-center justify-between p-2 rounded hover:bg-muted/50 transition-colors\"\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"font-semibold text-xs\">\n                      {position.symbol}\n                    </div>\n                    <div className=\"text-xs text-muted-foreground\">\n                      {position.totalShares} shares\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <div className=\"text-xs font-medium\">\n                      {formatCurrency(currentValue)}\n                    </div>\n                    <div className={`text-xs flex items-center gap-1 ${\n                      totalReturn >= 0 ? 'text-green-500' : 'text-red-500'\n                    }`}>\n                      {totalReturn >= 0 ? (\n                        <TrendingUp className=\"w-3 h-3\" />\n                      ) : (\n                        <TrendingDown className=\"w-3 h-3\" />\n                      )}\n                      {totalReturn >= 0 ? '+' : ''}{returnPercent.toFixed(1)}%\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":4468},"client/src/components/widgets/StockGraphWidget.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from \"recharts\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { TrendingUp, TrendingDown, Search } from \"lucide-react\";\n\ninterface StockGraphWidgetProps {\n  height?: number;\n}\n\nexport function StockGraphWidget({ height = 300 }: StockGraphWidgetProps) {\n  const [symbol, setSymbol] = useState(\"AAPL\");\n  const [inputSymbol, setInputSymbol] = useState(\"AAPL\");\n  const { formatCurrency } = useUserPreferences();\n\n  // Fetch stock quote\n  const { data: stockData, isLoading } = useQuery({\n    queryKey: [\"/api/quote\", symbol],\n    enabled: !!symbol,\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  // Generate sample historical data\n  const generateHistoricalData = (currentPrice: number) => {\n    const data = [];\n    const days = 30;\n    \n    for (let i = 0; i < days; i++) {\n      const date = new Date();\n      date.setDate(date.getDate() - (days - i));\n      const randomChange = (Math.random() - 0.5) * (currentPrice * 0.1);\n      const basePrice = currentPrice * (0.95 + Math.random() * 0.1);\n      const price = i === days - 1 ? currentPrice : basePrice + randomChange;\n      \n      data.push({\n        date: date.toISOString().split('T')[0],\n        price: Math.max(price, 0.01),\n        displayDate: date.toLocaleDateString()\n      });\n    }\n    return data;\n  };\n\n  const handleSymbolChange = () => {\n    if (inputSymbol.trim()) {\n      setSymbol(inputSymbol.trim().toUpperCase());\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handleSymbolChange();\n    }\n  };\n\n  const currentPrice = stockData?.data?.price || 0;\n  const change = stockData?.data?.change || 0;\n  const changePercent = stockData?.data?.changePercent || 0;\n  const chartData = generateHistoricalData(currentPrice);\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between gap-2\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2\">\n              <Input\n                type=\"text\"\n                placeholder=\"Symbol (e.g., AAPL)\"\n                value={inputSymbol}\n                onChange={(e) => setInputSymbol(e.target.value.toUpperCase())}\n                onKeyPress={handleKeyPress}\n                className=\"text-xs h-8 w-20\"\n                maxLength={10}\n              />\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={handleSymbolChange}\n                className=\"h-8 w-8 p-0\"\n              >\n                <Search className=\"w-3 h-3\" />\n              </Button>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            {change >= 0 ? (\n              <TrendingUp className=\"w-4 h-4 text-green-500\" />\n            ) : (\n              <TrendingDown className=\"w-4 h-4 text-red-500\" />\n            )}\n            <span className={`text-xs font-medium ${change >= 0 ? 'text-green-500' : 'text-red-500'}`}>\n              {changePercent >= 0 ? '+' : ''}{changePercent.toFixed(2)}%\n            </span>\n          </div>\n        </div>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-sm\">{symbol}</CardTitle>\n          <div className=\"text-sm font-bold\">\n            {isLoading ? 'Loading...' : formatCurrency(currentPrice)}\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-2\">\n        {isLoading ? (\n          <div className=\"flex items-center justify-center\" style={{ height: height - 100 }}>\n            <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full\" />\n          </div>\n        ) : (\n          <ResponsiveContainer width=\"100%\" height={height - 100}>\n            <LineChart data={chartData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" />\n              <XAxis \n                dataKey=\"displayDate\" \n                stroke=\"hsl(var(--muted-foreground))\"\n                fontSize={10}\n                tick={{ fontSize: 10 }}\n              />\n              <YAxis \n                stroke=\"hsl(var(--muted-foreground))\"\n                fontSize={10}\n                tick={{ fontSize: 10 }}\n                tickFormatter={(value) => `$${value.toFixed(0)}`}\n              />\n              <Tooltip \n                labelFormatter={(label) => `Date: ${label}`}\n                formatter={(value: number) => [formatCurrency(value), symbol]}\n                contentStyle={{\n                  backgroundColor: 'hsl(var(--card))',\n                  border: '1px solid hsl(var(--border))',\n                  borderRadius: '6px'\n                }}\n              />\n              <Line \n                type=\"monotone\" \n                dataKey=\"price\" \n                stroke={change >= 0 ? '#10b981' : '#ef4444'}\n                strokeWidth={2}\n                dot={false}\n                activeDot={{ r: 4, stroke: change >= 0 ? '#10b981' : '#ef4444', strokeWidth: 2 }}\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":5518},"client/src/components/widgets/TradingWidget.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { ShoppingCart, DollarSign, Search } from \"lucide-react\";\n\ninterface TradingWidgetProps {\n  height?: number;\n}\n\nexport function TradingWidget({ height = 400 }: TradingWidgetProps) {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const [buySymbol, setBuySymbol] = useState(\"\");\n  const [buyShares, setBuyShares] = useState(\"\");\n  const [sellSymbol, setSellSymbol] = useState(\"\");\n  const [sellShares, setSellShares] = useState(\"\");\n\n  // Fetch portfolio balance\n  const { data: portfolioData } = useQuery({\n    queryKey: [\"/api/personal-portfolio\"],\n    enabled: !!user,\n  });\n\n  // Fetch stock quote for buying\n  const { data: buyStockData, isLoading: buyLoading } = useQuery({\n    queryKey: [\"/api/quote\", buySymbol],\n    enabled: !!buySymbol && buySymbol.length > 0,\n  });\n\n  // Fetch stock quote for selling\n  const { data: sellStockData, isLoading: sellLoading } = useQuery({\n    queryKey: [\"/api/quote\", sellSymbol],\n    enabled: !!sellSymbol && sellSymbol.length > 0,\n  });\n\n  // Buy stock mutation\n  const buyMutation = useMutation({\n    mutationFn: async (data: { symbol: string; shares: number; price: number }) => {\n      const response = await apiRequest(\"POST\", \"/api/personal-portfolio/buy\", data);\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Failed to buy stock\");\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Purchase Successful\",\n        description: `Successfully purchased ${buyShares} shares of ${buySymbol}`,\n      });\n      setBuySymbol(\"\");\n      setBuyShares(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-portfolio\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-purchases\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Purchase Failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Sell stock mutation\n  const sellMutation = useMutation({\n    mutationFn: async (data: { symbol: string; shares: number; price: number }) => {\n      const response = await apiRequest(\"POST\", \"/api/personal-portfolio/sell\", data);\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Failed to sell stock\");\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Sale Successful\",\n        description: `Successfully sold ${sellShares} shares of ${sellSymbol}`,\n      });\n      setSellSymbol(\"\");\n      setSellShares(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-portfolio\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/personal-purchases\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Sale Failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleBuy = () => {\n    if (!buySymbol || !buyShares || !(buyStockData as any)?.data?.price) {\n      toast({\n        title: \"Invalid Input\",\n        description: \"Please enter a valid symbol and number of shares\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const shares = parseInt(buyShares);\n    const price = (buyStockData as any).data.price;\n    const totalCost = shares * price;\n\n    if (totalCost > parseFloat((portfolioData as any)?.data?.balance || \"0\")) {\n      toast({\n        title: \"Insufficient Funds\",\n        description: \"You don't have enough balance for this purchase\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    buyMutation.mutate({ symbol: buySymbol.toUpperCase(), shares, price });\n  };\n\n  const handleSell = () => {\n    if (!sellSymbol || !sellShares || !(sellStockData as any)?.data?.price) {\n      toast({\n        title: \"Invalid Input\",\n        description: \"Please enter a valid symbol and number of shares\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const shares = parseInt(sellShares);\n    const price = (sellStockData as any).data.price;\n\n    sellMutation.mutate({ symbol: sellSymbol.toUpperCase(), shares, price });\n  };\n\n  const buyPrice = (buyStockData as any)?.data?.price || 0;\n  const sellPrice = (sellStockData as any)?.data?.price || 0;\n  const buyTotal = parseInt(buyShares || \"0\") * buyPrice;\n  const sellTotal = parseInt(sellShares || \"0\") * sellPrice;\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-sm flex items-center gap-2\">\n          <ShoppingCart className=\"w-4 h-4\" />\n          Trading\n        </CardTitle>\n        <div className=\"text-xs text-muted-foreground\">\n          Balance: {formatCurrency(parseFloat((portfolioData as any)?.data?.balance || \"0\"))}\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-2\">\n        <Tabs defaultValue=\"buy\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-2\">\n            <TabsTrigger value=\"buy\" className=\"text-xs\">Buy</TabsTrigger>\n            <TabsTrigger value=\"sell\" className=\"text-xs\">Sell</TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"buy\" className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"buy-symbol\" className=\"text-xs\">Symbol</Label>\n              <Input\n                id=\"buy-symbol\"\n                type=\"text\"\n                placeholder=\"AAPL\"\n                value={buySymbol}\n                onChange={(e) => setBuySymbol(e.target.value.toUpperCase())}\n                className=\"text-xs h-8\"\n                maxLength={10}\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"buy-shares\" className=\"text-xs\">Shares</Label>\n              <Input\n                id=\"buy-shares\"\n                type=\"number\"\n                placeholder=\"100\"\n                value={buyShares}\n                onChange={(e) => setBuyShares(e.target.value)}\n                className=\"text-xs h-8\"\n                min=\"1\"\n              />\n            </div>\n\n            {buySymbol && (buyStockData as any)?.data && (\n              <div className=\"space-y-1 text-xs\">\n                <div className=\"flex justify-between\">\n                  <span>Price:</span>\n                  <span className=\"font-medium\">{formatCurrency(buyPrice)}</span>\n                </div>\n                {buyShares && (\n                  <div className=\"flex justify-between\">\n                    <span>Total:</span>\n                    <span className=\"font-medium\">{formatCurrency(buyTotal)}</span>\n                  </div>\n                )}\n              </div>\n            )}\n\n            <Button\n              onClick={handleBuy}\n              disabled={buyMutation.isPending || buyLoading || !buySymbol || !buyShares}\n              className=\"w-full bg-green-600 hover:bg-green-700 text-white text-xs h-8\"\n            >\n              {buyMutation.isPending ? \"Buying...\" : \"Buy Stock\"}\n            </Button>\n          </TabsContent>\n\n          <TabsContent value=\"sell\" className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"sell-symbol\" className=\"text-xs\">Symbol</Label>\n              <Input\n                id=\"sell-symbol\"\n                type=\"text\"\n                placeholder=\"AAPL\"\n                value={sellSymbol}\n                onChange={(e) => setSellSymbol(e.target.value.toUpperCase())}\n                className=\"text-xs h-8\"\n                maxLength={10}\n              />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"sell-shares\" className=\"text-xs\">Shares</Label>\n              <Input\n                id=\"sell-shares\"\n                type=\"number\"\n                placeholder=\"100\"\n                value={sellShares}\n                onChange={(e) => setSellShares(e.target.value)}\n                className=\"text-xs h-8\"\n                min=\"1\"\n              />\n            </div>\n\n            {sellSymbol && (sellStockData as any)?.data && (\n              <div className=\"space-y-1 text-xs\">\n                <div className=\"flex justify-between\">\n                  <span>Price:</span>\n                  <span className=\"font-medium\">{formatCurrency(sellPrice)}</span>\n                </div>\n                {sellShares && (\n                  <div className=\"flex justify-between\">\n                    <span>Total:</span>\n                    <span className=\"font-medium\">{formatCurrency(sellTotal)}</span>\n                  </div>\n                )}\n              </div>\n            )}\n\n            <Button\n              onClick={handleSell}\n              disabled={sellMutation.isPending || sellLoading || !sellSymbol || !sellShares}\n              className=\"w-full bg-red-600 hover:bg-red-700 text-white text-xs h-8\"\n            >\n              {sellMutation.isPending ? \"Selling...\" : \"Sell Stock\"}\n            </Button>\n          </TabsContent>\n        </Tabs>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":9774},"client/src/components/widgets/WatchlistWidget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Eye, TrendingUp, TrendingDown, Plus } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\ninterface WatchlistWidgetProps {\n  height?: number;\n}\n\nexport function WatchlistWidget({ height = 300 }: WatchlistWidgetProps) {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  // Fetch watchlist\n  const { data: watchlist, isLoading } = useQuery({\n    queryKey: [\"/api/watchlist\"],\n    enabled: !!user,\n    refetchInterval: 60000, // Refresh every minute\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-sm flex items-center gap-2\">\n            <Eye className=\"w-4 h-4\" />\n            Watchlist\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex items-center justify-center\" style={{ height: height - 80 }}>\n          <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const watchlistData = watchlist || [];\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-sm flex items-center gap-2\">\n            <Eye className=\"w-4 h-4\" />\n            Watchlist\n          </CardTitle>\n          <Link href=\"/dashboard\">\n            <Button variant=\"ghost\" size=\"sm\" className=\"h-6 text-xs\">\n              <Plus className=\"w-3 h-3 mr-1\" />\n              Add\n            </Button>\n          </Link>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-2\">\n        <div className=\"space-y-1\" style={{ height: height - 80, overflowY: 'auto' }}>\n          {watchlistData.length === 0 ? (\n            <div className=\"text-center text-muted-foreground text-xs py-4\">\n              No stocks in watchlist\n            </div>\n          ) : (\n            watchlistData.slice(0, 10).map((stock: any, index: number) => (\n              <div \n                key={stock.symbol || index}\n                className=\"flex items-center justify-between p-2 rounded hover:bg-muted/50 transition-colors\"\n              >\n                <div className=\"flex-1\">\n                  <div className=\"font-semibold text-xs\">\n                    {stock.symbol || 'N/A'}\n                  </div>\n                  <div className=\"text-xs text-muted-foreground truncate\">\n                    {stock.name || 'Unknown Company'}\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"text-xs font-medium\">\n                    {formatCurrency(stock.price || 0)}\n                  </div>\n                  <div className={`text-xs flex items-center gap-1 ${\n                    (stock.changePercent || 0) >= 0 ? 'text-green-500' : 'text-red-500'\n                  }`}>\n                    {(stock.changePercent || 0) >= 0 ? (\n                      <TrendingUp className=\"w-3 h-3\" />\n                    ) : (\n                      <TrendingDown className=\"w-3 h-3\" />\n                    )}\n                    {(stock.changePercent || 0).toFixed(2)}%\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3624},"client/src/components/portfolio/widgets/MarketNewsWidget.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { ExternalLink, Clock } from \"lucide-react\";\n\nconst mockNews = [\n  {\n    id: 1,\n    title: \"Fed Signals Potential Rate Cut as Inflation Cools\",\n    source: \"Financial Times\",\n    time: \"2h ago\",\n    category: \"Economy\"\n  },\n  {\n    id: 2,\n    title: \"Tech Stocks Rally on Strong Earnings Reports\",\n    source: \"MarketWatch\",\n    time: \"4h ago\",\n    category: \"Technology\"\n  },\n  {\n    id: 3,\n    title: \"Energy Sector Gains on Rising Oil Prices\",\n    source: \"Reuters\",\n    time: \"6h ago\",\n    category: \"Energy\"\n  },\n  {\n    id: 4,\n    title: \"Consumer Spending Shows Resilience Despite Headwinds\",\n    source: \"Bloomberg\",\n    time: \"8h ago\",\n    category: \"Consumer\"\n  }\n];\n\nexport function MarketNewsWidget() {\n  return (\n    <div className=\"p-4 h-full flex flex-col\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <h3 className=\"text-sm font-medium text-foreground\">Market News</h3>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          Live\n        </Badge>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto space-y-3\">\n        {mockNews.map((article) => (\n          <div\n            key={article.id}\n            className=\"p-3 rounded-lg border border-border/50 hover:bg-muted/30 transition-colors cursor-pointer group\"\n          >\n            <div className=\"flex items-start justify-between gap-2 mb-2\">\n              <h4 className=\"text-sm font-medium text-foreground group-hover:text-primary transition-colors line-clamp-2\">\n                {article.title}\n              </h4>\n              <ExternalLink className=\"h-3 w-3 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0\" />\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-xs text-muted-foreground\">\n                  {article.source}\n                </span>\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  {article.category}\n                </Badge>\n              </div>\n              \n              <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                <Clock className=\"h-3 w-3\" />\n                {article.time}\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"mt-2 pt-2 border-t border-border/50\">\n        <Button size=\"sm\" variant=\"ghost\" className=\"w-full text-xs\">\n          View more news\n        </Button>\n      </div>\n    </div>\n  );\n}","size_bytes":2662},"client/src/components/portfolio/widgets/MarketOverview.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { BarChart3, TrendingUp, TrendingDown } from \"lucide-react\";\n\nexport function MarketOverview() {\n  const { data: marketData, isLoading } = useQuery({\n    queryKey: ['/api/popular'],\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg\">Market Overview</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"animate-pulse space-y-3\">\n            {[1, 2, 3, 4].map((i) => (\n              <div key={i} className=\"flex justify-between items-center\">\n                <div className=\"h-4 bg-muted rounded w-16\"></div>\n                <div className=\"h-4 bg-muted rounded w-20\"></div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const stocks = marketData?.data?.slice(0, 6) || [];\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg flex items-center space-x-2\">\n          <BarChart3 className=\"w-5 h-5\" />\n          <span>Market Overview</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3\">\n          {stocks.map((stock: any) => {\n            const change = parseFloat(stock.changePercent || 0);\n            const isPositive = change >= 0;\n            \n            return (\n              <div key={stock.symbol} className=\"flex justify-between items-center\">\n                <div className=\"flex items-center space-x-2\">\n                  <span className=\"font-medium text-sm\">{stock.symbol}</span>\n                  {isPositive ? (\n                    <TrendingUp className=\"w-3 h-3 text-green-600\" />\n                  ) : (\n                    <TrendingDown className=\"w-3 h-3 text-red-600\" />\n                  )}\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <span className=\"text-sm\">${stock.price?.toFixed(2)}</span>\n                  <Badge variant={isPositive ? \"default\" : \"destructive\"} className=\"text-xs\">\n                    {isPositive ? '+' : ''}{change.toFixed(2)}%\n                  </Badge>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":2472},"client/src/components/portfolio/widgets/PerformanceChart.tsx":{"content":"/*\n * TRADINGVIEW LIGHTWEIGHT CHARTS COMPONENT\n * =======================================\n * \n * Features:\n * - Professional price charts using TradingView's Lightweight Charts\n * - Integrates with portfolio holdings and Yahoo Finance API\n * - Dark theme optimized styling\n * - Manual data mode for custom testing/development\n * - Responsive design with timeframe dropdown\n * - Multiple timeframe support (1D, 5D, 1M, 3M, 6M, 1Y)\n * \n * Usage:\n * - Select symbol from your portfolio holdings or default stocks\n * - Choose timeframe from dropdown menu\n * - Chart updates automatically with real market data\n * - Toggle manual mode for custom data testing\n */\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { TrendingUp, RefreshCw, Search } from \"lucide-react\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { createChart, ColorType, LineSeries } from 'lightweight-charts';\n\ninterface PerformanceChartProps {\n  selectedStock?: string | null;\n}\n\nexport function PerformanceChart({ selectedStock }: PerformanceChartProps = {}) {\n  const { user } = useAuth();\n  const chartContainerRef = useRef<HTMLDivElement>(null);\n  const chartRef = useRef<any>(null);\n  const seriesRef = useRef<any>(null);\n  \n  const [selectedSymbol, setSelectedSymbol] = useState<string>(selectedStock || \"NVDA\");\n  const [searchQuery, setSearchQuery] = useState<string>(selectedStock || \"NVDA\");\n  \n  const [selectedTimeframe, setSelectedTimeframe] = useState<string>(\"1M\");\n  \n  // Update chart when selectedStock prop changes\n  useEffect(() => {\n    if (selectedStock && selectedStock !== selectedSymbol) {\n      setSelectedSymbol(selectedStock);\n      setSearchQuery(selectedStock);\n      // Need to wait for updateChart to be defined\n      setTimeout(() => updateChart(selectedStock, selectedTimeframe), 100);\n    }\n  }, [selectedStock]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [searchResults, setSearchResults] = useState<any[]>([]);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [isSearching, setIsSearching] = useState(false);\n\n  // Search for companies/stocks as user types\n  const searchCompanies = async (query: string) => {\n    if (query.length < 2) {\n      setSearchResults([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    setIsSearching(true);\n    try {\n      const response = await fetch(`/api/search/${encodeURIComponent(query)}`);\n      const data = await response.json();\n      \n      if (data.success && data.data && Array.isArray(data.data)) {\n        setSearchResults(data.data.slice(0, 8)); // Limit to 8 results\n        setShowDropdown(true);\n      } else {\n        setSearchResults([]);\n        setShowDropdown(false);\n      }\n    } catch (error) {\n      console.error('Error searching companies:', error);\n      setSearchResults([]);\n      setShowDropdown(false);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  // Handle search input changes\n  const handleSearchInput = (value: string) => {\n    setSearchQuery(value);\n    if (value.trim().length >= 2) {\n      searchCompanies(value.trim());\n    } else {\n      setSearchResults([]);\n      setShowDropdown(false);\n    }\n  };\n\n  // Handle selecting a search result\n  const selectSearchResult = (result: any) => {\n    const symbol = result.symbol;\n    setSearchQuery(symbol);\n    setSelectedSymbol(symbol);\n    setShowDropdown(false);\n    updateChart(symbol, selectedTimeframe);\n  };\n\n  // Handle Enter key for direct symbol search\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      if (searchQuery.trim()) {\n        setSelectedSymbol(searchQuery.trim().toUpperCase());\n        updateChart(searchQuery.trim().toUpperCase(), selectedTimeframe);\n        setShowDropdown(false);\n      }\n    }\n  };\n\n  // Get portfolio data to show available holdings\n  const { data: portfolioData } = useQuery({\n    queryKey: [\"/api/personal-portfolio\"],\n    enabled: !!user\n  });\n\n  const portfolio = (portfolioData as any)?.data;\n  const holdings = portfolio?.holdings || [];\n\n  // Fetch historical price data\n  const fetchChartData = async (symbol: string, timeframe: string) => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(`/api/historical/${symbol}?timeframe=${timeframe}`);\n      const data = await response.json();\n      \n      if (data.success && data.data && Array.isArray(data.data)) {\n        const chartData = data.data.map((item: any) => ({\n          time: typeof item.date === 'number' ? item.date : item.date,\n          value: parseFloat(item.close) || 0\n        }));\n        // Sort by time to ensure proper left-to-right display\n        chartData.sort((a: any, b: any) => {\n          const timeA = typeof a.time === 'number' ? a.time : new Date(a.time).getTime() / 1000;\n          const timeB = typeof b.time === 'number' ? b.time : new Date(b.time).getTime() / 1000;\n          return timeA - timeB;\n        });\n        return chartData;\n      }\n      return [];\n    } catch (error) {\n      console.error('Error fetching chart data:', error);\n      return [];\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Initialize TradingView chart\n  const initializeChart = () => {\n    if (!chartContainerRef.current) return;\n\n    // Remove existing chart\n    if (chartRef.current) {\n      chartRef.current.remove();\n    }\n\n    const chart = createChart(chartContainerRef.current, {\n      layout: {\n        background: { type: ColorType.Solid, color: 'transparent' },\n        textColor: '#ffffff',\n      },\n      grid: {\n        vertLines: { color: 'rgba(255, 255, 255, 0.1)' },\n        horzLines: { color: 'rgba(255, 255, 255, 0.1)' },\n      },\n      crosshair: {\n        mode: 1,\n      },\n      rightPriceScale: {\n        borderColor: 'rgba(255, 255, 255, 0.3)',\n      },\n      timeScale: {\n        borderColor: 'rgba(255, 255, 255, 0.3)',\n        timeVisible: true,\n        secondsVisible: false,\n        rightOffset: 5,\n        barSpacing: 6,\n        fixLeftEdge: true,\n        fixRightEdge: true,\n      },\n      width: chartContainerRef.current.clientWidth,\n      height: 400,\n    });\n\n    // Add line series using correct API\n    const lineSeries = chart.addSeries(LineSeries, {\n      color: '#26a69a',\n      lineWidth: 2,\n    });\n\n    chartRef.current = chart;\n    seriesRef.current = lineSeries;\n\n    // Handle resize\n    const handleResize = () => {\n      if (chartRef.current && chartContainerRef.current) {\n        chartRef.current.applyOptions({\n          width: chartContainerRef.current.clientWidth,\n        });\n      }\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  };\n\n  // Update chart data\n  const updateChart = async (symbol: string, timeframe: string) => {\n    if (!seriesRef.current || !chartRef.current) return;\n\n    const data = await fetchChartData(symbol, timeframe);\n    \n    if (data.length > 0) {\n      seriesRef.current.setData(data);\n      \n      // Add a small delay to ensure data is loaded before fitting\n      setTimeout(() => {\n        if (chartRef.current) {\n          // Fit the chart content to show all data from left to right\n          chartRef.current.timeScale().fitContent();\n        }\n      }, 100);\n    }\n  };\n\n  // Initialize chart on mount\n  useEffect(() => {\n    const cleanup = initializeChart();\n    // Load initial data after chart is initialized\n    setTimeout(() => {\n      if (selectedSymbol && selectedTimeframe) {\n        updateChart(selectedSymbol, selectedTimeframe);\n      }\n    }, 200);\n    return cleanup;\n  }, []);\n\n  // Update chart when symbol or timeframe changes\n  useEffect(() => {\n    if (selectedSymbol && selectedTimeframe) {\n      updateChart(selectedSymbol, selectedTimeframe);\n    }\n  }, [selectedSymbol, selectedTimeframe]);\n\n  // Set default symbol to first holding if available\n  useEffect(() => {\n    if (holdings.length > 0 && selectedSymbol === \"NVDA\") {\n      setSelectedSymbol(holdings[0].symbol);\n    }\n  }, [holdings]);\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg flex items-center space-x-2\">\n            <TrendingUp className=\"w-5 h-5\" />\n            <span>Price Chart - {selectedSymbol}</span>\n          </CardTitle>\n          <div className=\"flex items-center space-x-2\">\n            {/* Symbol Search Bar with Autocomplete */}\n            <div className=\"relative\">\n              <Search className=\"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n              <Input\n                type=\"text\"\n                value={searchQuery}\n                onChange={(e) => handleSearchInput(e.target.value)}\n                onKeyDown={handleKeyDown}\n                onFocus={() => searchQuery.length >= 2 && setShowDropdown(true)}\n                onBlur={() => setTimeout(() => setShowDropdown(false), 200)}\n                placeholder=\"Search stocks, crypto...\"\n                className=\"pl-8 w-48 h-8\"\n              />\n              \n              {/* Search Results Dropdown */}\n              {showDropdown && (searchResults.length > 0 || isSearching) && (\n                <div className=\"absolute top-full right-0 w-80 mt-1 bg-background border border-border rounded-md shadow-lg z-50 max-h-64 overflow-y-auto\">\n                  {isSearching ? (\n                    <div className=\"p-3 text-center text-muted-foreground\">\n                      <RefreshCw className=\"w-4 h-4 animate-spin mx-auto mb-1\" />\n                      Searching...\n                    </div>\n                  ) : (\n                    searchResults.map((result, index) => (\n                      <div\n                        key={index}\n                        onClick={() => selectSearchResult(result)}\n                        className=\"p-3 hover:bg-accent cursor-pointer border-b border-border last:border-b-0\"\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-center space-x-2\">\n                              <span className=\"font-medium text-sm\">{result.symbol}</span>\n                              <span className=\"text-xs text-muted-foreground truncate\">\n                                {result.name || result.shortName || result.companyName}\n                              </span>\n                            </div>\n                            {result.exchange && (\n                              <div className=\"text-xs text-muted-foreground mt-1\">\n                                {result.exchange}\n                              </div>\n                            )}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            Chart\n                          </div>\n                        </div>\n                      </div>\n                    ))\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Timeframe Selector */}\n            <Select value={selectedTimeframe} onValueChange={setSelectedTimeframe}>\n              <SelectTrigger className=\"w-24\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"1D\">1D</SelectItem>\n                <SelectItem value=\"5D\">5D</SelectItem>\n                <SelectItem value=\"1M\">1M</SelectItem>\n                <SelectItem value=\"3M\">3M</SelectItem>\n                <SelectItem value=\"6M\">6M</SelectItem>\n                <SelectItem value=\"1Y\">1Y</SelectItem>\n              </SelectContent>\n            </Select>\n\n            {/* Refresh Button */}\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => updateChart(selectedSymbol, selectedTimeframe)}\n              disabled={isLoading}\n            >\n              <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"h-[430px] w-full relative\">\n          {isLoading && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-background/80 z-10\">\n              <RefreshCw className=\"w-6 h-6 animate-spin mr-2\" />\n              <span className=\"text-muted-foreground\">Loading chart data...</span>\n            </div>\n          )}\n          <div \n            ref={chartContainerRef} \n            className=\"w-full h-full rounded-md\"\n          />\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":13029},"client/src/components/portfolio/widgets/PerformanceChartWidget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { LineChart, Line, XAxis, YAxis, ResponsiveContainer, Tooltip } from \"recharts\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\nexport function PerformanceChartWidget() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  const { data: historyData } = useQuery({\n    queryKey: [\"/api/portfolio-history\", 0], // Personal portfolio\n    enabled: !!user\n  });\n\n  const history = (historyData?.data as any[]) || [];\n  // Generate mock data if no real data exists\n  const chartData = Array.isArray(history) && history.length > 0 ? history : generateMockData();\n\n  return (\n    <div className=\"p-4 h-full flex flex-col\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <h3 className=\"text-sm font-medium text-foreground\">Portfolio Performance</h3>\n        <div className=\"flex gap-1\">\n          {['1D', '1W', '1M', '3M', '1Y'].map((period) => (\n            <button\n              key={period}\n              className=\"px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors\"\n            >\n              {period}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"flex-1 min-h-0\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <LineChart data={chartData}>\n            <XAxis \n              dataKey=\"date\" \n              axisLine={false}\n              tickLine={false}\n              tick={{ fontSize: 10, fill: '#6b7280' }}\n            />\n            <YAxis \n              axisLine={false}\n              tickLine={false}\n              tick={{ fontSize: 10, fill: '#6b7280' }}\n              tickFormatter={(value) => `$${(value / 1000).toFixed(0)}K`}\n            />\n            <Tooltip\n              contentStyle={{\n                backgroundColor: 'hsl(var(--card))',\n                border: '1px solid hsl(var(--border))',\n                borderRadius: '6px',\n                fontSize: '12px'\n              }}\n              formatter={(value: number) => [formatCurrency(value), 'Portfolio Value']}\n            />\n            <Line\n              type=\"monotone\"\n              dataKey=\"value\"\n              stroke=\"hsl(var(--primary))\"\n              strokeWidth={2}\n              dot={false}\n              activeDot={{ r: 4, fill: 'hsl(var(--primary))' }}\n            />\n          </LineChart>\n        </ResponsiveContainer>\n      </div>\n    </div>\n  );\n}\n\nfunction generateMockData() {\n  const data = [];\n  const startDate = new Date();\n  startDate.setDate(startDate.getDate() - 30);\n  \n  let value = 10000;\n  \n  for (let i = 0; i < 30; i++) {\n    const date = new Date(startDate);\n    date.setDate(date.getDate() + i);\n    \n    // Random walk with slight upward bias\n    value += (Math.random() - 0.45) * 200;\n    value = Math.max(8000, Math.min(15000, value));\n    \n    data.push({\n      date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),\n      value: Math.round(value)\n    });\n  }\n  \n  return data;\n}","size_bytes":3083},"client/src/components/portfolio/widgets/PortfolioHoldingsWidget.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { TrendingUp, TrendingDown, Building, BarChart3 } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { SellStockDialog } from \"@/components/trading/SellStockDialog\";\n\ninterface PortfolioHoldingsWidgetProps {\n  onSelectStock?: (symbol: string) => void;\n}\n\nexport function PortfolioHoldingsWidget({ onSelectStock }: PortfolioHoldingsWidgetProps = {}) {\n  const { user } = useAuth();\n  const { formatCurrency, t } = useUserPreferences();\n  const [sellDialogOpen, setSellDialogOpen] = useState(false);\n  const [selectedStock, setSelectedStock] = useState<any>(null);\n\n  const { data: portfolioData } = useQuery({\n    queryKey: [\"/api/personal-portfolio\"],\n    enabled: !!user\n  });\n\n  const portfolio = (portfolioData as any)?.data;\n  const holdings = portfolio?.holdings || [];\n\n  const handleSell = (stock: any) => {\n    setSelectedStock(stock);\n    setSellDialogOpen(true);\n  };\n\n  if (!Array.isArray(holdings) || !holdings.length) {\n    return (\n      <>\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg flex items-center space-x-2\">\n            <Building className=\"w-5 h-5\" />\n            <span>{t('holdings')}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"flex items-center justify-center h-full\">\n          <div className=\"text-center text-muted-foreground\">\n            <p className=\"text-sm\">{t('noData')}</p>\n            <p className=\"text-xs mt-1\">{t('startTradingMessage')}</p>\n          </div>\n        </CardContent>\n        \n        <SellStockDialog\n          open={sellDialogOpen}\n          onOpenChange={setSellDialogOpen}\n          stock={selectedStock}\n        />\n      </>\n    );\n  }\n\n  return (\n    <>\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Building className=\"w-5 h-5\" />\n            <span>{t('holdings')}</span>\n          </div>\n          <Badge variant=\"secondary\" className=\"text-xs\">\n            {holdings.length} positions\n          </Badge>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"flex-1 overflow-y-auto\">\n        <div className=\"space-y-2\">\n          {/* Table Header */}\n          <div className=\"grid grid-cols-7 gap-2 px-3 py-2 text-xs font-medium text-muted-foreground border-b\">\n            <div>Symbol</div>\n            <div>Shares</div>\n            <div>Purchase Price</div>\n            <div>Current Price</div>\n            <div>Change</div>\n            <div>Value</div>\n            <div>Actions</div>\n          </div>\n          \n          {holdings.map((holding: any) => {\n            const totalCost = holding.shares * holding.averagePrice;\n            const currentValue = holding.shares * holding.currentPrice;\n            const gainLoss = currentValue - totalCost;\n            const gainLossPercent = (gainLoss / totalCost) * 100;\n            const priceChange = holding.currentPrice - holding.averagePrice;\n            const priceChangePercent = (priceChange / holding.averagePrice) * 100;\n            const isPositive = gainLoss >= 0;\n\n            return (\n              <div\n                key={holding.symbol}\n                className=\"grid grid-cols-7 gap-2 px-3 py-2 rounded-lg border border-border/50 hover:bg-muted/30 transition-colors items-center\"\n              >\n                <div className=\"flex flex-col\">\n                  <span className=\"font-medium text-sm text-foreground\">\n                    {holding.symbol}\n                  </span>\n                  <span className=\"text-xs text-muted-foreground truncate\">\n                    {holding.companyName || holding.symbol}\n                  </span>\n                </div>\n                \n                <div className=\"text-sm\">\n                  {holding.shares}\n                </div>\n                \n                <div className=\"text-sm\">\n                  {formatCurrency(holding.averagePrice)}\n                </div>\n                \n                <div className=\"text-sm font-medium\">\n                  {formatCurrency(holding.currentPrice)}\n                </div>\n                \n                <div className={`text-sm flex items-center gap-1 ${\n                  isPositive ? 'text-green-500' : 'text-red-500'\n                }`}>\n                  {isPositive ? (\n                    <TrendingUp className=\"h-3 w-3\" />\n                  ) : (\n                    <TrendingDown className=\"h-3 w-3\" />\n                  )}\n                  <div className=\"flex flex-col\">\n                    <span>{isPositive ? '+' : ''}{formatCurrency(priceChange)}</span>\n                    <span className=\"text-xs\">({isPositive ? '+' : ''}{priceChangePercent.toFixed(2)}%)</span>\n                  </div>\n                </div>\n                \n                <div className=\"text-sm font-medium\">\n                  {formatCurrency(currentValue)}\n                </div>\n                \n                <div className=\"flex gap-1\">\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => onSelectStock?.(holding.symbol)}\n                    className=\"text-xs px-2 py-1 h-7\"\n                    title=\"View chart\"\n                  >\n                    <BarChart3 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleSell(holding)}\n                    className=\"text-xs px-2 py-1 h-7\"\n                  >\n                    Sell\n                  </Button>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </CardContent>\n      \n      <SellStockDialog\n        open={sellDialogOpen}\n        onOpenChange={setSellDialogOpen}\n        stock={selectedStock}\n      />\n    </>\n  );\n}","size_bytes":6241},"client/src/components/portfolio/widgets/PortfolioSummary.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { TrendingUp, TrendingDown, DollarSign, Target } from \"lucide-react\";\n\nexport function PortfolioSummary() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  const { data: portfolioData, isLoading } = useQuery({\n    queryKey: ['/api/portfolio/personal'],\n    enabled: !!user,\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg\">Portfolio Summary</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"animate-pulse space-y-3\">\n            <div className=\"h-4 bg-muted rounded w-3/4\"></div>\n            <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n            <div className=\"h-4 bg-muted rounded w-2/3\"></div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const totalValue = portfolioData?.data?.totalValue || 10000;\n  const initialDeposit = 10000;\n  const totalGain = totalValue - initialDeposit;\n  const totalGainPercent = ((totalGain / initialDeposit) * 100);\n  const isPositive = totalGain >= 0;\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg flex items-center space-x-2\">\n          <DollarSign className=\"w-5 h-5\" />\n          <span>Portfolio Summary</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"space-y-3\">\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-sm text-muted-foreground\">Total Value</span>\n            <span className=\"text-lg font-bold\">{formatCurrency(totalValue)}</span>\n          </div>\n          \n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-sm text-muted-foreground\">Initial Deposit</span>\n            <span className=\"text-sm\">{formatCurrency(initialDeposit)}</span>\n          </div>\n          \n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-sm text-muted-foreground\">Total Gain/Loss</span>\n            <div className=\"flex items-center space-x-2\">\n              {isPositive ? (\n                <TrendingUp className=\"w-4 h-4 text-green-600\" />\n              ) : (\n                <TrendingDown className=\"w-4 h-4 text-red-600\" />\n              )}\n              <span className={`text-sm font-medium ${isPositive ? 'text-green-600' : 'text-red-600'}`}>\n                {formatCurrency(Math.abs(totalGain))}\n              </span>\n              <Badge variant={isPositive ? \"default\" : \"destructive\"} className=\"text-xs\">\n                {isPositive ? '+' : ''}{totalGainPercent.toFixed(2)}%\n              </Badge>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3122},"client/src/components/portfolio/widgets/PortfolioSummaryWidget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { TrendingUp, TrendingDown, DollarSign, Target, Building } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\nexport function PortfolioSummaryWidget() {\n  const { user } = useAuth();\n  const { formatCurrency, t } = useUserPreferences();\n\n  const { data: portfolioData } = useQuery({\n    queryKey: [\"/api/personal-portfolio\"],\n    enabled: !!user\n  });\n\n  const portfolio = (portfolioData as any)?.data;\n  const balance = Number(portfolio?.balance) || 0;\n  const holdings = portfolio?.holdings || [];\n  \n  // Calculate total stock value from holdings\n  const stockValue = holdings.reduce((total: number, holding: any) => {\n    return total + (holding.shares * holding.currentPrice);\n  }, 0);\n  \n  // Total portfolio value = cash balance + stock value\n  const totalValue = balance + stockValue;\n  \n  // Calculate P&L based on initial $10,000 deposit\n  const initialDeposit = 10000;\n  const totalGainLoss = totalValue - initialDeposit;\n  const totalGainLossPercent = (totalGainLoss / initialDeposit) * 100;\n\n  const isPositive = totalGainLoss >= 0;\n\n  return (\n    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-muted/20 rounded-lg border\">\n      {/* Total Portfolio Value */}\n      <div className=\"flex flex-col items-center text-center\">\n        <div className=\"flex items-center space-x-1 mb-1\">\n          <DollarSign className=\"h-4 w-4 text-primary\" />\n          <span className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">{t('totalValue')}</span>\n        </div>\n        <span className=\"text-lg font-bold text-foreground\">{formatCurrency(totalValue)}</span>\n      </div>\n\n      {/* Cash Balance */}\n      <div className=\"flex flex-col items-center text-center\">\n        <div className=\"flex items-center space-x-1 mb-1\">\n          <Target className=\"h-4 w-4 text-blue-500\" />\n          <span className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">{t('availableCash')}</span>\n        </div>\n        <span className=\"text-lg font-bold text-foreground\">{formatCurrency(balance)}</span>\n      </div>\n\n      {/* Profit/Loss */}\n      <div className=\"flex flex-col items-center text-center\">\n        <div className=\"flex items-center space-x-1 mb-1\">\n          {isPositive ? (\n            <TrendingUp className=\"h-4 w-4 text-green-500\" />\n          ) : (\n            <TrendingDown className=\"h-4 w-4 text-red-500\" />\n          )}\n          <span className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">{t('profitLoss')}</span>\n        </div>\n        <div className=\"flex flex-col items-center\">\n          <span className={`text-lg font-bold ${isPositive ? 'text-green-500' : 'text-red-500'}`}>\n            {isPositive ? '+' : ''}{formatCurrency(totalGainLoss)}\n          </span>\n          <span className={`text-xs ${isPositive ? 'text-green-500' : 'text-red-500'}`}>\n            ({isPositive ? '+' : ''}{totalGainLossPercent.toFixed(2)}%)\n          </span>\n        </div>\n      </div>\n\n      {/* Holdings Count */}\n      <div className=\"flex flex-col items-center text-center\">\n        <div className=\"flex items-center space-x-1 mb-1\">\n          <Building className=\"h-4 w-4 text-purple-500\" />\n          <span className=\"text-xs font-medium text-muted-foreground uppercase tracking-wide\">Holdings</span>\n        </div>\n        <span className=\"text-lg font-bold text-foreground\">\n          {Array.isArray(portfolio?.holdings) ? portfolio.holdings.length : 0}\n        </span>\n      </div>\n    </div>\n  );\n}","size_bytes":3631},"client/src/components/portfolio/widgets/RecentOrdersWidget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Clock, ArrowUpRight, ArrowDownRight } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\n\nexport function RecentOrdersWidget() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  const { data: purchasesData } = useQuery({\n    queryKey: [\"/api/personal-purchases\"],\n    enabled: !!user\n  });\n\n  const purchases = (purchasesData?.data as any[]) || [];\n\n  const recentOrders = Array.isArray(purchases) ? purchases.slice(0, 5).map((purchase: any) => ({\n    ...purchase,\n    type: 'buy',\n    timestamp: purchase.purchaseDate || new Date().toISOString()\n  })) : [];\n\n  if (!recentOrders.length) {\n    return (\n      <div className=\"p-4 h-full flex items-center justify-center\">\n        <div className=\"text-center text-muted-foreground\">\n          <Clock className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n          <p className=\"text-sm\">No recent orders</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-4 h-full flex flex-col\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <h3 className=\"text-sm font-medium text-foreground\">Recent Orders</h3>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {recentOrders.length}\n        </Badge>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto space-y-2\">\n        {recentOrders.map((order: any) => {\n          const isBuy = order.type === 'buy';\n          const totalValue = order.shares * order.purchasePrice;\n\n          return (\n            <div\n              key={order.id}\n              className=\"flex items-center justify-between p-3 rounded-lg border border-border/50 hover:bg-muted/30 transition-colors\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className={`p-1 rounded-full ${\n                  isBuy ? 'bg-green-500/10' : 'bg-red-500/10'\n                }`}>\n                  {isBuy ? (\n                    <ArrowUpRight className=\"h-3 w-3 text-green-500\" />\n                  ) : (\n                    <ArrowDownRight className=\"h-3 w-3 text-red-500\" />\n                  )}\n                </div>\n                \n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"font-medium text-sm text-foreground\">\n                      {order.symbol}\n                    </span>\n                    <Badge variant={isBuy ? \"default\" : \"secondary\"} className=\"text-xs\">\n                      {isBuy ? 'BUY' : 'SELL'}\n                    </Badge>\n                  </div>\n                  <div className=\"text-xs text-muted-foreground\">\n                    {order.shares} shares @ {formatCurrency(order.purchasePrice)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"text-right\">\n                <div className=\"text-sm font-medium text-foreground\">\n                  {formatCurrency(totalValue)}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">\n                  {new Date(order.timestamp).toLocaleDateString()}\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      <div className=\"mt-2 pt-2 border-t border-border/50\">\n        <Button size=\"sm\" variant=\"ghost\" className=\"w-full text-xs\">\n          View all orders\n        </Button>\n      </div>\n    </div>\n  );\n}","size_bytes":3639},"client/src/components/portfolio/widgets/RecentTrades.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useUserPreferences } from \"@/contexts/UserPreferencesContext\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Activity, ArrowUpRight, ArrowDownRight, Calendar } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\nexport function RecentTrades() {\n  const { user } = useAuth();\n  const { formatCurrency } = useUserPreferences();\n\n  const { data: tradesData, isLoading } = useQuery({\n    queryKey: ['/api/portfolio/personal'],\n    enabled: !!user,\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg\">Recent Trades</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"animate-pulse space-y-3\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex justify-between items-center\">\n                <div className=\"h-4 bg-muted rounded w-24\"></div>\n                <div className=\"h-4 bg-muted rounded w-16\"></div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const trades = tradesData?.data?.purchases?.slice(0, 5) || [];\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg flex items-center space-x-2\">\n          <Activity className=\"w-5 h-5\" />\n          <span>Recent Trades</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        {trades.length === 0 ? (\n          <div className=\"text-center text-muted-foreground py-4\">\n            <Activity className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n            <p className=\"text-sm\">No recent trades</p>\n            <p className=\"text-xs mt-1\">Start trading to see your activity here</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {trades.map((trade: any) => (\n              <div key={trade.id} className=\"flex justify-between items-center\">\n                <div className=\"flex items-center space-x-2\">\n                  <ArrowUpRight className=\"w-4 h-4 text-green-600\" />\n                  <div>\n                    <div className=\"font-medium text-sm\">{trade.symbol}</div>\n                    <div className=\"text-xs text-muted-foreground flex items-center space-x-1\">\n                      <Calendar className=\"w-3 h-3\" />\n                      <span>{format(new Date(trade.createdAt), 'MMM d')}</span>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"text-sm font-medium\">{trade.quantity} shares</div>\n                  <div className=\"text-xs text-muted-foreground\">\n                    {formatCurrency(trade.purchasePrice)}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3059},"client/src/components/portfolio/widgets/TournamentPerformanceChart.tsx":{"content":"/*\n * TOURNAMENT PERFORMANCE CHART COMPONENT\n * =====================================\n * \n * Features:\n * - Professional price charts using TradingView's Lightweight Charts\n * - Tournament-specific data integration\n * - Dark theme optimized styling\n * - Responsive design with timeframe dropdown\n * - Multiple timeframe support (1D, 5D, 1M, 3M, 6M, 1Y)\n * - Search functionality for stocks and crypto\n * \n * Usage:\n * - Displays charts for tournament trading\n * - Search and select symbols to view their charts\n * - Chart updates automatically with real market data\n */\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { TrendingUp, RefreshCw, Search } from \"lucide-react\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { createChart, ColorType, LineSeries } from 'lightweight-charts';\n\ninterface TournamentPerformanceChartProps {\n  tournamentId: number;\n  selectedStock?: string | null;\n}\n\nexport function TournamentPerformanceChart({ tournamentId, selectedStock }: TournamentPerformanceChartProps) {\n  const { user } = useAuth();\n  const chartContainerRef = useRef<HTMLDivElement>(null);\n  const chartRef = useRef<any>(null);\n  const seriesRef = useRef<any>(null);\n  \n  const [selectedSymbol, setSelectedSymbol] = useState<string>(selectedStock || \"NVDA\");\n  const [searchQuery, setSearchQuery] = useState<string>(selectedStock || \"NVDA\");\n  \n  // Update chart when selectedStock prop changes\n  useEffect(() => {\n    if (selectedStock && selectedStock !== selectedSymbol) {\n      setSelectedSymbol(selectedStock);\n      setSearchQuery(selectedStock);\n      setTimeout(() => updateChart(selectedStock, selectedTimeframe), 100);\n    }\n  }, [selectedStock]);\n  const [selectedTimeframe, setSelectedTimeframe] = useState<string>(\"1M\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [searchResults, setSearchResults] = useState<any[]>([]);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [isSearching, setIsSearching] = useState(false);\n\n  // Search for companies/stocks as user types\n  const searchCompanies = async (query: string) => {\n    if (query.length < 2) {\n      setSearchResults([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    setIsSearching(true);\n    try {\n      const response = await fetch(`/api/search/${encodeURIComponent(query)}`);\n      const data = await response.json();\n      \n      if (data.success && data.data && Array.isArray(data.data)) {\n        setSearchResults(data.data.slice(0, 8)); // Limit to 8 results\n        setShowDropdown(true);\n      } else {\n        setSearchResults([]);\n        setShowDropdown(false);\n      }\n    } catch (error) {\n      console.error('Error searching companies:', error);\n      setSearchResults([]);\n      setShowDropdown(false);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  // Handle search input changes\n  const handleSearchInput = (value: string) => {\n    setSearchQuery(value);\n    if (value.trim().length >= 2) {\n      searchCompanies(value.trim());\n    } else {\n      setSearchResults([]);\n      setShowDropdown(false);\n    }\n  };\n\n  // Handle selecting a search result\n  const selectSearchResult = (result: any) => {\n    const symbol = result.symbol;\n    setSearchQuery(symbol);\n    setSelectedSymbol(symbol);\n    setShowDropdown(false);\n    updateChart(symbol, selectedTimeframe);\n  };\n\n  // Handle Enter key for direct symbol search\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      if (searchQuery.trim()) {\n        setSelectedSymbol(searchQuery.trim().toUpperCase());\n        updateChart(searchQuery.trim().toUpperCase(), selectedTimeframe);\n        setShowDropdown(false);\n      }\n    }\n  };\n\n  // Get tournament portfolio data to show available holdings\n  const { data: portfolioData } = useQuery({\n    queryKey: [\"/api/portfolio/tournament\", tournamentId],\n    enabled: !!user && !!tournamentId\n  });\n\n  const portfolio = (portfolioData as any)?.data;\n  const holdings = portfolio?.holdings || [];\n\n  // Fetch historical price data\n  const fetchChartData = async (symbol: string, timeframe: string) => {\n    try {\n      const response = await fetch(`/api/historical/${symbol}?timeframe=${timeframe}`);\n      const data = await response.json();\n      \n      if (data.success && data.data) {\n        const chartData = data.data.map((item: any) => ({\n          time: typeof item.date === 'number' ? item.date : item.date,\n          value: parseFloat(item.close) || 0\n        }));\n        // Sort by time to ensure proper left-to-right display\n        chartData.sort((a: any, b: any) => {\n          const timeA = typeof a.time === 'number' ? a.time : new Date(a.time).getTime() / 1000;\n          const timeB = typeof b.time === 'number' ? b.time : new Date(b.time).getTime() / 1000;\n          return timeA - timeB;\n        });\n        return chartData;\n      }\n      return [];\n    } catch (error) {\n      console.error('Error fetching chart data:', error);\n      return [];\n    }\n  };\n\n  // Update chart data\n  const updateChart = async (symbol: string, timeframe: string) => {\n    if (!seriesRef.current || !chartRef.current) return;\n\n    setIsLoading(true);\n    try {\n      const data = await fetchChartData(symbol, timeframe);\n      \n      if (data.length > 0) {\n        seriesRef.current.setData(data);\n        \n        // Add a small delay to ensure data is loaded before fitting\n        setTimeout(() => {\n          if (chartRef.current) {\n            // Fit the chart content to show all data from left to right\n            chartRef.current.timeScale().fitContent();\n          }\n        }, 100);\n      }\n    } catch (error) {\n      console.error('Error updating chart:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Initialize chart\n  const initializeChart = () => {\n    if (!chartContainerRef.current) return;\n\n    // Remove existing chart\n    if (chartRef.current) {\n      chartRef.current.remove();\n    }\n\n    const chart = createChart(chartContainerRef.current, {\n      layout: {\n        background: { type: ColorType.Solid, color: 'transparent' },\n        textColor: '#ffffff',\n      },\n      grid: {\n        vertLines: { color: 'rgba(255, 255, 255, 0.1)' },\n        horzLines: { color: 'rgba(255, 255, 255, 0.1)' },\n      },\n      crosshair: {\n        mode: 1,\n      },\n      rightPriceScale: {\n        borderColor: 'rgba(255, 255, 255, 0.3)',\n      },\n      timeScale: {\n        borderColor: 'rgba(255, 255, 255, 0.3)',\n        timeVisible: true,\n        secondsVisible: false,\n        rightOffset: 5,\n        barSpacing: 6,\n        fixLeftEdge: true,\n        fixRightEdge: true,\n      },\n      width: chartContainerRef.current.clientWidth,\n      height: 400,\n    });\n\n    // Add line series using correct API\n    const lineSeries = chart.addSeries(LineSeries, {\n      color: '#26a69a',\n      lineWidth: 2,\n    });\n\n    chartRef.current = chart;\n    seriesRef.current = lineSeries;\n\n    // Handle resize\n    const handleResize = () => {\n      if (chartRef.current && chartContainerRef.current) {\n        chartRef.current.applyOptions({\n          width: chartContainerRef.current.clientWidth,\n        });\n      }\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  };\n\n  // Initialize chart on mount\n  useEffect(() => {\n    const cleanup = initializeChart();\n    // Load initial data after chart is initialized\n    setTimeout(() => {\n      if (selectedSymbol && selectedTimeframe) {\n        updateChart(selectedSymbol, selectedTimeframe);\n      }\n    }, 200);\n    return cleanup;\n  }, []);\n\n  // Update chart when symbol or timeframe changes\n  useEffect(() => {\n    if (selectedSymbol && selectedTimeframe) {\n      updateChart(selectedSymbol, selectedTimeframe);\n    }\n  }, [selectedSymbol, selectedTimeframe]);\n\n  // Set default symbol to first holding if available\n  useEffect(() => {\n    if (holdings.length > 0 && selectedSymbol === \"NVDA\") {\n      setSelectedSymbol(holdings[0].symbol);\n    }\n  }, [holdings]);\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg flex items-center space-x-2\">\n            <TrendingUp className=\"w-5 h-5\" />\n            <span>Tournament Chart - {selectedSymbol}</span>\n          </CardTitle>\n          <div className=\"flex items-center space-x-2\">\n            {/* Symbol Search Bar with Autocomplete */}\n            <div className=\"relative\">\n              <Search className=\"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n              <Input\n                type=\"text\"\n                value={searchQuery}\n                onChange={(e) => handleSearchInput(e.target.value)}\n                onKeyDown={handleKeyDown}\n                onFocus={() => searchQuery.length >= 2 && setShowDropdown(true)}\n                onBlur={() => setTimeout(() => setShowDropdown(false), 200)}\n                placeholder=\"Search stocks, crypto...\"\n                className=\"pl-8 w-48 h-8\"\n              />\n              \n              {/* Search Results Dropdown */}\n              {showDropdown && (searchResults.length > 0 || isSearching) && (\n                <div className=\"absolute top-full right-0 w-80 mt-1 bg-background border border-border rounded-md shadow-lg z-50 max-h-64 overflow-y-auto\">\n                  {isSearching ? (\n                    <div className=\"p-3 text-center text-muted-foreground\">\n                      <RefreshCw className=\"w-4 h-4 animate-spin mx-auto mb-1\" />\n                      Searching...\n                    </div>\n                  ) : (\n                    searchResults.map((result, index) => (\n                      <div\n                        key={index}\n                        onClick={() => selectSearchResult(result)}\n                        className=\"p-3 hover:bg-accent cursor-pointer border-b border-border last:border-b-0\"\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-center space-x-2\">\n                              <span className=\"font-medium text-sm\">{result.symbol}</span>\n                              <span className=\"text-xs text-muted-foreground truncate\">\n                                {result.name || result.shortName || result.companyName}\n                              </span>\n                            </div>\n                            {result.exchange && (\n                              <div className=\"text-xs text-muted-foreground mt-1\">\n                                {result.exchange}\n                              </div>\n                            )}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            Chart\n                          </div>\n                        </div>\n                      </div>\n                    ))\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Timeframe Selector */}\n            <Select value={selectedTimeframe} onValueChange={setSelectedTimeframe}>\n              <SelectTrigger className=\"w-24\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"1D\">1D</SelectItem>\n                <SelectItem value=\"5D\">5D</SelectItem>\n                <SelectItem value=\"1M\">1M</SelectItem>\n                <SelectItem value=\"3M\">3M</SelectItem>\n                <SelectItem value=\"6M\">6M</SelectItem>\n                <SelectItem value=\"1Y\">1Y</SelectItem>\n              </SelectContent>\n            </Select>\n\n            {/* Refresh Button */}\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => updateChart(selectedSymbol, selectedTimeframe)}\n              disabled={isLoading}\n            >\n              <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"h-[430px] w-full relative\">\n          {isLoading && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-background/80 z-10\">\n              <RefreshCw className=\"w-6 h-6 animate-spin mr-2\" />\n              <span className=\"text-muted-foreground\">Loading chart data...</span>\n            </div>\n          )}\n          <div \n            ref={chartContainerRef} \n            className=\"w-full h-full rounded-md\"\n          />\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":13076},"client/src/components/portfolio/widgets/WatchlistWidget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Eye, TrendingUp, TrendingDown, Plus } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\n\nexport function WatchlistWidget() {\n  const { user } = useAuth();\n\n  const { data: watchlistData, isLoading } = useQuery({\n    queryKey: ['/api/watchlist'],\n    enabled: !!user,\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg\">Watchlist</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"animate-pulse space-y-3\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex justify-between items-center\">\n                <div className=\"h-4 bg-muted rounded w-16\"></div>\n                <div className=\"h-4 bg-muted rounded w-20\"></div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const watchlist = watchlistData?.data?.slice(0, 5) || [];\n\n  return (\n    <Card className=\"h-full\">\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Eye className=\"w-5 h-5\" />\n            <span>Watchlist</span>\n          </div>\n          <Link href=\"/dashboard\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <Plus className=\"w-4 h-4\" />\n            </Button>\n          </Link>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        {watchlist.length === 0 ? (\n          <div className=\"text-center text-muted-foreground py-4\">\n            <Eye className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n            <p className=\"text-sm\">No stocks in watchlist</p>\n            <Link href=\"/dashboard\">\n              <Button variant=\"outline\" size=\"sm\" className=\"mt-2\">\n                Add Stocks\n              </Button>\n            </Link>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {watchlist.map((stock: any) => {\n              const change = parseFloat(stock.changePercent || 0);\n              const isPositive = change >= 0;\n              \n              return (\n                <div key={stock.symbol} className=\"flex justify-between items-center\">\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"font-medium text-sm\">{stock.symbol}</span>\n                    {isPositive ? (\n                      <TrendingUp className=\"w-3 h-3 text-green-600\" />\n                    ) : (\n                      <TrendingDown className=\"w-3 h-3 text-red-600\" />\n                    )}\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"text-sm\">${stock.price?.toFixed(2)}</span>\n                    <Badge variant={isPositive ? \"default\" : \"destructive\"} className=\"text-xs\">\n                      {isPositive ? '+' : ''}{change.toFixed(2)}%\n                    </Badge>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3387}},"version":1}